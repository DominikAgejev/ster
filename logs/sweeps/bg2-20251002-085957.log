[sweep] === ./configs/results/bg2.yaml ===
[sweep] cmd: python [sweep] cmd: -u [sweep] cmd: -m [sweep] cmd: src.engine.sweep [sweep] cmd: --config [sweep] cmd: ./configs/results/bg2.yaml [sweep] cmd: --only_full [sweep] cmd: --auto-summary [sweep] cmd: --analysis [sweep] cmd: --eval-winners [sweep] cmd: --test_split_file [sweep] cmd: AUTO [sweep] cmd: --skip-existing 
[sweep] FULL-only mode: training full stage for all runs.
[sweep] === Run 1/24 ===
[sweep] id=001_model=late__backbone=smallcnn__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model late --backbone smallcnn --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:04<08:10,  4.95s/it]Training (late/smallcnn):   1%|          | 1/100 [00:04<08:10,  4.95s/it, train loss=0.0117, val ΔE00=11.158, best=11.158]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:37,  4.67s/it, train loss=0.0117, val ΔE00=11.158, best=11.158]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:37,  4.67s/it, train loss=0.0098, val ΔE00=7.173, best=7.173]  Training (late/smallcnn):   3%|▎         | 3/100 [00:13<07:23,  4.57s/it, train loss=0.0098, val ΔE00=7.173, best=7.173]Training (late/smallcnn):   3%|▎         | 3/100 [00:13<07:23,  4.57s/it, train loss=0.0163, val ΔE00=7.848, best=7.173]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:15,  4.54s/it, train loss=0.0163, val ΔE00=7.848, best=7.173]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:15,  4.54s/it, train loss=0.0245, val ΔE00=6.083, best=6.083]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:16,  4.60s/it, train loss=0.0245, val ΔE00=6.083, best=6.083]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:16,  4.60s/it, train loss=0.0401, val ΔE00=7.060, best=6.083]Training (late/smallcnn):   6%|▌         | 6/100 [00:27<07:11,  4.59s/it, train loss=0.0401, val ΔE00=7.060, best=6.083]Training (late/smallcnn):   6%|▌         | 6/100 [00:27<07:11,  4.59s/it, train loss=0.0569, val ΔE00=5.912, best=5.912]Training (late/smallcnn):   7%|▋         | 7/100 [00:32<07:03,  4.55s/it, train loss=0.0569, val ΔE00=5.912, best=5.912]Training (late/smallcnn):   7%|▋         | 7/100 [00:32<07:03,  4.55s/it, train loss=0.0688, val ΔE00=5.836, best=5.836]Training (late/smallcnn):   8%|▊         | 8/100 [00:36<06:56,  4.53s/it, train loss=0.0688, val ΔE00=5.836, best=5.836]Training (late/smallcnn):   8%|▊         | 8/100 [00:36<06:56,  4.53s/it, train loss=0.0933, val ΔE00=7.835, best=5.836]Training (late/smallcnn):   9%|▉         | 9/100 [00:41<06:50,  4.51s/it, train loss=0.0933, val ΔE00=7.835, best=5.836]Training (late/smallcnn):   9%|▉         | 9/100 [00:41<06:50,  4.51s/it, train loss=0.1147, val ΔE00=10.852, best=5.836]Training (late/smallcnn):  10%|█         | 10/100 [00:45<06:51,  4.57s/it, train loss=0.1147, val ΔE00=10.852, best=5.836]Training (late/smallcnn):  10%|█         | 10/100 [00:45<06:51,  4.57s/it, train loss=0.1301, val ΔE00=4.412, best=4.412] Training (late/smallcnn):  11%|█         | 11/100 [00:50<06:47,  4.58s/it, train loss=0.1301, val ΔE00=4.412, best=4.412]Training (late/smallcnn):  11%|█         | 11/100 [00:50<06:47,  4.58s/it, train loss=0.1497, val ΔE00=4.183, best=4.183]Training (late/smallcnn):  12%|█▏        | 12/100 [00:54<06:40,  4.55s/it, train loss=0.1497, val ΔE00=4.183, best=4.183]Training (late/smallcnn):  12%|█▏        | 12/100 [00:54<06:40,  4.55s/it, train loss=0.1945, val ΔE00=4.627, best=4.183]Training (late/smallcnn):  13%|█▎        | 13/100 [00:59<06:33,  4.53s/it, train loss=0.1945, val ΔE00=4.627, best=4.183]Training (late/smallcnn):  13%|█▎        | 13/100 [00:59<06:33,  4.53s/it, train loss=0.2127, val ΔE00=6.618, best=4.183]Training (late/smallcnn):  14%|█▍        | 14/100 [01:03<06:28,  4.51s/it, train loss=0.2127, val ΔE00=6.618, best=4.183]Training (late/smallcnn):  14%|█▍        | 14/100 [01:03<06:28,  4.51s/it, train loss=0.2491, val ΔE00=4.559, best=4.183]Training (late/smallcnn):  15%|█▌        | 15/100 [01:08<06:28,  4.57s/it, train loss=0.2491, val ΔE00=4.559, best=4.183]Training (late/smallcnn):  15%|█▌        | 15/100 [01:08<06:28,  4.57s/it, train loss=0.2758, val ΔE00=4.199, best=4.183]Training (late/smallcnn):  16%|█▌        | 16/100 [01:13<06:24,  4.58s/it, train loss=0.2758, val ΔE00=4.199, best=4.183]Training (late/smallcnn):  16%|█▌        | 16/100 [01:13<06:24,  4.58s/it, train loss=0.3024, val ΔE00=5.353, best=4.183]Training (late/smallcnn):  17%|█▋        | 17/100 [01:17<06:17,  4.55s/it, train loss=0.3024, val ΔE00=5.353, best=4.183]Training (late/smallcnn):  17%|█▋        | 17/100 [01:17<06:17,  4.55s/it, train loss=0.3439, val ΔE00=3.551, best=3.551]Training (late/smallcnn):  18%|█▊        | 18/100 [01:22<06:11,  4.53s/it, train loss=0.3439, val ΔE00=3.551, best=3.551]Training (late/smallcnn):  18%|█▊        | 18/100 [01:22<06:11,  4.53s/it, train loss=0.3713, val ΔE00=4.182, best=3.551]Training (late/smallcnn):  19%|█▉        | 19/100 [01:26<06:05,  4.52s/it, train loss=0.3713, val ΔE00=4.182, best=3.551]Training (late/smallcnn):  19%|█▉        | 19/100 [01:26<06:05,  4.52s/it, train loss=0.4151, val ΔE00=3.215, best=3.215]Training (late/smallcnn):  20%|██        | 20/100 [01:31<06:05,  4.57s/it, train loss=0.4151, val ΔE00=3.215, best=3.215]Training (late/smallcnn):  20%|██        | 20/100 [01:31<06:05,  4.57s/it, train loss=0.4879, val ΔE00=4.717, best=3.215]Training (late/smallcnn):  21%|██        | 21/100 [01:35<06:01,  4.58s/it, train loss=0.4879, val ΔE00=4.717, best=3.215]Training (late/smallcnn):  21%|██        | 21/100 [01:35<06:01,  4.58s/it, train loss=0.5046, val ΔE00=5.971, best=3.215]Training (late/smallcnn):  22%|██▏       | 22/100 [01:40<05:54,  4.55s/it, train loss=0.5046, val ΔE00=5.971, best=3.215]Training (late/smallcnn):  22%|██▏       | 22/100 [01:40<05:54,  4.55s/it, train loss=0.5478, val ΔE00=3.514, best=3.215]Training (late/smallcnn):  23%|██▎       | 23/100 [01:44<05:48,  4.52s/it, train loss=0.5478, val ΔE00=3.514, best=3.215]Training (late/smallcnn):  23%|██▎       | 23/100 [01:44<05:48,  4.52s/it, train loss=0.5653, val ΔE00=3.878, best=3.215]Training (late/smallcnn):  24%|██▍       | 24/100 [01:49<05:42,  4.51s/it, train loss=0.5653, val ΔE00=3.878, best=3.215]Training (late/smallcnn):  24%|██▍       | 24/100 [01:49<05:42,  4.51s/it, train loss=0.6062, val ΔE00=3.802, best=3.215]Training (late/smallcnn):  25%|██▌       | 25/100 [01:53<05:42,  4.56s/it, train loss=0.6062, val ΔE00=3.802, best=3.215]Training (late/smallcnn):  25%|██▌       | 25/100 [01:53<05:42,  4.56s/it, train loss=0.6658, val ΔE00=4.601, best=3.215]Training (late/smallcnn):  26%|██▌       | 26/100 [01:58<05:38,  4.57s/it, train loss=0.6658, val ΔE00=4.601, best=3.215]Training (late/smallcnn):  26%|██▌       | 26/100 [01:58<05:38,  4.57s/it, train loss=0.7166, val ΔE00=4.709, best=3.215]Training (late/smallcnn):  27%|██▋       | 27/100 [02:03<05:31,  4.54s/it, train loss=0.7166, val ΔE00=4.709, best=3.215]Training (late/smallcnn):  27%|██▋       | 27/100 [02:03<05:31,  4.54s/it, train loss=0.7593, val ΔE00=3.989, best=3.215]Training (late/smallcnn):  28%|██▊       | 28/100 [02:07<05:25,  4.53s/it, train loss=0.7593, val ΔE00=3.989, best=3.215]Training (late/smallcnn):  28%|██▊       | 28/100 [02:07<05:25,  4.53s/it, train loss=0.8051, val ΔE00=3.170, best=3.170]Training (late/smallcnn):  29%|██▉       | 29/100 [02:12<05:20,  4.51s/it, train loss=0.8051, val ΔE00=3.170, best=3.170]Training (late/smallcnn):  29%|██▉       | 29/100 [02:12<05:20,  4.51s/it, train loss=0.8200, val ΔE00=3.850, best=3.170]Training (late/smallcnn):  30%|███       | 30/100 [02:16<05:19,  4.57s/it, train loss=0.8200, val ΔE00=3.850, best=3.170]Training (late/smallcnn):  30%|███       | 30/100 [02:16<05:19,  4.57s/it, train loss=0.9139, val ΔE00=3.920, best=3.170]Training (late/smallcnn):  31%|███       | 31/100 [02:21<05:16,  4.58s/it, train loss=0.9139, val ΔE00=3.920, best=3.170]Training (late/smallcnn):  31%|███       | 31/100 [02:21<05:16,  4.58s/it, train loss=0.9616, val ΔE00=6.196, best=3.170]Training (late/smallcnn):  32%|███▏      | 32/100 [02:25<05:09,  4.55s/it, train loss=0.9616, val ΔE00=6.196, best=3.170]Training (late/smallcnn):  32%|███▏      | 32/100 [02:25<05:09,  4.55s/it, train loss=0.9641, val ΔE00=3.212, best=3.170]Training (late/smallcnn):  33%|███▎      | 33/100 [02:30<05:03,  4.53s/it, train loss=0.9641, val ΔE00=3.212, best=3.170]Training (late/smallcnn):  33%|███▎      | 33/100 [02:30<05:03,  4.53s/it, train loss=0.9987, val ΔE00=3.236, best=3.170]Training (late/smallcnn):  34%|███▍      | 34/100 [02:34<04:57,  4.51s/it, train loss=0.9987, val ΔE00=3.236, best=3.170]Training (late/smallcnn):  34%|███▍      | 34/100 [02:34<04:57,  4.51s/it, train loss=1.0856, val ΔE00=3.128, best=3.128]Training (late/smallcnn):  35%|███▌      | 35/100 [02:39<04:56,  4.56s/it, train loss=1.0856, val ΔE00=3.128, best=3.128]Training (late/smallcnn):  35%|███▌      | 35/100 [02:39<04:56,  4.56s/it, train loss=1.0989, val ΔE00=3.114, best=3.114]Training (late/smallcnn):  36%|███▌      | 36/100 [02:44<04:52,  4.57s/it, train loss=1.0989, val ΔE00=3.114, best=3.114]Training (late/smallcnn):  36%|███▌      | 36/100 [02:44<04:52,  4.57s/it, train loss=1.1401, val ΔE00=3.296, best=3.114]Training (late/smallcnn):  37%|███▋      | 37/100 [02:48<04:46,  4.54s/it, train loss=1.1401, val ΔE00=3.296, best=3.114]Training (late/smallcnn):  37%|███▋      | 37/100 [02:48<04:46,  4.54s/it, train loss=1.1987, val ΔE00=3.850, best=3.114]Training (late/smallcnn):  38%|███▊      | 38/100 [02:52<04:40,  4.52s/it, train loss=1.1987, val ΔE00=3.850, best=3.114]Training (late/smallcnn):  38%|███▊      | 38/100 [02:52<04:40,  4.52s/it, train loss=1.2600, val ΔE00=3.578, best=3.114]Training (late/smallcnn):  39%|███▉      | 39/100 [02:57<04:34,  4.51s/it, train loss=1.2600, val ΔE00=3.578, best=3.114]Training (late/smallcnn):  39%|███▉      | 39/100 [02:57<04:34,  4.51s/it, train loss=1.3310, val ΔE00=3.678, best=3.114]Training (late/smallcnn):  40%|████      | 40/100 [03:02<04:34,  4.57s/it, train loss=1.3310, val ΔE00=3.678, best=3.114]Training (late/smallcnn):  40%|████      | 40/100 [03:02<04:34,  4.57s/it, train loss=1.3623, val ΔE00=3.362, best=3.114]Training (late/smallcnn):  41%|████      | 41/100 [03:06<04:29,  4.57s/it, train loss=1.3623, val ΔE00=3.362, best=3.114]Training (late/smallcnn):  41%|████      | 41/100 [03:06<04:29,  4.57s/it, train loss=1.3930, val ΔE00=5.795, best=3.114]Training (late/smallcnn):  42%|████▏     | 42/100 [03:11<04:23,  4.55s/it, train loss=1.3930, val ΔE00=5.795, best=3.114]Training (late/smallcnn):  42%|████▏     | 42/100 [03:11<04:23,  4.55s/it, train loss=1.4839, val ΔE00=3.115, best=3.114]Training (late/smallcnn):  43%|████▎     | 43/100 [03:15<04:17,  4.53s/it, train loss=1.4839, val ΔE00=3.115, best=3.114]Training (late/smallcnn):  43%|████▎     | 43/100 [03:15<04:17,  4.53s/it, train loss=1.4821, val ΔE00=4.249, best=3.114]Training (late/smallcnn):  44%|████▍     | 44/100 [03:20<04:12,  4.51s/it, train loss=1.4821, val ΔE00=4.249, best=3.114]Training (late/smallcnn):  44%|████▍     | 44/100 [03:20<04:12,  4.51s/it, train loss=1.5321, val ΔE00=2.956, best=2.956]Training (late/smallcnn):  45%|████▌     | 45/100 [03:24<04:11,  4.57s/it, train loss=1.5321, val ΔE00=2.956, best=2.956]Training (late/smallcnn):  45%|████▌     | 45/100 [03:24<04:11,  4.57s/it, train loss=1.5791, val ΔE00=3.634, best=2.956]Training (late/smallcnn):  46%|████▌     | 46/100 [03:29<04:06,  4.57s/it, train loss=1.5791, val ΔE00=3.634, best=2.956]Training (late/smallcnn):  46%|████▌     | 46/100 [03:29<04:06,  4.57s/it, train loss=1.6377, val ΔE00=3.239, best=2.956]Training (late/smallcnn):  47%|████▋     | 47/100 [03:33<04:00,  4.54s/it, train loss=1.6377, val ΔE00=3.239, best=2.956]Training (late/smallcnn):  47%|████▋     | 47/100 [03:33<04:00,  4.54s/it, train loss=1.6378, val ΔE00=3.014, best=2.956]Training (late/smallcnn):  48%|████▊     | 48/100 [03:38<03:55,  4.52s/it, train loss=1.6378, val ΔE00=3.014, best=2.956]Training (late/smallcnn):  48%|████▊     | 48/100 [03:38<03:55,  4.52s/it, train loss=1.7138, val ΔE00=3.047, best=2.956]Training (late/smallcnn):  49%|████▉     | 49/100 [03:42<03:49,  4.51s/it, train loss=1.7138, val ΔE00=3.047, best=2.956]Training (late/smallcnn):  49%|████▉     | 49/100 [03:42<03:49,  4.51s/it, train loss=1.6646, val ΔE00=3.364, best=2.956]Training (late/smallcnn):  50%|█████     | 50/100 [03:47<03:48,  4.56s/it, train loss=1.6646, val ΔE00=3.364, best=2.956]Training (late/smallcnn):  50%|█████     | 50/100 [03:47<03:48,  4.56s/it, train loss=1.7477, val ΔE00=4.432, best=2.956]Training (late/smallcnn):  51%|█████     | 51/100 [03:52<03:44,  4.58s/it, train loss=1.7477, val ΔE00=4.432, best=2.956]Training (late/smallcnn):  51%|█████     | 51/100 [03:52<03:44,  4.58s/it, train loss=1.8421, val ΔE00=3.978, best=2.956]Training (late/smallcnn):  52%|█████▏    | 52/100 [03:56<03:38,  4.55s/it, train loss=1.8421, val ΔE00=3.978, best=2.956]Training (late/smallcnn):  52%|█████▏    | 52/100 [03:56<03:38,  4.55s/it, train loss=1.9013, val ΔE00=2.913, best=2.913]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:01<03:32,  4.52s/it, train loss=1.9013, val ΔE00=2.913, best=2.913]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:01<03:32,  4.52s/it, train loss=1.8650, val ΔE00=3.522, best=2.913]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:05<03:27,  4.51s/it, train loss=1.8650, val ΔE00=3.522, best=2.913]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:05<03:27,  4.51s/it, train loss=1.9375, val ΔE00=2.764, best=2.764]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:10<03:25,  4.56s/it, train loss=1.9375, val ΔE00=2.764, best=2.764]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:10<03:25,  4.56s/it, train loss=1.9720, val ΔE00=3.219, best=2.764]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:14<03:21,  4.58s/it, train loss=1.9720, val ΔE00=3.219, best=2.764]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:14<03:21,  4.58s/it, train loss=2.0459, val ΔE00=3.267, best=2.764]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:19<03:15,  4.54s/it, train loss=2.0459, val ΔE00=3.267, best=2.764]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:19<03:15,  4.54s/it, train loss=1.9902, val ΔE00=4.164, best=2.764]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:23<03:09,  4.52s/it, train loss=1.9902, val ΔE00=4.164, best=2.764]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:23<03:09,  4.52s/it, train loss=2.0686, val ΔE00=3.502, best=2.764]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:28<03:04,  4.51s/it, train loss=2.0686, val ΔE00=3.502, best=2.764]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:28<03:04,  4.51s/it, train loss=2.0494, val ΔE00=3.041, best=2.764]Training (late/smallcnn):  60%|██████    | 60/100 [04:33<03:02,  4.57s/it, train loss=2.0494, val ΔE00=3.041, best=2.764]Training (late/smallcnn):  60%|██████    | 60/100 [04:33<03:02,  4.57s/it, train loss=2.1231, val ΔE00=5.496, best=2.764]Training (late/smallcnn):  61%|██████    | 61/100 [04:37<02:58,  4.58s/it, train loss=2.1231, val ΔE00=5.496, best=2.764]Training (late/smallcnn):  61%|██████    | 61/100 [04:37<02:58,  4.58s/it, train loss=2.0548, val ΔE00=2.748, best=2.748]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:42<02:52,  4.55s/it, train loss=2.0548, val ΔE00=2.748, best=2.748]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:42<02:52,  4.55s/it, train loss=2.1430, val ΔE00=3.096, best=2.748]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:46<02:47,  4.53s/it, train loss=2.1430, val ΔE00=3.096, best=2.748]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:46<02:47,  4.53s/it, train loss=2.1816, val ΔE00=3.402, best=2.748]Training (late/smallcnn):  64%|██████▍   | 64/100 [04:51<02:42,  4.52s/it, train loss=2.1816, val ΔE00=3.402, best=2.748]Training (late/smallcnn):  64%|██████▍   | 64/100 [04:51<02:42,  4.52s/it, train loss=2.0808, val ΔE00=2.922, best=2.748]Training (late/smallcnn):  65%|██████▌   | 65/100 [04:55<02:41,  4.61s/it, train loss=2.0808, val ΔE00=2.922, best=2.748]Training (late/smallcnn):  65%|██████▌   | 65/100 [04:55<02:41,  4.61s/it, train loss=2.1400, val ΔE00=3.481, best=2.748]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:00<02:40,  4.71s/it, train loss=2.1400, val ΔE00=3.481, best=2.748]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:00<02:40,  4.71s/it, train loss=2.1563, val ΔE00=2.547, best=2.547]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:05<02:33,  4.65s/it, train loss=2.1563, val ΔE00=2.547, best=2.547]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:05<02:33,  4.65s/it, train loss=2.2283, val ΔE00=3.387, best=2.547]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:09<02:27,  4.62s/it, train loss=2.2283, val ΔE00=3.387, best=2.547]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:09<02:27,  4.62s/it, train loss=2.1649, val ΔE00=3.137, best=2.547]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:14<02:22,  4.59s/it, train loss=2.1649, val ΔE00=3.137, best=2.547]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:14<02:22,  4.59s/it, train loss=2.2183, val ΔE00=2.846, best=2.547]Training (late/smallcnn):  70%|███████   | 70/100 [05:19<02:19,  4.66s/it, train loss=2.2183, val ΔE00=2.846, best=2.547]Training (late/smallcnn):  70%|███████   | 70/100 [05:19<02:19,  4.66s/it, train loss=2.3632, val ΔE00=2.800, best=2.547]Training (late/smallcnn):  71%|███████   | 71/100 [05:23<02:15,  4.67s/it, train loss=2.3632, val ΔE00=2.800, best=2.547]Training (late/smallcnn):  71%|███████   | 71/100 [05:23<02:15,  4.67s/it, train loss=2.2783, val ΔE00=3.114, best=2.547]Training (late/smallcnn):  72%|███████▏  | 72/100 [05:28<02:09,  4.62s/it, train loss=2.2783, val ΔE00=3.114, best=2.547]Training (late/smallcnn):  72%|███████▏  | 72/100 [05:28<02:09,  4.62s/it, train loss=2.1668, val ΔE00=3.694, best=2.547]Training (late/smallcnn):  73%|███████▎  | 73/100 [05:32<02:03,  4.58s/it, train loss=2.1668, val ΔE00=3.694, best=2.547]Training (late/smallcnn):  73%|███████▎  | 73/100 [05:32<02:03,  4.58s/it, train loss=2.2254, val ΔE00=2.684, best=2.547]Training (late/smallcnn):  74%|███████▍  | 74/100 [05:37<01:58,  4.55s/it, train loss=2.2254, val ΔE00=2.684, best=2.547]Training (late/smallcnn):  74%|███████▍  | 74/100 [05:37<01:58,  4.55s/it, train loss=2.1956, val ΔE00=2.987, best=2.547]Training (late/smallcnn):  75%|███████▌  | 75/100 [05:42<01:55,  4.60s/it, train loss=2.1956, val ΔE00=2.987, best=2.547]Training (late/smallcnn):  75%|███████▌  | 75/100 [05:42<01:55,  4.60s/it, train loss=2.6947, val ΔE00=2.901, best=2.547]Training (late/smallcnn):  75%|███████▌  | 75/100 [05:46<01:55,  4.60s/it, train loss=2.4301, val ΔE00=2.706, early_stop=yes]Training (late/smallcnn):  75%|███████▌  | 75/100 [05:46<01:55,  4.62s/it, train loss=2.4301, val ΔE00=2.706, early_stop=yes]
[early] stop at epoch 76 (best de00=2.5474 @ 66)
[done] best ΔE00=2.547 over 76 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/late__smallcnn__image__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image/final_summary.json (kind=val)
[sweep] === Run 2/24 ===
[sweep] id=002_model=late__backbone=smallcnn__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model late --backbone smallcnn --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image+mean, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:27,  5.13s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:27,  5.13s/it, train loss=0.0097, val ΔE00=8.118, best=8.118]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:53,  4.83s/it, train loss=0.0097, val ΔE00=8.118, best=8.118]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:53,  4.83s/it, train loss=0.0070, val ΔE00=4.777, best=4.777]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:39,  4.74s/it, train loss=0.0070, val ΔE00=4.777, best=4.777]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:39,  4.74s/it, train loss=0.0126, val ΔE00=4.751, best=4.751]Training (late/smallcnn):   4%|▍         | 4/100 [00:19<07:30,  4.69s/it, train loss=0.0126, val ΔE00=4.751, best=4.751]Training (late/smallcnn):   4%|▍         | 4/100 [00:19<07:30,  4.69s/it, train loss=0.0200, val ΔE00=4.979, best=4.751]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:32,  4.77s/it, train loss=0.0200, val ΔE00=4.979, best=4.751]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:32,  4.77s/it, train loss=0.0315, val ΔE00=3.879, best=3.879]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:26,  4.75s/it, train loss=0.0315, val ΔE00=3.879, best=3.879]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:26,  4.75s/it, train loss=0.0440, val ΔE00=4.963, best=3.879]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:17,  4.71s/it, train loss=0.0440, val ΔE00=4.963, best=3.879]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:17,  4.71s/it, train loss=0.0600, val ΔE00=3.396, best=3.396]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:10,  4.68s/it, train loss=0.0600, val ΔE00=3.396, best=3.396]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:10,  4.68s/it, train loss=0.0725, val ΔE00=3.514, best=3.396]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:03,  4.66s/it, train loss=0.0725, val ΔE00=3.514, best=3.396]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:03,  4.66s/it, train loss=0.0892, val ΔE00=3.426, best=3.396]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.72s/it, train loss=0.0892, val ΔE00=3.426, best=3.396]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.72s/it, train loss=0.1162, val ΔE00=3.736, best=3.396]Training (late/smallcnn):  11%|█         | 11/100 [00:52<06:59,  4.72s/it, train loss=0.1162, val ΔE00=3.736, best=3.396]Training (late/smallcnn):  11%|█         | 11/100 [00:52<06:59,  4.72s/it, train loss=0.1354, val ΔE00=3.154, best=3.154]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:52,  4.69s/it, train loss=0.1354, val ΔE00=3.154, best=3.154]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:52,  4.69s/it, train loss=0.1664, val ΔE00=4.222, best=3.154]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:45,  4.66s/it, train loss=0.1664, val ΔE00=4.222, best=3.154]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:45,  4.66s/it, train loss=0.1940, val ΔE00=4.168, best=3.154]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:39,  4.64s/it, train loss=0.1940, val ΔE00=4.168, best=3.154]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:39,  4.64s/it, train loss=0.2073, val ΔE00=3.359, best=3.154]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:40,  4.71s/it, train loss=0.2073, val ΔE00=3.359, best=3.154]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:40,  4.71s/it, train loss=0.2312, val ΔE00=2.825, best=2.825]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:36,  4.72s/it, train loss=0.2312, val ΔE00=2.825, best=2.825]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:36,  4.72s/it, train loss=0.2760, val ΔE00=4.260, best=2.825]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:29,  4.69s/it, train loss=0.2760, val ΔE00=4.260, best=2.825]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:29,  4.69s/it, train loss=0.3128, val ΔE00=2.842, best=2.825]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:22,  4.67s/it, train loss=0.3128, val ΔE00=2.842, best=2.825]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:22,  4.67s/it, train loss=0.3662, val ΔE00=2.743, best=2.743]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:16,  4.65s/it, train loss=0.3662, val ΔE00=2.743, best=2.743]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:16,  4.65s/it, train loss=0.3752, val ΔE00=2.936, best=2.743]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:16,  4.71s/it, train loss=0.3752, val ΔE00=2.936, best=2.743]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:16,  4.71s/it, train loss=0.3905, val ΔE00=3.730, best=2.743]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:12,  4.72s/it, train loss=0.3905, val ΔE00=3.730, best=2.743]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:12,  4.72s/it, train loss=0.4344, val ΔE00=2.812, best=2.743]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:05,  4.68s/it, train loss=0.4344, val ΔE00=2.812, best=2.743]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:05,  4.68s/it, train loss=0.4676, val ΔE00=2.925, best=2.743]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<05:59,  4.67s/it, train loss=0.4676, val ΔE00=2.925, best=2.743]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<05:59,  4.67s/it, train loss=0.5142, val ΔE00=2.636, best=2.636]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:53,  4.65s/it, train loss=0.5142, val ΔE00=2.636, best=2.636]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:53,  4.65s/it, train loss=0.5497, val ΔE00=3.079, best=2.636]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:53,  4.71s/it, train loss=0.5497, val ΔE00=3.079, best=2.636]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:53,  4.71s/it, train loss=0.6251, val ΔE00=3.716, best=2.636]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:48,  4.71s/it, train loss=0.6251, val ΔE00=3.716, best=2.636]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:48,  4.71s/it, train loss=0.6501, val ΔE00=2.808, best=2.636]Training (late/smallcnn):  27%|██▋       | 27/100 [02:06<05:41,  4.68s/it, train loss=0.6501, val ΔE00=2.808, best=2.636]Training (late/smallcnn):  27%|██▋       | 27/100 [02:06<05:41,  4.68s/it, train loss=0.6708, val ΔE00=3.159, best=2.636]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:35,  4.66s/it, train loss=0.6708, val ΔE00=3.159, best=2.636]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:35,  4.66s/it, train loss=0.6679, val ΔE00=2.525, best=2.525]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:29,  4.64s/it, train loss=0.6679, val ΔE00=2.525, best=2.525]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:29,  4.64s/it, train loss=0.7512, val ΔE00=2.876, best=2.525]Training (late/smallcnn):  30%|███       | 30/100 [02:20<05:28,  4.69s/it, train loss=0.7512, val ΔE00=2.876, best=2.525]Training (late/smallcnn):  30%|███       | 30/100 [02:20<05:28,  4.69s/it, train loss=0.8001, val ΔE00=2.636, best=2.525]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:24,  4.70s/it, train loss=0.8001, val ΔE00=2.636, best=2.525]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:24,  4.70s/it, train loss=0.8196, val ΔE00=2.552, best=2.525]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:17,  4.67s/it, train loss=0.8196, val ΔE00=2.552, best=2.525]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:17,  4.67s/it, train loss=0.8724, val ΔE00=3.926, best=2.525]Training (late/smallcnn):  33%|███▎      | 33/100 [02:34<05:11,  4.65s/it, train loss=0.8724, val ΔE00=3.926, best=2.525]Training (late/smallcnn):  33%|███▎      | 33/100 [02:34<05:11,  4.65s/it, train loss=0.9556, val ΔE00=2.675, best=2.525]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:06,  4.64s/it, train loss=0.9556, val ΔE00=2.675, best=2.525]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:06,  4.64s/it, train loss=0.9233, val ΔE00=2.559, best=2.525]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:05,  4.70s/it, train loss=0.9233, val ΔE00=2.559, best=2.525]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:05,  4.70s/it, train loss=0.9562, val ΔE00=2.518, best=2.518]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:01,  4.71s/it, train loss=0.9562, val ΔE00=2.518, best=2.518]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:01,  4.71s/it, train loss=1.0472, val ΔE00=2.404, best=2.404]Training (late/smallcnn):  37%|███▋      | 37/100 [02:53<04:54,  4.68s/it, train loss=1.0472, val ΔE00=2.404, best=2.404]Training (late/smallcnn):  37%|███▋      | 37/100 [02:53<04:54,  4.68s/it, train loss=1.1016, val ΔE00=2.605, best=2.404]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:48,  4.66s/it, train loss=1.1016, val ΔE00=2.605, best=2.404]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:48,  4.66s/it, train loss=1.1277, val ΔE00=2.493, best=2.404]Training (late/smallcnn):  39%|███▉      | 39/100 [03:02<04:43,  4.65s/it, train loss=1.1277, val ΔE00=2.493, best=2.404]Training (late/smallcnn):  39%|███▉      | 39/100 [03:02<04:43,  4.65s/it, train loss=1.1753, val ΔE00=2.367, best=2.367]Training (late/smallcnn):  40%|████      | 40/100 [03:07<04:42,  4.70s/it, train loss=1.1753, val ΔE00=2.367, best=2.367]Training (late/smallcnn):  40%|████      | 40/100 [03:07<04:42,  4.70s/it, train loss=1.2273, val ΔE00=2.767, best=2.367]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:38,  4.72s/it, train loss=1.2273, val ΔE00=2.767, best=2.367]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:38,  4.72s/it, train loss=1.1740, val ΔE00=2.371, best=2.367]Training (late/smallcnn):  42%|████▏     | 42/100 [03:17<04:32,  4.69s/it, train loss=1.1740, val ΔE00=2.371, best=2.367]Training (late/smallcnn):  42%|████▏     | 42/100 [03:17<04:32,  4.69s/it, train loss=1.2674, val ΔE00=3.338, best=2.367]Training (late/smallcnn):  43%|████▎     | 43/100 [03:21<04:26,  4.67s/it, train loss=1.2674, val ΔE00=3.338, best=2.367]Training (late/smallcnn):  43%|████▎     | 43/100 [03:21<04:26,  4.67s/it, train loss=1.2920, val ΔE00=2.622, best=2.367]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.66s/it, train loss=1.2920, val ΔE00=2.622, best=2.367]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.66s/it, train loss=1.3290, val ΔE00=2.513, best=2.367]Training (late/smallcnn):  45%|████▌     | 45/100 [03:31<04:18,  4.71s/it, train loss=1.3290, val ΔE00=2.513, best=2.367]Training (late/smallcnn):  45%|████▌     | 45/100 [03:31<04:18,  4.71s/it, train loss=1.3657, val ΔE00=2.585, best=2.367]Training (late/smallcnn):  46%|████▌     | 46/100 [03:35<04:15,  4.72s/it, train loss=1.3657, val ΔE00=2.585, best=2.367]Training (late/smallcnn):  46%|████▌     | 46/100 [03:35<04:15,  4.72s/it, train loss=1.4009, val ΔE00=2.524, best=2.367]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.70s/it, train loss=1.4009, val ΔE00=2.524, best=2.367]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.70s/it, train loss=1.5043, val ΔE00=2.548, best=2.367]Training (late/smallcnn):  48%|████▊     | 48/100 [03:45<04:03,  4.68s/it, train loss=1.5043, val ΔE00=2.548, best=2.367]Training (late/smallcnn):  48%|████▊     | 48/100 [03:45<04:03,  4.68s/it, train loss=1.5590, val ΔE00=2.601, best=2.367]Training (late/smallcnn):  49%|████▉     | 49/100 [03:49<03:57,  4.66s/it, train loss=1.5590, val ΔE00=2.601, best=2.367]Training (late/smallcnn):  49%|████▉     | 49/100 [03:49<03:57,  4.66s/it, train loss=1.5927, val ΔE00=2.744, best=2.367]Training (late/smallcnn):  50%|█████     | 50/100 [03:54<03:55,  4.72s/it, train loss=1.5927, val ΔE00=2.744, best=2.367]Training (late/smallcnn):  50%|█████     | 50/100 [03:54<03:55,  4.72s/it, train loss=1.5450, val ΔE00=2.541, best=2.367]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:51,  4.73s/it, train loss=1.5450, val ΔE00=2.541, best=2.367]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:51,  4.73s/it, train loss=1.6030, val ΔE00=2.931, best=2.367]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:04<03:45,  4.70s/it, train loss=1.6030, val ΔE00=2.931, best=2.367]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:04<03:45,  4.70s/it, train loss=1.6633, val ΔE00=2.868, best=2.367]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:08<03:39,  4.67s/it, train loss=1.6633, val ΔE00=2.868, best=2.367]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:08<03:39,  4.67s/it, train loss=1.7113, val ΔE00=2.579, best=2.367]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:13<03:34,  4.66s/it, train loss=1.7113, val ΔE00=2.579, best=2.367]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:13<03:34,  4.66s/it, train loss=1.6988, val ΔE00=2.410, best=2.367]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:18<03:32,  4.72s/it, train loss=1.6988, val ΔE00=2.410, best=2.367]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:18<03:32,  4.72s/it, train loss=1.7367, val ΔE00=2.421, best=2.367]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:22<03:27,  4.73s/it, train loss=1.7367, val ΔE00=2.421, best=2.367]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:22<03:27,  4.73s/it, train loss=1.7748, val ΔE00=2.440, best=2.367]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:22,  4.70s/it, train loss=1.7748, val ΔE00=2.440, best=2.367]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:22,  4.70s/it, train loss=1.8128, val ΔE00=2.375, best=2.367]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:32<03:16,  4.68s/it, train loss=1.8128, val ΔE00=2.375, best=2.367]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:32<03:16,  4.68s/it, train loss=1.7877, val ΔE00=2.362, best=2.362]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:36<03:11,  4.67s/it, train loss=1.7877, val ΔE00=2.362, best=2.362]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:36<03:11,  4.67s/it, train loss=1.8170, val ΔE00=2.556, best=2.362]Training (late/smallcnn):  60%|██████    | 60/100 [04:41<03:09,  4.73s/it, train loss=1.8170, val ΔE00=2.556, best=2.362]Training (late/smallcnn):  60%|██████    | 60/100 [04:41<03:09,  4.73s/it, train loss=1.9535, val ΔE00=2.502, best=2.362]Training (late/smallcnn):  61%|██████    | 61/100 [04:46<03:04,  4.73s/it, train loss=1.9535, val ΔE00=2.502, best=2.362]Training (late/smallcnn):  61%|██████    | 61/100 [04:46<03:04,  4.73s/it, train loss=1.8801, val ΔE00=3.432, best=2.362]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:51<02:58,  4.71s/it, train loss=1.8801, val ΔE00=3.432, best=2.362]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:51<02:58,  4.71s/it, train loss=1.8661, val ΔE00=2.446, best=2.362]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:55<02:53,  4.68s/it, train loss=1.8661, val ΔE00=2.446, best=2.362]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:55<02:53,  4.68s/it, train loss=1.8743, val ΔE00=2.892, best=2.362]Training (late/smallcnn):  64%|██████▍   | 64/100 [05:00<02:47,  4.66s/it, train loss=1.8743, val ΔE00=2.892, best=2.362]Training (late/smallcnn):  64%|██████▍   | 64/100 [05:00<02:47,  4.66s/it, train loss=1.8374, val ΔE00=2.503, best=2.362]Training (late/smallcnn):  65%|██████▌   | 65/100 [05:05<02:45,  4.72s/it, train loss=1.8374, val ΔE00=2.503, best=2.362]Training (late/smallcnn):  65%|██████▌   | 65/100 [05:05<02:45,  4.72s/it, train loss=2.0438, val ΔE00=2.347, best=2.347]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:09<02:40,  4.73s/it, train loss=2.0438, val ΔE00=2.347, best=2.347]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:09<02:40,  4.73s/it, train loss=1.8860, val ΔE00=2.415, best=2.347]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:14<02:35,  4.70s/it, train loss=1.8860, val ΔE00=2.415, best=2.347]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:14<02:35,  4.70s/it, train loss=1.9860, val ΔE00=2.439, best=2.347]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:19<02:29,  4.67s/it, train loss=1.9860, val ΔE00=2.439, best=2.347]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:19<02:29,  4.67s/it, train loss=2.1287, val ΔE00=2.723, best=2.347]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:23<02:24,  4.65s/it, train loss=2.1287, val ΔE00=2.723, best=2.347]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:23<02:24,  4.65s/it, train loss=1.9677, val ΔE00=2.427, best=2.347]Training (late/smallcnn):  70%|███████   | 70/100 [05:28<02:21,  4.72s/it, train loss=1.9677, val ΔE00=2.427, best=2.347]Training (late/smallcnn):  70%|███████   | 70/100 [05:28<02:21,  4.72s/it, train loss=1.9905, val ΔE00=2.222, best=2.222]Training (late/smallcnn):  71%|███████   | 71/100 [05:33<02:16,  4.71s/it, train loss=1.9905, val ΔE00=2.222, best=2.222]Training (late/smallcnn):  71%|███████   | 71/100 [05:33<02:16,  4.71s/it, train loss=1.9663, val ΔE00=2.277, best=2.222]Training (late/smallcnn):  72%|███████▏  | 72/100 [05:37<02:11,  4.68s/it, train loss=1.9663, val ΔE00=2.277, best=2.222]Training (late/smallcnn):  72%|███████▏  | 72/100 [05:37<02:11,  4.68s/it, train loss=2.0533, val ΔE00=2.527, best=2.222]Training (late/smallcnn):  73%|███████▎  | 73/100 [05:42<02:05,  4.66s/it, train loss=2.0533, val ΔE00=2.527, best=2.222]Training (late/smallcnn):  73%|███████▎  | 73/100 [05:42<02:05,  4.66s/it, train loss=1.9174, val ΔE00=2.465, best=2.222]Training (late/smallcnn):  74%|███████▍  | 74/100 [05:47<02:00,  4.65s/it, train loss=1.9174, val ΔE00=2.465, best=2.222]Training (late/smallcnn):  74%|███████▍  | 74/100 [05:47<02:00,  4.65s/it, train loss=2.0408, val ΔE00=2.291, best=2.222]Training (late/smallcnn):  75%|███████▌  | 75/100 [05:52<01:57,  4.71s/it, train loss=2.0408, val ΔE00=2.291, best=2.222]Training (late/smallcnn):  75%|███████▌  | 75/100 [05:52<01:57,  4.71s/it, train loss=2.2210, val ΔE00=2.690, best=2.222]Training (late/smallcnn):  76%|███████▌  | 76/100 [05:56<01:53,  4.72s/it, train loss=2.2210, val ΔE00=2.690, best=2.222]Training (late/smallcnn):  76%|███████▌  | 76/100 [05:56<01:53,  4.72s/it, train loss=2.2807, val ΔE00=2.356, best=2.222]Training (late/smallcnn):  77%|███████▋  | 77/100 [06:01<01:47,  4.68s/it, train loss=2.2807, val ΔE00=2.356, best=2.222]Training (late/smallcnn):  77%|███████▋  | 77/100 [06:01<01:47,  4.68s/it, train loss=2.2529, val ΔE00=3.034, best=2.222]Training (late/smallcnn):  78%|███████▊  | 78/100 [06:05<01:42,  4.66s/it, train loss=2.2529, val ΔE00=3.034, best=2.222]Training (late/smallcnn):  78%|███████▊  | 78/100 [06:05<01:42,  4.66s/it, train loss=2.2327, val ΔE00=2.353, best=2.222]Training (late/smallcnn):  79%|███████▉  | 79/100 [06:10<01:37,  4.65s/it, train loss=2.2327, val ΔE00=2.353, best=2.222]Training (late/smallcnn):  79%|███████▉  | 79/100 [06:10<01:37,  4.65s/it, train loss=2.1879, val ΔE00=2.397, best=2.222]Training (late/smallcnn):  80%|████████  | 80/100 [06:15<01:34,  4.70s/it, train loss=2.1879, val ΔE00=2.397, best=2.222]Training (late/smallcnn):  80%|████████  | 80/100 [06:15<01:34,  4.70s/it, train loss=2.1747, val ΔE00=2.198, best=2.198]Training (late/smallcnn):  81%|████████  | 81/100 [06:20<01:29,  4.71s/it, train loss=2.1747, val ΔE00=2.198, best=2.198]Training (late/smallcnn):  81%|████████  | 81/100 [06:20<01:29,  4.71s/it, train loss=2.1610, val ΔE00=2.498, best=2.198]Training (late/smallcnn):  82%|████████▏ | 82/100 [06:24<01:24,  4.68s/it, train loss=2.1610, val ΔE00=2.498, best=2.198]Training (late/smallcnn):  82%|████████▏ | 82/100 [06:24<01:24,  4.68s/it, train loss=2.2276, val ΔE00=2.752, best=2.198]Training (late/smallcnn):  83%|████████▎ | 83/100 [06:29<01:19,  4.66s/it, train loss=2.2276, val ΔE00=2.752, best=2.198]Training (late/smallcnn):  83%|████████▎ | 83/100 [06:29<01:19,  4.66s/it, train loss=2.1815, val ΔE00=2.452, best=2.198]Training (late/smallcnn):  84%|████████▍ | 84/100 [06:33<01:14,  4.64s/it, train loss=2.1815, val ΔE00=2.452, best=2.198]Training (late/smallcnn):  84%|████████▍ | 84/100 [06:33<01:14,  4.64s/it, train loss=2.1505, val ΔE00=2.896, best=2.198]Training (late/smallcnn):  85%|████████▌ | 85/100 [06:38<01:10,  4.70s/it, train loss=2.1505, val ΔE00=2.896, best=2.198]Training (late/smallcnn):  85%|████████▌ | 85/100 [06:38<01:10,  4.70s/it, train loss=2.2038, val ΔE00=2.669, best=2.198]Training (late/smallcnn):  86%|████████▌ | 86/100 [06:43<01:05,  4.71s/it, train loss=2.2038, val ΔE00=2.669, best=2.198]Training (late/smallcnn):  86%|████████▌ | 86/100 [06:43<01:05,  4.71s/it, train loss=2.2991, val ΔE00=2.952, best=2.198]Training (late/smallcnn):  87%|████████▋ | 87/100 [06:48<01:00,  4.68s/it, train loss=2.2991, val ΔE00=2.952, best=2.198]Training (late/smallcnn):  87%|████████▋ | 87/100 [06:48<01:00,  4.68s/it, train loss=2.1934, val ΔE00=2.616, best=2.198]Training (late/smallcnn):  88%|████████▊ | 88/100 [06:52<00:55,  4.66s/it, train loss=2.1934, val ΔE00=2.616, best=2.198]Training (late/smallcnn):  88%|████████▊ | 88/100 [06:52<00:55,  4.66s/it, train loss=2.1540, val ΔE00=2.972, best=2.198]Training (late/smallcnn):  89%|████████▉ | 89/100 [06:57<00:51,  4.64s/it, train loss=2.1540, val ΔE00=2.972, best=2.198]Training (late/smallcnn):  89%|████████▉ | 89/100 [06:57<00:51,  4.64s/it, train loss=2.1856, val ΔE00=2.443, best=2.198]Training (late/smallcnn):  89%|████████▉ | 89/100 [07:02<00:51,  4.64s/it, train loss=2.0157, val ΔE00=2.984, early_stop=yes]Training (late/smallcnn):  89%|████████▉ | 89/100 [07:02<00:52,  4.74s/it, train loss=2.0157, val ΔE00=2.984, early_stop=yes]
[early] stop at epoch 90 (best de00=2.1979 @ 80)
[done] best ΔE00=2.198 over 90 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/late__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 3/24 ===
[sweep] id=003_model=late__backbone=smallcnn__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model late --backbone smallcnn --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image+meta, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:29,  5.15s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:29,  5.15s/it, train loss=0.0120, val ΔE00=13.434, best=13.434]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:55,  4.85s/it, train loss=0.0120, val ΔE00=13.434, best=13.434]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:55,  4.85s/it, train loss=0.0099, val ΔE00=7.241, best=7.241]  Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:41,  4.76s/it, train loss=0.0099, val ΔE00=7.241, best=7.241]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:41,  4.76s/it, train loss=0.0158, val ΔE00=5.506, best=5.506]Training (late/smallcnn):   4%|▍         | 4/100 [00:19<07:32,  4.71s/it, train loss=0.0158, val ΔE00=5.506, best=5.506]Training (late/smallcnn):   4%|▍         | 4/100 [00:19<07:32,  4.71s/it, train loss=0.0264, val ΔE00=6.409, best=5.506]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:32,  4.77s/it, train loss=0.0264, val ΔE00=6.409, best=5.506]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:32,  4.77s/it, train loss=0.0383, val ΔE00=6.883, best=5.506]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:27,  4.76s/it, train loss=0.0383, val ΔE00=6.883, best=5.506]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:27,  4.76s/it, train loss=0.0541, val ΔE00=5.643, best=5.506]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:19,  4.72s/it, train loss=0.0541, val ΔE00=5.643, best=5.506]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:19,  4.72s/it, train loss=0.0712, val ΔE00=5.423, best=5.423]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:11,  4.69s/it, train loss=0.0712, val ΔE00=5.423, best=5.423]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:11,  4.69s/it, train loss=0.0878, val ΔE00=5.497, best=5.423]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:05,  4.67s/it, train loss=0.0878, val ΔE00=5.497, best=5.423]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:05,  4.67s/it, train loss=0.1111, val ΔE00=4.400, best=4.400]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:05,  4.73s/it, train loss=0.1111, val ΔE00=4.400, best=4.400]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:05,  4.73s/it, train loss=0.1296, val ΔE00=4.419, best=4.400]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:01,  4.73s/it, train loss=0.1296, val ΔE00=4.419, best=4.400]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:01,  4.73s/it, train loss=0.1492, val ΔE00=4.711, best=4.400]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:54,  4.71s/it, train loss=0.1492, val ΔE00=4.711, best=4.400]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:54,  4.71s/it, train loss=0.1798, val ΔE00=3.547, best=3.547]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:48,  4.69s/it, train loss=0.1798, val ΔE00=3.547, best=3.547]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:48,  4.69s/it, train loss=0.2028, val ΔE00=3.442, best=3.442]Training (late/smallcnn):  14%|█▍        | 14/100 [01:06<06:42,  4.68s/it, train loss=0.2028, val ΔE00=3.442, best=3.442]Training (late/smallcnn):  14%|█▍        | 14/100 [01:06<06:42,  4.68s/it, train loss=0.2258, val ΔE00=3.808, best=3.442]Training (late/smallcnn):  15%|█▌        | 15/100 [01:11<06:43,  4.75s/it, train loss=0.2258, val ΔE00=3.808, best=3.442]Training (late/smallcnn):  15%|█▌        | 15/100 [01:11<06:43,  4.75s/it, train loss=0.2654, val ΔE00=3.758, best=3.442]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:39,  4.75s/it, train loss=0.2654, val ΔE00=3.758, best=3.442]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:39,  4.75s/it, train loss=0.2927, val ΔE00=4.110, best=3.442]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:32,  4.73s/it, train loss=0.2927, val ΔE00=4.110, best=3.442]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:32,  4.73s/it, train loss=0.3281, val ΔE00=3.516, best=3.442]Training (late/smallcnn):  18%|█▊        | 18/100 [01:25<06:25,  4.70s/it, train loss=0.3281, val ΔE00=3.516, best=3.442]Training (late/smallcnn):  18%|█▊        | 18/100 [01:25<06:25,  4.70s/it, train loss=0.3488, val ΔE00=2.954, best=2.954]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:18,  4.67s/it, train loss=0.3488, val ΔE00=2.954, best=2.954]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:18,  4.67s/it, train loss=0.3974, val ΔE00=5.674, best=2.954]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:18,  4.73s/it, train loss=0.3974, val ΔE00=5.674, best=2.954]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:18,  4.73s/it, train loss=0.4473, val ΔE00=3.317, best=2.954]Training (late/smallcnn):  21%|██        | 21/100 [01:39<06:13,  4.73s/it, train loss=0.4473, val ΔE00=3.317, best=2.954]Training (late/smallcnn):  21%|██        | 21/100 [01:39<06:13,  4.73s/it, train loss=0.4628, val ΔE00=2.768, best=2.768]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:06,  4.69s/it, train loss=0.4628, val ΔE00=2.768, best=2.768]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:06,  4.69s/it, train loss=0.4991, val ΔE00=4.125, best=2.768]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<05:59,  4.67s/it, train loss=0.4991, val ΔE00=4.125, best=2.768]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<05:59,  4.67s/it, train loss=0.5416, val ΔE00=3.875, best=2.768]Training (late/smallcnn):  24%|██▍       | 24/100 [01:53<05:53,  4.66s/it, train loss=0.5416, val ΔE00=3.875, best=2.768]Training (late/smallcnn):  24%|██▍       | 24/100 [01:53<05:53,  4.66s/it, train loss=0.5757, val ΔE00=3.242, best=2.768]Training (late/smallcnn):  25%|██▌       | 25/100 [01:58<05:53,  4.71s/it, train loss=0.5757, val ΔE00=3.242, best=2.768]Training (late/smallcnn):  25%|██▌       | 25/100 [01:58<05:53,  4.71s/it, train loss=0.6333, val ΔE00=3.961, best=2.768]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:50,  4.73s/it, train loss=0.6333, val ΔE00=3.961, best=2.768]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:50,  4.73s/it, train loss=0.6771, val ΔE00=3.743, best=2.768]Training (late/smallcnn):  27%|██▋       | 27/100 [02:07<05:43,  4.71s/it, train loss=0.6771, val ΔE00=3.743, best=2.768]Training (late/smallcnn):  27%|██▋       | 27/100 [02:07<05:43,  4.71s/it, train loss=0.7174, val ΔE00=2.858, best=2.768]Training (late/smallcnn):  28%|██▊       | 28/100 [02:12<05:38,  4.70s/it, train loss=0.7174, val ΔE00=2.858, best=2.768]Training (late/smallcnn):  28%|██▊       | 28/100 [02:12<05:38,  4.70s/it, train loss=0.7705, val ΔE00=3.191, best=2.768]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:31,  4.67s/it, train loss=0.7705, val ΔE00=3.191, best=2.768]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:31,  4.67s/it, train loss=0.7840, val ΔE00=3.328, best=2.768]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:31,  4.73s/it, train loss=0.7840, val ΔE00=3.328, best=2.768]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:31,  4.73s/it, train loss=0.8416, val ΔE00=3.454, best=2.768]Training (late/smallcnn):  31%|███       | 31/100 [02:26<05:27,  4.74s/it, train loss=0.8416, val ΔE00=3.454, best=2.768]Training (late/smallcnn):  31%|███       | 31/100 [02:26<05:27,  4.74s/it, train loss=0.8894, val ΔE00=2.945, best=2.768]Training (late/smallcnn):  32%|███▏      | 32/100 [02:31<05:20,  4.71s/it, train loss=0.8894, val ΔE00=2.945, best=2.768]Training (late/smallcnn):  32%|███▏      | 32/100 [02:31<05:20,  4.71s/it, train loss=0.9374, val ΔE00=3.072, best=2.768]Training (late/smallcnn):  33%|███▎      | 33/100 [02:35<05:14,  4.69s/it, train loss=0.9374, val ΔE00=3.072, best=2.768]Training (late/smallcnn):  33%|███▎      | 33/100 [02:35<05:14,  4.69s/it, train loss=0.9997, val ΔE00=2.787, best=2.768]Training (late/smallcnn):  34%|███▍      | 34/100 [02:40<05:08,  4.67s/it, train loss=0.9997, val ΔE00=2.787, best=2.768]Training (late/smallcnn):  34%|███▍      | 34/100 [02:40<05:08,  4.67s/it, train loss=1.0976, val ΔE00=3.344, best=2.768]Training (late/smallcnn):  35%|███▌      | 35/100 [02:45<05:07,  4.72s/it, train loss=1.0976, val ΔE00=3.344, best=2.768]Training (late/smallcnn):  35%|███▌      | 35/100 [02:45<05:07,  4.72s/it, train loss=1.0530, val ΔE00=2.834, best=2.768]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:03,  4.75s/it, train loss=1.0530, val ΔE00=2.834, best=2.768]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:03,  4.75s/it, train loss=1.1383, val ΔE00=3.254, best=2.768]Training (late/smallcnn):  37%|███▋      | 37/100 [02:54<04:57,  4.71s/it, train loss=1.1383, val ΔE00=3.254, best=2.768]Training (late/smallcnn):  37%|███▋      | 37/100 [02:54<04:57,  4.71s/it, train loss=1.1354, val ΔE00=3.331, best=2.768]Training (late/smallcnn):  38%|███▊      | 38/100 [02:59<04:50,  4.69s/it, train loss=1.1354, val ΔE00=3.331, best=2.768]Training (late/smallcnn):  38%|███▊      | 38/100 [02:59<04:50,  4.69s/it, train loss=1.1894, val ΔE00=3.091, best=2.768]Training (late/smallcnn):  39%|███▉      | 39/100 [03:03<04:45,  4.68s/it, train loss=1.1894, val ΔE00=3.091, best=2.768]Training (late/smallcnn):  39%|███▉      | 39/100 [03:03<04:45,  4.68s/it, train loss=1.2440, val ΔE00=2.642, best=2.642]Training (late/smallcnn):  40%|████      | 40/100 [03:08<04:43,  4.73s/it, train loss=1.2440, val ΔE00=2.642, best=2.642]Training (late/smallcnn):  40%|████      | 40/100 [03:08<04:43,  4.73s/it, train loss=1.3733, val ΔE00=4.081, best=2.642]Training (late/smallcnn):  41%|████      | 41/100 [03:13<04:39,  4.73s/it, train loss=1.3733, val ΔE00=4.081, best=2.642]Training (late/smallcnn):  41%|████      | 41/100 [03:13<04:39,  4.73s/it, train loss=1.3053, val ΔE00=3.281, best=2.642]Training (late/smallcnn):  42%|████▏     | 42/100 [03:18<04:32,  4.70s/it, train loss=1.3053, val ΔE00=3.281, best=2.642]Training (late/smallcnn):  42%|████▏     | 42/100 [03:18<04:32,  4.70s/it, train loss=1.3399, val ΔE00=2.875, best=2.642]Training (late/smallcnn):  43%|████▎     | 43/100 [03:22<04:26,  4.67s/it, train loss=1.3399, val ΔE00=2.875, best=2.642]Training (late/smallcnn):  43%|████▎     | 43/100 [03:22<04:26,  4.67s/it, train loss=1.3954, val ΔE00=2.841, best=2.642]Training (late/smallcnn):  44%|████▍     | 44/100 [03:27<04:21,  4.66s/it, train loss=1.3954, val ΔE00=2.841, best=2.642]Training (late/smallcnn):  44%|████▍     | 44/100 [03:27<04:21,  4.66s/it, train loss=1.3811, val ΔE00=2.785, best=2.642]Training (late/smallcnn):  45%|████▌     | 45/100 [03:32<04:20,  4.73s/it, train loss=1.3811, val ΔE00=2.785, best=2.642]Training (late/smallcnn):  45%|████▌     | 45/100 [03:32<04:20,  4.73s/it, train loss=1.5079, val ΔE00=3.090, best=2.642]Training (late/smallcnn):  46%|████▌     | 46/100 [03:36<04:16,  4.74s/it, train loss=1.5079, val ΔE00=3.090, best=2.642]Training (late/smallcnn):  46%|████▌     | 46/100 [03:36<04:16,  4.74s/it, train loss=1.5633, val ΔE00=3.029, best=2.642]Training (late/smallcnn):  47%|████▋     | 47/100 [03:41<04:09,  4.70s/it, train loss=1.5633, val ΔE00=3.029, best=2.642]Training (late/smallcnn):  47%|████▋     | 47/100 [03:41<04:09,  4.70s/it, train loss=1.5970, val ΔE00=3.045, best=2.642]Training (late/smallcnn):  48%|████▊     | 48/100 [03:46<04:03,  4.68s/it, train loss=1.5970, val ΔE00=3.045, best=2.642]Training (late/smallcnn):  48%|████▊     | 48/100 [03:46<04:03,  4.68s/it, train loss=1.7440, val ΔE00=2.577, best=2.577]Training (late/smallcnn):  49%|████▉     | 49/100 [03:50<03:57,  4.66s/it, train loss=1.7440, val ΔE00=2.577, best=2.577]Training (late/smallcnn):  49%|████▉     | 49/100 [03:50<03:57,  4.66s/it, train loss=1.6450, val ΔE00=2.915, best=2.577]Training (late/smallcnn):  50%|█████     | 50/100 [03:55<03:55,  4.72s/it, train loss=1.6450, val ΔE00=2.915, best=2.577]Training (late/smallcnn):  50%|█████     | 50/100 [03:55<03:55,  4.72s/it, train loss=1.7046, val ΔE00=2.563, best=2.563]Training (late/smallcnn):  51%|█████     | 51/100 [04:00<03:52,  4.74s/it, train loss=1.7046, val ΔE00=2.563, best=2.563]Training (late/smallcnn):  51%|█████     | 51/100 [04:00<03:52,  4.74s/it, train loss=1.6888, val ΔE00=2.749, best=2.563]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:05<03:45,  4.70s/it, train loss=1.6888, val ΔE00=2.749, best=2.563]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:05<03:45,  4.70s/it, train loss=1.7350, val ΔE00=4.272, best=2.563]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:09<03:40,  4.68s/it, train loss=1.7350, val ΔE00=4.272, best=2.563]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:09<03:40,  4.68s/it, train loss=1.7503, val ΔE00=2.852, best=2.563]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:14<03:34,  4.67s/it, train loss=1.7503, val ΔE00=2.852, best=2.563]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:14<03:34,  4.67s/it, train loss=1.8209, val ΔE00=3.634, best=2.563]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:19<03:32,  4.72s/it, train loss=1.8209, val ΔE00=3.634, best=2.563]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:19<03:32,  4.72s/it, train loss=1.8288, val ΔE00=2.847, best=2.563]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:23<03:28,  4.73s/it, train loss=1.8288, val ΔE00=2.847, best=2.563]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:23<03:28,  4.73s/it, train loss=1.8482, val ΔE00=3.366, best=2.563]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:28<03:22,  4.70s/it, train loss=1.8482, val ΔE00=3.366, best=2.563]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:28<03:22,  4.70s/it, train loss=1.8887, val ΔE00=3.197, best=2.563]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:33<03:16,  4.68s/it, train loss=1.8887, val ΔE00=3.197, best=2.563]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:33<03:16,  4.68s/it, train loss=1.9213, val ΔE00=2.431, best=2.431]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:37<03:11,  4.67s/it, train loss=1.9213, val ΔE00=2.431, best=2.431]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:37<03:11,  4.67s/it, train loss=1.9747, val ΔE00=3.752, best=2.431]Training (late/smallcnn):  60%|██████    | 60/100 [04:42<03:08,  4.72s/it, train loss=1.9747, val ΔE00=3.752, best=2.431]Training (late/smallcnn):  60%|██████    | 60/100 [04:42<03:08,  4.72s/it, train loss=1.9379, val ΔE00=2.706, best=2.431]Training (late/smallcnn):  61%|██████    | 61/100 [04:47<03:04,  4.74s/it, train loss=1.9379, val ΔE00=2.706, best=2.431]Training (late/smallcnn):  61%|██████    | 61/100 [04:47<03:04,  4.74s/it, train loss=1.9334, val ΔE00=2.564, best=2.431]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:52<02:58,  4.71s/it, train loss=1.9334, val ΔE00=2.564, best=2.431]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:52<02:58,  4.71s/it, train loss=2.0005, val ΔE00=3.716, best=2.431]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:56<02:53,  4.68s/it, train loss=2.0005, val ΔE00=3.716, best=2.431]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:56<02:53,  4.68s/it, train loss=2.0022, val ΔE00=3.183, best=2.431]Training (late/smallcnn):  64%|██████▍   | 64/100 [05:01<02:48,  4.67s/it, train loss=2.0022, val ΔE00=3.183, best=2.431]Training (late/smallcnn):  64%|██████▍   | 64/100 [05:01<02:48,  4.67s/it, train loss=2.0204, val ΔE00=2.557, best=2.431]Training (late/smallcnn):  65%|██████▌   | 65/100 [05:06<02:45,  4.73s/it, train loss=2.0204, val ΔE00=2.557, best=2.431]Training (late/smallcnn):  65%|██████▌   | 65/100 [05:06<02:45,  4.73s/it, train loss=2.0652, val ΔE00=2.707, best=2.431]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:11<02:41,  4.74s/it, train loss=2.0652, val ΔE00=2.707, best=2.431]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:11<02:41,  4.74s/it, train loss=2.0621, val ΔE00=2.613, best=2.431]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:15<02:35,  4.71s/it, train loss=2.0621, val ΔE00=2.613, best=2.431]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:15<02:35,  4.71s/it, train loss=2.0867, val ΔE00=2.579, best=2.431]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:20<02:29,  4.68s/it, train loss=2.0867, val ΔE00=2.579, best=2.431]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:20<02:29,  4.68s/it, train loss=2.0969, val ΔE00=2.553, best=2.431]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:24<02:29,  4.68s/it, train loss=2.0686, val ΔE00=2.598, early_stop=yes]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:24<02:32,  4.78s/it, train loss=2.0686, val ΔE00=2.598, early_stop=yes]
[early] stop at epoch 69 (best de00=2.4309 @ 58)
[done] best ΔE00=2.431 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/late__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 4/24 ===
[sweep] id=004_model=late__backbone=smallcnn__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model late --backbone smallcnn --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image+mean+meta, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:30,  5.16s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:30,  5.16s/it, train loss=0.0103, val ΔE00=11.946, best=11.946]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:56,  4.86s/it, train loss=0.0103, val ΔE00=11.946, best=11.946]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:56,  4.86s/it, train loss=0.0072, val ΔE00=5.941, best=5.941]  Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:41,  4.76s/it, train loss=0.0072, val ΔE00=5.941, best=5.941]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:41,  4.76s/it, train loss=0.0122, val ΔE00=6.290, best=5.941]Training (late/smallcnn):   4%|▍         | 4/100 [00:19<07:32,  4.71s/it, train loss=0.0122, val ΔE00=6.290, best=5.941]Training (late/smallcnn):   4%|▍         | 4/100 [00:19<07:32,  4.71s/it, train loss=0.0207, val ΔE00=4.187, best=4.187]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:32,  4.76s/it, train loss=0.0207, val ΔE00=4.187, best=4.187]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:32,  4.76s/it, train loss=0.0306, val ΔE00=4.384, best=4.187]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:28,  4.77s/it, train loss=0.0306, val ΔE00=4.384, best=4.187]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:28,  4.77s/it, train loss=0.0463, val ΔE00=4.782, best=4.187]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:19,  4.73s/it, train loss=0.0463, val ΔE00=4.782, best=4.187]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:19,  4.73s/it, train loss=0.0602, val ΔE00=3.997, best=3.997]Training (late/smallcnn):   8%|▊         | 8/100 [00:38<07:12,  4.71s/it, train loss=0.0602, val ΔE00=3.997, best=3.997]Training (late/smallcnn):   8%|▊         | 8/100 [00:38<07:12,  4.71s/it, train loss=0.0756, val ΔE00=3.878, best=3.878]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:06,  4.69s/it, train loss=0.0756, val ΔE00=3.878, best=3.878]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:06,  4.69s/it, train loss=0.0959, val ΔE00=4.592, best=3.878]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:06,  4.74s/it, train loss=0.0959, val ΔE00=4.592, best=3.878]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:06,  4.74s/it, train loss=0.1232, val ΔE00=4.032, best=3.878]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:03,  4.76s/it, train loss=0.1232, val ΔE00=4.032, best=3.878]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:03,  4.76s/it, train loss=0.1360, val ΔE00=4.034, best=3.878]Training (late/smallcnn):  12%|█▏        | 12/100 [00:57<06:56,  4.74s/it, train loss=0.1360, val ΔE00=4.034, best=3.878]Training (late/smallcnn):  12%|█▏        | 12/100 [00:57<06:56,  4.74s/it, train loss=0.1564, val ΔE00=3.316, best=3.316]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:50,  4.71s/it, train loss=0.1564, val ΔE00=3.316, best=3.316]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:50,  4.71s/it, train loss=0.1838, val ΔE00=2.924, best=2.924]Training (late/smallcnn):  14%|█▍        | 14/100 [01:06<06:44,  4.70s/it, train loss=0.1838, val ΔE00=2.924, best=2.924]Training (late/smallcnn):  14%|█▍        | 14/100 [01:06<06:44,  4.70s/it, train loss=0.2062, val ΔE00=3.237, best=2.924]Training (late/smallcnn):  15%|█▌        | 15/100 [01:11<06:43,  4.75s/it, train loss=0.2062, val ΔE00=3.237, best=2.924]Training (late/smallcnn):  15%|█▌        | 15/100 [01:11<06:43,  4.75s/it, train loss=0.2476, val ΔE00=3.533, best=2.924]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:39,  4.76s/it, train loss=0.2476, val ΔE00=3.533, best=2.924]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:39,  4.76s/it, train loss=0.2566, val ΔE00=2.962, best=2.924]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:31,  4.72s/it, train loss=0.2566, val ΔE00=2.962, best=2.924]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:31,  4.72s/it, train loss=0.2981, val ΔE00=3.508, best=2.924]Training (late/smallcnn):  18%|█▊        | 18/100 [01:25<06:25,  4.70s/it, train loss=0.2981, val ΔE00=3.508, best=2.924]Training (late/smallcnn):  18%|█▊        | 18/100 [01:25<06:25,  4.70s/it, train loss=0.3668, val ΔE00=3.006, best=2.924]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:19,  4.69s/it, train loss=0.3668, val ΔE00=3.006, best=2.924]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:19,  4.69s/it, train loss=0.3627, val ΔE00=3.010, best=2.924]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:18,  4.73s/it, train loss=0.3627, val ΔE00=3.010, best=2.924]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:18,  4.73s/it, train loss=0.3927, val ΔE00=2.831, best=2.831]Training (late/smallcnn):  21%|██        | 21/100 [01:39<06:14,  4.75s/it, train loss=0.3927, val ΔE00=2.831, best=2.831]Training (late/smallcnn):  21%|██        | 21/100 [01:39<06:14,  4.75s/it, train loss=0.4249, val ΔE00=3.043, best=2.831]Training (late/smallcnn):  22%|██▏       | 22/100 [01:44<06:07,  4.71s/it, train loss=0.4249, val ΔE00=3.043, best=2.831]Training (late/smallcnn):  22%|██▏       | 22/100 [01:44<06:07,  4.71s/it, train loss=0.4709, val ΔE00=2.844, best=2.831]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<06:01,  4.70s/it, train loss=0.4709, val ΔE00=2.844, best=2.831]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<06:01,  4.70s/it, train loss=0.4984, val ΔE00=3.161, best=2.831]Training (late/smallcnn):  24%|██▍       | 24/100 [01:53<05:55,  4.68s/it, train loss=0.4984, val ΔE00=3.161, best=2.831]Training (late/smallcnn):  24%|██▍       | 24/100 [01:53<05:55,  4.68s/it, train loss=0.5417, val ΔE00=2.849, best=2.831]Training (late/smallcnn):  25%|██▌       | 25/100 [01:58<05:55,  4.74s/it, train loss=0.5417, val ΔE00=2.849, best=2.831]Training (late/smallcnn):  25%|██▌       | 25/100 [01:58<05:55,  4.74s/it, train loss=0.5702, val ΔE00=2.853, best=2.831]Training (late/smallcnn):  26%|██▌       | 26/100 [02:03<05:51,  4.75s/it, train loss=0.5702, val ΔE00=2.853, best=2.831]Training (late/smallcnn):  26%|██▌       | 26/100 [02:03<05:51,  4.75s/it, train loss=0.6202, val ΔE00=2.865, best=2.831]Training (late/smallcnn):  27%|██▋       | 27/100 [02:07<05:44,  4.72s/it, train loss=0.6202, val ΔE00=2.865, best=2.831]Training (late/smallcnn):  27%|██▋       | 27/100 [02:07<05:44,  4.72s/it, train loss=0.6619, val ΔE00=3.178, best=2.831]Training (late/smallcnn):  28%|██▊       | 28/100 [02:12<05:37,  4.69s/it, train loss=0.6619, val ΔE00=3.178, best=2.831]Training (late/smallcnn):  28%|██▊       | 28/100 [02:12<05:37,  4.69s/it, train loss=0.6905, val ΔE00=2.535, best=2.535]Training (late/smallcnn):  29%|██▉       | 29/100 [02:17<05:32,  4.68s/it, train loss=0.6905, val ΔE00=2.535, best=2.535]Training (late/smallcnn):  29%|██▉       | 29/100 [02:17<05:32,  4.68s/it, train loss=0.7360, val ΔE00=2.579, best=2.535]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:31,  4.73s/it, train loss=0.7360, val ΔE00=2.579, best=2.535]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:31,  4.73s/it, train loss=0.7637, val ΔE00=2.469, best=2.469]Training (late/smallcnn):  31%|███       | 31/100 [02:26<05:27,  4.74s/it, train loss=0.7637, val ΔE00=2.469, best=2.469]Training (late/smallcnn):  31%|███       | 31/100 [02:26<05:27,  4.74s/it, train loss=0.7955, val ΔE00=2.470, best=2.469]Training (late/smallcnn):  32%|███▏      | 32/100 [02:31<05:20,  4.72s/it, train loss=0.7955, val ΔE00=2.470, best=2.469]Training (late/smallcnn):  32%|███▏      | 32/100 [02:31<05:20,  4.72s/it, train loss=0.8149, val ΔE00=2.360, best=2.360]Training (late/smallcnn):  33%|███▎      | 33/100 [02:36<05:14,  4.70s/it, train loss=0.8149, val ΔE00=2.360, best=2.360]Training (late/smallcnn):  33%|███▎      | 33/100 [02:36<05:14,  4.70s/it, train loss=0.8657, val ΔE00=2.399, best=2.360]Training (late/smallcnn):  34%|███▍      | 34/100 [02:40<05:09,  4.69s/it, train loss=0.8657, val ΔE00=2.399, best=2.360]Training (late/smallcnn):  34%|███▍      | 34/100 [02:40<05:09,  4.69s/it, train loss=0.9487, val ΔE00=3.384, best=2.360]Training (late/smallcnn):  35%|███▌      | 35/100 [02:45<05:08,  4.74s/it, train loss=0.9487, val ΔE00=3.384, best=2.360]Training (late/smallcnn):  35%|███▌      | 35/100 [02:45<05:08,  4.74s/it, train loss=0.9742, val ΔE00=2.548, best=2.360]Training (late/smallcnn):  36%|███▌      | 36/100 [02:50<05:04,  4.75s/it, train loss=0.9742, val ΔE00=2.548, best=2.360]Training (late/smallcnn):  36%|███▌      | 36/100 [02:50<05:04,  4.75s/it, train loss=1.0532, val ΔE00=3.171, best=2.360]Training (late/smallcnn):  37%|███▋      | 37/100 [02:54<04:57,  4.72s/it, train loss=1.0532, val ΔE00=3.171, best=2.360]Training (late/smallcnn):  37%|███▋      | 37/100 [02:54<04:57,  4.72s/it, train loss=1.0727, val ΔE00=2.830, best=2.360]Training (late/smallcnn):  38%|███▊      | 38/100 [02:59<04:50,  4.69s/it, train loss=1.0727, val ΔE00=2.830, best=2.360]Training (late/smallcnn):  38%|███▊      | 38/100 [02:59<04:50,  4.69s/it, train loss=1.0895, val ΔE00=2.487, best=2.360]Training (late/smallcnn):  39%|███▉      | 39/100 [03:04<04:45,  4.67s/it, train loss=1.0895, val ΔE00=2.487, best=2.360]Training (late/smallcnn):  39%|███▉      | 39/100 [03:04<04:45,  4.67s/it, train loss=1.1232, val ΔE00=2.909, best=2.360]Training (late/smallcnn):  40%|████      | 40/100 [03:09<04:43,  4.73s/it, train loss=1.1232, val ΔE00=2.909, best=2.360]Training (late/smallcnn):  40%|████      | 40/100 [03:09<04:43,  4.73s/it, train loss=1.1537, val ΔE00=2.299, best=2.299]Training (late/smallcnn):  41%|████      | 41/100 [03:13<04:39,  4.74s/it, train loss=1.1537, val ΔE00=2.299, best=2.299]Training (late/smallcnn):  41%|████      | 41/100 [03:13<04:39,  4.74s/it, train loss=1.2057, val ΔE00=2.764, best=2.299]Training (late/smallcnn):  42%|████▏     | 42/100 [03:18<04:32,  4.71s/it, train loss=1.2057, val ΔE00=2.764, best=2.299]Training (late/smallcnn):  42%|████▏     | 42/100 [03:18<04:32,  4.71s/it, train loss=1.2259, val ΔE00=2.548, best=2.299]Training (late/smallcnn):  43%|████▎     | 43/100 [03:23<04:27,  4.69s/it, train loss=1.2259, val ΔE00=2.548, best=2.299]Training (late/smallcnn):  43%|████▎     | 43/100 [03:23<04:27,  4.69s/it, train loss=1.2750, val ΔE00=2.864, best=2.299]Training (late/smallcnn):  44%|████▍     | 44/100 [03:27<04:21,  4.68s/it, train loss=1.2750, val ΔE00=2.864, best=2.299]Training (late/smallcnn):  44%|████▍     | 44/100 [03:27<04:21,  4.68s/it, train loss=1.3230, val ΔE00=2.535, best=2.299]Training (late/smallcnn):  45%|████▌     | 45/100 [03:32<04:20,  4.73s/it, train loss=1.3230, val ΔE00=2.535, best=2.299]Training (late/smallcnn):  45%|████▌     | 45/100 [03:32<04:20,  4.73s/it, train loss=1.3585, val ΔE00=2.634, best=2.299]Training (late/smallcnn):  46%|████▌     | 46/100 [03:37<04:15,  4.74s/it, train loss=1.3585, val ΔE00=2.634, best=2.299]Training (late/smallcnn):  46%|████▌     | 46/100 [03:37<04:15,  4.74s/it, train loss=1.3698, val ΔE00=3.652, best=2.299]Training (late/smallcnn):  47%|████▋     | 47/100 [03:42<04:09,  4.71s/it, train loss=1.3698, val ΔE00=3.652, best=2.299]Training (late/smallcnn):  47%|████▋     | 47/100 [03:42<04:09,  4.71s/it, train loss=1.4458, val ΔE00=3.023, best=2.299]Training (late/smallcnn):  48%|████▊     | 48/100 [03:46<04:03,  4.68s/it, train loss=1.4458, val ΔE00=3.023, best=2.299]Training (late/smallcnn):  48%|████▊     | 48/100 [03:46<04:03,  4.68s/it, train loss=1.5176, val ΔE00=2.802, best=2.299]Training (late/smallcnn):  49%|████▉     | 49/100 [03:51<03:58,  4.67s/it, train loss=1.5176, val ΔE00=2.802, best=2.299]Training (late/smallcnn):  49%|████▉     | 49/100 [03:51<03:58,  4.67s/it, train loss=1.5088, val ΔE00=2.542, best=2.299]Training (late/smallcnn):  50%|█████     | 50/100 [03:56<03:56,  4.73s/it, train loss=1.5088, val ΔE00=2.542, best=2.299]Training (late/smallcnn):  50%|█████     | 50/100 [03:56<03:56,  4.73s/it, train loss=1.5616, val ΔE00=2.564, best=2.299]Training (late/smallcnn):  51%|█████     | 51/100 [04:00<03:52,  4.75s/it, train loss=1.5616, val ΔE00=2.564, best=2.299]Training (late/smallcnn):  51%|█████     | 51/100 [04:00<03:52,  4.75s/it, train loss=1.6127, val ΔE00=2.223, best=2.223]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:05<03:46,  4.72s/it, train loss=1.6127, val ΔE00=2.223, best=2.223]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:05<03:46,  4.72s/it, train loss=1.5596, val ΔE00=2.283, best=2.223]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:10<03:41,  4.71s/it, train loss=1.5596, val ΔE00=2.283, best=2.223]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:10<03:41,  4.71s/it, train loss=1.5731, val ΔE00=2.328, best=2.223]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:14<03:35,  4.69s/it, train loss=1.5731, val ΔE00=2.328, best=2.223]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:14<03:35,  4.69s/it, train loss=1.7790, val ΔE00=2.381, best=2.223]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:19<03:33,  4.75s/it, train loss=1.7790, val ΔE00=2.381, best=2.223]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:19<03:33,  4.75s/it, train loss=1.6645, val ΔE00=2.927, best=2.223]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:24<03:29,  4.76s/it, train loss=1.6645, val ΔE00=2.927, best=2.223]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:24<03:29,  4.76s/it, train loss=1.7586, val ΔE00=2.947, best=2.223]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:29<03:23,  4.72s/it, train loss=1.7586, val ΔE00=2.947, best=2.223]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:29<03:23,  4.72s/it, train loss=1.8162, val ΔE00=2.117, best=2.117]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:33<03:17,  4.70s/it, train loss=1.8162, val ΔE00=2.117, best=2.117]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:33<03:17,  4.70s/it, train loss=1.8106, val ΔE00=2.463, best=2.117]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:38<03:12,  4.68s/it, train loss=1.8106, val ΔE00=2.463, best=2.117]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:38<03:12,  4.68s/it, train loss=1.8504, val ΔE00=2.366, best=2.117]Training (late/smallcnn):  60%|██████    | 60/100 [04:43<03:10,  4.75s/it, train loss=1.8504, val ΔE00=2.366, best=2.117]Training (late/smallcnn):  60%|██████    | 60/100 [04:43<03:10,  4.75s/it, train loss=1.9396, val ΔE00=2.340, best=2.117]Training (late/smallcnn):  61%|██████    | 61/100 [04:48<03:04,  4.74s/it, train loss=1.9396, val ΔE00=2.340, best=2.117]Training (late/smallcnn):  61%|██████    | 61/100 [04:48<03:04,  4.74s/it, train loss=1.7691, val ΔE00=2.325, best=2.117]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:52<02:59,  4.71s/it, train loss=1.7691, val ΔE00=2.325, best=2.117]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:52<02:59,  4.71s/it, train loss=1.8235, val ΔE00=2.447, best=2.117]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:57<02:53,  4.70s/it, train loss=1.8235, val ΔE00=2.447, best=2.117]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:57<02:53,  4.70s/it, train loss=1.9176, val ΔE00=2.367, best=2.117]Training (late/smallcnn):  64%|██████▍   | 64/100 [05:02<02:48,  4.69s/it, train loss=1.9176, val ΔE00=2.367, best=2.117]Training (late/smallcnn):  64%|██████▍   | 64/100 [05:02<02:48,  4.69s/it, train loss=1.8528, val ΔE00=2.408, best=2.117]Training (late/smallcnn):  65%|██████▌   | 65/100 [05:06<02:46,  4.74s/it, train loss=1.8528, val ΔE00=2.408, best=2.117]Training (late/smallcnn):  65%|██████▌   | 65/100 [05:06<02:46,  4.74s/it, train loss=1.8996, val ΔE00=2.279, best=2.117]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:11<02:41,  4.76s/it, train loss=1.8996, val ΔE00=2.279, best=2.117]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:11<02:41,  4.76s/it, train loss=1.9425, val ΔE00=2.264, best=2.117]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:16<02:35,  4.72s/it, train loss=1.9425, val ΔE00=2.264, best=2.117]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:16<02:35,  4.72s/it, train loss=1.9235, val ΔE00=2.918, best=2.117]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:21<02:30,  4.69s/it, train loss=1.9235, val ΔE00=2.918, best=2.117]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:21<02:30,  4.69s/it, train loss=1.9142, val ΔE00=2.559, best=2.117]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:25<02:30,  4.69s/it, train loss=1.9424, val ΔE00=2.922, early_stop=yes]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:25<02:33,  4.79s/it, train loss=1.9424, val ΔE00=2.922, early_stop=yes]
[early] stop at epoch 69 (best de00=2.1169 @ 57)
[done] best ΔE00=2.117 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/late__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 5/24 ===
[sweep] id=005_model=late__backbone=resnet18__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model late --backbone resnet18 --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:43,  7.11s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:43,  7.11s/it, train loss=0.0118, val ΔE00=7.316, best=7.316]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:07,  6.81s/it, train loss=0.0118, val ΔE00=7.316, best=7.316]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:07,  6.81s/it, train loss=0.0061, val ΔE00=4.807, best=4.807]Training (late/resnet18):   3%|▎         | 3/100 [00:20<10:50,  6.71s/it, train loss=0.0061, val ΔE00=4.807, best=4.807]Training (late/resnet18):   3%|▎         | 3/100 [00:20<10:50,  6.71s/it, train loss=0.0093, val ΔE00=3.977, best=3.977]Training (late/resnet18):   4%|▍         | 4/100 [00:26<10:40,  6.67s/it, train loss=0.0093, val ΔE00=3.977, best=3.977]Training (late/resnet18):   4%|▍         | 4/100 [00:26<10:40,  6.67s/it, train loss=0.0158, val ΔE00=3.918, best=3.918]Training (late/resnet18):   5%|▌         | 5/100 [00:33<10:37,  6.71s/it, train loss=0.0158, val ΔE00=3.918, best=3.918]Training (late/resnet18):   5%|▌         | 5/100 [00:33<10:37,  6.71s/it, train loss=0.0237, val ΔE00=3.501, best=3.501]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:27,  6.68s/it, train loss=0.0237, val ΔE00=3.501, best=3.501]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:27,  6.68s/it, train loss=0.0333, val ΔE00=4.022, best=3.501]Training (late/resnet18):   7%|▋         | 7/100 [00:46<10:19,  6.66s/it, train loss=0.0333, val ΔE00=4.022, best=3.501]Training (late/resnet18):   7%|▋         | 7/100 [00:46<10:19,  6.66s/it, train loss=0.0436, val ΔE00=3.101, best=3.101]Training (late/resnet18):   8%|▊         | 8/100 [00:53<10:09,  6.63s/it, train loss=0.0436, val ΔE00=3.101, best=3.101]Training (late/resnet18):   8%|▊         | 8/100 [00:53<10:09,  6.63s/it, train loss=0.0540, val ΔE00=3.167, best=3.101]Training (late/resnet18):   9%|▉         | 9/100 [01:00<10:00,  6.60s/it, train loss=0.0540, val ΔE00=3.167, best=3.101]Training (late/resnet18):   9%|▉         | 9/100 [01:00<10:00,  6.60s/it, train loss=0.0677, val ΔE00=4.102, best=3.101]Training (late/resnet18):  10%|█         | 10/100 [01:06<09:57,  6.64s/it, train loss=0.0677, val ΔE00=4.102, best=3.101]Training (late/resnet18):  10%|█         | 10/100 [01:06<09:57,  6.64s/it, train loss=0.0832, val ΔE00=3.114, best=3.101]Training (late/resnet18):  11%|█         | 11/100 [01:13<09:51,  6.65s/it, train loss=0.0832, val ΔE00=3.114, best=3.101]Training (late/resnet18):  11%|█         | 11/100 [01:13<09:51,  6.65s/it, train loss=0.0953, val ΔE00=2.767, best=2.767]Training (late/resnet18):  12%|█▏        | 12/100 [01:19<09:42,  6.62s/it, train loss=0.0953, val ΔE00=2.767, best=2.767]Training (late/resnet18):  12%|█▏        | 12/100 [01:19<09:42,  6.62s/it, train loss=0.1059, val ΔE00=3.065, best=2.767]Training (late/resnet18):  13%|█▎        | 13/100 [01:26<09:34,  6.60s/it, train loss=0.1059, val ΔE00=3.065, best=2.767]Training (late/resnet18):  13%|█▎        | 13/100 [01:26<09:34,  6.60s/it, train loss=0.1299, val ΔE00=3.152, best=2.767]Training (late/resnet18):  14%|█▍        | 14/100 [01:33<09:26,  6.59s/it, train loss=0.1299, val ΔE00=3.152, best=2.767]Training (late/resnet18):  14%|█▍        | 14/100 [01:33<09:26,  6.59s/it, train loss=0.1341, val ΔE00=2.892, best=2.767]Training (late/resnet18):  15%|█▌        | 15/100 [01:39<09:23,  6.62s/it, train loss=0.1341, val ΔE00=2.892, best=2.767]Training (late/resnet18):  15%|█▌        | 15/100 [01:39<09:23,  6.62s/it, train loss=0.1748, val ΔE00=2.962, best=2.767]Training (late/resnet18):  16%|█▌        | 16/100 [01:46<09:18,  6.64s/it, train loss=0.1748, val ΔE00=2.962, best=2.767]Training (late/resnet18):  16%|█▌        | 16/100 [01:46<09:18,  6.64s/it, train loss=0.1644, val ΔE00=2.675, best=2.675]Training (late/resnet18):  17%|█▋        | 17/100 [01:53<09:09,  6.62s/it, train loss=0.1644, val ΔE00=2.675, best=2.675]Training (late/resnet18):  17%|█▋        | 17/100 [01:53<09:09,  6.62s/it, train loss=0.1941, val ΔE00=2.731, best=2.675]Training (late/resnet18):  18%|█▊        | 18/100 [01:59<09:01,  6.60s/it, train loss=0.1941, val ΔE00=2.731, best=2.675]Training (late/resnet18):  18%|█▊        | 18/100 [01:59<09:01,  6.60s/it, train loss=0.2185, val ΔE00=2.790, best=2.675]Training (late/resnet18):  19%|█▉        | 19/100 [02:06<08:55,  6.61s/it, train loss=0.2185, val ΔE00=2.790, best=2.675]Training (late/resnet18):  19%|█▉        | 19/100 [02:06<08:55,  6.61s/it, train loss=0.2254, val ΔE00=2.541, best=2.541]Training (late/resnet18):  20%|██        | 20/100 [02:13<08:53,  6.67s/it, train loss=0.2254, val ΔE00=2.541, best=2.541]Training (late/resnet18):  20%|██        | 20/100 [02:13<08:53,  6.67s/it, train loss=0.2492, val ΔE00=2.378, best=2.378]Training (late/resnet18):  21%|██        | 21/100 [02:19<08:45,  6.65s/it, train loss=0.2492, val ΔE00=2.378, best=2.378]Training (late/resnet18):  21%|██        | 21/100 [02:19<08:45,  6.65s/it, train loss=0.2590, val ΔE00=2.565, best=2.378]Training (late/resnet18):  22%|██▏       | 22/100 [02:26<08:38,  6.64s/it, train loss=0.2590, val ΔE00=2.565, best=2.378]Training (late/resnet18):  22%|██▏       | 22/100 [02:26<08:38,  6.64s/it, train loss=0.2728, val ΔE00=2.286, best=2.286]Training (late/resnet18):  23%|██▎       | 23/100 [02:32<08:29,  6.62s/it, train loss=0.2728, val ΔE00=2.286, best=2.286]Training (late/resnet18):  23%|██▎       | 23/100 [02:32<08:29,  6.62s/it, train loss=0.3074, val ΔE00=2.624, best=2.286]Training (late/resnet18):  24%|██▍       | 24/100 [02:39<08:22,  6.62s/it, train loss=0.3074, val ΔE00=2.624, best=2.286]Training (late/resnet18):  24%|██▍       | 24/100 [02:39<08:22,  6.62s/it, train loss=0.2987, val ΔE00=2.270, best=2.270]Training (late/resnet18):  25%|██▌       | 25/100 [02:46<08:19,  6.65s/it, train loss=0.2987, val ΔE00=2.270, best=2.270]Training (late/resnet18):  25%|██▌       | 25/100 [02:46<08:19,  6.65s/it, train loss=0.3497, val ΔE00=2.927, best=2.270]Training (late/resnet18):  26%|██▌       | 26/100 [02:52<08:11,  6.64s/it, train loss=0.3497, val ΔE00=2.927, best=2.270]Training (late/resnet18):  26%|██▌       | 26/100 [02:52<08:11,  6.64s/it, train loss=0.3567, val ΔE00=2.712, best=2.270]Training (late/resnet18):  27%|██▋       | 27/100 [02:59<08:02,  6.61s/it, train loss=0.3567, val ΔE00=2.712, best=2.270]Training (late/resnet18):  27%|██▋       | 27/100 [02:59<08:02,  6.61s/it, train loss=0.3550, val ΔE00=2.677, best=2.270]Training (late/resnet18):  28%|██▊       | 28/100 [03:05<07:54,  6.59s/it, train loss=0.3550, val ΔE00=2.677, best=2.270]Training (late/resnet18):  28%|██▊       | 28/100 [03:05<07:54,  6.59s/it, train loss=0.3699, val ΔE00=2.436, best=2.270]Training (late/resnet18):  29%|██▉       | 29/100 [03:12<07:47,  6.58s/it, train loss=0.3699, val ΔE00=2.436, best=2.270]Training (late/resnet18):  29%|██▉       | 29/100 [03:12<07:47,  6.58s/it, train loss=0.4084, val ΔE00=2.294, best=2.270]Training (late/resnet18):  30%|███       | 30/100 [03:19<07:43,  6.62s/it, train loss=0.4084, val ΔE00=2.294, best=2.270]Training (late/resnet18):  30%|███       | 30/100 [03:19<07:43,  6.62s/it, train loss=0.4373, val ΔE00=2.536, best=2.270]Training (late/resnet18):  31%|███       | 31/100 [03:25<07:36,  6.62s/it, train loss=0.4373, val ΔE00=2.536, best=2.270]Training (late/resnet18):  31%|███       | 31/100 [03:25<07:36,  6.62s/it, train loss=0.4424, val ΔE00=2.326, best=2.270]Training (late/resnet18):  32%|███▏      | 32/100 [03:32<07:29,  6.62s/it, train loss=0.4424, val ΔE00=2.326, best=2.270]Training (late/resnet18):  32%|███▏      | 32/100 [03:32<07:29,  6.62s/it, train loss=0.4481, val ΔE00=2.185, best=2.185]Training (late/resnet18):  33%|███▎      | 33/100 [03:38<07:21,  6.59s/it, train loss=0.4481, val ΔE00=2.185, best=2.185]Training (late/resnet18):  33%|███▎      | 33/100 [03:38<07:21,  6.59s/it, train loss=0.5144, val ΔE00=2.441, best=2.185]Training (late/resnet18):  34%|███▍      | 34/100 [03:45<07:14,  6.58s/it, train loss=0.5144, val ΔE00=2.441, best=2.185]Training (late/resnet18):  34%|███▍      | 34/100 [03:45<07:14,  6.58s/it, train loss=0.5163, val ΔE00=2.523, best=2.185]Training (late/resnet18):  35%|███▌      | 35/100 [03:52<07:10,  6.62s/it, train loss=0.5163, val ΔE00=2.523, best=2.185]Training (late/resnet18):  35%|███▌      | 35/100 [03:52<07:10,  6.62s/it, train loss=0.5037, val ΔE00=2.521, best=2.185]Training (late/resnet18):  36%|███▌      | 36/100 [03:58<07:03,  6.62s/it, train loss=0.5037, val ΔE00=2.521, best=2.185]Training (late/resnet18):  36%|███▌      | 36/100 [03:58<07:03,  6.62s/it, train loss=0.5825, val ΔE00=2.414, best=2.185]Training (late/resnet18):  37%|███▋      | 37/100 [04:05<06:56,  6.61s/it, train loss=0.5825, val ΔE00=2.414, best=2.185]Training (late/resnet18):  37%|███▋      | 37/100 [04:05<06:56,  6.61s/it, train loss=0.5715, val ΔE00=2.261, best=2.185]Training (late/resnet18):  38%|███▊      | 38/100 [04:11<06:48,  6.59s/it, train loss=0.5715, val ΔE00=2.261, best=2.185]Training (late/resnet18):  38%|███▊      | 38/100 [04:11<06:48,  6.59s/it, train loss=0.5614, val ΔE00=2.277, best=2.185]Training (late/resnet18):  39%|███▉      | 39/100 [04:18<06:41,  6.58s/it, train loss=0.5614, val ΔE00=2.277, best=2.185]Training (late/resnet18):  39%|███▉      | 39/100 [04:18<06:41,  6.58s/it, train loss=0.5683, val ΔE00=2.194, best=2.185]Training (late/resnet18):  40%|████      | 40/100 [04:25<06:37,  6.63s/it, train loss=0.5683, val ΔE00=2.194, best=2.185]Training (late/resnet18):  40%|████      | 40/100 [04:25<06:37,  6.63s/it, train loss=0.5967, val ΔE00=2.545, best=2.185]Training (late/resnet18):  41%|████      | 41/100 [04:31<06:30,  6.62s/it, train loss=0.5967, val ΔE00=2.545, best=2.185]Training (late/resnet18):  41%|████      | 41/100 [04:31<06:30,  6.62s/it, train loss=0.6394, val ΔE00=2.361, best=2.185]Training (late/resnet18):  42%|████▏     | 42/100 [04:38<06:22,  6.60s/it, train loss=0.6394, val ΔE00=2.361, best=2.185]Training (late/resnet18):  42%|████▏     | 42/100 [04:38<06:22,  6.60s/it, train loss=0.6316, val ΔE00=2.362, best=2.185]Training (late/resnet18):  43%|████▎     | 43/100 [04:44<06:15,  6.59s/it, train loss=0.6316, val ΔE00=2.362, best=2.185]Training (late/resnet18):  43%|████▎     | 43/100 [04:44<06:15,  6.59s/it, train loss=0.7296, val ΔE00=2.346, best=2.185]Training (late/resnet18):  44%|████▍     | 44/100 [04:51<06:08,  6.57s/it, train loss=0.7296, val ΔE00=2.346, best=2.185]Training (late/resnet18):  44%|████▍     | 44/100 [04:51<06:08,  6.57s/it, train loss=0.7171, val ΔE00=2.314, best=2.185]Training (late/resnet18):  45%|████▌     | 45/100 [04:58<06:03,  6.62s/it, train loss=0.7171, val ΔE00=2.314, best=2.185]Training (late/resnet18):  45%|████▌     | 45/100 [04:58<06:03,  6.62s/it, train loss=0.6914, val ΔE00=2.330, best=2.185]Training (late/resnet18):  46%|████▌     | 46/100 [05:04<05:57,  6.62s/it, train loss=0.6914, val ΔE00=2.330, best=2.185]Training (late/resnet18):  46%|████▌     | 46/100 [05:04<05:57,  6.62s/it, train loss=0.6970, val ΔE00=2.576, best=2.185]Training (late/resnet18):  47%|████▋     | 47/100 [05:11<05:49,  6.60s/it, train loss=0.6970, val ΔE00=2.576, best=2.185]Training (late/resnet18):  47%|████▋     | 47/100 [05:11<05:49,  6.60s/it, train loss=0.7407, val ΔE00=2.203, best=2.185]Training (late/resnet18):  48%|████▊     | 48/100 [05:17<05:42,  6.59s/it, train loss=0.7407, val ΔE00=2.203, best=2.185]Training (late/resnet18):  48%|████▊     | 48/100 [05:17<05:42,  6.59s/it, train loss=0.7345, val ΔE00=2.313, best=2.185]Training (late/resnet18):  49%|████▉     | 49/100 [05:24<05:35,  6.58s/it, train loss=0.7345, val ΔE00=2.313, best=2.185]Training (late/resnet18):  49%|████▉     | 49/100 [05:24<05:35,  6.58s/it, train loss=0.7376, val ΔE00=2.296, best=2.185]Training (late/resnet18):  50%|█████     | 50/100 [05:31<05:31,  6.62s/it, train loss=0.7376, val ΔE00=2.296, best=2.185]Training (late/resnet18):  50%|█████     | 50/100 [05:31<05:31,  6.62s/it, train loss=0.7529, val ΔE00=2.440, best=2.185]Training (late/resnet18):  51%|█████     | 51/100 [05:37<05:24,  6.62s/it, train loss=0.7529, val ΔE00=2.440, best=2.185]Training (late/resnet18):  51%|█████     | 51/100 [05:37<05:24,  6.62s/it, train loss=0.7819, val ΔE00=2.449, best=2.185]Training (late/resnet18):  52%|█████▏    | 52/100 [05:44<05:16,  6.60s/it, train loss=0.7819, val ΔE00=2.449, best=2.185]Training (late/resnet18):  52%|█████▏    | 52/100 [05:44<05:16,  6.60s/it, train loss=0.7816, val ΔE00=2.523, best=2.185]Training (late/resnet18):  53%|█████▎    | 53/100 [05:50<05:09,  6.59s/it, train loss=0.7816, val ΔE00=2.523, best=2.185]Training (late/resnet18):  53%|█████▎    | 53/100 [05:50<05:09,  6.59s/it, train loss=0.8188, val ΔE00=2.246, best=2.185]Training (late/resnet18):  54%|█████▍    | 54/100 [05:57<05:02,  6.58s/it, train loss=0.8188, val ΔE00=2.246, best=2.185]Training (late/resnet18):  54%|█████▍    | 54/100 [05:57<05:02,  6.58s/it, train loss=0.8110, val ΔE00=2.215, best=2.185]Training (late/resnet18):  55%|█████▌    | 55/100 [06:04<04:59,  6.65s/it, train loss=0.8110, val ΔE00=2.215, best=2.185]Training (late/resnet18):  55%|█████▌    | 55/100 [06:04<04:59,  6.65s/it, train loss=0.8069, val ΔE00=2.134, best=2.134]Training (late/resnet18):  56%|█████▌    | 56/100 [06:10<04:52,  6.64s/it, train loss=0.8069, val ΔE00=2.134, best=2.134]Training (late/resnet18):  56%|█████▌    | 56/100 [06:10<04:52,  6.64s/it, train loss=0.8263, val ΔE00=2.302, best=2.134]Training (late/resnet18):  57%|█████▋    | 57/100 [06:17<04:44,  6.62s/it, train loss=0.8263, val ΔE00=2.302, best=2.134]Training (late/resnet18):  57%|█████▋    | 57/100 [06:17<04:44,  6.62s/it, train loss=0.8302, val ΔE00=2.425, best=2.134]Training (late/resnet18):  58%|█████▊    | 58/100 [06:24<04:37,  6.61s/it, train loss=0.8302, val ΔE00=2.425, best=2.134]Training (late/resnet18):  58%|█████▊    | 58/100 [06:24<04:37,  6.61s/it, train loss=0.8611, val ΔE00=2.407, best=2.134]Training (late/resnet18):  59%|█████▉    | 59/100 [06:30<04:30,  6.59s/it, train loss=0.8611, val ΔE00=2.407, best=2.134]Training (late/resnet18):  59%|█████▉    | 59/100 [06:30<04:30,  6.59s/it, train loss=0.8457, val ΔE00=2.386, best=2.134]Training (late/resnet18):  60%|██████    | 60/100 [06:37<04:25,  6.64s/it, train loss=0.8457, val ΔE00=2.386, best=2.134]Training (late/resnet18):  60%|██████    | 60/100 [06:37<04:25,  6.64s/it, train loss=0.8379, val ΔE00=2.414, best=2.134]Training (late/resnet18):  61%|██████    | 61/100 [06:43<04:18,  6.63s/it, train loss=0.8379, val ΔE00=2.414, best=2.134]Training (late/resnet18):  61%|██████    | 61/100 [06:43<04:18,  6.63s/it, train loss=0.8521, val ΔE00=2.631, best=2.134]Training (late/resnet18):  62%|██████▏   | 62/100 [06:50<04:11,  6.61s/it, train loss=0.8521, val ΔE00=2.631, best=2.134]Training (late/resnet18):  62%|██████▏   | 62/100 [06:50<04:11,  6.61s/it, train loss=0.8460, val ΔE00=2.531, best=2.134]Training (late/resnet18):  63%|██████▎   | 63/100 [06:57<04:03,  6.59s/it, train loss=0.8460, val ΔE00=2.531, best=2.134]Training (late/resnet18):  63%|██████▎   | 63/100 [06:57<04:03,  6.59s/it, train loss=0.8409, val ΔE00=2.421, best=2.134]Training (late/resnet18):  64%|██████▍   | 64/100 [07:03<03:56,  6.58s/it, train loss=0.8409, val ΔE00=2.421, best=2.134]Training (late/resnet18):  64%|██████▍   | 64/100 [07:03<03:56,  6.58s/it, train loss=0.8511, val ΔE00=2.484, best=2.134]Training (late/resnet18):  65%|██████▌   | 65/100 [07:10<03:52,  6.64s/it, train loss=0.8511, val ΔE00=2.484, best=2.134]Training (late/resnet18):  65%|██████▌   | 65/100 [07:10<03:52,  6.64s/it, train loss=0.9268, val ΔE00=2.342, best=2.134]Training (late/resnet18):  66%|██████▌   | 66/100 [07:17<03:45,  6.62s/it, train loss=0.9268, val ΔE00=2.342, best=2.134]Training (late/resnet18):  66%|██████▌   | 66/100 [07:17<03:45,  6.62s/it, train loss=0.8599, val ΔE00=2.336, best=2.134]Training (late/resnet18):  67%|██████▋   | 67/100 [07:23<03:37,  6.60s/it, train loss=0.8599, val ΔE00=2.336, best=2.134]Training (late/resnet18):  67%|██████▋   | 67/100 [07:23<03:37,  6.60s/it, train loss=0.9348, val ΔE00=2.516, best=2.134]Training (late/resnet18):  68%|██████▊   | 68/100 [07:30<03:30,  6.59s/it, train loss=0.9348, val ΔE00=2.516, best=2.134]Training (late/resnet18):  68%|██████▊   | 68/100 [07:30<03:30,  6.59s/it, train loss=0.8939, val ΔE00=2.410, best=2.134]Training (late/resnet18):  68%|██████▊   | 68/100 [07:36<03:30,  6.59s/it, train loss=0.8955, val ΔE00=2.343, early_stop=yes]Training (late/resnet18):  68%|██████▊   | 68/100 [07:36<03:34,  6.72s/it, train loss=0.8955, val ΔE00=2.343, early_stop=yes]
[early] stop at epoch 69 (best de00=2.1335 @ 55)
[done] best ΔE00=2.134 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/late__resnet18__image__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image/final_summary.json (kind=val)
[sweep] === Run 6/24 ===
[sweep] id=006_model=late__backbone=resnet18__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model late --backbone resnet18 --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image+mean, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:54,  7.22s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:54,  7.22s/it, train loss=0.0110, val ΔE00=6.343, best=6.343]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:18,  6.92s/it, train loss=0.0110, val ΔE00=6.343, best=6.343]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:18,  6.92s/it, train loss=0.0054, val ΔE00=4.345, best=4.345]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:01,  6.82s/it, train loss=0.0054, val ΔE00=4.345, best=4.345]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:01,  6.82s/it, train loss=0.0089, val ΔE00=3.506, best=3.506]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:47,  6.75s/it, train loss=0.0089, val ΔE00=3.506, best=3.506]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:47,  6.75s/it, train loss=0.0151, val ΔE00=3.708, best=3.506]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:46,  6.81s/it, train loss=0.0151, val ΔE00=3.708, best=3.506]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:46,  6.81s/it, train loss=0.0233, val ΔE00=3.478, best=3.478]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:38,  6.80s/it, train loss=0.0233, val ΔE00=3.478, best=3.478]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:38,  6.80s/it, train loss=0.0330, val ΔE00=3.236, best=3.236]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0330, val ΔE00=3.236, best=3.236]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0466, val ΔE00=2.806, best=2.806]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:18,  6.73s/it, train loss=0.0466, val ΔE00=2.806, best=2.806]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:18,  6.73s/it, train loss=0.0564, val ΔE00=2.817, best=2.806]Training (late/resnet18):   9%|▉         | 9/100 [01:00<10:09,  6.70s/it, train loss=0.0564, val ΔE00=2.817, best=2.806]Training (late/resnet18):   9%|▉         | 9/100 [01:00<10:09,  6.70s/it, train loss=0.0694, val ΔE00=2.965, best=2.806]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:06,  6.74s/it, train loss=0.0694, val ΔE00=2.965, best=2.806]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:06,  6.74s/it, train loss=0.0804, val ΔE00=2.909, best=2.806]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:00,  6.74s/it, train loss=0.0804, val ΔE00=2.909, best=2.806]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:00,  6.74s/it, train loss=0.0963, val ΔE00=2.695, best=2.695]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:52,  6.73s/it, train loss=0.0963, val ΔE00=2.695, best=2.695]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:52,  6.73s/it, train loss=0.1090, val ΔE00=2.288, best=2.288]Training (late/resnet18):  13%|█▎        | 13/100 [01:27<09:43,  6.71s/it, train loss=0.1090, val ΔE00=2.288, best=2.288]Training (late/resnet18):  13%|█▎        | 13/100 [01:27<09:43,  6.71s/it, train loss=0.1212, val ΔE00=2.533, best=2.288]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:35,  6.69s/it, train loss=0.1212, val ΔE00=2.533, best=2.288]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:35,  6.69s/it, train loss=0.1521, val ΔE00=2.382, best=2.288]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:32,  6.73s/it, train loss=0.1521, val ΔE00=2.382, best=2.288]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:32,  6.73s/it, train loss=0.1536, val ΔE00=2.453, best=2.288]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:25,  6.73s/it, train loss=0.1536, val ΔE00=2.453, best=2.288]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:25,  6.73s/it, train loss=0.1747, val ΔE00=2.443, best=2.288]Training (late/resnet18):  17%|█▋        | 17/100 [01:54<09:16,  6.70s/it, train loss=0.1747, val ΔE00=2.443, best=2.288]Training (late/resnet18):  17%|█▋        | 17/100 [01:54<09:16,  6.70s/it, train loss=0.1855, val ΔE00=2.433, best=2.288]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:07,  6.68s/it, train loss=0.1855, val ΔE00=2.433, best=2.288]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:07,  6.68s/it, train loss=0.2314, val ΔE00=2.837, best=2.288]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:00,  6.67s/it, train loss=0.2314, val ΔE00=2.837, best=2.288]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:00,  6.67s/it, train loss=0.2337, val ΔE00=2.394, best=2.288]Training (late/resnet18):  20%|██        | 20/100 [02:14<08:58,  6.74s/it, train loss=0.2337, val ΔE00=2.394, best=2.288]Training (late/resnet18):  20%|██        | 20/100 [02:14<08:58,  6.74s/it, train loss=0.2556, val ΔE00=2.220, best=2.220]Training (late/resnet18):  21%|██        | 21/100 [02:21<08:51,  6.72s/it, train loss=0.2556, val ΔE00=2.220, best=2.220]Training (late/resnet18):  21%|██        | 21/100 [02:21<08:51,  6.72s/it, train loss=0.2636, val ΔE00=2.498, best=2.220]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:42,  6.70s/it, train loss=0.2636, val ΔE00=2.498, best=2.220]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:42,  6.70s/it, train loss=0.2940, val ΔE00=2.321, best=2.220]Training (late/resnet18):  23%|██▎       | 23/100 [02:34<08:34,  6.68s/it, train loss=0.2940, val ΔE00=2.321, best=2.220]Training (late/resnet18):  23%|██▎       | 23/100 [02:34<08:34,  6.68s/it, train loss=0.3071, val ΔE00=2.495, best=2.220]Training (late/resnet18):  24%|██▍       | 24/100 [02:41<08:26,  6.67s/it, train loss=0.3071, val ΔE00=2.495, best=2.220]Training (late/resnet18):  24%|██▍       | 24/100 [02:41<08:26,  6.67s/it, train loss=0.3160, val ΔE00=2.581, best=2.220]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:24,  6.73s/it, train loss=0.3160, val ΔE00=2.581, best=2.220]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:24,  6.73s/it, train loss=0.3692, val ΔE00=2.492, best=2.220]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:17,  6.72s/it, train loss=0.3692, val ΔE00=2.492, best=2.220]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:17,  6.72s/it, train loss=0.3601, val ΔE00=2.390, best=2.220]Training (late/resnet18):  27%|██▋       | 27/100 [03:01<08:10,  6.72s/it, train loss=0.3601, val ΔE00=2.390, best=2.220]Training (late/resnet18):  27%|██▋       | 27/100 [03:01<08:10,  6.72s/it, train loss=0.4009, val ΔE00=2.208, best=2.208]Training (late/resnet18):  28%|██▊       | 28/100 [03:08<08:02,  6.70s/it, train loss=0.4009, val ΔE00=2.208, best=2.208]Training (late/resnet18):  28%|██▊       | 28/100 [03:08<08:02,  6.70s/it, train loss=0.4371, val ΔE00=2.357, best=2.208]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:55,  6.70s/it, train loss=0.4371, val ΔE00=2.357, best=2.208]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:55,  6.70s/it, train loss=0.4457, val ΔE00=2.159, best=2.159]Training (late/resnet18):  30%|███       | 30/100 [03:21<07:52,  6.74s/it, train loss=0.4457, val ΔE00=2.159, best=2.159]Training (late/resnet18):  30%|███       | 30/100 [03:21<07:52,  6.74s/it, train loss=0.4965, val ΔE00=2.188, best=2.159]Training (late/resnet18):  31%|███       | 31/100 [03:28<07:44,  6.74s/it, train loss=0.4965, val ΔE00=2.188, best=2.159]Training (late/resnet18):  31%|███       | 31/100 [03:28<07:44,  6.74s/it, train loss=0.4945, val ΔE00=2.247, best=2.159]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:36,  6.71s/it, train loss=0.4945, val ΔE00=2.247, best=2.159]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:36,  6.71s/it, train loss=0.4883, val ΔE00=2.179, best=2.159]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:28,  6.70s/it, train loss=0.4883, val ΔE00=2.179, best=2.159]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:28,  6.70s/it, train loss=0.5306, val ΔE00=2.320, best=2.159]Training (late/resnet18):  34%|███▍      | 34/100 [03:48<07:21,  6.69s/it, train loss=0.5306, val ΔE00=2.320, best=2.159]Training (late/resnet18):  34%|███▍      | 34/100 [03:48<07:21,  6.69s/it, train loss=0.5580, val ΔE00=2.195, best=2.159]Training (late/resnet18):  35%|███▌      | 35/100 [03:55<07:18,  6.74s/it, train loss=0.5580, val ΔE00=2.195, best=2.159]Training (late/resnet18):  35%|███▌      | 35/100 [03:55<07:18,  6.74s/it, train loss=0.5553, val ΔE00=2.325, best=2.159]Training (late/resnet18):  36%|███▌      | 36/100 [04:02<07:11,  6.74s/it, train loss=0.5553, val ΔE00=2.325, best=2.159]Training (late/resnet18):  36%|███▌      | 36/100 [04:02<07:11,  6.74s/it, train loss=0.5969, val ΔE00=2.151, best=2.151]Training (late/resnet18):  37%|███▋      | 37/100 [04:08<07:02,  6.71s/it, train loss=0.5969, val ΔE00=2.151, best=2.151]Training (late/resnet18):  37%|███▋      | 37/100 [04:08<07:02,  6.71s/it, train loss=0.6216, val ΔE00=2.408, best=2.151]Training (late/resnet18):  38%|███▊      | 38/100 [04:15<06:56,  6.71s/it, train loss=0.6216, val ΔE00=2.408, best=2.151]Training (late/resnet18):  38%|███▊      | 38/100 [04:15<06:56,  6.71s/it, train loss=0.6424, val ΔE00=2.109, best=2.109]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:48,  6.70s/it, train loss=0.6424, val ΔE00=2.109, best=2.109]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:48,  6.70s/it, train loss=0.6199, val ΔE00=2.528, best=2.109]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:44,  6.75s/it, train loss=0.6199, val ΔE00=2.528, best=2.109]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:44,  6.75s/it, train loss=0.6429, val ΔE00=2.209, best=2.109]Training (late/resnet18):  41%|████      | 41/100 [04:35<06:37,  6.73s/it, train loss=0.6429, val ΔE00=2.209, best=2.109]Training (late/resnet18):  41%|████      | 41/100 [04:35<06:37,  6.73s/it, train loss=0.7022, val ΔE00=2.242, best=2.109]Training (late/resnet18):  42%|████▏     | 42/100 [04:42<06:29,  6.71s/it, train loss=0.7022, val ΔE00=2.242, best=2.109]Training (late/resnet18):  42%|████▏     | 42/100 [04:42<06:29,  6.71s/it, train loss=0.6545, val ΔE00=2.269, best=2.109]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.70s/it, train loss=0.6545, val ΔE00=2.269, best=2.109]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.70s/it, train loss=0.6972, val ΔE00=2.323, best=2.109]Training (late/resnet18):  44%|████▍     | 44/100 [04:55<06:14,  6.68s/it, train loss=0.6972, val ΔE00=2.323, best=2.109]Training (late/resnet18):  44%|████▍     | 44/100 [04:55<06:14,  6.68s/it, train loss=0.7421, val ΔE00=2.309, best=2.109]Training (late/resnet18):  45%|████▌     | 45/100 [05:02<06:10,  6.73s/it, train loss=0.7421, val ΔE00=2.309, best=2.109]Training (late/resnet18):  45%|████▌     | 45/100 [05:02<06:10,  6.73s/it, train loss=0.6996, val ΔE00=2.304, best=2.109]Training (late/resnet18):  46%|████▌     | 46/100 [05:09<06:02,  6.72s/it, train loss=0.6996, val ΔE00=2.304, best=2.109]Training (late/resnet18):  46%|████▌     | 46/100 [05:09<06:02,  6.72s/it, train loss=0.7740, val ΔE00=2.317, best=2.109]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:54,  6.69s/it, train loss=0.7740, val ΔE00=2.317, best=2.109]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:54,  6.69s/it, train loss=0.7904, val ΔE00=2.375, best=2.109]Training (late/resnet18):  48%|████▊     | 48/100 [05:22<05:47,  6.68s/it, train loss=0.7904, val ΔE00=2.375, best=2.109]Training (late/resnet18):  48%|████▊     | 48/100 [05:22<05:47,  6.68s/it, train loss=0.7720, val ΔE00=2.182, best=2.109]Training (late/resnet18):  49%|████▉     | 49/100 [05:29<05:40,  6.67s/it, train loss=0.7720, val ΔE00=2.182, best=2.109]Training (late/resnet18):  49%|████▉     | 49/100 [05:29<05:40,  6.67s/it, train loss=0.8007, val ΔE00=2.264, best=2.109]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:36,  6.73s/it, train loss=0.8007, val ΔE00=2.264, best=2.109]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:36,  6.73s/it, train loss=0.8196, val ΔE00=2.248, best=2.109]Training (late/resnet18):  51%|█████     | 51/100 [05:42<05:29,  6.71s/it, train loss=0.8196, val ΔE00=2.248, best=2.109]Training (late/resnet18):  51%|█████     | 51/100 [05:42<05:29,  6.71s/it, train loss=0.7645, val ΔE00=2.215, best=2.109]Training (late/resnet18):  52%|█████▏    | 52/100 [05:49<05:21,  6.70s/it, train loss=0.7645, val ΔE00=2.215, best=2.109]Training (late/resnet18):  52%|█████▏    | 52/100 [05:49<05:21,  6.70s/it, train loss=0.8478, val ΔE00=2.330, best=2.109]Training (late/resnet18):  53%|█████▎    | 53/100 [05:56<05:13,  6.68s/it, train loss=0.8478, val ΔE00=2.330, best=2.109]Training (late/resnet18):  53%|█████▎    | 53/100 [05:56<05:13,  6.68s/it, train loss=0.8439, val ΔE00=2.174, best=2.109]Training (late/resnet18):  54%|█████▍    | 54/100 [06:02<05:06,  6.67s/it, train loss=0.8439, val ΔE00=2.174, best=2.109]Training (late/resnet18):  54%|█████▍    | 54/100 [06:02<05:06,  6.67s/it, train loss=0.8242, val ΔE00=2.385, best=2.109]Training (late/resnet18):  55%|█████▌    | 55/100 [06:09<05:02,  6.73s/it, train loss=0.8242, val ΔE00=2.385, best=2.109]Training (late/resnet18):  55%|█████▌    | 55/100 [06:09<05:02,  6.73s/it, train loss=0.8692, val ΔE00=2.197, best=2.109]Training (late/resnet18):  56%|█████▌    | 56/100 [06:16<04:56,  6.73s/it, train loss=0.8692, val ΔE00=2.197, best=2.109]Training (late/resnet18):  56%|█████▌    | 56/100 [06:16<04:56,  6.73s/it, train loss=0.8664, val ΔE00=2.086, best=2.086]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:48,  6.71s/it, train loss=0.8664, val ΔE00=2.086, best=2.086]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:48,  6.71s/it, train loss=0.8626, val ΔE00=2.130, best=2.086]Training (late/resnet18):  58%|█████▊    | 58/100 [06:29<04:40,  6.69s/it, train loss=0.8626, val ΔE00=2.130, best=2.086]Training (late/resnet18):  58%|█████▊    | 58/100 [06:29<04:40,  6.69s/it, train loss=0.8806, val ΔE00=2.343, best=2.086]Training (late/resnet18):  59%|█████▉    | 59/100 [06:36<04:33,  6.67s/it, train loss=0.8806, val ΔE00=2.343, best=2.086]Training (late/resnet18):  59%|█████▉    | 59/100 [06:36<04:33,  6.67s/it, train loss=0.9093, val ΔE00=2.133, best=2.086]Training (late/resnet18):  60%|██████    | 60/100 [06:43<04:29,  6.73s/it, train loss=0.9093, val ΔE00=2.133, best=2.086]Training (late/resnet18):  60%|██████    | 60/100 [06:43<04:29,  6.73s/it, train loss=0.8898, val ΔE00=2.206, best=2.086]Training (late/resnet18):  61%|██████    | 61/100 [06:49<04:22,  6.74s/it, train loss=0.8898, val ΔE00=2.206, best=2.086]Training (late/resnet18):  61%|██████    | 61/100 [06:49<04:22,  6.74s/it, train loss=0.8749, val ΔE00=2.075, best=2.075]Training (late/resnet18):  62%|██████▏   | 62/100 [06:56<04:14,  6.71s/it, train loss=0.8749, val ΔE00=2.075, best=2.075]Training (late/resnet18):  62%|██████▏   | 62/100 [06:56<04:14,  6.71s/it, train loss=0.9790, val ΔE00=2.134, best=2.075]Training (late/resnet18):  63%|██████▎   | 63/100 [07:03<04:07,  6.69s/it, train loss=0.9790, val ΔE00=2.134, best=2.075]Training (late/resnet18):  63%|██████▎   | 63/100 [07:03<04:07,  6.69s/it, train loss=0.9553, val ΔE00=2.162, best=2.075]Training (late/resnet18):  64%|██████▍   | 64/100 [07:09<04:00,  6.68s/it, train loss=0.9553, val ΔE00=2.162, best=2.075]Training (late/resnet18):  64%|██████▍   | 64/100 [07:09<04:00,  6.68s/it, train loss=0.9170, val ΔE00=2.304, best=2.075]Training (late/resnet18):  65%|██████▌   | 65/100 [07:16<03:55,  6.73s/it, train loss=0.9170, val ΔE00=2.304, best=2.075]Training (late/resnet18):  65%|██████▌   | 65/100 [07:16<03:55,  6.73s/it, train loss=0.9471, val ΔE00=2.212, best=2.075]Training (late/resnet18):  66%|██████▌   | 66/100 [07:23<03:48,  6.72s/it, train loss=0.9471, val ΔE00=2.212, best=2.075]Training (late/resnet18):  66%|██████▌   | 66/100 [07:23<03:48,  6.72s/it, train loss=0.9206, val ΔE00=2.260, best=2.075]Training (late/resnet18):  67%|██████▋   | 67/100 [07:30<03:41,  6.70s/it, train loss=0.9206, val ΔE00=2.260, best=2.075]Training (late/resnet18):  67%|██████▋   | 67/100 [07:30<03:41,  6.70s/it, train loss=0.9352, val ΔE00=2.194, best=2.075]Training (late/resnet18):  68%|██████▊   | 68/100 [07:36<03:33,  6.69s/it, train loss=0.9352, val ΔE00=2.194, best=2.075]Training (late/resnet18):  68%|██████▊   | 68/100 [07:36<03:33,  6.69s/it, train loss=0.9087, val ΔE00=2.282, best=2.075]Training (late/resnet18):  69%|██████▉   | 69/100 [07:43<03:27,  6.68s/it, train loss=0.9087, val ΔE00=2.282, best=2.075]Training (late/resnet18):  69%|██████▉   | 69/100 [07:43<03:27,  6.68s/it, train loss=0.9374, val ΔE00=2.153, best=2.075]Training (late/resnet18):  70%|███████   | 70/100 [07:50<03:21,  6.73s/it, train loss=0.9374, val ΔE00=2.153, best=2.075]Training (late/resnet18):  70%|███████   | 70/100 [07:50<03:21,  6.73s/it, train loss=0.9358, val ΔE00=2.282, best=2.075]Training (late/resnet18):  70%|███████   | 70/100 [07:56<03:21,  6.73s/it, train loss=0.8948, val ΔE00=2.296, early_stop=yes]Training (late/resnet18):  70%|███████   | 70/100 [07:56<03:24,  6.81s/it, train loss=0.8948, val ΔE00=2.296, early_stop=yes]
[early] stop at epoch 71 (best de00=2.0746 @ 61)
[done] best ΔE00=2.075 over 71 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/late__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 7/24 ===
[sweep] id=007_model=late__backbone=resnet18__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model late --backbone resnet18 --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image+meta, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:57,  7.25s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:57,  7.25s/it, train loss=0.0129, val ΔE00=7.974, best=7.974]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:18,  6.92s/it, train loss=0.0129, val ΔE00=7.974, best=7.974]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:18,  6.92s/it, train loss=0.0058, val ΔE00=6.334, best=6.334]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:01,  6.82s/it, train loss=0.0058, val ΔE00=6.334, best=6.334]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:01,  6.82s/it, train loss=0.0102, val ΔE00=4.201, best=4.201]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:49,  6.77s/it, train loss=0.0102, val ΔE00=4.201, best=4.201]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:49,  6.77s/it, train loss=0.0160, val ΔE00=4.165, best=4.165]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:47,  6.82s/it, train loss=0.0160, val ΔE00=4.165, best=4.165]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:47,  6.82s/it, train loss=0.0247, val ΔE00=3.876, best=3.876]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:38,  6.80s/it, train loss=0.0247, val ΔE00=3.876, best=3.876]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:38,  6.80s/it, train loss=0.0332, val ΔE00=3.565, best=3.565]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0332, val ΔE00=3.565, best=3.565]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0452, val ΔE00=3.234, best=3.234]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:19,  6.73s/it, train loss=0.0452, val ΔE00=3.234, best=3.234]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:19,  6.73s/it, train loss=0.0590, val ΔE00=3.244, best=3.234]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:12,  6.73s/it, train loss=0.0590, val ΔE00=3.244, best=3.234]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:12,  6.73s/it, train loss=0.0749, val ΔE00=3.156, best=3.156]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:09,  6.77s/it, train loss=0.0749, val ΔE00=3.156, best=3.156]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:09,  6.77s/it, train loss=0.0894, val ΔE00=3.263, best=3.156]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:01,  6.76s/it, train loss=0.0894, val ΔE00=3.263, best=3.156]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:01,  6.76s/it, train loss=0.0989, val ΔE00=3.039, best=3.039]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:53,  6.75s/it, train loss=0.0989, val ΔE00=3.039, best=3.039]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:53,  6.75s/it, train loss=0.1110, val ΔE00=2.771, best=2.771]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:44,  6.72s/it, train loss=0.1110, val ΔE00=2.771, best=2.771]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:44,  6.72s/it, train loss=0.1278, val ΔE00=2.891, best=2.771]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:38,  6.72s/it, train loss=0.1278, val ΔE00=2.891, best=2.771]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:38,  6.72s/it, train loss=0.1410, val ΔE00=2.605, best=2.605]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:36,  6.78s/it, train loss=0.1410, val ΔE00=2.605, best=2.605]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:36,  6.78s/it, train loss=0.1595, val ΔE00=2.525, best=2.525]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:28,  6.77s/it, train loss=0.1595, val ΔE00=2.525, best=2.525]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:28,  6.77s/it, train loss=0.1708, val ΔE00=2.407, best=2.407]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:19,  6.74s/it, train loss=0.1708, val ΔE00=2.407, best=2.407]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:19,  6.74s/it, train loss=0.2102, val ΔE00=2.661, best=2.407]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:10,  6.71s/it, train loss=0.2102, val ΔE00=2.661, best=2.407]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:10,  6.71s/it, train loss=0.2388, val ΔE00=2.633, best=2.407]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:02,  6.69s/it, train loss=0.2388, val ΔE00=2.633, best=2.407]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:02,  6.69s/it, train loss=0.2249, val ΔE00=2.851, best=2.407]Training (late/resnet18):  20%|██        | 20/100 [02:15<08:58,  6.74s/it, train loss=0.2249, val ΔE00=2.851, best=2.407]Training (late/resnet18):  20%|██        | 20/100 [02:15<08:58,  6.74s/it, train loss=0.2323, val ΔE00=2.449, best=2.407]Training (late/resnet18):  21%|██        | 21/100 [02:22<08:52,  6.74s/it, train loss=0.2323, val ΔE00=2.449, best=2.407]Training (late/resnet18):  21%|██        | 21/100 [02:22<08:52,  6.74s/it, train loss=0.2720, val ΔE00=2.314, best=2.314]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:43,  6.72s/it, train loss=0.2720, val ΔE00=2.314, best=2.314]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:43,  6.72s/it, train loss=0.2725, val ΔE00=2.463, best=2.314]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:36,  6.70s/it, train loss=0.2725, val ΔE00=2.463, best=2.314]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:36,  6.70s/it, train loss=0.3128, val ΔE00=2.938, best=2.314]Training (late/resnet18):  24%|██▍       | 24/100 [02:41<08:28,  6.69s/it, train loss=0.3128, val ΔE00=2.938, best=2.314]Training (late/resnet18):  24%|██▍       | 24/100 [02:41<08:28,  6.69s/it, train loss=0.3187, val ΔE00=2.473, best=2.314]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:24,  6.73s/it, train loss=0.3187, val ΔE00=2.473, best=2.314]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:24,  6.73s/it, train loss=0.3361, val ΔE00=2.417, best=2.314]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:17,  6.72s/it, train loss=0.3361, val ΔE00=2.417, best=2.314]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:17,  6.72s/it, train loss=0.3785, val ΔE00=2.777, best=2.314]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:09,  6.70s/it, train loss=0.3785, val ΔE00=2.777, best=2.314]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:09,  6.70s/it, train loss=0.3785, val ΔE00=2.491, best=2.314]Training (late/resnet18):  28%|██▊       | 28/100 [03:08<08:02,  6.70s/it, train loss=0.3785, val ΔE00=2.491, best=2.314]Training (late/resnet18):  28%|██▊       | 28/100 [03:08<08:02,  6.70s/it, train loss=0.3705, val ΔE00=2.306, best=2.306]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:54,  6.68s/it, train loss=0.3705, val ΔE00=2.306, best=2.306]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:54,  6.68s/it, train loss=0.4244, val ΔE00=2.403, best=2.306]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:52,  6.75s/it, train loss=0.4244, val ΔE00=2.403, best=2.306]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:52,  6.75s/it, train loss=0.4451, val ΔE00=2.442, best=2.306]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:44,  6.73s/it, train loss=0.4451, val ΔE00=2.442, best=2.306]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:44,  6.73s/it, train loss=0.4351, val ΔE00=2.271, best=2.271]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:36,  6.71s/it, train loss=0.4351, val ΔE00=2.271, best=2.271]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:36,  6.71s/it, train loss=0.4810, val ΔE00=2.621, best=2.271]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:29,  6.71s/it, train loss=0.4810, val ΔE00=2.621, best=2.271]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:29,  6.71s/it, train loss=0.4898, val ΔE00=2.271, best=2.271]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:21,  6.69s/it, train loss=0.4898, val ΔE00=2.271, best=2.271]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:21,  6.69s/it, train loss=0.4928, val ΔE00=2.392, best=2.271]Training (late/resnet18):  35%|███▌      | 35/100 [03:55<07:17,  6.73s/it, train loss=0.4928, val ΔE00=2.392, best=2.271]Training (late/resnet18):  35%|███▌      | 35/100 [03:55<07:17,  6.73s/it, train loss=0.5185, val ΔE00=2.554, best=2.271]Training (late/resnet18):  36%|███▌      | 36/100 [04:02<07:10,  6.72s/it, train loss=0.5185, val ΔE00=2.554, best=2.271]Training (late/resnet18):  36%|███▌      | 36/100 [04:02<07:10,  6.72s/it, train loss=0.5573, val ΔE00=2.617, best=2.271]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:02,  6.71s/it, train loss=0.5573, val ΔE00=2.617, best=2.271]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:02,  6.71s/it, train loss=0.5390, val ΔE00=2.276, best=2.271]Training (late/resnet18):  38%|███▊      | 38/100 [04:15<06:54,  6.69s/it, train loss=0.5390, val ΔE00=2.276, best=2.271]Training (late/resnet18):  38%|███▊      | 38/100 [04:15<06:54,  6.69s/it, train loss=0.5682, val ΔE00=2.509, best=2.271]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:47,  6.68s/it, train loss=0.5682, val ΔE00=2.509, best=2.271]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:47,  6.68s/it, train loss=0.5896, val ΔE00=2.379, best=2.271]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:43,  6.72s/it, train loss=0.5896, val ΔE00=2.379, best=2.271]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:43,  6.72s/it, train loss=0.6107, val ΔE00=2.401, best=2.271]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:37,  6.74s/it, train loss=0.6107, val ΔE00=2.401, best=2.271]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:37,  6.74s/it, train loss=0.6397, val ΔE00=2.227, best=2.227]Training (late/resnet18):  42%|████▏     | 42/100 [04:42<06:29,  6.71s/it, train loss=0.6397, val ΔE00=2.227, best=2.227]Training (late/resnet18):  42%|████▏     | 42/100 [04:42<06:29,  6.71s/it, train loss=0.7112, val ΔE00=2.293, best=2.227]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.70s/it, train loss=0.7112, val ΔE00=2.293, best=2.227]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.70s/it, train loss=0.6672, val ΔE00=2.268, best=2.227]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:14,  6.69s/it, train loss=0.6672, val ΔE00=2.268, best=2.227]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:14,  6.69s/it, train loss=0.6849, val ΔE00=2.729, best=2.227]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:10,  6.73s/it, train loss=0.6849, val ΔE00=2.729, best=2.227]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:10,  6.73s/it, train loss=0.7344, val ΔE00=2.235, best=2.227]Training (late/resnet18):  46%|████▌     | 46/100 [05:09<06:03,  6.72s/it, train loss=0.7344, val ΔE00=2.235, best=2.227]Training (late/resnet18):  46%|████▌     | 46/100 [05:09<06:03,  6.72s/it, train loss=0.7215, val ΔE00=2.282, best=2.227]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:55,  6.71s/it, train loss=0.7215, val ΔE00=2.282, best=2.227]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:55,  6.71s/it, train loss=0.7041, val ΔE00=2.421, best=2.227]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:48,  6.71s/it, train loss=0.7041, val ΔE00=2.421, best=2.227]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:48,  6.71s/it, train loss=0.7487, val ΔE00=2.218, best=2.218]Training (late/resnet18):  49%|████▉     | 49/100 [05:29<05:41,  6.69s/it, train loss=0.7487, val ΔE00=2.218, best=2.218]Training (late/resnet18):  49%|████▉     | 49/100 [05:29<05:41,  6.69s/it, train loss=0.7818, val ΔE00=2.243, best=2.218]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:37,  6.75s/it, train loss=0.7818, val ΔE00=2.243, best=2.218]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:37,  6.75s/it, train loss=0.7885, val ΔE00=2.521, best=2.218]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:29,  6.73s/it, train loss=0.7885, val ΔE00=2.521, best=2.218]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:29,  6.73s/it, train loss=0.7845, val ΔE00=2.600, best=2.218]Training (late/resnet18):  52%|█████▏    | 52/100 [05:49<05:21,  6.71s/it, train loss=0.7845, val ΔE00=2.600, best=2.218]Training (late/resnet18):  52%|█████▏    | 52/100 [05:49<05:21,  6.71s/it, train loss=0.8145, val ΔE00=2.224, best=2.218]Training (late/resnet18):  53%|█████▎    | 53/100 [05:56<05:14,  6.69s/it, train loss=0.8145, val ΔE00=2.224, best=2.218]Training (late/resnet18):  53%|█████▎    | 53/100 [05:56<05:14,  6.69s/it, train loss=0.7943, val ΔE00=2.266, best=2.218]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:07,  6.68s/it, train loss=0.7943, val ΔE00=2.266, best=2.218]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:07,  6.68s/it, train loss=0.7667, val ΔE00=2.516, best=2.218]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:03,  6.74s/it, train loss=0.7667, val ΔE00=2.516, best=2.218]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:03,  6.74s/it, train loss=0.8469, val ΔE00=2.410, best=2.218]Training (late/resnet18):  56%|█████▌    | 56/100 [06:16<04:56,  6.74s/it, train loss=0.8469, val ΔE00=2.410, best=2.218]Training (late/resnet18):  56%|█████▌    | 56/100 [06:16<04:56,  6.74s/it, train loss=0.8769, val ΔE00=2.144, best=2.144]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:48,  6.71s/it, train loss=0.8769, val ΔE00=2.144, best=2.144]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:48,  6.71s/it, train loss=0.8480, val ΔE00=2.526, best=2.144]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:40,  6.69s/it, train loss=0.8480, val ΔE00=2.526, best=2.144]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:40,  6.69s/it, train loss=0.8372, val ΔE00=2.240, best=2.144]Training (late/resnet18):  59%|█████▉    | 59/100 [06:36<04:33,  6.68s/it, train loss=0.8372, val ΔE00=2.240, best=2.144]Training (late/resnet18):  59%|█████▉    | 59/100 [06:36<04:33,  6.68s/it, train loss=0.8674, val ΔE00=2.501, best=2.144]Training (late/resnet18):  60%|██████    | 60/100 [06:43<04:29,  6.73s/it, train loss=0.8674, val ΔE00=2.501, best=2.144]Training (late/resnet18):  60%|██████    | 60/100 [06:43<04:29,  6.73s/it, train loss=0.8360, val ΔE00=2.333, best=2.144]Training (late/resnet18):  61%|██████    | 61/100 [06:50<04:22,  6.73s/it, train loss=0.8360, val ΔE00=2.333, best=2.144]Training (late/resnet18):  61%|██████    | 61/100 [06:50<04:22,  6.73s/it, train loss=0.9429, val ΔE00=2.438, best=2.144]Training (late/resnet18):  62%|██████▏   | 62/100 [06:57<04:14,  6.71s/it, train loss=0.9429, val ΔE00=2.438, best=2.144]Training (late/resnet18):  62%|██████▏   | 62/100 [06:57<04:14,  6.71s/it, train loss=0.8708, val ΔE00=2.294, best=2.144]Training (late/resnet18):  63%|██████▎   | 63/100 [07:03<04:07,  6.69s/it, train loss=0.8708, val ΔE00=2.294, best=2.144]Training (late/resnet18):  63%|██████▎   | 63/100 [07:03<04:07,  6.69s/it, train loss=0.8718, val ΔE00=2.214, best=2.144]Training (late/resnet18):  64%|██████▍   | 64/100 [07:10<04:00,  6.67s/it, train loss=0.8718, val ΔE00=2.214, best=2.144]Training (late/resnet18):  64%|██████▍   | 64/100 [07:10<04:00,  6.67s/it, train loss=0.8589, val ΔE00=2.471, best=2.144]Training (late/resnet18):  65%|██████▌   | 65/100 [07:17<03:55,  6.73s/it, train loss=0.8589, val ΔE00=2.471, best=2.144]Training (late/resnet18):  65%|██████▌   | 65/100 [07:17<03:55,  6.73s/it, train loss=0.8871, val ΔE00=2.369, best=2.144]Training (late/resnet18):  66%|██████▌   | 66/100 [07:23<03:48,  6.71s/it, train loss=0.8871, val ΔE00=2.369, best=2.144]Training (late/resnet18):  66%|██████▌   | 66/100 [07:23<03:48,  6.71s/it, train loss=0.9100, val ΔE00=2.622, best=2.144]Training (late/resnet18):  67%|██████▋   | 67/100 [07:30<03:40,  6.69s/it, train loss=0.9100, val ΔE00=2.622, best=2.144]Training (late/resnet18):  67%|██████▋   | 67/100 [07:30<03:40,  6.69s/it, train loss=0.8964, val ΔE00=2.323, best=2.144]Training (late/resnet18):  68%|██████▊   | 68/100 [07:37<03:33,  6.68s/it, train loss=0.8964, val ΔE00=2.323, best=2.144]Training (late/resnet18):  68%|██████▊   | 68/100 [07:37<03:33,  6.68s/it, train loss=0.8785, val ΔE00=2.208, best=2.144]Training (late/resnet18):  68%|██████▊   | 68/100 [07:43<03:33,  6.68s/it, train loss=0.8682, val ΔE00=2.379, early_stop=yes]Training (late/resnet18):  68%|██████▊   | 68/100 [07:43<03:38,  6.82s/it, train loss=0.8682, val ΔE00=2.379, early_stop=yes]
[early] stop at epoch 69 (best de00=2.1443 @ 56)
[done] best ΔE00=2.144 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/late__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 8/24 ===
[sweep] id=008_model=late__backbone=resnet18__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model late --backbone resnet18 --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image+mean+meta, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<12:03,  7.30s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<12:03,  7.30s/it, train loss=0.0100, val ΔE00=5.946, best=5.946]Training (late/resnet18):   2%|▏         | 2/100 [00:14<11:26,  7.01s/it, train loss=0.0100, val ΔE00=5.946, best=5.946]Training (late/resnet18):   2%|▏         | 2/100 [00:14<11:26,  7.01s/it, train loss=0.0055, val ΔE00=4.883, best=4.883]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:09,  6.90s/it, train loss=0.0055, val ΔE00=4.883, best=4.883]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:09,  6.90s/it, train loss=0.0090, val ΔE00=3.624, best=3.624]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:58,  6.86s/it, train loss=0.0090, val ΔE00=3.624, best=3.624]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:58,  6.86s/it, train loss=0.0148, val ΔE00=3.146, best=3.146]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:53,  6.88s/it, train loss=0.0148, val ΔE00=3.146, best=3.146]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:53,  6.88s/it, train loss=0.0230, val ΔE00=3.656, best=3.146]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:43,  6.84s/it, train loss=0.0230, val ΔE00=3.656, best=3.146]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:43,  6.84s/it, train loss=0.0320, val ΔE00=3.291, best=3.146]Training (late/resnet18):   7%|▋         | 7/100 [00:48<10:34,  6.82s/it, train loss=0.0320, val ΔE00=3.291, best=3.146]Training (late/resnet18):   7%|▋         | 7/100 [00:48<10:34,  6.82s/it, train loss=0.0419, val ΔE00=3.016, best=3.016]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:24,  6.78s/it, train loss=0.0419, val ΔE00=3.016, best=3.016]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:24,  6.78s/it, train loss=0.0564, val ΔE00=3.185, best=3.016]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:15,  6.76s/it, train loss=0.0564, val ΔE00=3.185, best=3.016]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:15,  6.76s/it, train loss=0.0680, val ΔE00=3.228, best=3.016]Training (late/resnet18):  10%|█         | 10/100 [01:08<10:14,  6.82s/it, train loss=0.0680, val ΔE00=3.228, best=3.016]Training (late/resnet18):  10%|█         | 10/100 [01:08<10:14,  6.82s/it, train loss=0.0783, val ΔE00=2.636, best=2.636]Training (late/resnet18):  11%|█         | 11/100 [01:15<10:05,  6.80s/it, train loss=0.0783, val ΔE00=2.636, best=2.636]Training (late/resnet18):  11%|█         | 11/100 [01:15<10:05,  6.80s/it, train loss=0.0916, val ΔE00=2.850, best=2.636]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:55,  6.77s/it, train loss=0.0916, val ΔE00=2.850, best=2.636]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:55,  6.77s/it, train loss=0.1077, val ΔE00=2.657, best=2.636]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:48,  6.77s/it, train loss=0.1077, val ΔE00=2.657, best=2.636]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:48,  6.77s/it, train loss=0.1247, val ΔE00=2.533, best=2.533]Training (late/resnet18):  14%|█▍        | 14/100 [01:35<09:40,  6.75s/it, train loss=0.1247, val ΔE00=2.533, best=2.533]Training (late/resnet18):  14%|█▍        | 14/100 [01:35<09:40,  6.75s/it, train loss=0.1402, val ΔE00=2.717, best=2.533]Training (late/resnet18):  15%|█▌        | 15/100 [01:42<09:40,  6.83s/it, train loss=0.1402, val ΔE00=2.717, best=2.533]Training (late/resnet18):  15%|█▌        | 15/100 [01:42<09:40,  6.83s/it, train loss=0.1561, val ΔE00=2.381, best=2.381]Training (late/resnet18):  16%|█▌        | 16/100 [01:49<09:32,  6.81s/it, train loss=0.1561, val ΔE00=2.381, best=2.381]Training (late/resnet18):  16%|█▌        | 16/100 [01:49<09:32,  6.81s/it, train loss=0.1672, val ΔE00=2.372, best=2.372]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:22,  6.78s/it, train loss=0.1672, val ΔE00=2.372, best=2.372]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:22,  6.78s/it, train loss=0.1878, val ΔE00=2.632, best=2.372]Training (late/resnet18):  18%|█▊        | 18/100 [02:02<09:14,  6.76s/it, train loss=0.1878, val ΔE00=2.632, best=2.372]Training (late/resnet18):  18%|█▊        | 18/100 [02:02<09:14,  6.76s/it, train loss=0.2081, val ΔE00=2.545, best=2.372]Training (late/resnet18):  19%|█▉        | 19/100 [02:09<09:05,  6.74s/it, train loss=0.2081, val ΔE00=2.545, best=2.372]Training (late/resnet18):  19%|█▉        | 19/100 [02:09<09:05,  6.74s/it, train loss=0.2215, val ΔE00=2.429, best=2.372]Training (late/resnet18):  20%|██        | 20/100 [02:16<09:03,  6.80s/it, train loss=0.2215, val ΔE00=2.429, best=2.372]Training (late/resnet18):  20%|██        | 20/100 [02:16<09:03,  6.80s/it, train loss=0.2423, val ΔE00=2.459, best=2.372]Training (late/resnet18):  21%|██        | 21/100 [02:23<08:56,  6.79s/it, train loss=0.2423, val ΔE00=2.459, best=2.372]Training (late/resnet18):  21%|██        | 21/100 [02:23<08:56,  6.79s/it, train loss=0.2467, val ΔE00=2.334, best=2.334]Training (late/resnet18):  22%|██▏       | 22/100 [02:29<08:47,  6.76s/it, train loss=0.2467, val ΔE00=2.334, best=2.334]Training (late/resnet18):  22%|██▏       | 22/100 [02:29<08:47,  6.76s/it, train loss=0.2722, val ΔE00=2.482, best=2.334]Training (late/resnet18):  23%|██▎       | 23/100 [02:36<08:40,  6.77s/it, train loss=0.2722, val ΔE00=2.482, best=2.334]Training (late/resnet18):  23%|██▎       | 23/100 [02:36<08:40,  6.77s/it, train loss=0.2914, val ΔE00=2.291, best=2.291]Training (late/resnet18):  24%|██▍       | 24/100 [02:43<08:32,  6.75s/it, train loss=0.2914, val ΔE00=2.291, best=2.291]Training (late/resnet18):  24%|██▍       | 24/100 [02:43<08:32,  6.75s/it, train loss=0.3254, val ΔE00=2.397, best=2.291]Training (late/resnet18):  25%|██▌       | 25/100 [02:50<08:28,  6.79s/it, train loss=0.3254, val ΔE00=2.397, best=2.291]Training (late/resnet18):  25%|██▌       | 25/100 [02:50<08:28,  6.79s/it, train loss=0.3392, val ΔE00=2.323, best=2.291]Training (late/resnet18):  26%|██▌       | 26/100 [02:56<08:23,  6.80s/it, train loss=0.3392, val ΔE00=2.323, best=2.291]Training (late/resnet18):  26%|██▌       | 26/100 [02:56<08:23,  6.80s/it, train loss=0.3548, val ΔE00=2.258, best=2.258]Training (late/resnet18):  27%|██▋       | 27/100 [03:03<08:14,  6.77s/it, train loss=0.3548, val ΔE00=2.258, best=2.258]Training (late/resnet18):  27%|██▋       | 27/100 [03:03<08:14,  6.77s/it, train loss=0.3821, val ΔE00=2.496, best=2.258]Training (late/resnet18):  28%|██▊       | 28/100 [03:10<08:06,  6.76s/it, train loss=0.3821, val ΔE00=2.496, best=2.258]Training (late/resnet18):  28%|██▊       | 28/100 [03:10<08:06,  6.76s/it, train loss=0.3784, val ΔE00=2.441, best=2.258]Training (late/resnet18):  29%|██▉       | 29/100 [03:17<07:58,  6.74s/it, train loss=0.3784, val ΔE00=2.441, best=2.258]Training (late/resnet18):  29%|██▉       | 29/100 [03:17<07:58,  6.74s/it, train loss=0.4378, val ΔE00=2.358, best=2.258]Training (late/resnet18):  30%|███       | 30/100 [03:24<07:56,  6.81s/it, train loss=0.4378, val ΔE00=2.358, best=2.258]Training (late/resnet18):  30%|███       | 30/100 [03:24<07:56,  6.81s/it, train loss=0.4353, val ΔE00=2.565, best=2.258]Training (late/resnet18):  31%|███       | 31/100 [03:30<07:49,  6.80s/it, train loss=0.4353, val ΔE00=2.565, best=2.258]Training (late/resnet18):  31%|███       | 31/100 [03:30<07:49,  6.80s/it, train loss=0.4912, val ΔE00=2.252, best=2.252]Training (late/resnet18):  32%|███▏      | 32/100 [03:37<07:40,  6.77s/it, train loss=0.4912, val ΔE00=2.252, best=2.252]Training (late/resnet18):  32%|███▏      | 32/100 [03:37<07:40,  6.77s/it, train loss=0.4635, val ΔE00=2.325, best=2.252]Training (late/resnet18):  33%|███▎      | 33/100 [03:44<07:33,  6.77s/it, train loss=0.4635, val ΔE00=2.325, best=2.252]Training (late/resnet18):  33%|███▎      | 33/100 [03:44<07:33,  6.77s/it, train loss=0.5217, val ΔE00=2.249, best=2.249]Training (late/resnet18):  34%|███▍      | 34/100 [03:50<07:25,  6.76s/it, train loss=0.5217, val ΔE00=2.249, best=2.249]Training (late/resnet18):  34%|███▍      | 34/100 [03:50<07:25,  6.76s/it, train loss=0.5202, val ΔE00=2.416, best=2.249]Training (late/resnet18):  35%|███▌      | 35/100 [03:57<07:22,  6.80s/it, train loss=0.5202, val ΔE00=2.416, best=2.249]Training (late/resnet18):  35%|███▌      | 35/100 [03:57<07:22,  6.80s/it, train loss=0.5389, val ΔE00=2.257, best=2.249]Training (late/resnet18):  36%|███▌      | 36/100 [04:04<07:14,  6.79s/it, train loss=0.5389, val ΔE00=2.257, best=2.249]Training (late/resnet18):  36%|███▌      | 36/100 [04:04<07:14,  6.79s/it, train loss=0.5684, val ΔE00=2.337, best=2.249]Training (late/resnet18):  37%|███▋      | 37/100 [04:11<07:06,  6.77s/it, train loss=0.5684, val ΔE00=2.337, best=2.249]Training (late/resnet18):  37%|███▋      | 37/100 [04:11<07:06,  6.77s/it, train loss=0.5920, val ΔE00=2.323, best=2.249]Training (late/resnet18):  38%|███▊      | 38/100 [04:18<06:59,  6.77s/it, train loss=0.5920, val ΔE00=2.323, best=2.249]Training (late/resnet18):  38%|███▊      | 38/100 [04:18<06:59,  6.77s/it, train loss=0.6124, val ΔE00=2.106, best=2.106]Training (late/resnet18):  39%|███▉      | 39/100 [04:24<06:51,  6.75s/it, train loss=0.6124, val ΔE00=2.106, best=2.106]Training (late/resnet18):  39%|███▉      | 39/100 [04:24<06:51,  6.75s/it, train loss=0.5978, val ΔE00=2.269, best=2.106]Training (late/resnet18):  40%|████      | 40/100 [04:31<06:47,  6.80s/it, train loss=0.5978, val ΔE00=2.269, best=2.106]Training (late/resnet18):  40%|████      | 40/100 [04:31<06:47,  6.80s/it, train loss=0.6397, val ΔE00=2.322, best=2.106]Training (late/resnet18):  41%|████      | 41/100 [04:38<06:40,  6.79s/it, train loss=0.6397, val ΔE00=2.322, best=2.106]Training (late/resnet18):  41%|████      | 41/100 [04:38<06:40,  6.79s/it, train loss=0.6781, val ΔE00=2.577, best=2.106]Training (late/resnet18):  42%|████▏     | 42/100 [04:45<06:32,  6.77s/it, train loss=0.6781, val ΔE00=2.577, best=2.106]Training (late/resnet18):  42%|████▏     | 42/100 [04:45<06:32,  6.77s/it, train loss=0.6784, val ΔE00=2.307, best=2.106]Training (late/resnet18):  43%|████▎     | 43/100 [04:51<06:24,  6.75s/it, train loss=0.6784, val ΔE00=2.307, best=2.106]Training (late/resnet18):  43%|████▎     | 43/100 [04:51<06:24,  6.75s/it, train loss=0.6912, val ΔE00=2.503, best=2.106]Training (late/resnet18):  44%|████▍     | 44/100 [04:58<06:17,  6.74s/it, train loss=0.6912, val ΔE00=2.503, best=2.106]Training (late/resnet18):  44%|████▍     | 44/100 [04:58<06:17,  6.74s/it, train loss=0.6973, val ΔE00=2.322, best=2.106]Training (late/resnet18):  45%|████▌     | 45/100 [05:05<06:13,  6.79s/it, train loss=0.6973, val ΔE00=2.322, best=2.106]Training (late/resnet18):  45%|████▌     | 45/100 [05:05<06:13,  6.79s/it, train loss=0.7028, val ΔE00=2.352, best=2.106]Training (late/resnet18):  46%|████▌     | 46/100 [05:12<06:06,  6.78s/it, train loss=0.7028, val ΔE00=2.352, best=2.106]Training (late/resnet18):  46%|████▌     | 46/100 [05:12<06:06,  6.78s/it, train loss=0.7188, val ΔE00=2.322, best=2.106]Training (late/resnet18):  47%|████▋     | 47/100 [05:19<05:58,  6.76s/it, train loss=0.7188, val ΔE00=2.322, best=2.106]Training (late/resnet18):  47%|████▋     | 47/100 [05:19<05:58,  6.76s/it, train loss=0.7079, val ΔE00=2.370, best=2.106]Training (late/resnet18):  48%|████▊     | 48/100 [05:25<05:50,  6.75s/it, train loss=0.7079, val ΔE00=2.370, best=2.106]Training (late/resnet18):  48%|████▊     | 48/100 [05:25<05:50,  6.75s/it, train loss=0.7251, val ΔE00=2.251, best=2.106]Training (late/resnet18):  49%|████▉     | 49/100 [05:32<05:43,  6.73s/it, train loss=0.7251, val ΔE00=2.251, best=2.106]Training (late/resnet18):  49%|████▉     | 49/100 [05:32<05:43,  6.73s/it, train loss=0.7763, val ΔE00=2.331, best=2.106]Training (late/resnet18):  50%|█████     | 50/100 [05:39<05:39,  6.78s/it, train loss=0.7763, val ΔE00=2.331, best=2.106]Training (late/resnet18):  50%|█████     | 50/100 [05:39<05:39,  6.78s/it, train loss=0.8090, val ΔE00=2.151, best=2.106]Training (late/resnet18):  51%|█████     | 51/100 [05:46<05:32,  6.78s/it, train loss=0.8090, val ΔE00=2.151, best=2.106]Training (late/resnet18):  51%|█████     | 51/100 [05:46<05:32,  6.78s/it, train loss=0.8322, val ΔE00=2.249, best=2.106]Training (late/resnet18):  52%|█████▏    | 52/100 [05:52<05:24,  6.76s/it, train loss=0.8322, val ΔE00=2.249, best=2.106]Training (late/resnet18):  52%|█████▏    | 52/100 [05:52<05:24,  6.76s/it, train loss=0.8350, val ΔE00=2.296, best=2.106]Training (late/resnet18):  53%|█████▎    | 53/100 [05:59<05:16,  6.74s/it, train loss=0.8350, val ΔE00=2.296, best=2.106]Training (late/resnet18):  53%|█████▎    | 53/100 [05:59<05:16,  6.74s/it, train loss=0.8243, val ΔE00=2.332, best=2.106]Training (late/resnet18):  54%|█████▍    | 54/100 [06:06<05:09,  6.73s/it, train loss=0.8243, val ΔE00=2.332, best=2.106]Training (late/resnet18):  54%|█████▍    | 54/100 [06:06<05:09,  6.73s/it, train loss=0.8200, val ΔE00=2.153, best=2.106]Training (late/resnet18):  55%|█████▌    | 55/100 [06:13<05:05,  6.78s/it, train loss=0.8200, val ΔE00=2.153, best=2.106]Training (late/resnet18):  55%|█████▌    | 55/100 [06:13<05:05,  6.78s/it, train loss=0.8760, val ΔE00=2.181, best=2.106]Training (late/resnet18):  56%|█████▌    | 56/100 [06:19<04:58,  6.78s/it, train loss=0.8760, val ΔE00=2.181, best=2.106]Training (late/resnet18):  56%|█████▌    | 56/100 [06:19<04:58,  6.78s/it, train loss=0.8986, val ΔE00=2.239, best=2.106]Training (late/resnet18):  57%|█████▋    | 57/100 [06:26<04:50,  6.76s/it, train loss=0.8986, val ΔE00=2.239, best=2.106]Training (late/resnet18):  57%|█████▋    | 57/100 [06:26<04:50,  6.76s/it, train loss=0.9419, val ΔE00=2.199, best=2.106]Training (late/resnet18):  58%|█████▊    | 58/100 [06:33<04:43,  6.74s/it, train loss=0.9419, val ΔE00=2.199, best=2.106]Training (late/resnet18):  58%|█████▊    | 58/100 [06:33<04:43,  6.74s/it, train loss=0.8070, val ΔE00=2.500, best=2.106]Training (late/resnet18):  59%|█████▉    | 59/100 [06:40<04:36,  6.73s/it, train loss=0.8070, val ΔE00=2.500, best=2.106]Training (late/resnet18):  59%|█████▉    | 59/100 [06:40<04:36,  6.73s/it, train loss=0.9170, val ΔE00=2.152, best=2.106]Training (late/resnet18):  60%|██████    | 60/100 [06:46<04:31,  6.78s/it, train loss=0.9170, val ΔE00=2.152, best=2.106]Training (late/resnet18):  60%|██████    | 60/100 [06:46<04:31,  6.78s/it, train loss=0.8645, val ΔE00=2.264, best=2.106]Training (late/resnet18):  61%|██████    | 61/100 [06:53<04:24,  6.77s/it, train loss=0.8645, val ΔE00=2.264, best=2.106]Training (late/resnet18):  61%|██████    | 61/100 [06:53<04:24,  6.77s/it, train loss=0.8930, val ΔE00=2.232, best=2.106]Training (late/resnet18):  62%|██████▏   | 62/100 [07:00<04:16,  6.76s/it, train loss=0.8930, val ΔE00=2.232, best=2.106]Training (late/resnet18):  62%|██████▏   | 62/100 [07:00<04:16,  6.76s/it, train loss=0.9172, val ΔE00=2.133, best=2.106]Training (late/resnet18):  63%|██████▎   | 63/100 [07:07<04:09,  6.75s/it, train loss=0.9172, val ΔE00=2.133, best=2.106]Training (late/resnet18):  63%|██████▎   | 63/100 [07:07<04:09,  6.75s/it, train loss=0.8773, val ΔE00=2.235, best=2.106]Training (late/resnet18):  64%|██████▍   | 64/100 [07:13<04:02,  6.74s/it, train loss=0.8773, val ΔE00=2.235, best=2.106]Training (late/resnet18):  64%|██████▍   | 64/100 [07:13<04:02,  6.74s/it, train loss=0.9156, val ΔE00=2.260, best=2.106]Training (late/resnet18):  65%|██████▌   | 65/100 [07:20<03:57,  6.79s/it, train loss=0.9156, val ΔE00=2.260, best=2.106]Training (late/resnet18):  65%|██████▌   | 65/100 [07:20<03:57,  6.79s/it, train loss=0.8934, val ΔE00=2.436, best=2.106]Training (late/resnet18):  66%|██████▌   | 66/100 [07:27<03:50,  6.78s/it, train loss=0.8934, val ΔE00=2.436, best=2.106]Training (late/resnet18):  66%|██████▌   | 66/100 [07:27<03:50,  6.78s/it, train loss=0.8997, val ΔE00=2.212, best=2.106]Training (late/resnet18):  67%|██████▋   | 67/100 [07:34<03:42,  6.76s/it, train loss=0.8997, val ΔE00=2.212, best=2.106]Training (late/resnet18):  67%|██████▋   | 67/100 [07:34<03:42,  6.76s/it, train loss=0.9149, val ΔE00=2.476, best=2.106]Training (late/resnet18):  68%|██████▊   | 68/100 [07:40<03:35,  6.74s/it, train loss=0.9149, val ΔE00=2.476, best=2.106]Training (late/resnet18):  68%|██████▊   | 68/100 [07:40<03:35,  6.74s/it, train loss=0.9307, val ΔE00=2.318, best=2.106]Training (late/resnet18):  69%|██████▉   | 69/100 [07:47<03:29,  6.76s/it, train loss=0.9307, val ΔE00=2.318, best=2.106]Training (late/resnet18):  69%|██████▉   | 69/100 [07:47<03:29,  6.76s/it, train loss=0.8987, val ΔE00=2.080, best=2.080]Training (late/resnet18):  70%|███████   | 70/100 [07:54<03:23,  6.80s/it, train loss=0.8987, val ΔE00=2.080, best=2.080]Training (late/resnet18):  70%|███████   | 70/100 [07:54<03:23,  6.80s/it, train loss=0.8698, val ΔE00=2.168, best=2.080]Training (late/resnet18):  71%|███████   | 71/100 [08:01<03:16,  6.79s/it, train loss=0.8698, val ΔE00=2.168, best=2.080]Training (late/resnet18):  71%|███████   | 71/100 [08:01<03:16,  6.79s/it, train loss=0.8874, val ΔE00=2.344, best=2.080]Training (late/resnet18):  72%|███████▏  | 72/100 [08:08<03:09,  6.76s/it, train loss=0.8874, val ΔE00=2.344, best=2.080]Training (late/resnet18):  72%|███████▏  | 72/100 [08:08<03:09,  6.76s/it, train loss=0.9370, val ΔE00=2.213, best=2.080]Training (late/resnet18):  73%|███████▎  | 73/100 [08:14<03:02,  6.74s/it, train loss=0.9370, val ΔE00=2.213, best=2.080]Training (late/resnet18):  73%|███████▎  | 73/100 [08:14<03:02,  6.74s/it, train loss=0.9513, val ΔE00=2.386, best=2.080]Training (late/resnet18):  74%|███████▍  | 74/100 [08:21<02:54,  6.73s/it, train loss=0.9513, val ΔE00=2.386, best=2.080]Training (late/resnet18):  74%|███████▍  | 74/100 [08:21<02:54,  6.73s/it, train loss=0.9344, val ΔE00=2.129, best=2.080]Training (late/resnet18):  75%|███████▌  | 75/100 [08:28<02:49,  6.78s/it, train loss=0.9344, val ΔE00=2.129, best=2.080]Training (late/resnet18):  75%|███████▌  | 75/100 [08:28<02:49,  6.78s/it, train loss=0.9119, val ΔE00=2.184, best=2.080]Training (late/resnet18):  76%|███████▌  | 76/100 [08:35<02:42,  6.77s/it, train loss=0.9119, val ΔE00=2.184, best=2.080]Training (late/resnet18):  76%|███████▌  | 76/100 [08:35<02:42,  6.77s/it, train loss=0.8608, val ΔE00=2.142, best=2.080]Training (late/resnet18):  77%|███████▋  | 77/100 [08:41<02:35,  6.74s/it, train loss=0.8608, val ΔE00=2.142, best=2.080]Training (late/resnet18):  77%|███████▋  | 77/100 [08:41<02:35,  6.74s/it, train loss=0.9829, val ΔE00=2.466, best=2.080]Training (late/resnet18):  78%|███████▊  | 78/100 [08:48<02:28,  6.73s/it, train loss=0.9829, val ΔE00=2.466, best=2.080]Training (late/resnet18):  78%|███████▊  | 78/100 [08:48<02:28,  6.73s/it, train loss=0.9647, val ΔE00=2.212, best=2.080]Training (late/resnet18):  78%|███████▊  | 78/100 [08:55<02:28,  6.73s/it, train loss=0.9621, val ΔE00=2.278, early_stop=yes]Training (late/resnet18):  78%|███████▊  | 78/100 [08:55<02:30,  6.86s/it, train loss=0.9621, val ΔE00=2.278, early_stop=yes]
[early] stop at epoch 79 (best de00=2.0799 @ 69)
[done] best ΔE00=2.080 over 79 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/late__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 9/24 ===
[sweep] id=009_model=film__backbone=smallcnn__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model film --backbone smallcnn --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:16,  5.02s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:16,  5.02s/it, train loss=0.0107, val ΔE00=14.895, best=14.895]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:44,  4.74s/it, train loss=0.0107, val ΔE00=14.895, best=14.895]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:44,  4.74s/it, train loss=0.0084, val ΔE00=7.586, best=7.586]  Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:30,  4.65s/it, train loss=0.0084, val ΔE00=7.586, best=7.586]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:30,  4.65s/it, train loss=0.0134, val ΔE00=6.883, best=6.883]Training (film/smallcnn):   4%|▍         | 4/100 [00:18<07:21,  4.60s/it, train loss=0.0134, val ΔE00=6.883, best=6.883]Training (film/smallcnn):   4%|▍         | 4/100 [00:18<07:21,  4.60s/it, train loss=0.0215, val ΔE00=7.008, best=6.883]Training (film/smallcnn):   5%|▌         | 5/100 [00:23<07:23,  4.67s/it, train loss=0.0215, val ΔE00=7.008, best=6.883]Training (film/smallcnn):   5%|▌         | 5/100 [00:23<07:23,  4.67s/it, train loss=0.0347, val ΔE00=5.368, best=5.368]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:17,  4.66s/it, train loss=0.0347, val ΔE00=5.368, best=5.368]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:17,  4.66s/it, train loss=0.0494, val ΔE00=4.773, best=4.773]Training (film/smallcnn):   7%|▋         | 7/100 [00:32<07:09,  4.61s/it, train loss=0.0494, val ΔE00=4.773, best=4.773]Training (film/smallcnn):   7%|▋         | 7/100 [00:32<07:09,  4.61s/it, train loss=0.0658, val ΔE00=4.990, best=4.773]Training (film/smallcnn):   8%|▊         | 8/100 [00:37<07:01,  4.59s/it, train loss=0.0658, val ΔE00=4.990, best=4.773]Training (film/smallcnn):   8%|▊         | 8/100 [00:37<07:01,  4.59s/it, train loss=0.0846, val ΔE00=5.030, best=4.773]Training (film/smallcnn):   9%|▉         | 9/100 [00:41<06:55,  4.57s/it, train loss=0.0846, val ΔE00=5.030, best=4.773]Training (film/smallcnn):   9%|▉         | 9/100 [00:41<06:55,  4.57s/it, train loss=0.0949, val ΔE00=6.763, best=4.773]Training (film/smallcnn):  10%|█         | 10/100 [00:46<06:55,  4.62s/it, train loss=0.0949, val ΔE00=6.763, best=4.773]Training (film/smallcnn):  10%|█         | 10/100 [00:46<06:55,  4.62s/it, train loss=0.1241, val ΔE00=6.082, best=4.773]Training (film/smallcnn):  11%|█         | 11/100 [00:51<06:52,  4.63s/it, train loss=0.1241, val ΔE00=6.082, best=4.773]Training (film/smallcnn):  11%|█         | 11/100 [00:51<06:52,  4.63s/it, train loss=0.1413, val ΔE00=5.109, best=4.773]Training (film/smallcnn):  12%|█▏        | 12/100 [00:55<06:44,  4.60s/it, train loss=0.1413, val ΔE00=5.109, best=4.773]Training (film/smallcnn):  12%|█▏        | 12/100 [00:55<06:44,  4.60s/it, train loss=0.1719, val ΔE00=3.608, best=3.608]Training (film/smallcnn):  13%|█▎        | 13/100 [01:00<06:38,  4.58s/it, train loss=0.1719, val ΔE00=3.608, best=3.608]Training (film/smallcnn):  13%|█▎        | 13/100 [01:00<06:38,  4.58s/it, train loss=0.1892, val ΔE00=5.106, best=3.608]Training (film/smallcnn):  14%|█▍        | 14/100 [01:04<06:32,  4.57s/it, train loss=0.1892, val ΔE00=5.106, best=3.608]Training (film/smallcnn):  14%|█▍        | 14/100 [01:04<06:32,  4.57s/it, train loss=0.2140, val ΔE00=3.738, best=3.608]Training (film/smallcnn):  15%|█▌        | 15/100 [01:09<06:32,  4.62s/it, train loss=0.2140, val ΔE00=3.738, best=3.608]Training (film/smallcnn):  15%|█▌        | 15/100 [01:09<06:32,  4.62s/it, train loss=0.2422, val ΔE00=3.586, best=3.586]Training (film/smallcnn):  16%|█▌        | 16/100 [01:14<06:28,  4.63s/it, train loss=0.2422, val ΔE00=3.586, best=3.586]Training (film/smallcnn):  16%|█▌        | 16/100 [01:14<06:28,  4.63s/it, train loss=0.2664, val ΔE00=3.972, best=3.586]Training (film/smallcnn):  17%|█▋        | 17/100 [01:18<06:21,  4.60s/it, train loss=0.2664, val ΔE00=3.972, best=3.586]Training (film/smallcnn):  17%|█▋        | 17/100 [01:18<06:21,  4.60s/it, train loss=0.3248, val ΔE00=4.220, best=3.586]Training (film/smallcnn):  18%|█▊        | 18/100 [01:23<06:15,  4.58s/it, train loss=0.3248, val ΔE00=4.220, best=3.586]Training (film/smallcnn):  18%|█▊        | 18/100 [01:23<06:15,  4.58s/it, train loss=0.3501, val ΔE00=3.262, best=3.262]Training (film/smallcnn):  19%|█▉        | 19/100 [01:27<06:09,  4.56s/it, train loss=0.3501, val ΔE00=3.262, best=3.262]Training (film/smallcnn):  19%|█▉        | 19/100 [01:27<06:09,  4.56s/it, train loss=0.3689, val ΔE00=4.190, best=3.262]Training (film/smallcnn):  20%|██        | 20/100 [01:32<06:09,  4.62s/it, train loss=0.3689, val ΔE00=4.190, best=3.262]Training (film/smallcnn):  20%|██        | 20/100 [01:32<06:09,  4.62s/it, train loss=0.4169, val ΔE00=3.263, best=3.262]Training (film/smallcnn):  21%|██        | 21/100 [01:36<06:05,  4.63s/it, train loss=0.4169, val ΔE00=3.263, best=3.262]Training (film/smallcnn):  21%|██        | 21/100 [01:36<06:05,  4.63s/it, train loss=0.4493, val ΔE00=3.622, best=3.262]Training (film/smallcnn):  22%|██▏       | 22/100 [01:41<05:58,  4.59s/it, train loss=0.4493, val ΔE00=3.622, best=3.262]Training (film/smallcnn):  22%|██▏       | 22/100 [01:41<05:58,  4.59s/it, train loss=0.4767, val ΔE00=3.875, best=3.262]Training (film/smallcnn):  23%|██▎       | 23/100 [01:46<05:52,  4.58s/it, train loss=0.4767, val ΔE00=3.875, best=3.262]Training (film/smallcnn):  23%|██▎       | 23/100 [01:46<05:52,  4.58s/it, train loss=0.4798, val ΔE00=3.025, best=3.025]Training (film/smallcnn):  24%|██▍       | 24/100 [01:50<05:46,  4.56s/it, train loss=0.4798, val ΔE00=3.025, best=3.025]Training (film/smallcnn):  24%|██▍       | 24/100 [01:50<05:46,  4.56s/it, train loss=0.5245, val ΔE00=3.091, best=3.025]Training (film/smallcnn):  25%|██▌       | 25/100 [01:55<05:45,  4.61s/it, train loss=0.5245, val ΔE00=3.091, best=3.025]Training (film/smallcnn):  25%|██▌       | 25/100 [01:55<05:45,  4.61s/it, train loss=0.6068, val ΔE00=3.292, best=3.025]Training (film/smallcnn):  26%|██▌       | 26/100 [01:59<05:42,  4.62s/it, train loss=0.6068, val ΔE00=3.292, best=3.025]Training (film/smallcnn):  26%|██▌       | 26/100 [01:59<05:42,  4.62s/it, train loss=0.6324, val ΔE00=3.203, best=3.025]Training (film/smallcnn):  27%|██▋       | 27/100 [02:04<05:35,  4.59s/it, train loss=0.6324, val ΔE00=3.203, best=3.025]Training (film/smallcnn):  27%|██▋       | 27/100 [02:04<05:35,  4.59s/it, train loss=0.6565, val ΔE00=3.067, best=3.025]Training (film/smallcnn):  28%|██▊       | 28/100 [02:08<05:29,  4.57s/it, train loss=0.6565, val ΔE00=3.067, best=3.025]Training (film/smallcnn):  28%|██▊       | 28/100 [02:08<05:29,  4.57s/it, train loss=0.7547, val ΔE00=3.605, best=3.025]Training (film/smallcnn):  29%|██▉       | 29/100 [02:13<05:23,  4.56s/it, train loss=0.7547, val ΔE00=3.605, best=3.025]Training (film/smallcnn):  29%|██▉       | 29/100 [02:13<05:23,  4.56s/it, train loss=0.7324, val ΔE00=2.983, best=2.983]Training (film/smallcnn):  30%|███       | 30/100 [02:18<05:22,  4.61s/it, train loss=0.7324, val ΔE00=2.983, best=2.983]Training (film/smallcnn):  30%|███       | 30/100 [02:18<05:22,  4.61s/it, train loss=0.7024, val ΔE00=3.003, best=2.983]Training (film/smallcnn):  31%|███       | 31/100 [02:22<05:19,  4.63s/it, train loss=0.7024, val ΔE00=3.003, best=2.983]Training (film/smallcnn):  31%|███       | 31/100 [02:22<05:19,  4.63s/it, train loss=0.8075, val ΔE00=2.963, best=2.963]Training (film/smallcnn):  32%|███▏      | 32/100 [02:27<05:12,  4.59s/it, train loss=0.8075, val ΔE00=2.963, best=2.963]Training (film/smallcnn):  32%|███▏      | 32/100 [02:27<05:12,  4.59s/it, train loss=0.8108, val ΔE00=3.349, best=2.963]Training (film/smallcnn):  33%|███▎      | 33/100 [02:31<05:06,  4.57s/it, train loss=0.8108, val ΔE00=3.349, best=2.963]Training (film/smallcnn):  33%|███▎      | 33/100 [02:31<05:06,  4.57s/it, train loss=0.8999, val ΔE00=3.592, best=2.963]Training (film/smallcnn):  34%|███▍      | 34/100 [02:36<05:00,  4.56s/it, train loss=0.8999, val ΔE00=3.592, best=2.963]Training (film/smallcnn):  34%|███▍      | 34/100 [02:36<05:00,  4.56s/it, train loss=0.9553, val ΔE00=3.729, best=2.963]Training (film/smallcnn):  35%|███▌      | 35/100 [02:41<05:00,  4.62s/it, train loss=0.9553, val ΔE00=3.729, best=2.963]Training (film/smallcnn):  35%|███▌      | 35/100 [02:41<05:00,  4.62s/it, train loss=0.9534, val ΔE00=3.459, best=2.963]Training (film/smallcnn):  36%|███▌      | 36/100 [02:45<04:56,  4.63s/it, train loss=0.9534, val ΔE00=3.459, best=2.963]Training (film/smallcnn):  36%|███▌      | 36/100 [02:45<04:56,  4.63s/it, train loss=1.0976, val ΔE00=3.421, best=2.963]Training (film/smallcnn):  37%|███▋      | 37/100 [02:50<04:49,  4.60s/it, train loss=1.0976, val ΔE00=3.421, best=2.963]Training (film/smallcnn):  37%|███▋      | 37/100 [02:50<04:49,  4.60s/it, train loss=1.0285, val ΔE00=3.069, best=2.963]Training (film/smallcnn):  38%|███▊      | 38/100 [02:54<04:43,  4.57s/it, train loss=1.0285, val ΔE00=3.069, best=2.963]Training (film/smallcnn):  38%|███▊      | 38/100 [02:54<04:43,  4.57s/it, train loss=1.1051, val ΔE00=3.783, best=2.963]Training (film/smallcnn):  39%|███▉      | 39/100 [02:59<04:38,  4.56s/it, train loss=1.1051, val ΔE00=3.783, best=2.963]Training (film/smallcnn):  39%|███▉      | 39/100 [02:59<04:38,  4.56s/it, train loss=1.1018, val ΔE00=2.985, best=2.963]Training (film/smallcnn):  40%|████      | 40/100 [03:04<04:36,  4.61s/it, train loss=1.1018, val ΔE00=2.985, best=2.963]Training (film/smallcnn):  40%|████      | 40/100 [03:04<04:36,  4.61s/it, train loss=1.1201, val ΔE00=3.478, best=2.963]Training (film/smallcnn):  41%|████      | 41/100 [03:08<04:33,  4.63s/it, train loss=1.1201, val ΔE00=3.478, best=2.963]Training (film/smallcnn):  41%|████      | 41/100 [03:08<04:33,  4.63s/it, train loss=1.2665, val ΔE00=3.062, best=2.963]Training (film/smallcnn):  42%|████▏     | 42/100 [03:13<04:26,  4.60s/it, train loss=1.2665, val ΔE00=3.062, best=2.963]Training (film/smallcnn):  42%|████▏     | 42/100 [03:13<04:26,  4.60s/it, train loss=1.3169, val ΔE00=3.825, best=2.963]Training (film/smallcnn):  43%|████▎     | 43/100 [03:17<04:21,  4.58s/it, train loss=1.3169, val ΔE00=3.825, best=2.963]Training (film/smallcnn):  43%|████▎     | 43/100 [03:17<04:21,  4.58s/it, train loss=1.2494, val ΔE00=4.094, best=2.963]Training (film/smallcnn):  44%|████▍     | 44/100 [03:22<04:15,  4.57s/it, train loss=1.2494, val ΔE00=4.094, best=2.963]Training (film/smallcnn):  44%|████▍     | 44/100 [03:22<04:15,  4.57s/it, train loss=1.5384, val ΔE00=3.291, best=2.963]Training (film/smallcnn):  45%|████▌     | 45/100 [03:27<04:14,  4.63s/it, train loss=1.5384, val ΔE00=3.291, best=2.963]Training (film/smallcnn):  45%|████▌     | 45/100 [03:27<04:14,  4.63s/it, train loss=1.3548, val ΔE00=2.640, best=2.640]Training (film/smallcnn):  46%|████▌     | 46/100 [03:31<04:10,  4.63s/it, train loss=1.3548, val ΔE00=2.640, best=2.640]Training (film/smallcnn):  46%|████▌     | 46/100 [03:31<04:10,  4.63s/it, train loss=1.3397, val ΔE00=3.019, best=2.640]Training (film/smallcnn):  47%|████▋     | 47/100 [03:36<04:03,  4.60s/it, train loss=1.3397, val ΔE00=3.019, best=2.640]Training (film/smallcnn):  47%|████▋     | 47/100 [03:36<04:03,  4.60s/it, train loss=1.4156, val ΔE00=2.681, best=2.640]Training (film/smallcnn):  48%|████▊     | 48/100 [03:40<03:58,  4.58s/it, train loss=1.4156, val ΔE00=2.681, best=2.640]Training (film/smallcnn):  48%|████▊     | 48/100 [03:40<03:58,  4.58s/it, train loss=1.4581, val ΔE00=4.448, best=2.640]Training (film/smallcnn):  49%|████▉     | 49/100 [03:45<03:52,  4.56s/it, train loss=1.4581, val ΔE00=4.448, best=2.640]Training (film/smallcnn):  49%|████▉     | 49/100 [03:45<03:52,  4.56s/it, train loss=1.5164, val ΔE00=2.809, best=2.640]Training (film/smallcnn):  50%|█████     | 50/100 [03:50<03:50,  4.62s/it, train loss=1.5164, val ΔE00=2.809, best=2.640]Training (film/smallcnn):  50%|█████     | 50/100 [03:50<03:50,  4.62s/it, train loss=1.5025, val ΔE00=2.981, best=2.640]Training (film/smallcnn):  51%|█████     | 51/100 [03:54<03:46,  4.63s/it, train loss=1.5025, val ΔE00=2.981, best=2.640]Training (film/smallcnn):  51%|█████     | 51/100 [03:54<03:46,  4.63s/it, train loss=1.4948, val ΔE00=2.726, best=2.640]Training (film/smallcnn):  52%|█████▏    | 52/100 [03:59<03:40,  4.60s/it, train loss=1.4948, val ΔE00=2.726, best=2.640]Training (film/smallcnn):  52%|█████▏    | 52/100 [03:59<03:40,  4.60s/it, train loss=1.5169, val ΔE00=3.583, best=2.640]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:03<03:34,  4.57s/it, train loss=1.5169, val ΔE00=3.583, best=2.640]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:03<03:34,  4.57s/it, train loss=1.6335, val ΔE00=2.872, best=2.640]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:08<03:29,  4.56s/it, train loss=1.6335, val ΔE00=2.872, best=2.640]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:08<03:29,  4.56s/it, train loss=1.6410, val ΔE00=3.082, best=2.640]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:13<03:27,  4.61s/it, train loss=1.6410, val ΔE00=3.082, best=2.640]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:13<03:27,  4.61s/it, train loss=1.5930, val ΔE00=3.228, best=2.640]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:17<03:23,  4.62s/it, train loss=1.5930, val ΔE00=3.228, best=2.640]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:17<03:23,  4.62s/it, train loss=1.7196, val ΔE00=3.696, best=2.640]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:22<03:17,  4.59s/it, train loss=1.7196, val ΔE00=3.696, best=2.640]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:22<03:17,  4.59s/it, train loss=1.6499, val ΔE00=2.223, best=2.223]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:26<03:11,  4.57s/it, train loss=1.6499, val ΔE00=2.223, best=2.223]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:26<03:11,  4.57s/it, train loss=1.7080, val ΔE00=2.743, best=2.223]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:31<03:06,  4.55s/it, train loss=1.7080, val ΔE00=2.743, best=2.223]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:31<03:06,  4.55s/it, train loss=1.7051, val ΔE00=2.845, best=2.223]Training (film/smallcnn):  60%|██████    | 60/100 [04:36<03:04,  4.61s/it, train loss=1.7051, val ΔE00=2.845, best=2.223]Training (film/smallcnn):  60%|██████    | 60/100 [04:36<03:04,  4.61s/it, train loss=1.7394, val ΔE00=4.694, best=2.223]Training (film/smallcnn):  61%|██████    | 61/100 [04:40<03:00,  4.62s/it, train loss=1.7394, val ΔE00=4.694, best=2.223]Training (film/smallcnn):  61%|██████    | 61/100 [04:40<03:00,  4.62s/it, train loss=1.7520, val ΔE00=2.862, best=2.223]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:45<02:54,  4.59s/it, train loss=1.7520, val ΔE00=2.862, best=2.223]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:45<02:54,  4.59s/it, train loss=1.8330, val ΔE00=2.874, best=2.223]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:49<02:49,  4.57s/it, train loss=1.8330, val ΔE00=2.874, best=2.223]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:49<02:49,  4.57s/it, train loss=1.9249, val ΔE00=2.575, best=2.223]Training (film/smallcnn):  64%|██████▍   | 64/100 [04:54<02:44,  4.56s/it, train loss=1.9249, val ΔE00=2.575, best=2.223]Training (film/smallcnn):  64%|██████▍   | 64/100 [04:54<02:44,  4.56s/it, train loss=1.8255, val ΔE00=2.621, best=2.223]Training (film/smallcnn):  65%|██████▌   | 65/100 [04:59<02:41,  4.61s/it, train loss=1.8255, val ΔE00=2.621, best=2.223]Training (film/smallcnn):  65%|██████▌   | 65/100 [04:59<02:41,  4.61s/it, train loss=1.8942, val ΔE00=2.341, best=2.223]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:03<02:37,  4.63s/it, train loss=1.8942, val ΔE00=2.341, best=2.223]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:03<02:37,  4.63s/it, train loss=1.7506, val ΔE00=2.491, best=2.223]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:08<02:31,  4.60s/it, train loss=1.7506, val ΔE00=2.491, best=2.223]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:08<02:31,  4.60s/it, train loss=1.8122, val ΔE00=2.924, best=2.223]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:12<02:26,  4.58s/it, train loss=1.8122, val ΔE00=2.924, best=2.223]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:12<02:26,  4.58s/it, train loss=1.8232, val ΔE00=2.681, best=2.223]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:17<02:26,  4.58s/it, train loss=1.8300, val ΔE00=2.919, early_stop=yes]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:17<02:29,  4.67s/it, train loss=1.8300, val ΔE00=2.919, early_stop=yes]
[early] stop at epoch 69 (best de00=2.2229 @ 57)
[done] best ΔE00=2.223 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/film__smallcnn__image__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image/final_summary.json (kind=val)
[sweep] === Run 10/24 ===
[sweep] id=010_model=film__backbone=smallcnn__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model film --backbone smallcnn --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image+mean, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:32,  5.17s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:32,  5.17s/it, train loss=0.0060, val ΔE00=8.594, best=8.594]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:58,  4.89s/it, train loss=0.0060, val ΔE00=8.594, best=8.594]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:58,  4.89s/it, train loss=0.0046, val ΔE00=4.564, best=4.564]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:45,  4.80s/it, train loss=0.0046, val ΔE00=4.564, best=4.564]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:45,  4.80s/it, train loss=0.0082, val ΔE00=4.150, best=4.150]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:36,  4.76s/it, train loss=0.0082, val ΔE00=4.150, best=4.150]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:36,  4.76s/it, train loss=0.0148, val ΔE00=4.283, best=4.150]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:37,  4.82s/it, train loss=0.0148, val ΔE00=4.283, best=4.150]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:37,  4.82s/it, train loss=0.0238, val ΔE00=4.023, best=4.023]Training (film/smallcnn):   6%|▌         | 6/100 [00:29<07:33,  4.83s/it, train loss=0.0238, val ΔE00=4.023, best=4.023]Training (film/smallcnn):   6%|▌         | 6/100 [00:29<07:33,  4.83s/it, train loss=0.0333, val ΔE00=3.344, best=3.344]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:24,  4.78s/it, train loss=0.0333, val ΔE00=3.344, best=3.344]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:24,  4.78s/it, train loss=0.0432, val ΔE00=3.526, best=3.344]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:17,  4.75s/it, train loss=0.0432, val ΔE00=3.526, best=3.344]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:17,  4.75s/it, train loss=0.0586, val ΔE00=3.478, best=3.344]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:10,  4.73s/it, train loss=0.0586, val ΔE00=3.478, best=3.344]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:10,  4.73s/it, train loss=0.0672, val ΔE00=4.216, best=3.344]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:10,  4.78s/it, train loss=0.0672, val ΔE00=4.216, best=3.344]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:10,  4.78s/it, train loss=0.0817, val ΔE00=2.828, best=2.828]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:06,  4.80s/it, train loss=0.0817, val ΔE00=2.828, best=2.828]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:06,  4.80s/it, train loss=0.1027, val ΔE00=2.980, best=2.828]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:59,  4.76s/it, train loss=0.1027, val ΔE00=2.980, best=2.828]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:59,  4.76s/it, train loss=0.1174, val ΔE00=2.844, best=2.828]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:52,  4.74s/it, train loss=0.1174, val ΔE00=2.844, best=2.828]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:52,  4.74s/it, train loss=0.1360, val ΔE00=3.150, best=2.828]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:45,  4.72s/it, train loss=0.1360, val ΔE00=3.150, best=2.828]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:45,  4.72s/it, train loss=0.1501, val ΔE00=3.095, best=2.828]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:45,  4.78s/it, train loss=0.1501, val ΔE00=3.095, best=2.828]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:45,  4.78s/it, train loss=0.1774, val ΔE00=3.397, best=2.828]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:42,  4.79s/it, train loss=0.1774, val ΔE00=3.397, best=2.828]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:42,  4.79s/it, train loss=0.1956, val ΔE00=2.881, best=2.828]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:35,  4.76s/it, train loss=0.1956, val ΔE00=2.881, best=2.828]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:35,  4.76s/it, train loss=0.2109, val ΔE00=2.376, best=2.376]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:28,  4.74s/it, train loss=0.2109, val ΔE00=2.376, best=2.376]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:28,  4.74s/it, train loss=0.2433, val ΔE00=2.555, best=2.376]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:23,  4.73s/it, train loss=0.2433, val ΔE00=2.555, best=2.376]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:23,  4.73s/it, train loss=0.2642, val ΔE00=2.792, best=2.376]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:22,  4.79s/it, train loss=0.2642, val ΔE00=2.792, best=2.376]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:22,  4.79s/it, train loss=0.2944, val ΔE00=2.712, best=2.376]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:19,  4.80s/it, train loss=0.2944, val ΔE00=2.712, best=2.376]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:19,  4.80s/it, train loss=0.3089, val ΔE00=3.509, best=2.376]Training (film/smallcnn):  22%|██▏       | 22/100 [01:45<06:12,  4.77s/it, train loss=0.3089, val ΔE00=3.509, best=2.376]Training (film/smallcnn):  22%|██▏       | 22/100 [01:45<06:12,  4.77s/it, train loss=0.3485, val ΔE00=2.526, best=2.376]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:05,  4.74s/it, train loss=0.3485, val ΔE00=2.526, best=2.376]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:05,  4.74s/it, train loss=0.3522, val ΔE00=2.503, best=2.376]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:59,  4.73s/it, train loss=0.3522, val ΔE00=2.503, best=2.376]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:59,  4.73s/it, train loss=0.3942, val ΔE00=2.911, best=2.376]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:58,  4.78s/it, train loss=0.3942, val ΔE00=2.911, best=2.376]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:58,  4.78s/it, train loss=0.4254, val ΔE00=2.396, best=2.376]Training (film/smallcnn):  26%|██▌       | 26/100 [02:04<05:55,  4.80s/it, train loss=0.4254, val ΔE00=2.396, best=2.376]Training (film/smallcnn):  26%|██▌       | 26/100 [02:04<05:55,  4.80s/it, train loss=0.4517, val ΔE00=2.148, best=2.148]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:48,  4.77s/it, train loss=0.4517, val ΔE00=2.148, best=2.148]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:48,  4.77s/it, train loss=0.4769, val ΔE00=2.392, best=2.148]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:42,  4.75s/it, train loss=0.4769, val ΔE00=2.392, best=2.148]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:42,  4.75s/it, train loss=0.5086, val ΔE00=2.312, best=2.148]Training (film/smallcnn):  29%|██▉       | 29/100 [02:18<05:36,  4.73s/it, train loss=0.5086, val ΔE00=2.312, best=2.148]Training (film/smallcnn):  29%|██▉       | 29/100 [02:18<05:36,  4.73s/it, train loss=0.5392, val ΔE00=2.455, best=2.148]Training (film/smallcnn):  30%|███       | 30/100 [02:23<05:34,  4.79s/it, train loss=0.5392, val ΔE00=2.455, best=2.148]Training (film/smallcnn):  30%|███       | 30/100 [02:23<05:34,  4.79s/it, train loss=0.5700, val ΔE00=2.609, best=2.148]Training (film/smallcnn):  31%|███       | 31/100 [02:28<05:31,  4.80s/it, train loss=0.5700, val ΔE00=2.609, best=2.148]Training (film/smallcnn):  31%|███       | 31/100 [02:28<05:31,  4.80s/it, train loss=0.6154, val ΔE00=3.903, best=2.148]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:24,  4.77s/it, train loss=0.6154, val ΔE00=3.903, best=2.148]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:24,  4.77s/it, train loss=0.6470, val ΔE00=2.310, best=2.148]Training (film/smallcnn):  33%|███▎      | 33/100 [02:37<05:17,  4.74s/it, train loss=0.6470, val ΔE00=2.310, best=2.148]Training (film/smallcnn):  33%|███▎      | 33/100 [02:37<05:17,  4.74s/it, train loss=0.6898, val ΔE00=2.333, best=2.148]Training (film/smallcnn):  34%|███▍      | 34/100 [02:42<05:11,  4.73s/it, train loss=0.6898, val ΔE00=2.333, best=2.148]Training (film/smallcnn):  34%|███▍      | 34/100 [02:42<05:11,  4.73s/it, train loss=0.6650, val ΔE00=2.074, best=2.074]Training (film/smallcnn):  35%|███▌      | 35/100 [02:47<05:11,  4.79s/it, train loss=0.6650, val ΔE00=2.074, best=2.074]Training (film/smallcnn):  35%|███▌      | 35/100 [02:47<05:11,  4.79s/it, train loss=0.6759, val ΔE00=2.110, best=2.074]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:06,  4.79s/it, train loss=0.6759, val ΔE00=2.110, best=2.074]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:06,  4.79s/it, train loss=0.7649, val ΔE00=2.344, best=2.074]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<04:59,  4.76s/it, train loss=0.7649, val ΔE00=2.344, best=2.074]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<04:59,  4.76s/it, train loss=0.7186, val ΔE00=2.326, best=2.074]Training (film/smallcnn):  38%|███▊      | 38/100 [03:01<04:53,  4.74s/it, train loss=0.7186, val ΔE00=2.326, best=2.074]Training (film/smallcnn):  38%|███▊      | 38/100 [03:01<04:53,  4.74s/it, train loss=0.8074, val ΔE00=3.072, best=2.074]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:48,  4.73s/it, train loss=0.8074, val ΔE00=3.072, best=2.074]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:48,  4.73s/it, train loss=0.8475, val ΔE00=2.183, best=2.074]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:47,  4.79s/it, train loss=0.8475, val ΔE00=2.183, best=2.074]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:47,  4.79s/it, train loss=0.8374, val ΔE00=2.107, best=2.074]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:42,  4.80s/it, train loss=0.8374, val ΔE00=2.107, best=2.074]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:42,  4.80s/it, train loss=0.8704, val ΔE00=2.387, best=2.074]Training (film/smallcnn):  42%|████▏     | 42/100 [03:20<04:36,  4.76s/it, train loss=0.8704, val ΔE00=2.387, best=2.074]Training (film/smallcnn):  42%|████▏     | 42/100 [03:20<04:36,  4.76s/it, train loss=0.8964, val ΔE00=2.449, best=2.074]Training (film/smallcnn):  43%|████▎     | 43/100 [03:25<04:29,  4.73s/it, train loss=0.8964, val ΔE00=2.449, best=2.074]Training (film/smallcnn):  43%|████▎     | 43/100 [03:25<04:29,  4.73s/it, train loss=0.9078, val ΔE00=2.447, best=2.074]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:24,  4.72s/it, train loss=0.9078, val ΔE00=2.447, best=2.074]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:24,  4.72s/it, train loss=0.9425, val ΔE00=2.613, best=2.074]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:22,  4.78s/it, train loss=0.9425, val ΔE00=2.613, best=2.074]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:22,  4.78s/it, train loss=1.0190, val ΔE00=2.057, best=2.057]Training (film/smallcnn):  46%|████▌     | 46/100 [03:39<04:18,  4.79s/it, train loss=1.0190, val ΔE00=2.057, best=2.057]Training (film/smallcnn):  46%|████▌     | 46/100 [03:39<04:18,  4.79s/it, train loss=1.0191, val ΔE00=2.194, best=2.057]Training (film/smallcnn):  47%|████▋     | 47/100 [03:44<04:12,  4.76s/it, train loss=1.0191, val ΔE00=2.194, best=2.057]Training (film/smallcnn):  47%|████▋     | 47/100 [03:44<04:12,  4.76s/it, train loss=1.0235, val ΔE00=2.381, best=2.057]Training (film/smallcnn):  48%|████▊     | 48/100 [03:48<04:06,  4.74s/it, train loss=1.0235, val ΔE00=2.381, best=2.057]Training (film/smallcnn):  48%|████▊     | 48/100 [03:48<04:06,  4.74s/it, train loss=1.0630, val ΔE00=2.514, best=2.057]Training (film/smallcnn):  49%|████▉     | 49/100 [03:53<04:01,  4.73s/it, train loss=1.0630, val ΔE00=2.514, best=2.057]Training (film/smallcnn):  49%|████▉     | 49/100 [03:53<04:01,  4.73s/it, train loss=1.0895, val ΔE00=2.054, best=2.054]Training (film/smallcnn):  50%|█████     | 50/100 [03:58<03:59,  4.78s/it, train loss=1.0895, val ΔE00=2.054, best=2.054]Training (film/smallcnn):  50%|█████     | 50/100 [03:58<03:59,  4.78s/it, train loss=1.0991, val ΔE00=2.384, best=2.054]Training (film/smallcnn):  51%|█████     | 51/100 [04:03<03:55,  4.80s/it, train loss=1.0991, val ΔE00=2.384, best=2.054]Training (film/smallcnn):  51%|█████     | 51/100 [04:03<03:55,  4.80s/it, train loss=1.0852, val ΔE00=2.013, best=2.013]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:08<03:49,  4.77s/it, train loss=1.0852, val ΔE00=2.013, best=2.013]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:08<03:49,  4.77s/it, train loss=1.0941, val ΔE00=2.168, best=2.013]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:12<03:43,  4.75s/it, train loss=1.0941, val ΔE00=2.168, best=2.013]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:12<03:43,  4.75s/it, train loss=1.1861, val ΔE00=2.409, best=2.013]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:17<03:37,  4.73s/it, train loss=1.1861, val ΔE00=2.409, best=2.013]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:17<03:37,  4.73s/it, train loss=1.2254, val ΔE00=2.578, best=2.013]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:22<03:35,  4.78s/it, train loss=1.2254, val ΔE00=2.578, best=2.013]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:22<03:35,  4.78s/it, train loss=1.2561, val ΔE00=2.009, best=2.009]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:27<03:31,  4.80s/it, train loss=1.2561, val ΔE00=2.009, best=2.009]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:27<03:31,  4.80s/it, train loss=1.1693, val ΔE00=2.262, best=2.009]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:31<03:24,  4.76s/it, train loss=1.1693, val ΔE00=2.262, best=2.009]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:31<03:24,  4.76s/it, train loss=1.1927, val ΔE00=1.974, best=1.974]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:36<03:19,  4.74s/it, train loss=1.1927, val ΔE00=1.974, best=1.974]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:36<03:19,  4.74s/it, train loss=1.2701, val ΔE00=2.200, best=1.974]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:41<03:13,  4.72s/it, train loss=1.2701, val ΔE00=2.200, best=1.974]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:41<03:13,  4.72s/it, train loss=1.3276, val ΔE00=2.244, best=1.974]Training (film/smallcnn):  60%|██████    | 60/100 [04:46<03:10,  4.77s/it, train loss=1.3276, val ΔE00=2.244, best=1.974]Training (film/smallcnn):  60%|██████    | 60/100 [04:46<03:10,  4.77s/it, train loss=1.2842, val ΔE00=2.566, best=1.974]Training (film/smallcnn):  61%|██████    | 61/100 [04:50<03:06,  4.79s/it, train loss=1.2842, val ΔE00=2.566, best=1.974]Training (film/smallcnn):  61%|██████    | 61/100 [04:50<03:06,  4.79s/it, train loss=1.3396, val ΔE00=2.084, best=1.974]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:55<03:00,  4.76s/it, train loss=1.3396, val ΔE00=2.084, best=1.974]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:55<03:00,  4.76s/it, train loss=1.2975, val ΔE00=2.038, best=1.974]Training (film/smallcnn):  63%|██████▎   | 63/100 [05:00<02:55,  4.74s/it, train loss=1.2975, val ΔE00=2.038, best=1.974]Training (film/smallcnn):  63%|██████▎   | 63/100 [05:00<02:55,  4.74s/it, train loss=1.3282, val ΔE00=2.051, best=1.974]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:04<02:50,  4.72s/it, train loss=1.3282, val ΔE00=2.051, best=1.974]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:04<02:50,  4.72s/it, train loss=1.3094, val ΔE00=2.523, best=1.974]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:09<02:47,  4.78s/it, train loss=1.3094, val ΔE00=2.523, best=1.974]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:09<02:47,  4.78s/it, train loss=1.2749, val ΔE00=2.037, best=1.974]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:14<02:43,  4.79s/it, train loss=1.2749, val ΔE00=2.037, best=1.974]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:14<02:43,  4.79s/it, train loss=1.4052, val ΔE00=2.243, best=1.974]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:19<02:37,  4.76s/it, train loss=1.4052, val ΔE00=2.243, best=1.974]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:19<02:37,  4.76s/it, train loss=1.3840, val ΔE00=2.410, best=1.974]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:24<02:31,  4.74s/it, train loss=1.3840, val ΔE00=2.410, best=1.974]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:24<02:31,  4.74s/it, train loss=1.3502, val ΔE00=2.430, best=1.974]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:28<02:31,  4.74s/it, train loss=1.3882, val ΔE00=2.045, early_stop=yes]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:28<02:34,  4.84s/it, train loss=1.3882, val ΔE00=2.045, early_stop=yes]
[early] stop at epoch 69 (best de00=1.9742 @ 57)
[done] best ΔE00=1.974 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/film__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 11/24 ===
[sweep] id=011_model=film__backbone=smallcnn__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model film --backbone smallcnn --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image+meta, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:34,  5.20s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:34,  5.20s/it, train loss=0.0113, val ΔE00=11.432, best=11.432]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:59,  4.89s/it, train loss=0.0113, val ΔE00=11.432, best=11.432]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:59,  4.89s/it, train loss=0.0084, val ΔE00=11.217, best=11.217]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:45,  4.80s/it, train loss=0.0084, val ΔE00=11.217, best=11.217]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:45,  4.80s/it, train loss=0.0141, val ΔE00=5.732, best=5.732]  Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:35,  4.75s/it, train loss=0.0141, val ΔE00=5.732, best=5.732]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:35,  4.75s/it, train loss=0.0221, val ΔE00=6.556, best=5.732]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:36,  4.81s/it, train loss=0.0221, val ΔE00=6.556, best=5.732]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:36,  4.81s/it, train loss=0.0319, val ΔE00=4.360, best=4.360]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:32,  4.81s/it, train loss=0.0319, val ΔE00=4.360, best=4.360]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:32,  4.81s/it, train loss=0.0459, val ΔE00=4.879, best=4.360]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:23,  4.77s/it, train loss=0.0459, val ΔE00=4.879, best=4.360]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:23,  4.77s/it, train loss=0.0623, val ΔE00=6.610, best=4.360]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:16,  4.74s/it, train loss=0.0623, val ΔE00=6.610, best=4.360]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:16,  4.74s/it, train loss=0.0712, val ΔE00=4.263, best=4.263]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:09,  4.72s/it, train loss=0.0712, val ΔE00=4.263, best=4.263]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:09,  4.72s/it, train loss=0.0926, val ΔE00=4.389, best=4.263]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:09,  4.78s/it, train loss=0.0926, val ΔE00=4.389, best=4.263]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:09,  4.78s/it, train loss=0.1158, val ΔE00=3.557, best=3.557]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:05,  4.78s/it, train loss=0.1158, val ΔE00=3.557, best=3.557]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:05,  4.78s/it, train loss=0.1352, val ΔE00=4.346, best=3.557]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:58,  4.75s/it, train loss=0.1352, val ΔE00=4.346, best=3.557]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:58,  4.75s/it, train loss=0.1468, val ΔE00=3.145, best=3.145]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:51,  4.73s/it, train loss=0.1468, val ΔE00=3.145, best=3.145]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:51,  4.73s/it, train loss=0.1717, val ΔE00=3.818, best=3.145]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:45,  4.71s/it, train loss=0.1717, val ΔE00=3.818, best=3.145]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:45,  4.71s/it, train loss=0.1963, val ΔE00=3.936, best=3.145]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:45,  4.78s/it, train loss=0.1963, val ΔE00=3.936, best=3.145]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:45,  4.78s/it, train loss=0.2339, val ΔE00=3.631, best=3.145]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:42,  4.79s/it, train loss=0.2339, val ΔE00=3.631, best=3.145]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:42,  4.79s/it, train loss=0.2706, val ΔE00=3.492, best=3.145]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:34,  4.76s/it, train loss=0.2706, val ΔE00=3.492, best=3.145]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:34,  4.76s/it, train loss=0.2853, val ΔE00=3.511, best=3.145]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:28,  4.74s/it, train loss=0.2853, val ΔE00=3.511, best=3.145]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:28,  4.74s/it, train loss=0.3135, val ΔE00=3.792, best=3.145]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:22,  4.73s/it, train loss=0.3135, val ΔE00=3.792, best=3.145]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:22,  4.73s/it, train loss=0.3478, val ΔE00=2.957, best=2.957]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:22,  4.78s/it, train loss=0.3478, val ΔE00=2.957, best=2.957]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:22,  4.78s/it, train loss=0.3809, val ΔE00=3.033, best=2.957]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:18,  4.80s/it, train loss=0.3809, val ΔE00=3.033, best=2.957]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:18,  4.80s/it, train loss=0.3907, val ΔE00=2.745, best=2.745]Training (film/smallcnn):  22%|██▏       | 22/100 [01:44<06:11,  4.76s/it, train loss=0.3907, val ΔE00=2.745, best=2.745]Training (film/smallcnn):  22%|██▏       | 22/100 [01:44<06:11,  4.76s/it, train loss=0.4358, val ΔE00=4.093, best=2.745]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:04,  4.74s/it, train loss=0.4358, val ΔE00=4.093, best=2.745]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:04,  4.74s/it, train loss=0.4771, val ΔE00=2.907, best=2.745]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:58,  4.72s/it, train loss=0.4771, val ΔE00=2.907, best=2.745]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:58,  4.72s/it, train loss=0.5260, val ΔE00=4.031, best=2.745]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:57,  4.77s/it, train loss=0.5260, val ΔE00=4.031, best=2.745]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:57,  4.77s/it, train loss=0.5907, val ΔE00=3.605, best=2.745]Training (film/smallcnn):  26%|██▌       | 26/100 [02:04<05:54,  4.78s/it, train loss=0.5907, val ΔE00=3.605, best=2.745]Training (film/smallcnn):  26%|██▌       | 26/100 [02:04<05:54,  4.78s/it, train loss=0.5704, val ΔE00=3.494, best=2.745]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:46,  4.75s/it, train loss=0.5704, val ΔE00=3.494, best=2.745]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:46,  4.75s/it, train loss=0.6181, val ΔE00=3.615, best=2.745]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:40,  4.73s/it, train loss=0.6181, val ΔE00=3.615, best=2.745]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:40,  4.73s/it, train loss=0.6711, val ΔE00=4.404, best=2.745]Training (film/smallcnn):  29%|██▉       | 29/100 [02:18<05:34,  4.71s/it, train loss=0.6711, val ΔE00=4.404, best=2.745]Training (film/smallcnn):  29%|██▉       | 29/100 [02:18<05:34,  4.71s/it, train loss=0.6704, val ΔE00=3.153, best=2.745]Training (film/smallcnn):  30%|███       | 30/100 [02:22<05:33,  4.76s/it, train loss=0.6704, val ΔE00=3.153, best=2.745]Training (film/smallcnn):  30%|███       | 30/100 [02:22<05:33,  4.76s/it, train loss=0.7850, val ΔE00=3.504, best=2.745]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:30,  4.79s/it, train loss=0.7850, val ΔE00=3.504, best=2.745]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:30,  4.79s/it, train loss=0.7513, val ΔE00=2.688, best=2.688]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:23,  4.75s/it, train loss=0.7513, val ΔE00=2.688, best=2.688]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:23,  4.75s/it, train loss=0.7882, val ΔE00=3.301, best=2.688]Training (film/smallcnn):  33%|███▎      | 33/100 [02:37<05:16,  4.73s/it, train loss=0.7882, val ΔE00=3.301, best=2.688]Training (film/smallcnn):  33%|███▎      | 33/100 [02:37<05:16,  4.73s/it, train loss=0.8603, val ΔE00=3.385, best=2.688]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:11,  4.71s/it, train loss=0.8603, val ΔE00=3.385, best=2.688]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:11,  4.71s/it, train loss=0.8862, val ΔE00=3.425, best=2.688]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:09,  4.77s/it, train loss=0.8862, val ΔE00=3.425, best=2.688]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:09,  4.77s/it, train loss=0.9417, val ΔE00=3.772, best=2.688]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:05,  4.78s/it, train loss=0.9417, val ΔE00=3.772, best=2.688]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:05,  4.78s/it, train loss=0.9872, val ΔE00=2.836, best=2.688]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<04:59,  4.75s/it, train loss=0.9872, val ΔE00=2.836, best=2.688]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<04:59,  4.75s/it, train loss=0.9878, val ΔE00=2.937, best=2.688]Training (film/smallcnn):  38%|███▊      | 38/100 [03:00<04:53,  4.73s/it, train loss=0.9878, val ΔE00=2.937, best=2.688]Training (film/smallcnn):  38%|███▊      | 38/100 [03:00<04:53,  4.73s/it, train loss=1.0572, val ΔE00=2.671, best=2.671]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:47,  4.71s/it, train loss=1.0572, val ΔE00=2.671, best=2.671]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:47,  4.71s/it, train loss=1.0934, val ΔE00=2.667, best=2.667]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:45,  4.76s/it, train loss=1.0934, val ΔE00=2.667, best=2.667]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:45,  4.76s/it, train loss=1.0684, val ΔE00=2.875, best=2.667]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:42,  4.78s/it, train loss=1.0684, val ΔE00=2.875, best=2.667]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:42,  4.78s/it, train loss=1.1641, val ΔE00=2.831, best=2.667]Training (film/smallcnn):  42%|████▏     | 42/100 [03:19<04:35,  4.75s/it, train loss=1.1641, val ΔE00=2.831, best=2.667]Training (film/smallcnn):  42%|████▏     | 42/100 [03:19<04:35,  4.75s/it, train loss=1.1789, val ΔE00=2.581, best=2.581]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:29,  4.73s/it, train loss=1.1789, val ΔE00=2.581, best=2.581]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:29,  4.73s/it, train loss=1.1719, val ΔE00=3.211, best=2.581]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:23,  4.71s/it, train loss=1.1719, val ΔE00=3.211, best=2.581]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:23,  4.71s/it, train loss=1.1841, val ΔE00=2.926, best=2.581]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:22,  4.77s/it, train loss=1.1841, val ΔE00=2.926, best=2.581]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:22,  4.77s/it, train loss=1.2855, val ΔE00=3.055, best=2.581]Training (film/smallcnn):  46%|████▌     | 46/100 [03:38<04:17,  4.78s/it, train loss=1.2855, val ΔE00=3.055, best=2.581]Training (film/smallcnn):  46%|████▌     | 46/100 [03:38<04:17,  4.78s/it, train loss=1.2465, val ΔE00=2.701, best=2.581]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:11,  4.75s/it, train loss=1.2465, val ΔE00=2.701, best=2.581]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:11,  4.75s/it, train loss=1.3748, val ΔE00=2.975, best=2.581]Training (film/smallcnn):  48%|████▊     | 48/100 [03:48<04:05,  4.72s/it, train loss=1.3748, val ΔE00=2.975, best=2.581]Training (film/smallcnn):  48%|████▊     | 48/100 [03:48<04:05,  4.72s/it, train loss=1.3989, val ΔE00=2.799, best=2.581]Training (film/smallcnn):  49%|████▉     | 49/100 [03:52<04:00,  4.71s/it, train loss=1.3989, val ΔE00=2.799, best=2.581]Training (film/smallcnn):  49%|████▉     | 49/100 [03:52<04:00,  4.71s/it, train loss=1.3983, val ΔE00=3.394, best=2.581]Training (film/smallcnn):  50%|█████     | 50/100 [03:57<03:58,  4.77s/it, train loss=1.3983, val ΔE00=3.394, best=2.581]Training (film/smallcnn):  50%|█████     | 50/100 [03:57<03:58,  4.77s/it, train loss=1.5051, val ΔE00=2.995, best=2.581]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:53,  4.77s/it, train loss=1.5051, val ΔE00=2.995, best=2.581]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:53,  4.77s/it, train loss=1.5194, val ΔE00=2.844, best=2.581]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:07<03:47,  4.75s/it, train loss=1.5194, val ΔE00=2.844, best=2.581]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:07<03:47,  4.75s/it, train loss=1.4420, val ΔE00=3.578, best=2.581]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:12<03:41,  4.72s/it, train loss=1.4420, val ΔE00=3.578, best=2.581]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:12<03:41,  4.72s/it, train loss=1.5367, val ΔE00=3.257, best=2.581]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:16<03:36,  4.70s/it, train loss=1.5367, val ΔE00=3.257, best=2.581]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:16<03:36,  4.70s/it, train loss=1.6517, val ΔE00=2.750, best=2.581]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:34,  4.76s/it, train loss=1.6517, val ΔE00=2.750, best=2.581]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:34,  4.76s/it, train loss=1.5899, val ΔE00=2.662, best=2.581]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:26<03:30,  4.78s/it, train loss=1.5899, val ΔE00=2.662, best=2.581]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:26<03:30,  4.78s/it, train loss=1.6003, val ΔE00=2.656, best=2.581]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:31<03:24,  4.75s/it, train loss=1.6003, val ΔE00=2.656, best=2.581]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:31<03:24,  4.75s/it, train loss=1.6363, val ΔE00=2.560, best=2.560]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:35<03:18,  4.73s/it, train loss=1.6363, val ΔE00=2.560, best=2.560]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:35<03:18,  4.73s/it, train loss=1.5329, val ΔE00=2.358, best=2.358]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:40<03:13,  4.71s/it, train loss=1.5329, val ΔE00=2.358, best=2.358]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:40<03:13,  4.71s/it, train loss=1.6099, val ΔE00=2.890, best=2.358]Training (film/smallcnn):  60%|██████    | 60/100 [04:45<03:10,  4.77s/it, train loss=1.6099, val ΔE00=2.890, best=2.358]Training (film/smallcnn):  60%|██████    | 60/100 [04:45<03:10,  4.77s/it, train loss=1.8356, val ΔE00=3.116, best=2.358]Training (film/smallcnn):  61%|██████    | 61/100 [04:50<03:06,  4.78s/it, train loss=1.8356, val ΔE00=3.116, best=2.358]Training (film/smallcnn):  61%|██████    | 61/100 [04:50<03:06,  4.78s/it, train loss=1.6522, val ΔE00=2.329, best=2.329]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:54<03:00,  4.75s/it, train loss=1.6522, val ΔE00=2.329, best=2.329]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:54<03:00,  4.75s/it, train loss=1.6601, val ΔE00=2.524, best=2.329]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:59<02:55,  4.73s/it, train loss=1.6601, val ΔE00=2.524, best=2.329]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:59<02:55,  4.73s/it, train loss=1.6873, val ΔE00=2.486, best=2.329]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:04<02:49,  4.72s/it, train loss=1.6873, val ΔE00=2.486, best=2.329]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:04<02:49,  4.72s/it, train loss=1.6623, val ΔE00=2.512, best=2.329]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:09<02:46,  4.77s/it, train loss=1.6623, val ΔE00=2.512, best=2.329]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:09<02:46,  4.77s/it, train loss=1.7003, val ΔE00=2.436, best=2.329]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:13<02:42,  4.79s/it, train loss=1.7003, val ΔE00=2.436, best=2.329]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:13<02:42,  4.79s/it, train loss=1.7207, val ΔE00=2.710, best=2.329]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:18<02:36,  4.76s/it, train loss=1.7207, val ΔE00=2.710, best=2.329]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:18<02:36,  4.76s/it, train loss=1.7212, val ΔE00=2.602, best=2.329]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:23<02:31,  4.73s/it, train loss=1.7212, val ΔE00=2.602, best=2.329]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:23<02:31,  4.73s/it, train loss=1.6160, val ΔE00=3.077, best=2.329]Training (film/smallcnn):  69%|██████▉   | 69/100 [05:28<02:26,  4.72s/it, train loss=1.6160, val ΔE00=3.077, best=2.329]Training (film/smallcnn):  69%|██████▉   | 69/100 [05:28<02:26,  4.72s/it, train loss=1.8061, val ΔE00=3.620, best=2.329]Training (film/smallcnn):  70%|███████   | 70/100 [05:32<02:23,  4.80s/it, train loss=1.8061, val ΔE00=3.620, best=2.329]Training (film/smallcnn):  70%|███████   | 70/100 [05:32<02:23,  4.80s/it, train loss=1.8331, val ΔE00=2.555, best=2.329]Training (film/smallcnn):  70%|███████   | 70/100 [05:37<02:23,  4.80s/it, train loss=1.6919, val ΔE00=2.716, early_stop=yes]Training (film/smallcnn):  70%|███████   | 70/100 [05:37<02:24,  4.82s/it, train loss=1.6919, val ΔE00=2.716, early_stop=yes]
[early] stop at epoch 71 (best de00=2.3291 @ 61)
[done] best ΔE00=2.329 over 71 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/film__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 12/24 ===
[sweep] id=012_model=film__backbone=smallcnn__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model film --backbone smallcnn --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image+mean+meta, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:37,  5.23s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:37,  5.23s/it, train loss=0.0058, val ΔE00=8.218, best=8.218]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<08:02,  4.92s/it, train loss=0.0058, val ΔE00=8.218, best=8.218]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<08:02,  4.92s/it, train loss=0.0042, val ΔE00=4.906, best=4.906]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:48,  4.83s/it, train loss=0.0042, val ΔE00=4.906, best=4.906]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:48,  4.83s/it, train loss=0.0083, val ΔE00=3.996, best=3.996]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:38,  4.78s/it, train loss=0.0083, val ΔE00=3.996, best=3.996]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:38,  4.78s/it, train loss=0.0146, val ΔE00=3.678, best=3.678]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:38,  4.83s/it, train loss=0.0146, val ΔE00=3.678, best=3.678]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:38,  4.83s/it, train loss=0.0228, val ΔE00=4.399, best=3.678]Training (film/smallcnn):   6%|▌         | 6/100 [00:29<07:34,  4.83s/it, train loss=0.0228, val ΔE00=4.399, best=3.678]Training (film/smallcnn):   6%|▌         | 6/100 [00:29<07:34,  4.83s/it, train loss=0.0335, val ΔE00=3.647, best=3.647]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:25,  4.79s/it, train loss=0.0335, val ΔE00=3.647, best=3.647]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:25,  4.79s/it, train loss=0.0439, val ΔE00=3.595, best=3.595]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:18,  4.76s/it, train loss=0.0439, val ΔE00=3.595, best=3.595]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:18,  4.76s/it, train loss=0.0542, val ΔE00=3.166, best=3.166]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:11,  4.75s/it, train loss=0.0542, val ΔE00=3.166, best=3.166]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:11,  4.75s/it, train loss=0.0675, val ΔE00=2.920, best=2.920]Training (film/smallcnn):  10%|█         | 10/100 [00:48<07:11,  4.80s/it, train loss=0.0675, val ΔE00=2.920, best=2.920]Training (film/smallcnn):  10%|█         | 10/100 [00:48<07:11,  4.80s/it, train loss=0.0814, val ΔE00=2.885, best=2.885]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:07,  4.81s/it, train loss=0.0814, val ΔE00=2.885, best=2.885]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:07,  4.81s/it, train loss=0.0942, val ΔE00=2.925, best=2.885]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:59,  4.77s/it, train loss=0.0942, val ΔE00=2.925, best=2.885]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:59,  4.77s/it, train loss=0.1135, val ΔE00=3.148, best=2.885]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:53,  4.75s/it, train loss=0.1135, val ΔE00=3.148, best=2.885]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:53,  4.75s/it, train loss=0.1290, val ΔE00=2.834, best=2.834]Training (film/smallcnn):  14%|█▍        | 14/100 [01:07<06:46,  4.73s/it, train loss=0.1290, val ΔE00=2.834, best=2.834]Training (film/smallcnn):  14%|█▍        | 14/100 [01:07<06:46,  4.73s/it, train loss=0.1427, val ΔE00=2.590, best=2.590]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:46,  4.78s/it, train loss=0.1427, val ΔE00=2.590, best=2.590]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:46,  4.78s/it, train loss=0.1632, val ΔE00=2.689, best=2.590]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:42,  4.79s/it, train loss=0.1632, val ΔE00=2.689, best=2.590]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:42,  4.79s/it, train loss=0.1805, val ΔE00=3.025, best=2.590]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:35,  4.76s/it, train loss=0.1805, val ΔE00=3.025, best=2.590]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:35,  4.76s/it, train loss=0.2116, val ΔE00=2.412, best=2.412]Training (film/smallcnn):  18%|█▊        | 18/100 [01:26<06:29,  4.75s/it, train loss=0.2116, val ΔE00=2.412, best=2.412]Training (film/smallcnn):  18%|█▊        | 18/100 [01:26<06:29,  4.75s/it, train loss=0.2170, val ΔE00=2.280, best=2.280]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:22,  4.73s/it, train loss=0.2170, val ΔE00=2.280, best=2.280]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:22,  4.73s/it, train loss=0.2353, val ΔE00=2.463, best=2.280]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:22,  4.79s/it, train loss=0.2353, val ΔE00=2.463, best=2.280]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:22,  4.79s/it, train loss=0.2718, val ΔE00=2.434, best=2.280]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:18,  4.80s/it, train loss=0.2718, val ΔE00=2.434, best=2.280]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:18,  4.80s/it, train loss=0.2932, val ΔE00=2.431, best=2.280]Training (film/smallcnn):  22%|██▏       | 22/100 [01:45<06:11,  4.77s/it, train loss=0.2932, val ΔE00=2.431, best=2.280]Training (film/smallcnn):  22%|██▏       | 22/100 [01:45<06:11,  4.77s/it, train loss=0.3148, val ΔE00=2.274, best=2.274]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:05,  4.74s/it, train loss=0.3148, val ΔE00=2.274, best=2.274]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:05,  4.74s/it, train loss=0.3306, val ΔE00=2.399, best=2.274]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:59,  4.72s/it, train loss=0.3306, val ΔE00=2.399, best=2.274]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:59,  4.72s/it, train loss=0.3591, val ΔE00=2.342, best=2.274]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:58,  4.78s/it, train loss=0.3591, val ΔE00=2.342, best=2.274]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:58,  4.78s/it, train loss=0.3943, val ΔE00=2.431, best=2.274]Training (film/smallcnn):  26%|██▌       | 26/100 [02:04<05:55,  4.80s/it, train loss=0.3943, val ΔE00=2.431, best=2.274]Training (film/smallcnn):  26%|██▌       | 26/100 [02:04<05:55,  4.80s/it, train loss=0.4135, val ΔE00=2.453, best=2.274]Training (film/smallcnn):  27%|██▋       | 27/100 [02:09<05:48,  4.77s/it, train loss=0.4135, val ΔE00=2.453, best=2.274]Training (film/smallcnn):  27%|██▋       | 27/100 [02:09<05:48,  4.77s/it, train loss=0.4296, val ΔE00=3.142, best=2.274]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:41,  4.75s/it, train loss=0.4296, val ΔE00=3.142, best=2.274]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:41,  4.75s/it, train loss=0.4666, val ΔE00=2.316, best=2.274]Training (film/smallcnn):  29%|██▉       | 29/100 [02:18<05:36,  4.74s/it, train loss=0.4666, val ΔE00=2.316, best=2.274]Training (film/smallcnn):  29%|██▉       | 29/100 [02:18<05:36,  4.74s/it, train loss=0.4784, val ΔE00=2.482, best=2.274]Training (film/smallcnn):  30%|███       | 30/100 [02:23<05:35,  4.79s/it, train loss=0.4784, val ΔE00=2.482, best=2.274]Training (film/smallcnn):  30%|███       | 30/100 [02:23<05:35,  4.79s/it, train loss=0.5083, val ΔE00=2.422, best=2.274]Training (film/smallcnn):  31%|███       | 31/100 [02:28<05:30,  4.80s/it, train loss=0.5083, val ΔE00=2.422, best=2.274]Training (film/smallcnn):  31%|███       | 31/100 [02:28<05:30,  4.80s/it, train loss=0.5505, val ΔE00=2.316, best=2.274]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:23,  4.76s/it, train loss=0.5505, val ΔE00=2.316, best=2.274]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:23,  4.76s/it, train loss=0.5618, val ΔE00=2.113, best=2.113]Training (film/smallcnn):  33%|███▎      | 33/100 [02:37<05:17,  4.74s/it, train loss=0.5618, val ΔE00=2.113, best=2.113]Training (film/smallcnn):  33%|███▎      | 33/100 [02:37<05:17,  4.74s/it, train loss=0.5873, val ΔE00=2.360, best=2.113]Training (film/smallcnn):  34%|███▍      | 34/100 [02:42<05:11,  4.72s/it, train loss=0.5873, val ΔE00=2.360, best=2.113]Training (film/smallcnn):  34%|███▍      | 34/100 [02:42<05:11,  4.72s/it, train loss=0.6112, val ΔE00=2.358, best=2.113]Training (film/smallcnn):  35%|███▌      | 35/100 [02:47<05:12,  4.80s/it, train loss=0.6112, val ΔE00=2.358, best=2.113]Training (film/smallcnn):  35%|███▌      | 35/100 [02:47<05:12,  4.80s/it, train loss=0.6523, val ΔE00=2.004, best=2.004]Training (film/smallcnn):  36%|███▌      | 36/100 [02:52<05:06,  4.79s/it, train loss=0.6523, val ΔE00=2.004, best=2.004]Training (film/smallcnn):  36%|███▌      | 36/100 [02:52<05:06,  4.79s/it, train loss=0.6541, val ΔE00=2.935, best=2.004]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<04:59,  4.76s/it, train loss=0.6541, val ΔE00=2.935, best=2.004]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<04:59,  4.76s/it, train loss=0.6940, val ΔE00=2.393, best=2.004]Training (film/smallcnn):  38%|███▊      | 38/100 [03:01<04:53,  4.74s/it, train loss=0.6940, val ΔE00=2.393, best=2.004]Training (film/smallcnn):  38%|███▊      | 38/100 [03:01<04:53,  4.74s/it, train loss=0.7316, val ΔE00=2.405, best=2.004]Training (film/smallcnn):  39%|███▉      | 39/100 [03:06<04:48,  4.72s/it, train loss=0.7316, val ΔE00=2.405, best=2.004]Training (film/smallcnn):  39%|███▉      | 39/100 [03:06<04:48,  4.72s/it, train loss=0.7601, val ΔE00=2.291, best=2.004]Training (film/smallcnn):  40%|████      | 40/100 [03:11<04:48,  4.80s/it, train loss=0.7601, val ΔE00=2.291, best=2.004]Training (film/smallcnn):  40%|████      | 40/100 [03:11<04:48,  4.80s/it, train loss=0.7876, val ΔE00=2.045, best=2.004]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:43,  4.80s/it, train loss=0.7876, val ΔE00=2.045, best=2.004]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:43,  4.80s/it, train loss=0.7984, val ΔE00=2.077, best=2.004]Training (film/smallcnn):  42%|████▏     | 42/100 [03:20<04:36,  4.77s/it, train loss=0.7984, val ΔE00=2.077, best=2.004]Training (film/smallcnn):  42%|████▏     | 42/100 [03:20<04:36,  4.77s/it, train loss=0.8043, val ΔE00=1.885, best=1.885]Training (film/smallcnn):  43%|████▎     | 43/100 [03:25<04:30,  4.74s/it, train loss=0.8043, val ΔE00=1.885, best=1.885]Training (film/smallcnn):  43%|████▎     | 43/100 [03:25<04:30,  4.74s/it, train loss=0.8706, val ΔE00=2.108, best=1.885]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:24,  4.73s/it, train loss=0.8706, val ΔE00=2.108, best=1.885]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:24,  4.73s/it, train loss=0.8636, val ΔE00=1.919, best=1.885]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:23,  4.79s/it, train loss=0.8636, val ΔE00=1.919, best=1.885]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:23,  4.79s/it, train loss=0.9288, val ΔE00=2.340, best=1.885]Training (film/smallcnn):  46%|████▌     | 46/100 [03:39<04:19,  4.80s/it, train loss=0.9288, val ΔE00=2.340, best=1.885]Training (film/smallcnn):  46%|████▌     | 46/100 [03:39<04:19,  4.80s/it, train loss=0.9020, val ΔE00=2.479, best=1.885]Training (film/smallcnn):  47%|████▋     | 47/100 [03:44<04:13,  4.78s/it, train loss=0.9020, val ΔE00=2.479, best=1.885]Training (film/smallcnn):  47%|████▋     | 47/100 [03:44<04:13,  4.78s/it, train loss=0.9577, val ΔE00=2.418, best=1.885]Training (film/smallcnn):  48%|████▊     | 48/100 [03:49<04:07,  4.75s/it, train loss=0.9577, val ΔE00=2.418, best=1.885]Training (film/smallcnn):  48%|████▊     | 48/100 [03:49<04:07,  4.75s/it, train loss=0.9928, val ΔE00=2.004, best=1.885]Training (film/smallcnn):  49%|████▉     | 49/100 [03:53<04:01,  4.74s/it, train loss=0.9928, val ΔE00=2.004, best=1.885]Training (film/smallcnn):  49%|████▉     | 49/100 [03:53<04:01,  4.74s/it, train loss=0.9419, val ΔE00=2.084, best=1.885]Training (film/smallcnn):  50%|█████     | 50/100 [03:58<03:59,  4.79s/it, train loss=0.9419, val ΔE00=2.084, best=1.885]Training (film/smallcnn):  50%|█████     | 50/100 [03:58<03:59,  4.79s/it, train loss=1.0206, val ΔE00=2.032, best=1.885]Training (film/smallcnn):  51%|█████     | 51/100 [04:03<03:55,  4.80s/it, train loss=1.0206, val ΔE00=2.032, best=1.885]Training (film/smallcnn):  51%|█████     | 51/100 [04:03<03:55,  4.80s/it, train loss=1.0067, val ΔE00=1.968, best=1.885]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:08<03:49,  4.78s/it, train loss=1.0067, val ΔE00=1.968, best=1.885]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:08<03:49,  4.78s/it, train loss=1.0253, val ΔE00=2.052, best=1.885]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:13<03:43,  4.76s/it, train loss=1.0253, val ΔE00=2.052, best=1.885]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:13<03:43,  4.76s/it, train loss=1.0488, val ΔE00=2.066, best=1.885]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:17<03:38,  4.75s/it, train loss=1.0488, val ΔE00=2.066, best=1.885]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:17<03:38,  4.75s/it, train loss=1.0621, val ΔE00=1.955, best=1.885]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:22<03:35,  4.80s/it, train loss=1.0621, val ΔE00=1.955, best=1.885]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:22<03:35,  4.80s/it, train loss=1.0677, val ΔE00=2.313, best=1.885]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:27<03:31,  4.81s/it, train loss=1.0677, val ΔE00=2.313, best=1.885]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:27<03:31,  4.81s/it, train loss=1.1008, val ΔE00=2.229, best=1.885]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:32<03:25,  4.77s/it, train loss=1.1008, val ΔE00=2.229, best=1.885]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:32<03:25,  4.77s/it, train loss=1.1722, val ΔE00=2.194, best=1.885]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:36<03:19,  4.75s/it, train loss=1.1722, val ΔE00=2.194, best=1.885]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:36<03:19,  4.75s/it, train loss=1.1196, val ΔE00=2.163, best=1.885]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:41<03:13,  4.73s/it, train loss=1.1196, val ΔE00=2.163, best=1.885]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:41<03:13,  4.73s/it, train loss=1.1321, val ΔE00=2.098, best=1.885]Training (film/smallcnn):  60%|██████    | 60/100 [04:46<03:11,  4.80s/it, train loss=1.1321, val ΔE00=2.098, best=1.885]Training (film/smallcnn):  60%|██████    | 60/100 [04:46<03:11,  4.80s/it, train loss=1.1639, val ΔE00=2.508, best=1.885]Training (film/smallcnn):  61%|██████    | 61/100 [04:51<03:06,  4.79s/it, train loss=1.1639, val ΔE00=2.508, best=1.885]Training (film/smallcnn):  61%|██████    | 61/100 [04:51<03:06,  4.79s/it, train loss=1.1347, val ΔE00=2.312, best=1.885]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:55<03:00,  4.76s/it, train loss=1.1347, val ΔE00=2.312, best=1.885]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:55<03:00,  4.76s/it, train loss=1.1696, val ΔE00=2.333, best=1.885]Training (film/smallcnn):  63%|██████▎   | 63/100 [05:00<02:55,  4.75s/it, train loss=1.1696, val ΔE00=2.333, best=1.885]Training (film/smallcnn):  63%|██████▎   | 63/100 [05:00<02:55,  4.75s/it, train loss=1.1236, val ΔE00=2.189, best=1.885]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:05<02:50,  4.74s/it, train loss=1.1236, val ΔE00=2.189, best=1.885]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:05<02:50,  4.74s/it, train loss=1.1922, val ΔE00=1.890, best=1.885]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:10<02:47,  4.80s/it, train loss=1.1922, val ΔE00=1.890, best=1.885]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:10<02:47,  4.80s/it, train loss=1.1607, val ΔE00=2.051, best=1.885]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:15<02:43,  4.80s/it, train loss=1.1607, val ΔE00=2.051, best=1.885]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:15<02:43,  4.80s/it, train loss=1.1530, val ΔE00=1.889, best=1.885]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:19<02:37,  4.77s/it, train loss=1.1530, val ΔE00=1.889, best=1.885]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:19<02:37,  4.77s/it, train loss=1.2122, val ΔE00=1.911, best=1.885]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:24<02:31,  4.75s/it, train loss=1.2122, val ΔE00=1.911, best=1.885]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:24<02:31,  4.75s/it, train loss=1.1390, val ΔE00=1.958, best=1.885]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:29<02:31,  4.75s/it, train loss=1.2183, val ΔE00=2.047, early_stop=yes]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:29<02:34,  4.84s/it, train loss=1.2183, val ΔE00=2.047, early_stop=yes]
[early] stop at epoch 69 (best de00=1.8847 @ 42)
[done] best ΔE00=1.885 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/film__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 13/24 ===
[sweep] id=013_model=film__backbone=resnet18__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model film --backbone resnet18 --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=resnet18, features=image, meta_encoder=none
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:05<09:45,  5.91s/it]Training (film/resnet18):   1%|          | 1/100 [00:05<09:45,  5.91s/it, train loss=0.0155, val ΔE00=9.156, best=9.156]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:11,  5.63s/it, train loss=0.0155, val ΔE00=9.156, best=9.156]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:11,  5.63s/it, train loss=0.0068, val ΔE00=5.274, best=5.274]Training (film/resnet18):   3%|▎         | 3/100 [00:16<08:56,  5.53s/it, train loss=0.0068, val ΔE00=5.274, best=5.274]Training (film/resnet18):   3%|▎         | 3/100 [00:16<08:56,  5.53s/it, train loss=0.0094, val ΔE00=4.693, best=4.693]Training (film/resnet18):   4%|▍         | 4/100 [00:22<08:43,  5.45s/it, train loss=0.0094, val ΔE00=4.693, best=4.693]Training (film/resnet18):   4%|▍         | 4/100 [00:22<08:43,  5.45s/it, train loss=0.0165, val ΔE00=5.717, best=4.693]Training (film/resnet18):   5%|▌         | 5/100 [00:27<08:42,  5.50s/it, train loss=0.0165, val ΔE00=5.717, best=4.693]Training (film/resnet18):   5%|▌         | 5/100 [00:27<08:42,  5.50s/it, train loss=0.0261, val ΔE00=3.319, best=3.319]Training (film/resnet18):   6%|▌         | 6/100 [00:33<08:34,  5.48s/it, train loss=0.0261, val ΔE00=3.319, best=3.319]Training (film/resnet18):   6%|▌         | 6/100 [00:33<08:34,  5.48s/it, train loss=0.0348, val ΔE00=3.726, best=3.319]Training (film/resnet18):   7%|▋         | 7/100 [00:38<08:25,  5.44s/it, train loss=0.0348, val ΔE00=3.726, best=3.319]Training (film/resnet18):   7%|▋         | 7/100 [00:38<08:25,  5.44s/it, train loss=0.0433, val ΔE00=3.600, best=3.319]Training (film/resnet18):   8%|▊         | 8/100 [00:43<08:18,  5.42s/it, train loss=0.0433, val ΔE00=3.600, best=3.319]Training (film/resnet18):   8%|▊         | 8/100 [00:43<08:18,  5.42s/it, train loss=0.0536, val ΔE00=3.389, best=3.319]Training (film/resnet18):   9%|▉         | 9/100 [00:49<08:13,  5.42s/it, train loss=0.0536, val ΔE00=3.389, best=3.319]Training (film/resnet18):   9%|▉         | 9/100 [00:49<08:13,  5.42s/it, train loss=0.0706, val ΔE00=2.714, best=2.714]Training (film/resnet18):  10%|█         | 10/100 [00:54<08:14,  5.50s/it, train loss=0.0706, val ΔE00=2.714, best=2.714]Training (film/resnet18):  10%|█         | 10/100 [00:54<08:14,  5.50s/it, train loss=0.0792, val ΔE00=2.692, best=2.692]Training (film/resnet18):  11%|█         | 11/100 [01:00<08:05,  5.46s/it, train loss=0.0792, val ΔE00=2.692, best=2.692]Training (film/resnet18):  11%|█         | 11/100 [01:00<08:05,  5.46s/it, train loss=0.1014, val ΔE00=3.114, best=2.692]Training (film/resnet18):  12%|█▏        | 12/100 [01:05<07:59,  5.45s/it, train loss=0.1014, val ΔE00=3.114, best=2.692]Training (film/resnet18):  12%|█▏        | 12/100 [01:05<07:59,  5.45s/it, train loss=0.1143, val ΔE00=2.510, best=2.510]Training (film/resnet18):  13%|█▎        | 13/100 [01:11<07:51,  5.42s/it, train loss=0.1143, val ΔE00=2.510, best=2.510]Training (film/resnet18):  13%|█▎        | 13/100 [01:11<07:51,  5.42s/it, train loss=0.1340, val ΔE00=2.732, best=2.510]Training (film/resnet18):  14%|█▍        | 14/100 [01:16<07:45,  5.41s/it, train loss=0.1340, val ΔE00=2.732, best=2.510]Training (film/resnet18):  14%|█▍        | 14/100 [01:16<07:45,  5.41s/it, train loss=0.1479, val ΔE00=2.603, best=2.510]Training (film/resnet18):  15%|█▌        | 15/100 [01:22<07:44,  5.47s/it, train loss=0.1479, val ΔE00=2.603, best=2.510]Training (film/resnet18):  15%|█▌        | 15/100 [01:22<07:44,  5.47s/it, train loss=0.1750, val ΔE00=2.837, best=2.510]Training (film/resnet18):  16%|█▌        | 16/100 [01:27<07:36,  5.44s/it, train loss=0.1750, val ΔE00=2.837, best=2.510]Training (film/resnet18):  16%|█▌        | 16/100 [01:27<07:36,  5.44s/it, train loss=0.1770, val ΔE00=3.318, best=2.510]Training (film/resnet18):  17%|█▋        | 17/100 [01:32<07:29,  5.42s/it, train loss=0.1770, val ΔE00=3.318, best=2.510]Training (film/resnet18):  17%|█▋        | 17/100 [01:32<07:29,  5.42s/it, train loss=0.2117, val ΔE00=2.813, best=2.510]Training (film/resnet18):  18%|█▊        | 18/100 [01:38<07:24,  5.42s/it, train loss=0.2117, val ΔE00=2.813, best=2.510]Training (film/resnet18):  18%|█▊        | 18/100 [01:38<07:24,  5.42s/it, train loss=0.2285, val ΔE00=2.497, best=2.497]Training (film/resnet18):  19%|█▉        | 19/100 [01:43<07:19,  5.42s/it, train loss=0.2285, val ΔE00=2.497, best=2.497]Training (film/resnet18):  19%|█▉        | 19/100 [01:43<07:19,  5.42s/it, train loss=0.2310, val ΔE00=2.390, best=2.390]Training (film/resnet18):  20%|██        | 20/100 [01:49<07:16,  5.45s/it, train loss=0.2310, val ΔE00=2.390, best=2.390]Training (film/resnet18):  20%|██        | 20/100 [01:49<07:16,  5.45s/it, train loss=0.2653, val ΔE00=2.503, best=2.390]Training (film/resnet18):  21%|██        | 21/100 [01:54<07:10,  5.44s/it, train loss=0.2653, val ΔE00=2.503, best=2.390]Training (film/resnet18):  21%|██        | 21/100 [01:54<07:10,  5.44s/it, train loss=0.3026, val ΔE00=2.720, best=2.390]Training (film/resnet18):  22%|██▏       | 22/100 [02:00<07:04,  5.44s/it, train loss=0.3026, val ΔE00=2.720, best=2.390]Training (film/resnet18):  22%|██▏       | 22/100 [02:00<07:04,  5.44s/it, train loss=0.3241, val ΔE00=2.167, best=2.167]Training (film/resnet18):  23%|██▎       | 23/100 [02:05<06:57,  5.42s/it, train loss=0.3241, val ΔE00=2.167, best=2.167]Training (film/resnet18):  23%|██▎       | 23/100 [02:05<06:57,  5.42s/it, train loss=0.3121, val ΔE00=2.660, best=2.167]Training (film/resnet18):  24%|██▍       | 24/100 [02:10<06:50,  5.40s/it, train loss=0.3121, val ΔE00=2.660, best=2.167]Training (film/resnet18):  24%|██▍       | 24/100 [02:10<06:50,  5.40s/it, train loss=0.3426, val ΔE00=2.401, best=2.167]Training (film/resnet18):  25%|██▌       | 25/100 [02:16<06:48,  5.45s/it, train loss=0.3426, val ΔE00=2.401, best=2.167]Training (film/resnet18):  25%|██▌       | 25/100 [02:16<06:48,  5.45s/it, train loss=0.3826, val ΔE00=2.795, best=2.167]Training (film/resnet18):  26%|██▌       | 26/100 [02:21<06:41,  5.43s/it, train loss=0.3826, val ΔE00=2.795, best=2.167]Training (film/resnet18):  26%|██▌       | 26/100 [02:21<06:41,  5.43s/it, train loss=0.4253, val ΔE00=2.620, best=2.167]Training (film/resnet18):  27%|██▋       | 27/100 [02:27<06:35,  5.41s/it, train loss=0.4253, val ΔE00=2.620, best=2.167]Training (film/resnet18):  27%|██▋       | 27/100 [02:27<06:35,  5.41s/it, train loss=0.3856, val ΔE00=2.182, best=2.167]Training (film/resnet18):  28%|██▊       | 28/100 [02:32<06:28,  5.40s/it, train loss=0.3856, val ΔE00=2.182, best=2.167]Training (film/resnet18):  28%|██▊       | 28/100 [02:32<06:28,  5.40s/it, train loss=0.4305, val ΔE00=2.171, best=2.167]Training (film/resnet18):  29%|██▉       | 29/100 [02:37<06:22,  5.39s/it, train loss=0.4305, val ΔE00=2.171, best=2.167]Training (film/resnet18):  29%|██▉       | 29/100 [02:37<06:22,  5.39s/it, train loss=0.4614, val ΔE00=2.570, best=2.167]Training (film/resnet18):  30%|███       | 30/100 [02:43<06:21,  5.45s/it, train loss=0.4614, val ΔE00=2.570, best=2.167]Training (film/resnet18):  30%|███       | 30/100 [02:43<06:21,  5.45s/it, train loss=0.4593, val ΔE00=2.041, best=2.041]Training (film/resnet18):  31%|███       | 31/100 [02:48<06:16,  5.46s/it, train loss=0.4593, val ΔE00=2.041, best=2.041]Training (film/resnet18):  31%|███       | 31/100 [02:48<06:16,  5.46s/it, train loss=0.4696, val ΔE00=1.972, best=1.972]Training (film/resnet18):  32%|███▏      | 32/100 [02:54<06:09,  5.43s/it, train loss=0.4696, val ΔE00=1.972, best=1.972]Training (film/resnet18):  32%|███▏      | 32/100 [02:54<06:09,  5.43s/it, train loss=0.5326, val ΔE00=2.314, best=1.972]Training (film/resnet18):  33%|███▎      | 33/100 [02:59<06:02,  5.41s/it, train loss=0.5326, val ΔE00=2.314, best=1.972]Training (film/resnet18):  33%|███▎      | 33/100 [02:59<06:02,  5.41s/it, train loss=0.5303, val ΔE00=2.065, best=1.972]Training (film/resnet18):  34%|███▍      | 34/100 [03:04<05:56,  5.39s/it, train loss=0.5303, val ΔE00=2.065, best=1.972]Training (film/resnet18):  34%|███▍      | 34/100 [03:04<05:56,  5.39s/it, train loss=0.5844, val ΔE00=2.195, best=1.972]Training (film/resnet18):  35%|███▌      | 35/100 [03:10<05:53,  5.44s/it, train loss=0.5844, val ΔE00=2.195, best=1.972]Training (film/resnet18):  35%|███▌      | 35/100 [03:10<05:53,  5.44s/it, train loss=0.5994, val ΔE00=2.579, best=1.972]Training (film/resnet18):  36%|███▌      | 36/100 [03:15<05:47,  5.43s/it, train loss=0.5994, val ΔE00=2.579, best=1.972]Training (film/resnet18):  36%|███▌      | 36/100 [03:15<05:47,  5.43s/it, train loss=0.6180, val ΔE00=2.028, best=1.972]Training (film/resnet18):  37%|███▋      | 37/100 [03:21<05:40,  5.40s/it, train loss=0.6180, val ΔE00=2.028, best=1.972]Training (film/resnet18):  37%|███▋      | 37/100 [03:21<05:40,  5.40s/it, train loss=0.6386, val ΔE00=2.084, best=1.972]Training (film/resnet18):  38%|███▊      | 38/100 [03:26<05:33,  5.39s/it, train loss=0.6386, val ΔE00=2.084, best=1.972]Training (film/resnet18):  38%|███▊      | 38/100 [03:26<05:33,  5.39s/it, train loss=0.6981, val ΔE00=2.115, best=1.972]Training (film/resnet18):  39%|███▉      | 39/100 [03:31<05:28,  5.38s/it, train loss=0.6981, val ΔE00=2.115, best=1.972]Training (film/resnet18):  39%|███▉      | 39/100 [03:31<05:28,  5.38s/it, train loss=0.6663, val ΔE00=2.289, best=1.972]Training (film/resnet18):  40%|████      | 40/100 [03:37<05:25,  5.42s/it, train loss=0.6663, val ΔE00=2.289, best=1.972]Training (film/resnet18):  40%|████      | 40/100 [03:37<05:25,  5.42s/it, train loss=0.7453, val ΔE00=2.179, best=1.972]Training (film/resnet18):  41%|████      | 41/100 [03:42<05:19,  5.42s/it, train loss=0.7453, val ΔE00=2.179, best=1.972]Training (film/resnet18):  41%|████      | 41/100 [03:42<05:19,  5.42s/it, train loss=0.7306, val ΔE00=2.044, best=1.972]Training (film/resnet18):  42%|████▏     | 42/100 [03:48<05:13,  5.41s/it, train loss=0.7306, val ΔE00=2.044, best=1.972]Training (film/resnet18):  42%|████▏     | 42/100 [03:48<05:13,  5.41s/it, train loss=0.6321, val ΔE00=2.323, best=1.972]Training (film/resnet18):  43%|████▎     | 43/100 [03:53<05:07,  5.39s/it, train loss=0.6321, val ΔE00=2.323, best=1.972]Training (film/resnet18):  43%|████▎     | 43/100 [03:53<05:07,  5.39s/it, train loss=0.7931, val ΔE00=2.185, best=1.972]Training (film/resnet18):  44%|████▍     | 44/100 [03:59<05:02,  5.41s/it, train loss=0.7931, val ΔE00=2.185, best=1.972]Training (film/resnet18):  44%|████▍     | 44/100 [03:59<05:02,  5.41s/it, train loss=0.7883, val ΔE00=1.899, best=1.899]Training (film/resnet18):  45%|████▌     | 45/100 [04:04<04:59,  5.44s/it, train loss=0.7883, val ΔE00=1.899, best=1.899]Training (film/resnet18):  45%|████▌     | 45/100 [04:04<04:59,  5.44s/it, train loss=0.7128, val ΔE00=2.198, best=1.899]Training (film/resnet18):  46%|████▌     | 46/100 [04:10<04:53,  5.43s/it, train loss=0.7128, val ΔE00=2.198, best=1.899]Training (film/resnet18):  46%|████▌     | 46/100 [04:10<04:53,  5.43s/it, train loss=0.8273, val ΔE00=2.509, best=1.899]Training (film/resnet18):  47%|████▋     | 47/100 [04:15<04:46,  5.41s/it, train loss=0.8273, val ΔE00=2.509, best=1.899]Training (film/resnet18):  47%|████▋     | 47/100 [04:15<04:46,  5.41s/it, train loss=0.8968, val ΔE00=2.419, best=1.899]Training (film/resnet18):  48%|████▊     | 48/100 [04:20<04:40,  5.40s/it, train loss=0.8968, val ΔE00=2.419, best=1.899]Training (film/resnet18):  48%|████▊     | 48/100 [04:20<04:40,  5.40s/it, train loss=0.8765, val ΔE00=1.974, best=1.899]Training (film/resnet18):  49%|████▉     | 49/100 [04:26<04:34,  5.38s/it, train loss=0.8765, val ΔE00=1.974, best=1.899]Training (film/resnet18):  49%|████▉     | 49/100 [04:26<04:34,  5.38s/it, train loss=0.7725, val ΔE00=2.198, best=1.899]Training (film/resnet18):  50%|█████     | 50/100 [04:31<04:31,  5.43s/it, train loss=0.7725, val ΔE00=2.198, best=1.899]Training (film/resnet18):  50%|█████     | 50/100 [04:31<04:31,  5.43s/it, train loss=0.7603, val ΔE00=2.352, best=1.899]Training (film/resnet18):  51%|█████     | 51/100 [04:37<04:25,  5.42s/it, train loss=0.7603, val ΔE00=2.352, best=1.899]Training (film/resnet18):  51%|█████     | 51/100 [04:37<04:25,  5.42s/it, train loss=0.9120, val ΔE00=2.150, best=1.899]Training (film/resnet18):  52%|█████▏    | 52/100 [04:42<04:19,  5.41s/it, train loss=0.9120, val ΔE00=2.150, best=1.899]Training (film/resnet18):  52%|█████▏    | 52/100 [04:42<04:19,  5.41s/it, train loss=0.7755, val ΔE00=2.374, best=1.899]Training (film/resnet18):  53%|█████▎    | 53/100 [04:47<04:13,  5.39s/it, train loss=0.7755, val ΔE00=2.374, best=1.899]Training (film/resnet18):  53%|█████▎    | 53/100 [04:47<04:13,  5.39s/it, train loss=0.8194, val ΔE00=2.229, best=1.899]Training (film/resnet18):  54%|█████▍    | 54/100 [04:53<04:07,  5.39s/it, train loss=0.8194, val ΔE00=2.229, best=1.899]Training (film/resnet18):  54%|█████▍    | 54/100 [04:53<04:07,  5.39s/it, train loss=0.8373, val ΔE00=2.249, best=1.899]Training (film/resnet18):  55%|█████▌    | 55/100 [04:58<04:04,  5.43s/it, train loss=0.8373, val ΔE00=2.249, best=1.899]Training (film/resnet18):  55%|█████▌    | 55/100 [04:58<04:04,  5.43s/it, train loss=0.8527, val ΔE00=2.024, best=1.899]Training (film/resnet18):  56%|█████▌    | 56/100 [05:04<03:58,  5.42s/it, train loss=0.8527, val ΔE00=2.024, best=1.899]Training (film/resnet18):  56%|█████▌    | 56/100 [05:04<03:58,  5.42s/it, train loss=0.8780, val ΔE00=2.216, best=1.899]Training (film/resnet18):  57%|█████▋    | 57/100 [05:09<03:52,  5.41s/it, train loss=0.8780, val ΔE00=2.216, best=1.899]Training (film/resnet18):  57%|█████▋    | 57/100 [05:09<03:52,  5.41s/it, train loss=0.9679, val ΔE00=2.314, best=1.899]Training (film/resnet18):  58%|█████▊    | 58/100 [05:14<03:46,  5.39s/it, train loss=0.9679, val ΔE00=2.314, best=1.899]Training (film/resnet18):  58%|█████▊    | 58/100 [05:14<03:46,  5.39s/it, train loss=0.9599, val ΔE00=2.259, best=1.899]Training (film/resnet18):  59%|█████▉    | 59/100 [05:20<03:40,  5.38s/it, train loss=0.9599, val ΔE00=2.259, best=1.899]Training (film/resnet18):  59%|█████▉    | 59/100 [05:20<03:40,  5.38s/it, train loss=0.9306, val ΔE00=2.204, best=1.899]Training (film/resnet18):  60%|██████    | 60/100 [05:25<03:36,  5.42s/it, train loss=0.9306, val ΔE00=2.204, best=1.899]Training (film/resnet18):  60%|██████    | 60/100 [05:25<03:36,  5.42s/it, train loss=0.8910, val ΔE00=2.075, best=1.899]Training (film/resnet18):  61%|██████    | 61/100 [05:31<03:31,  5.42s/it, train loss=0.8910, val ΔE00=2.075, best=1.899]Training (film/resnet18):  61%|██████    | 61/100 [05:31<03:31,  5.42s/it, train loss=0.9813, val ΔE00=1.984, best=1.899]Training (film/resnet18):  62%|██████▏   | 62/100 [05:36<03:25,  5.40s/it, train loss=0.9813, val ΔE00=1.984, best=1.899]Training (film/resnet18):  62%|██████▏   | 62/100 [05:36<03:25,  5.40s/it, train loss=1.0730, val ΔE00=2.582, best=1.899]Training (film/resnet18):  63%|██████▎   | 63/100 [05:41<03:19,  5.39s/it, train loss=1.0730, val ΔE00=2.582, best=1.899]Training (film/resnet18):  63%|██████▎   | 63/100 [05:41<03:19,  5.39s/it, train loss=0.9794, val ΔE00=2.294, best=1.899]Training (film/resnet18):  64%|██████▍   | 64/100 [05:47<03:13,  5.38s/it, train loss=0.9794, val ΔE00=2.294, best=1.899]Training (film/resnet18):  64%|██████▍   | 64/100 [05:47<03:13,  5.38s/it, train loss=1.0343, val ΔE00=2.361, best=1.899]Training (film/resnet18):  65%|██████▌   | 65/100 [05:52<03:10,  5.43s/it, train loss=1.0343, val ΔE00=2.361, best=1.899]Training (film/resnet18):  65%|██████▌   | 65/100 [05:52<03:10,  5.43s/it, train loss=1.1043, val ΔE00=2.522, best=1.899]Training (film/resnet18):  66%|██████▌   | 66/100 [05:58<03:04,  5.42s/it, train loss=1.1043, val ΔE00=2.522, best=1.899]Training (film/resnet18):  66%|██████▌   | 66/100 [05:58<03:04,  5.42s/it, train loss=0.9382, val ΔE00=2.164, best=1.899]Training (film/resnet18):  67%|██████▋   | 67/100 [06:03<02:58,  5.40s/it, train loss=0.9382, val ΔE00=2.164, best=1.899]Training (film/resnet18):  67%|██████▋   | 67/100 [06:03<02:58,  5.40s/it, train loss=0.9702, val ΔE00=2.650, best=1.899]Training (film/resnet18):  68%|██████▊   | 68/100 [06:08<02:52,  5.39s/it, train loss=0.9702, val ΔE00=2.650, best=1.899]Training (film/resnet18):  68%|██████▊   | 68/100 [06:08<02:52,  5.39s/it, train loss=0.9914, val ΔE00=2.470, best=1.899]Training (film/resnet18):  68%|██████▊   | 68/100 [06:14<02:52,  5.39s/it, train loss=0.9767, val ΔE00=2.085, early_stop=yes]Training (film/resnet18):  68%|██████▊   | 68/100 [06:14<02:56,  5.50s/it, train loss=0.9767, val ΔE00=2.085, early_stop=yes]
[early] stop at epoch 69 (best de00=1.8992 @ 44)
[done] best ΔE00=1.899 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/film__resnet18__image__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image/final_summary.json (kind=val)
[sweep] === Run 14/24 ===
[sweep] id=014_model=film__backbone=resnet18__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model film --backbone resnet18 --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=resnet18, features=image+mean, meta_encoder=none
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:06<10:02,  6.09s/it]Training (film/resnet18):   1%|          | 1/100 [00:06<10:02,  6.09s/it, train loss=0.0076, val ΔE00=5.488, best=5.488]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:27,  5.80s/it, train loss=0.0076, val ΔE00=5.488, best=5.488]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:27,  5.80s/it, train loss=0.0037, val ΔE00=4.335, best=4.335]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:12,  5.70s/it, train loss=0.0037, val ΔE00=4.335, best=4.335]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:12,  5.70s/it, train loss=0.0068, val ΔE00=3.815, best=3.815]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:02,  5.65s/it, train loss=0.0068, val ΔE00=3.815, best=3.815]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:02,  5.65s/it, train loss=0.0135, val ΔE00=2.956, best=2.956]Training (film/resnet18):   5%|▌         | 5/100 [00:28<08:59,  5.68s/it, train loss=0.0135, val ΔE00=2.956, best=2.956]Training (film/resnet18):   5%|▌         | 5/100 [00:28<08:59,  5.68s/it, train loss=0.0197, val ΔE00=3.204, best=2.956]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:52,  5.67s/it, train loss=0.0197, val ΔE00=3.204, best=2.956]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:52,  5.67s/it, train loss=0.0254, val ΔE00=2.680, best=2.680]Training (film/resnet18):   7%|▋         | 7/100 [00:39<08:43,  5.63s/it, train loss=0.0254, val ΔE00=2.680, best=2.680]Training (film/resnet18):   7%|▋         | 7/100 [00:39<08:43,  5.63s/it, train loss=0.0328, val ΔE00=2.982, best=2.680]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:35,  5.60s/it, train loss=0.0328, val ΔE00=2.982, best=2.680]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:35,  5.60s/it, train loss=0.0433, val ΔE00=2.687, best=2.680]Training (film/resnet18):   9%|▉         | 9/100 [00:50<08:27,  5.58s/it, train loss=0.0433, val ΔE00=2.687, best=2.680]Training (film/resnet18):   9%|▉         | 9/100 [00:50<08:27,  5.58s/it, train loss=0.0514, val ΔE00=2.848, best=2.680]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:25,  5.62s/it, train loss=0.0514, val ΔE00=2.848, best=2.680]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:25,  5.62s/it, train loss=0.0648, val ΔE00=2.847, best=2.680]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:21,  5.63s/it, train loss=0.0648, val ΔE00=2.847, best=2.680]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:21,  5.63s/it, train loss=0.0720, val ΔE00=2.373, best=2.373]Training (film/resnet18):  12%|█▏        | 12/100 [01:07<08:12,  5.60s/it, train loss=0.0720, val ΔE00=2.373, best=2.373]Training (film/resnet18):  12%|█▏        | 12/100 [01:07<08:12,  5.60s/it, train loss=0.0879, val ΔE00=2.704, best=2.373]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:05,  5.58s/it, train loss=0.0879, val ΔE00=2.704, best=2.373]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:05,  5.58s/it, train loss=0.1008, val ΔE00=2.483, best=2.373]Training (film/resnet18):  14%|█▍        | 14/100 [01:18<07:58,  5.56s/it, train loss=0.1008, val ΔE00=2.483, best=2.373]Training (film/resnet18):  14%|█▍        | 14/100 [01:18<07:58,  5.56s/it, train loss=0.1096, val ΔE00=2.839, best=2.373]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<07:58,  5.62s/it, train loss=0.1096, val ΔE00=2.839, best=2.373]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<07:58,  5.62s/it, train loss=0.1208, val ΔE00=2.314, best=2.314]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:51,  5.61s/it, train loss=0.1208, val ΔE00=2.314, best=2.314]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:51,  5.61s/it, train loss=0.1364, val ΔE00=2.996, best=2.314]Training (film/resnet18):  17%|█▋        | 17/100 [01:35<07:43,  5.58s/it, train loss=0.1364, val ΔE00=2.996, best=2.314]Training (film/resnet18):  17%|█▋        | 17/100 [01:35<07:43,  5.58s/it, train loss=0.1395, val ΔE00=2.323, best=2.314]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:36,  5.57s/it, train loss=0.1395, val ΔE00=2.323, best=2.314]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:36,  5.57s/it, train loss=0.1775, val ΔE00=2.354, best=2.314]Training (film/resnet18):  19%|█▉        | 19/100 [01:46<07:31,  5.57s/it, train loss=0.1775, val ΔE00=2.354, best=2.314]Training (film/resnet18):  19%|█▉        | 19/100 [01:46<07:31,  5.57s/it, train loss=0.1820, val ΔE00=2.306, best=2.306]Training (film/resnet18):  20%|██        | 20/100 [01:52<07:29,  5.62s/it, train loss=0.1820, val ΔE00=2.306, best=2.306]Training (film/resnet18):  20%|██        | 20/100 [01:52<07:29,  5.62s/it, train loss=0.1920, val ΔE00=2.499, best=2.306]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:24,  5.62s/it, train loss=0.1920, val ΔE00=2.499, best=2.306]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:24,  5.62s/it, train loss=0.2302, val ΔE00=2.215, best=2.215]Training (film/resnet18):  22%|██▏       | 22/100 [02:03<07:16,  5.60s/it, train loss=0.2302, val ΔE00=2.215, best=2.215]Training (film/resnet18):  22%|██▏       | 22/100 [02:03<07:16,  5.60s/it, train loss=0.2341, val ΔE00=2.286, best=2.215]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:10,  5.60s/it, train loss=0.2341, val ΔE00=2.286, best=2.215]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:10,  5.60s/it, train loss=0.2314, val ΔE00=2.188, best=2.188]Training (film/resnet18):  24%|██▍       | 24/100 [02:14<07:03,  5.57s/it, train loss=0.2314, val ΔE00=2.188, best=2.188]Training (film/resnet18):  24%|██▍       | 24/100 [02:14<07:03,  5.57s/it, train loss=0.2296, val ΔE00=2.398, best=2.188]Training (film/resnet18):  25%|██▌       | 25/100 [02:20<07:02,  5.64s/it, train loss=0.2296, val ΔE00=2.398, best=2.188]Training (film/resnet18):  25%|██▌       | 25/100 [02:20<07:02,  5.64s/it, train loss=0.2793, val ΔE00=2.159, best=2.159]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:55,  5.62s/it, train loss=0.2793, val ΔE00=2.159, best=2.159]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:55,  5.62s/it, train loss=0.2607, val ΔE00=2.341, best=2.159]Training (film/resnet18):  27%|██▋       | 27/100 [02:31<06:48,  5.59s/it, train loss=0.2607, val ΔE00=2.341, best=2.159]Training (film/resnet18):  27%|██▋       | 27/100 [02:31<06:48,  5.59s/it, train loss=0.2867, val ΔE00=2.249, best=2.159]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:41,  5.57s/it, train loss=0.2867, val ΔE00=2.249, best=2.159]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:41,  5.57s/it, train loss=0.3263, val ΔE00=2.279, best=2.159]Training (film/resnet18):  29%|██▉       | 29/100 [02:42<06:34,  5.56s/it, train loss=0.3263, val ΔE00=2.279, best=2.159]Training (film/resnet18):  29%|██▉       | 29/100 [02:42<06:34,  5.56s/it, train loss=0.3052, val ΔE00=2.192, best=2.159]Training (film/resnet18):  30%|███       | 30/100 [02:48<06:34,  5.63s/it, train loss=0.3052, val ΔE00=2.192, best=2.159]Training (film/resnet18):  30%|███       | 30/100 [02:48<06:34,  5.63s/it, train loss=0.3329, val ΔE00=2.038, best=2.038]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:26,  5.61s/it, train loss=0.3329, val ΔE00=2.038, best=2.038]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:26,  5.61s/it, train loss=0.3422, val ΔE00=2.237, best=2.038]Training (film/resnet18):  32%|███▏      | 32/100 [02:59<06:19,  5.58s/it, train loss=0.3422, val ΔE00=2.237, best=2.038]Training (film/resnet18):  32%|███▏      | 32/100 [02:59<06:19,  5.58s/it, train loss=0.3501, val ΔE00=2.120, best=2.038]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:12,  5.56s/it, train loss=0.3501, val ΔE00=2.120, best=2.038]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:12,  5.56s/it, train loss=0.3787, val ΔE00=2.143, best=2.038]Training (film/resnet18):  34%|███▍      | 34/100 [03:10<06:05,  5.54s/it, train loss=0.3787, val ΔE00=2.143, best=2.038]Training (film/resnet18):  34%|███▍      | 34/100 [03:10<06:05,  5.54s/it, train loss=0.3617, val ΔE00=2.518, best=2.038]Training (film/resnet18):  35%|███▌      | 35/100 [03:16<06:03,  5.60s/it, train loss=0.3617, val ΔE00=2.518, best=2.038]Training (film/resnet18):  35%|███▌      | 35/100 [03:16<06:03,  5.60s/it, train loss=0.4012, val ΔE00=2.233, best=2.038]Training (film/resnet18):  36%|███▌      | 36/100 [03:21<05:57,  5.59s/it, train loss=0.4012, val ΔE00=2.233, best=2.038]Training (film/resnet18):  36%|███▌      | 36/100 [03:21<05:57,  5.59s/it, train loss=0.4380, val ΔE00=2.353, best=2.038]Training (film/resnet18):  37%|███▋      | 37/100 [03:27<05:50,  5.57s/it, train loss=0.4380, val ΔE00=2.353, best=2.038]Training (film/resnet18):  37%|███▋      | 37/100 [03:27<05:50,  5.57s/it, train loss=0.4937, val ΔE00=2.196, best=2.038]Training (film/resnet18):  38%|███▊      | 38/100 [03:32<05:44,  5.55s/it, train loss=0.4937, val ΔE00=2.196, best=2.038]Training (film/resnet18):  38%|███▊      | 38/100 [03:32<05:44,  5.55s/it, train loss=0.4326, val ΔE00=2.487, best=2.038]Training (film/resnet18):  39%|███▉      | 39/100 [03:38<05:38,  5.54s/it, train loss=0.4326, val ΔE00=2.487, best=2.038]Training (film/resnet18):  39%|███▉      | 39/100 [03:38<05:38,  5.54s/it, train loss=0.4315, val ΔE00=2.306, best=2.038]Training (film/resnet18):  40%|████      | 40/100 [03:44<05:35,  5.60s/it, train loss=0.4315, val ΔE00=2.306, best=2.038]Training (film/resnet18):  40%|████      | 40/100 [03:44<05:35,  5.60s/it, train loss=0.4759, val ΔE00=2.142, best=2.038]Training (film/resnet18):  41%|████      | 41/100 [03:49<05:29,  5.59s/it, train loss=0.4759, val ΔE00=2.142, best=2.038]Training (film/resnet18):  41%|████      | 41/100 [03:49<05:29,  5.59s/it, train loss=0.4326, val ΔE00=2.336, best=2.038]Training (film/resnet18):  42%|████▏     | 42/100 [03:55<05:23,  5.57s/it, train loss=0.4326, val ΔE00=2.336, best=2.038]Training (film/resnet18):  42%|████▏     | 42/100 [03:55<05:23,  5.57s/it, train loss=0.5031, val ΔE00=2.061, best=2.038]Training (film/resnet18):  43%|████▎     | 43/100 [04:00<05:16,  5.56s/it, train loss=0.5031, val ΔE00=2.061, best=2.038]Training (film/resnet18):  43%|████▎     | 43/100 [04:00<05:16,  5.56s/it, train loss=0.4284, val ΔE00=2.366, best=2.038]Training (film/resnet18):  44%|████▍     | 44/100 [04:06<05:10,  5.55s/it, train loss=0.4284, val ΔE00=2.366, best=2.038]Training (film/resnet18):  44%|████▍     | 44/100 [04:06<05:10,  5.55s/it, train loss=0.4824, val ΔE00=2.360, best=2.038]Training (film/resnet18):  45%|████▌     | 45/100 [04:12<05:08,  5.62s/it, train loss=0.4824, val ΔE00=2.360, best=2.038]Training (film/resnet18):  45%|████▌     | 45/100 [04:12<05:08,  5.62s/it, train loss=0.5385, val ΔE00=2.209, best=2.038]Training (film/resnet18):  46%|████▌     | 46/100 [04:17<05:01,  5.59s/it, train loss=0.5385, val ΔE00=2.209, best=2.038]Training (film/resnet18):  46%|████▌     | 46/100 [04:17<05:01,  5.59s/it, train loss=0.5488, val ΔE00=2.061, best=2.038]Training (film/resnet18):  47%|████▋     | 47/100 [04:23<04:56,  5.59s/it, train loss=0.5488, val ΔE00=2.061, best=2.038]Training (film/resnet18):  47%|████▋     | 47/100 [04:23<04:56,  5.59s/it, train loss=0.4502, val ΔE00=1.972, best=1.972]Training (film/resnet18):  48%|████▊     | 48/100 [04:28<04:50,  5.59s/it, train loss=0.4502, val ΔE00=1.972, best=1.972]Training (film/resnet18):  48%|████▊     | 48/100 [04:28<04:50,  5.59s/it, train loss=0.4979, val ΔE00=1.936, best=1.936]Training (film/resnet18):  49%|████▉     | 49/100 [04:34<04:44,  5.57s/it, train loss=0.4979, val ΔE00=1.936, best=1.936]Training (film/resnet18):  49%|████▉     | 49/100 [04:34<04:44,  5.57s/it, train loss=0.4561, val ΔE00=2.085, best=1.936]Training (film/resnet18):  50%|█████     | 50/100 [04:40<04:41,  5.62s/it, train loss=0.4561, val ΔE00=2.085, best=1.936]Training (film/resnet18):  50%|█████     | 50/100 [04:40<04:41,  5.62s/it, train loss=0.4787, val ΔE00=2.025, best=1.936]Training (film/resnet18):  51%|█████     | 51/100 [04:45<04:34,  5.61s/it, train loss=0.4787, val ΔE00=2.025, best=1.936]Training (film/resnet18):  51%|█████     | 51/100 [04:45<04:34,  5.61s/it, train loss=0.5975, val ΔE00=1.969, best=1.936]Training (film/resnet18):  52%|█████▏    | 52/100 [04:51<04:27,  5.58s/it, train loss=0.5975, val ΔE00=1.969, best=1.936]Training (film/resnet18):  52%|█████▏    | 52/100 [04:51<04:27,  5.58s/it, train loss=0.5264, val ΔE00=2.002, best=1.936]Training (film/resnet18):  53%|█████▎    | 53/100 [04:56<04:21,  5.57s/it, train loss=0.5264, val ΔE00=2.002, best=1.936]Training (film/resnet18):  53%|█████▎    | 53/100 [04:56<04:21,  5.57s/it, train loss=0.5902, val ΔE00=1.981, best=1.936]Training (film/resnet18):  54%|█████▍    | 54/100 [05:02<04:15,  5.56s/it, train loss=0.5902, val ΔE00=1.981, best=1.936]Training (film/resnet18):  54%|█████▍    | 54/100 [05:02<04:15,  5.56s/it, train loss=0.5916, val ΔE00=2.095, best=1.936]Training (film/resnet18):  55%|█████▌    | 55/100 [05:07<04:12,  5.60s/it, train loss=0.5916, val ΔE00=2.095, best=1.936]Training (film/resnet18):  55%|█████▌    | 55/100 [05:07<04:12,  5.60s/it, train loss=0.6066, val ΔE00=2.020, best=1.936]Training (film/resnet18):  56%|█████▌    | 56/100 [05:13<04:06,  5.59s/it, train loss=0.6066, val ΔE00=2.020, best=1.936]Training (film/resnet18):  56%|█████▌    | 56/100 [05:13<04:06,  5.59s/it, train loss=0.5552, val ΔE00=1.946, best=1.936]Training (film/resnet18):  57%|█████▋    | 57/100 [05:19<03:59,  5.57s/it, train loss=0.5552, val ΔE00=1.946, best=1.936]Training (film/resnet18):  57%|█████▋    | 57/100 [05:19<03:59,  5.57s/it, train loss=0.6357, val ΔE00=1.956, best=1.936]Training (film/resnet18):  58%|█████▊    | 58/100 [05:24<03:54,  5.57s/it, train loss=0.6357, val ΔE00=1.956, best=1.936]Training (film/resnet18):  58%|█████▊    | 58/100 [05:24<03:54,  5.57s/it, train loss=0.5996, val ΔE00=1.934, best=1.934]Training (film/resnet18):  59%|█████▉    | 59/100 [05:30<03:47,  5.56s/it, train loss=0.5996, val ΔE00=1.934, best=1.934]Training (film/resnet18):  59%|█████▉    | 59/100 [05:30<03:47,  5.56s/it, train loss=0.6276, val ΔE00=2.215, best=1.934]Training (film/resnet18):  60%|██████    | 60/100 [05:35<03:44,  5.62s/it, train loss=0.6276, val ΔE00=2.215, best=1.934]Training (film/resnet18):  60%|██████    | 60/100 [05:35<03:44,  5.62s/it, train loss=0.5831, val ΔE00=2.162, best=1.934]Training (film/resnet18):  61%|██████    | 61/100 [05:41<03:38,  5.60s/it, train loss=0.5831, val ΔE00=2.162, best=1.934]Training (film/resnet18):  61%|██████    | 61/100 [05:41<03:38,  5.60s/it, train loss=0.6087, val ΔE00=2.025, best=1.934]Training (film/resnet18):  62%|██████▏   | 62/100 [05:46<03:31,  5.58s/it, train loss=0.6087, val ΔE00=2.025, best=1.934]Training (film/resnet18):  62%|██████▏   | 62/100 [05:46<03:31,  5.58s/it, train loss=0.6522, val ΔE00=2.055, best=1.934]Training (film/resnet18):  63%|██████▎   | 63/100 [05:52<03:25,  5.56s/it, train loss=0.6522, val ΔE00=2.055, best=1.934]Training (film/resnet18):  63%|██████▎   | 63/100 [05:52<03:25,  5.56s/it, train loss=0.5661, val ΔE00=2.294, best=1.934]Training (film/resnet18):  64%|██████▍   | 64/100 [05:57<03:19,  5.55s/it, train loss=0.5661, val ΔE00=2.294, best=1.934]Training (film/resnet18):  64%|██████▍   | 64/100 [05:57<03:19,  5.55s/it, train loss=0.6221, val ΔE00=2.027, best=1.934]Training (film/resnet18):  65%|██████▌   | 65/100 [06:03<03:16,  5.61s/it, train loss=0.6221, val ΔE00=2.027, best=1.934]Training (film/resnet18):  65%|██████▌   | 65/100 [06:03<03:16,  5.61s/it, train loss=0.5567, val ΔE00=2.072, best=1.934]Training (film/resnet18):  66%|██████▌   | 66/100 [06:09<03:10,  5.60s/it, train loss=0.5567, val ΔE00=2.072, best=1.934]Training (film/resnet18):  66%|██████▌   | 66/100 [06:09<03:10,  5.60s/it, train loss=0.5744, val ΔE00=2.018, best=1.934]Training (film/resnet18):  67%|██████▋   | 67/100 [06:14<03:04,  5.58s/it, train loss=0.5744, val ΔE00=2.018, best=1.934]Training (film/resnet18):  67%|██████▋   | 67/100 [06:14<03:04,  5.58s/it, train loss=0.5501, val ΔE00=1.956, best=1.934]Training (film/resnet18):  68%|██████▊   | 68/100 [06:20<02:58,  5.57s/it, train loss=0.5501, val ΔE00=1.956, best=1.934]Training (film/resnet18):  68%|██████▊   | 68/100 [06:20<02:58,  5.57s/it, train loss=0.5612, val ΔE00=2.058, best=1.934]Training (film/resnet18):  68%|██████▊   | 68/100 [06:25<02:58,  5.57s/it, train loss=0.5909, val ΔE00=2.078, early_stop=yes]Training (film/resnet18):  68%|██████▊   | 68/100 [06:25<03:01,  5.68s/it, train loss=0.5909, val ΔE00=2.078, early_stop=yes]
[early] stop at epoch 69 (best de00=1.9364 @ 48)
[done] best ΔE00=1.934 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/film__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 15/24 ===
[sweep] id=015_model=film__backbone=resnet18__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model film --backbone resnet18 --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=resnet18, features=image+meta, meta_encoder=none
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:06<10:06,  6.12s/it]Training (film/resnet18):   1%|          | 1/100 [00:06<10:06,  6.12s/it, train loss=0.0127, val ΔE00=8.254, best=8.254]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:29,  5.81s/it, train loss=0.0127, val ΔE00=8.254, best=8.254]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:29,  5.81s/it, train loss=0.0064, val ΔE00=5.816, best=5.816]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:15,  5.72s/it, train loss=0.0064, val ΔE00=5.816, best=5.816]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:15,  5.72s/it, train loss=0.0098, val ΔE00=5.290, best=5.290]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:04,  5.68s/it, train loss=0.0098, val ΔE00=5.290, best=5.290]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:04,  5.68s/it, train loss=0.0160, val ΔE00=4.021, best=4.021]Training (film/resnet18):   5%|▌         | 5/100 [00:28<09:03,  5.72s/it, train loss=0.0160, val ΔE00=4.021, best=4.021]Training (film/resnet18):   5%|▌         | 5/100 [00:28<09:03,  5.72s/it, train loss=0.0243, val ΔE00=3.505, best=3.505]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:55,  5.70s/it, train loss=0.0243, val ΔE00=3.505, best=3.505]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:55,  5.70s/it, train loss=0.0319, val ΔE00=3.153, best=3.153]Training (film/resnet18):   7%|▋         | 7/100 [00:40<08:47,  5.67s/it, train loss=0.0319, val ΔE00=3.153, best=3.153]Training (film/resnet18):   7%|▋         | 7/100 [00:40<08:47,  5.67s/it, train loss=0.0448, val ΔE00=3.007, best=3.007]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:38,  5.63s/it, train loss=0.0448, val ΔE00=3.007, best=3.007]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:38,  5.63s/it, train loss=0.0569, val ΔE00=3.191, best=3.007]Training (film/resnet18):   9%|▉         | 9/100 [00:51<08:30,  5.61s/it, train loss=0.0569, val ΔE00=3.191, best=3.007]Training (film/resnet18):   9%|▉         | 9/100 [00:51<08:30,  5.61s/it, train loss=0.0695, val ΔE00=3.160, best=3.007]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:30,  5.67s/it, train loss=0.0695, val ΔE00=3.160, best=3.007]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:30,  5.67s/it, train loss=0.0790, val ΔE00=3.200, best=3.007]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:21,  5.63s/it, train loss=0.0790, val ΔE00=3.200, best=3.007]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:21,  5.63s/it, train loss=0.0974, val ΔE00=3.434, best=3.007]Training (film/resnet18):  12%|█▏        | 12/100 [01:08<08:13,  5.60s/it, train loss=0.0974, val ΔE00=3.434, best=3.007]Training (film/resnet18):  12%|█▏        | 12/100 [01:08<08:13,  5.60s/it, train loss=0.1212, val ΔE00=3.433, best=3.007]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:07,  5.60s/it, train loss=0.1212, val ΔE00=3.433, best=3.007]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:07,  5.60s/it, train loss=0.1265, val ΔE00=2.596, best=2.596]Training (film/resnet18):  14%|█▍        | 14/100 [01:19<08:01,  5.60s/it, train loss=0.1265, val ΔE00=2.596, best=2.596]Training (film/resnet18):  14%|█▍        | 14/100 [01:19<08:01,  5.60s/it, train loss=0.1572, val ΔE00=2.477, best=2.477]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<08:00,  5.65s/it, train loss=0.1572, val ΔE00=2.477, best=2.477]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<08:00,  5.65s/it, train loss=0.1650, val ΔE00=3.796, best=2.477]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:52,  5.62s/it, train loss=0.1650, val ΔE00=3.796, best=2.477]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:52,  5.62s/it, train loss=0.1910, val ΔE00=2.971, best=2.477]Training (film/resnet18):  17%|█▋        | 17/100 [01:36<07:46,  5.62s/it, train loss=0.1910, val ΔE00=2.971, best=2.477]Training (film/resnet18):  17%|█▋        | 17/100 [01:36<07:46,  5.62s/it, train loss=0.1911, val ΔE00=2.438, best=2.438]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:39,  5.60s/it, train loss=0.1911, val ΔE00=2.438, best=2.438]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:39,  5.60s/it, train loss=0.2314, val ΔE00=2.465, best=2.438]Training (film/resnet18):  19%|█▉        | 19/100 [01:47<07:32,  5.58s/it, train loss=0.2314, val ΔE00=2.465, best=2.438]Training (film/resnet18):  19%|█▉        | 19/100 [01:47<07:32,  5.58s/it, train loss=0.2283, val ΔE00=2.567, best=2.438]Training (film/resnet18):  20%|██        | 20/100 [01:53<07:31,  5.65s/it, train loss=0.2283, val ΔE00=2.567, best=2.438]Training (film/resnet18):  20%|██        | 20/100 [01:53<07:31,  5.65s/it, train loss=0.2453, val ΔE00=2.713, best=2.438]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:23,  5.61s/it, train loss=0.2453, val ΔE00=2.713, best=2.438]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:23,  5.61s/it, train loss=0.2735, val ΔE00=2.793, best=2.438]Training (film/resnet18):  22%|██▏       | 22/100 [02:04<07:17,  5.61s/it, train loss=0.2735, val ΔE00=2.793, best=2.438]Training (film/resnet18):  22%|██▏       | 22/100 [02:04<07:17,  5.61s/it, train loss=0.2823, val ΔE00=2.352, best=2.352]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:10,  5.59s/it, train loss=0.2823, val ΔE00=2.352, best=2.352]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:10,  5.59s/it, train loss=0.3314, val ΔE00=2.507, best=2.352]Training (film/resnet18):  24%|██▍       | 24/100 [02:15<07:05,  5.59s/it, train loss=0.3314, val ΔE00=2.507, best=2.352]Training (film/resnet18):  24%|██▍       | 24/100 [02:15<07:05,  5.59s/it, train loss=0.3568, val ΔE00=2.237, best=2.237]Training (film/resnet18):  25%|██▌       | 25/100 [02:21<07:03,  5.65s/it, train loss=0.3568, val ΔE00=2.237, best=2.237]Training (film/resnet18):  25%|██▌       | 25/100 [02:21<07:03,  5.65s/it, train loss=0.3777, val ΔE00=2.282, best=2.237]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:55,  5.62s/it, train loss=0.3777, val ΔE00=2.282, best=2.237]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:55,  5.62s/it, train loss=0.4413, val ΔE00=2.753, best=2.237]Training (film/resnet18):  27%|██▋       | 27/100 [02:32<06:48,  5.59s/it, train loss=0.4413, val ΔE00=2.753, best=2.237]Training (film/resnet18):  27%|██▋       | 27/100 [02:32<06:48,  5.59s/it, train loss=0.4234, val ΔE00=2.252, best=2.237]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:43,  5.60s/it, train loss=0.4234, val ΔE00=2.252, best=2.237]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:43,  5.60s/it, train loss=0.3930, val ΔE00=2.203, best=2.203]Training (film/resnet18):  29%|██▉       | 29/100 [02:43<06:36,  5.58s/it, train loss=0.3930, val ΔE00=2.203, best=2.203]Training (film/resnet18):  29%|██▉       | 29/100 [02:43<06:36,  5.58s/it, train loss=0.4696, val ΔE00=2.257, best=2.203]Training (film/resnet18):  30%|███       | 30/100 [02:49<06:35,  5.65s/it, train loss=0.4696, val ΔE00=2.257, best=2.203]Training (film/resnet18):  30%|███       | 30/100 [02:49<06:35,  5.65s/it, train loss=0.4422, val ΔE00=2.336, best=2.203]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:27,  5.61s/it, train loss=0.4422, val ΔE00=2.336, best=2.203]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:27,  5.61s/it, train loss=0.4208, val ΔE00=2.311, best=2.203]Training (film/resnet18):  32%|███▏      | 32/100 [03:00<06:20,  5.59s/it, train loss=0.4208, val ΔE00=2.311, best=2.203]Training (film/resnet18):  32%|███▏      | 32/100 [03:00<06:20,  5.59s/it, train loss=0.5062, val ΔE00=2.344, best=2.203]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:13,  5.58s/it, train loss=0.5062, val ΔE00=2.344, best=2.203]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:13,  5.58s/it, train loss=0.5380, val ΔE00=2.258, best=2.203]Training (film/resnet18):  34%|███▍      | 34/100 [03:11<06:09,  5.59s/it, train loss=0.5380, val ΔE00=2.258, best=2.203]Training (film/resnet18):  34%|███▍      | 34/100 [03:11<06:09,  5.59s/it, train loss=0.5817, val ΔE00=2.024, best=2.024]Training (film/resnet18):  35%|███▌      | 35/100 [03:17<06:07,  5.65s/it, train loss=0.5817, val ΔE00=2.024, best=2.024]Training (film/resnet18):  35%|███▌      | 35/100 [03:17<06:07,  5.65s/it, train loss=0.6018, val ΔE00=2.779, best=2.024]Training (film/resnet18):  36%|███▌      | 36/100 [03:22<05:59,  5.62s/it, train loss=0.6018, val ΔE00=2.779, best=2.024]Training (film/resnet18):  36%|███▌      | 36/100 [03:22<05:59,  5.62s/it, train loss=0.7109, val ΔE00=2.031, best=2.024]Training (film/resnet18):  37%|███▋      | 37/100 [03:28<05:52,  5.60s/it, train loss=0.7109, val ΔE00=2.031, best=2.024]Training (film/resnet18):  37%|███▋      | 37/100 [03:28<05:52,  5.60s/it, train loss=0.6221, val ΔE00=2.142, best=2.024]Training (film/resnet18):  38%|███▊      | 38/100 [03:33<05:45,  5.58s/it, train loss=0.6221, val ΔE00=2.142, best=2.024]Training (film/resnet18):  38%|███▊      | 38/100 [03:33<05:45,  5.58s/it, train loss=0.5889, val ΔE00=2.168, best=2.024]Training (film/resnet18):  39%|███▉      | 39/100 [03:39<05:39,  5.57s/it, train loss=0.5889, val ΔE00=2.168, best=2.024]Training (film/resnet18):  39%|███▉      | 39/100 [03:39<05:39,  5.57s/it, train loss=0.6820, val ΔE00=2.281, best=2.024]Training (film/resnet18):  40%|████      | 40/100 [03:45<05:37,  5.63s/it, train loss=0.6820, val ΔE00=2.281, best=2.024]Training (film/resnet18):  40%|████      | 40/100 [03:45<05:37,  5.63s/it, train loss=0.7325, val ΔE00=2.050, best=2.024]Training (film/resnet18):  41%|████      | 41/100 [03:50<05:30,  5.61s/it, train loss=0.7325, val ΔE00=2.050, best=2.024]Training (film/resnet18):  41%|████      | 41/100 [03:50<05:30,  5.61s/it, train loss=0.7771, val ΔE00=2.291, best=2.024]Training (film/resnet18):  42%|████▏     | 42/100 [03:56<05:24,  5.59s/it, train loss=0.7771, val ΔE00=2.291, best=2.024]Training (film/resnet18):  42%|████▏     | 42/100 [03:56<05:24,  5.59s/it, train loss=0.7038, val ΔE00=2.145, best=2.024]Training (film/resnet18):  43%|████▎     | 43/100 [04:01<05:17,  5.57s/it, train loss=0.7038, val ΔE00=2.145, best=2.024]Training (film/resnet18):  43%|████▎     | 43/100 [04:01<05:17,  5.57s/it, train loss=0.6791, val ΔE00=2.203, best=2.024]Training (film/resnet18):  44%|████▍     | 44/100 [04:07<05:12,  5.58s/it, train loss=0.6791, val ΔE00=2.203, best=2.024]Training (film/resnet18):  44%|████▍     | 44/100 [04:07<05:12,  5.58s/it, train loss=0.7098, val ΔE00=2.001, best=2.001]Training (film/resnet18):  45%|████▌     | 45/100 [04:13<05:10,  5.64s/it, train loss=0.7098, val ΔE00=2.001, best=2.001]Training (film/resnet18):  45%|████▌     | 45/100 [04:13<05:10,  5.64s/it, train loss=0.7187, val ΔE00=2.102, best=2.001]Training (film/resnet18):  46%|████▌     | 46/100 [04:18<05:02,  5.61s/it, train loss=0.7187, val ΔE00=2.102, best=2.001]Training (film/resnet18):  46%|████▌     | 46/100 [04:18<05:02,  5.61s/it, train loss=0.8329, val ΔE00=2.072, best=2.001]Training (film/resnet18):  47%|████▋     | 47/100 [04:24<04:56,  5.59s/it, train loss=0.8329, val ΔE00=2.072, best=2.001]Training (film/resnet18):  47%|████▋     | 47/100 [04:24<04:56,  5.59s/it, train loss=0.8563, val ΔE00=2.232, best=2.001]Training (film/resnet18):  48%|████▊     | 48/100 [04:29<04:50,  5.58s/it, train loss=0.8563, val ΔE00=2.232, best=2.001]Training (film/resnet18):  48%|████▊     | 48/100 [04:29<04:50,  5.58s/it, train loss=0.8991, val ΔE00=2.144, best=2.001]Training (film/resnet18):  49%|████▉     | 49/100 [04:35<04:43,  5.57s/it, train loss=0.8991, val ΔE00=2.144, best=2.001]Training (film/resnet18):  49%|████▉     | 49/100 [04:35<04:43,  5.57s/it, train loss=0.9009, val ΔE00=2.393, best=2.001]Training (film/resnet18):  50%|█████     | 50/100 [04:41<04:40,  5.61s/it, train loss=0.9009, val ΔE00=2.393, best=2.001]Training (film/resnet18):  50%|█████     | 50/100 [04:41<04:40,  5.61s/it, train loss=0.7422, val ΔE00=2.223, best=2.001]Training (film/resnet18):  51%|█████     | 51/100 [04:46<04:34,  5.60s/it, train loss=0.7422, val ΔE00=2.223, best=2.001]Training (film/resnet18):  51%|█████     | 51/100 [04:46<04:34,  5.60s/it, train loss=0.8765, val ΔE00=2.402, best=2.001]Training (film/resnet18):  52%|█████▏    | 52/100 [04:52<04:27,  5.58s/it, train loss=0.8765, val ΔE00=2.402, best=2.001]Training (film/resnet18):  52%|█████▏    | 52/100 [04:52<04:27,  5.58s/it, train loss=0.9065, val ΔE00=2.160, best=2.001]Training (film/resnet18):  53%|█████▎    | 53/100 [04:57<04:21,  5.57s/it, train loss=0.9065, val ΔE00=2.160, best=2.001]Training (film/resnet18):  53%|█████▎    | 53/100 [04:57<04:21,  5.57s/it, train loss=0.9127, val ΔE00=2.055, best=2.001]Training (film/resnet18):  54%|█████▍    | 54/100 [05:03<04:15,  5.56s/it, train loss=0.9127, val ΔE00=2.055, best=2.001]Training (film/resnet18):  54%|█████▍    | 54/100 [05:03<04:15,  5.56s/it, train loss=0.8581, val ΔE00=2.010, best=2.001]Training (film/resnet18):  55%|█████▌    | 55/100 [05:09<04:13,  5.64s/it, train loss=0.8581, val ΔE00=2.010, best=2.001]Training (film/resnet18):  55%|█████▌    | 55/100 [05:09<04:13,  5.64s/it, train loss=0.8178, val ΔE00=1.974, best=1.974]Training (film/resnet18):  56%|█████▌    | 56/100 [05:14<04:07,  5.63s/it, train loss=0.8178, val ΔE00=1.974, best=1.974]Training (film/resnet18):  56%|█████▌    | 56/100 [05:14<04:07,  5.63s/it, train loss=1.0214, val ΔE00=2.112, best=1.974]Training (film/resnet18):  57%|█████▋    | 57/100 [05:20<04:00,  5.60s/it, train loss=1.0214, val ΔE00=2.112, best=1.974]Training (film/resnet18):  57%|█████▋    | 57/100 [05:20<04:00,  5.60s/it, train loss=0.9095, val ΔE00=2.489, best=1.974]Training (film/resnet18):  58%|█████▊    | 58/100 [05:25<03:54,  5.58s/it, train loss=0.9095, val ΔE00=2.489, best=1.974]Training (film/resnet18):  58%|█████▊    | 58/100 [05:25<03:54,  5.58s/it, train loss=0.9411, val ΔE00=2.163, best=1.974]Training (film/resnet18):  59%|█████▉    | 59/100 [05:31<03:48,  5.57s/it, train loss=0.9411, val ΔE00=2.163, best=1.974]Training (film/resnet18):  59%|█████▉    | 59/100 [05:31<03:48,  5.57s/it, train loss=0.8788, val ΔE00=1.990, best=1.974]Training (film/resnet18):  60%|██████    | 60/100 [05:37<03:44,  5.62s/it, train loss=0.8788, val ΔE00=1.990, best=1.974]Training (film/resnet18):  60%|██████    | 60/100 [05:37<03:44,  5.62s/it, train loss=1.0371, val ΔE00=2.029, best=1.974]Training (film/resnet18):  61%|██████    | 61/100 [05:42<03:38,  5.61s/it, train loss=1.0371, val ΔE00=2.029, best=1.974]Training (film/resnet18):  61%|██████    | 61/100 [05:42<03:38,  5.61s/it, train loss=0.9000, val ΔE00=2.083, best=1.974]Training (film/resnet18):  62%|██████▏   | 62/100 [05:48<03:32,  5.59s/it, train loss=0.9000, val ΔE00=2.083, best=1.974]Training (film/resnet18):  62%|██████▏   | 62/100 [05:48<03:32,  5.59s/it, train loss=0.9990, val ΔE00=2.016, best=1.974]Training (film/resnet18):  63%|██████▎   | 63/100 [05:53<03:26,  5.58s/it, train loss=0.9990, val ΔE00=2.016, best=1.974]Training (film/resnet18):  63%|██████▎   | 63/100 [05:53<03:26,  5.58s/it, train loss=0.9565, val ΔE00=2.231, best=1.974]Training (film/resnet18):  64%|██████▍   | 64/100 [05:59<03:20,  5.57s/it, train loss=0.9565, val ΔE00=2.231, best=1.974]Training (film/resnet18):  64%|██████▍   | 64/100 [05:59<03:20,  5.57s/it, train loss=1.0186, val ΔE00=2.512, best=1.974]Training (film/resnet18):  65%|██████▌   | 65/100 [06:05<03:17,  5.63s/it, train loss=1.0186, val ΔE00=2.512, best=1.974]Training (film/resnet18):  65%|██████▌   | 65/100 [06:05<03:17,  5.63s/it, train loss=0.9379, val ΔE00=2.353, best=1.974]Training (film/resnet18):  66%|██████▌   | 66/100 [06:10<03:10,  5.62s/it, train loss=0.9379, val ΔE00=2.353, best=1.974]Training (film/resnet18):  66%|██████▌   | 66/100 [06:10<03:10,  5.62s/it, train loss=1.0401, val ΔE00=2.275, best=1.974]Training (film/resnet18):  67%|██████▋   | 67/100 [06:16<03:04,  5.60s/it, train loss=1.0401, val ΔE00=2.275, best=1.974]Training (film/resnet18):  67%|██████▋   | 67/100 [06:16<03:04,  5.60s/it, train loss=0.9803, val ΔE00=2.443, best=1.974]Training (film/resnet18):  68%|██████▊   | 68/100 [06:21<02:58,  5.58s/it, train loss=0.9803, val ΔE00=2.443, best=1.974]Training (film/resnet18):  68%|██████▊   | 68/100 [06:21<02:58,  5.58s/it, train loss=1.0098, val ΔE00=2.218, best=1.974]Training (film/resnet18):  68%|██████▊   | 68/100 [06:27<02:58,  5.58s/it, train loss=1.0360, val ΔE00=2.256, early_stop=yes]Training (film/resnet18):  68%|██████▊   | 68/100 [06:27<03:02,  5.69s/it, train loss=1.0360, val ΔE00=2.256, early_stop=yes]
[early] stop at epoch 69 (best de00=1.9745 @ 55)
[done] best ΔE00=1.974 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/film__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 16/24 ===
[sweep] id=016_model=film__backbone=resnet18__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model film --backbone resnet18 --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=resnet18, features=image+mean+meta, meta_encoder=none
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:06<10:07,  6.13s/it]Training (film/resnet18):   1%|          | 1/100 [00:06<10:07,  6.13s/it, train loss=0.0092, val ΔE00=6.563, best=6.563]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:29,  5.81s/it, train loss=0.0092, val ΔE00=6.563, best=6.563]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:29,  5.81s/it, train loss=0.0040, val ΔE00=4.075, best=4.075]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:14,  5.71s/it, train loss=0.0040, val ΔE00=4.075, best=4.075]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:14,  5.71s/it, train loss=0.0080, val ΔE00=3.739, best=3.739]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:01,  5.64s/it, train loss=0.0080, val ΔE00=3.739, best=3.739]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:01,  5.64s/it, train loss=0.0129, val ΔE00=4.524, best=3.739]Training (film/resnet18):   5%|▌         | 5/100 [00:28<09:01,  5.70s/it, train loss=0.0129, val ΔE00=4.524, best=3.739]Training (film/resnet18):   5%|▌         | 5/100 [00:28<09:01,  5.70s/it, train loss=0.0194, val ΔE00=3.217, best=3.217]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:52,  5.66s/it, train loss=0.0194, val ΔE00=3.217, best=3.217]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:52,  5.66s/it, train loss=0.0264, val ΔE00=4.037, best=3.217]Training (film/resnet18):   7%|▋         | 7/100 [00:39<08:44,  5.64s/it, train loss=0.0264, val ΔE00=4.037, best=3.217]Training (film/resnet18):   7%|▋         | 7/100 [00:39<08:44,  5.64s/it, train loss=0.0354, val ΔE00=2.967, best=2.967]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:38,  5.63s/it, train loss=0.0354, val ΔE00=2.967, best=2.967]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:38,  5.63s/it, train loss=0.0436, val ΔE00=2.888, best=2.888]Training (film/resnet18):   9%|▉         | 9/100 [00:50<08:29,  5.60s/it, train loss=0.0436, val ΔE00=2.888, best=2.888]Training (film/resnet18):   9%|▉         | 9/100 [00:50<08:29,  5.60s/it, train loss=0.0601, val ΔE00=3.418, best=2.888]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:27,  5.64s/it, train loss=0.0601, val ΔE00=3.418, best=2.888]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:27,  5.64s/it, train loss=0.0664, val ΔE00=3.345, best=2.888]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:21,  5.64s/it, train loss=0.0664, val ΔE00=3.345, best=2.888]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:21,  5.64s/it, train loss=0.0846, val ΔE00=2.416, best=2.416]Training (film/resnet18):  12%|█▏        | 12/100 [01:07<08:13,  5.61s/it, train loss=0.0846, val ΔE00=2.416, best=2.416]Training (film/resnet18):  12%|█▏        | 12/100 [01:07<08:13,  5.61s/it, train loss=0.0968, val ΔE00=3.319, best=2.416]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:06,  5.59s/it, train loss=0.0968, val ΔE00=3.319, best=2.416]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:06,  5.59s/it, train loss=0.0990, val ΔE00=3.149, best=2.416]Training (film/resnet18):  14%|█▍        | 14/100 [01:18<07:59,  5.57s/it, train loss=0.0990, val ΔE00=3.149, best=2.416]Training (film/resnet18):  14%|█▍        | 14/100 [01:18<07:59,  5.57s/it, train loss=0.1137, val ΔE00=2.595, best=2.416]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<07:57,  5.62s/it, train loss=0.1137, val ΔE00=2.595, best=2.416]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<07:57,  5.62s/it, train loss=0.1238, val ΔE00=2.470, best=2.416]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:51,  5.61s/it, train loss=0.1238, val ΔE00=2.470, best=2.416]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:51,  5.61s/it, train loss=0.1514, val ΔE00=2.712, best=2.416]Training (film/resnet18):  17%|█▋        | 17/100 [01:35<07:43,  5.59s/it, train loss=0.1514, val ΔE00=2.712, best=2.416]Training (film/resnet18):  17%|█▋        | 17/100 [01:35<07:43,  5.59s/it, train loss=0.1572, val ΔE00=2.951, best=2.416]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:37,  5.57s/it, train loss=0.1572, val ΔE00=2.951, best=2.416]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:37,  5.57s/it, train loss=0.1753, val ΔE00=2.912, best=2.416]Training (film/resnet18):  19%|█▉        | 19/100 [01:46<07:30,  5.56s/it, train loss=0.1753, val ΔE00=2.912, best=2.416]Training (film/resnet18):  19%|█▉        | 19/100 [01:46<07:30,  5.56s/it, train loss=0.1798, val ΔE00=2.680, best=2.416]Training (film/resnet18):  20%|██        | 20/100 [01:52<07:30,  5.63s/it, train loss=0.1798, val ΔE00=2.680, best=2.416]Training (film/resnet18):  20%|██        | 20/100 [01:52<07:30,  5.63s/it, train loss=0.2057, val ΔE00=2.338, best=2.338]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:23,  5.61s/it, train loss=0.2057, val ΔE00=2.338, best=2.338]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:23,  5.61s/it, train loss=0.2181, val ΔE00=3.614, best=2.338]Training (film/resnet18):  22%|██▏       | 22/100 [02:03<07:17,  5.61s/it, train loss=0.2181, val ΔE00=3.614, best=2.338]Training (film/resnet18):  22%|██▏       | 22/100 [02:03<07:17,  5.61s/it, train loss=0.2353, val ΔE00=2.119, best=2.119]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:09,  5.58s/it, train loss=0.2353, val ΔE00=2.119, best=2.119]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:09,  5.58s/it, train loss=0.2668, val ΔE00=2.494, best=2.119]Training (film/resnet18):  24%|██▍       | 24/100 [02:14<07:02,  5.56s/it, train loss=0.2668, val ΔE00=2.494, best=2.119]Training (film/resnet18):  24%|██▍       | 24/100 [02:14<07:02,  5.56s/it, train loss=0.2569, val ΔE00=2.322, best=2.119]Training (film/resnet18):  25%|██▌       | 25/100 [02:20<07:00,  5.61s/it, train loss=0.2569, val ΔE00=2.322, best=2.119]Training (film/resnet18):  25%|██▌       | 25/100 [02:20<07:00,  5.61s/it, train loss=0.2767, val ΔE00=2.212, best=2.119]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:54,  5.61s/it, train loss=0.2767, val ΔE00=2.212, best=2.119]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:54,  5.61s/it, train loss=0.2778, val ΔE00=2.471, best=2.119]Training (film/resnet18):  27%|██▋       | 27/100 [02:31<06:47,  5.59s/it, train loss=0.2778, val ΔE00=2.471, best=2.119]Training (film/resnet18):  27%|██▋       | 27/100 [02:31<06:47,  5.59s/it, train loss=0.3008, val ΔE00=2.416, best=2.119]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:42,  5.59s/it, train loss=0.3008, val ΔE00=2.416, best=2.119]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:42,  5.59s/it, train loss=0.3082, val ΔE00=2.072, best=2.072]Training (film/resnet18):  29%|██▉       | 29/100 [02:42<06:35,  5.58s/it, train loss=0.3082, val ΔE00=2.072, best=2.072]Training (film/resnet18):  29%|██▉       | 29/100 [02:42<06:35,  5.58s/it, train loss=0.3684, val ΔE00=2.660, best=2.072]Training (film/resnet18):  30%|███       | 30/100 [02:48<06:33,  5.63s/it, train loss=0.3684, val ΔE00=2.660, best=2.072]Training (film/resnet18):  30%|███       | 30/100 [02:48<06:33,  5.63s/it, train loss=0.3462, val ΔE00=2.201, best=2.072]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:27,  5.61s/it, train loss=0.3462, val ΔE00=2.201, best=2.072]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:27,  5.61s/it, train loss=0.4021, val ΔE00=2.097, best=2.072]Training (film/resnet18):  32%|███▏      | 32/100 [02:59<06:19,  5.59s/it, train loss=0.4021, val ΔE00=2.097, best=2.072]Training (film/resnet18):  32%|███▏      | 32/100 [02:59<06:19,  5.59s/it, train loss=0.3717, val ΔE00=2.396, best=2.072]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:14,  5.59s/it, train loss=0.3717, val ΔE00=2.396, best=2.072]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:14,  5.59s/it, train loss=0.4265, val ΔE00=1.983, best=1.983]Training (film/resnet18):  34%|███▍      | 34/100 [03:10<06:07,  5.57s/it, train loss=0.4265, val ΔE00=1.983, best=1.983]Training (film/resnet18):  34%|███▍      | 34/100 [03:10<06:07,  5.57s/it, train loss=0.4348, val ΔE00=2.525, best=1.983]Training (film/resnet18):  35%|███▌      | 35/100 [03:16<06:05,  5.62s/it, train loss=0.4348, val ΔE00=2.525, best=1.983]Training (film/resnet18):  35%|███▌      | 35/100 [03:16<06:05,  5.62s/it, train loss=0.4361, val ΔE00=2.331, best=1.983]Training (film/resnet18):  36%|███▌      | 36/100 [03:22<05:59,  5.61s/it, train loss=0.4361, val ΔE00=2.331, best=1.983]Training (film/resnet18):  36%|███▌      | 36/100 [03:22<05:59,  5.61s/it, train loss=0.4917, val ΔE00=2.125, best=1.983]Training (film/resnet18):  37%|███▋      | 37/100 [03:27<05:51,  5.59s/it, train loss=0.4917, val ΔE00=2.125, best=1.983]Training (film/resnet18):  37%|███▋      | 37/100 [03:27<05:51,  5.59s/it, train loss=0.4173, val ΔE00=2.007, best=1.983]Training (film/resnet18):  38%|███▊      | 38/100 [03:33<05:45,  5.57s/it, train loss=0.4173, val ΔE00=2.007, best=1.983]Training (film/resnet18):  38%|███▊      | 38/100 [03:33<05:45,  5.57s/it, train loss=0.4707, val ΔE00=2.372, best=1.983]Training (film/resnet18):  39%|███▉      | 39/100 [03:38<05:39,  5.56s/it, train loss=0.4707, val ΔE00=2.372, best=1.983]Training (film/resnet18):  39%|███▉      | 39/100 [03:38<05:39,  5.56s/it, train loss=0.4785, val ΔE00=2.017, best=1.983]Training (film/resnet18):  40%|████      | 40/100 [03:44<05:36,  5.61s/it, train loss=0.4785, val ΔE00=2.017, best=1.983]Training (film/resnet18):  40%|████      | 40/100 [03:44<05:36,  5.61s/it, train loss=0.4692, val ΔE00=2.290, best=1.983]Training (film/resnet18):  41%|████      | 41/100 [03:50<05:30,  5.60s/it, train loss=0.4692, val ΔE00=2.290, best=1.983]Training (film/resnet18):  41%|████      | 41/100 [03:50<05:30,  5.60s/it, train loss=0.4673, val ΔE00=2.163, best=1.983]Training (film/resnet18):  42%|████▏     | 42/100 [03:55<05:25,  5.60s/it, train loss=0.4673, val ΔE00=2.163, best=1.983]Training (film/resnet18):  42%|████▏     | 42/100 [03:55<05:25,  5.60s/it, train loss=0.5665, val ΔE00=1.960, best=1.960]Training (film/resnet18):  43%|████▎     | 43/100 [04:01<05:18,  5.59s/it, train loss=0.5665, val ΔE00=1.960, best=1.960]Training (film/resnet18):  43%|████▎     | 43/100 [04:01<05:18,  5.59s/it, train loss=0.5298, val ΔE00=2.053, best=1.960]Training (film/resnet18):  44%|████▍     | 44/100 [04:06<05:11,  5.57s/it, train loss=0.5298, val ΔE00=2.053, best=1.960]Training (film/resnet18):  44%|████▍     | 44/100 [04:06<05:11,  5.57s/it, train loss=0.5946, val ΔE00=2.313, best=1.960]Training (film/resnet18):  45%|████▌     | 45/100 [04:12<05:08,  5.61s/it, train loss=0.5946, val ΔE00=2.313, best=1.960]Training (film/resnet18):  45%|████▌     | 45/100 [04:12<05:08,  5.61s/it, train loss=0.5204, val ΔE00=2.093, best=1.960]Training (film/resnet18):  46%|████▌     | 46/100 [04:18<05:02,  5.60s/it, train loss=0.5204, val ΔE00=2.093, best=1.960]Training (film/resnet18):  46%|████▌     | 46/100 [04:18<05:02,  5.60s/it, train loss=0.6124, val ΔE00=2.195, best=1.960]Training (film/resnet18):  47%|████▋     | 47/100 [04:23<04:55,  5.58s/it, train loss=0.6124, val ΔE00=2.195, best=1.960]Training (film/resnet18):  47%|████▋     | 47/100 [04:23<04:55,  5.58s/it, train loss=0.6030, val ΔE00=2.308, best=1.960]Training (film/resnet18):  48%|████▊     | 48/100 [04:29<04:49,  5.56s/it, train loss=0.6030, val ΔE00=2.308, best=1.960]Training (film/resnet18):  48%|████▊     | 48/100 [04:29<04:49,  5.56s/it, train loss=0.5996, val ΔE00=2.013, best=1.960]Training (film/resnet18):  49%|████▉     | 49/100 [04:34<04:43,  5.55s/it, train loss=0.5996, val ΔE00=2.013, best=1.960]Training (film/resnet18):  49%|████▉     | 49/100 [04:34<04:43,  5.55s/it, train loss=0.5586, val ΔE00=1.980, best=1.960]Training (film/resnet18):  50%|█████     | 50/100 [04:40<04:40,  5.61s/it, train loss=0.5586, val ΔE00=1.980, best=1.960]Training (film/resnet18):  50%|█████     | 50/100 [04:40<04:40,  5.61s/it, train loss=0.6627, val ΔE00=2.497, best=1.960]Training (film/resnet18):  51%|█████     | 51/100 [04:45<04:33,  5.59s/it, train loss=0.6627, val ΔE00=2.497, best=1.960]Training (film/resnet18):  51%|█████     | 51/100 [04:45<04:33,  5.59s/it, train loss=0.5675, val ΔE00=1.965, best=1.960]Training (film/resnet18):  52%|█████▏    | 52/100 [04:51<04:27,  5.57s/it, train loss=0.5675, val ΔE00=1.965, best=1.960]Training (film/resnet18):  52%|█████▏    | 52/100 [04:51<04:27,  5.57s/it, train loss=0.7246, val ΔE00=2.198, best=1.960]Training (film/resnet18):  53%|█████▎    | 53/100 [04:56<04:21,  5.56s/it, train loss=0.7246, val ΔE00=2.198, best=1.960]Training (film/resnet18):  53%|█████▎    | 53/100 [04:56<04:21,  5.56s/it, train loss=0.6392, val ΔE00=2.181, best=1.960]Training (film/resnet18):  54%|█████▍    | 54/100 [05:02<04:16,  5.57s/it, train loss=0.6392, val ΔE00=2.181, best=1.960]Training (film/resnet18):  54%|█████▍    | 54/100 [05:02<04:16,  5.57s/it, train loss=0.6696, val ΔE00=1.925, best=1.925]Training (film/resnet18):  55%|█████▌    | 55/100 [05:08<04:12,  5.62s/it, train loss=0.6696, val ΔE00=1.925, best=1.925]Training (film/resnet18):  55%|█████▌    | 55/100 [05:08<04:12,  5.62s/it, train loss=0.5495, val ΔE00=2.525, best=1.925]Training (film/resnet18):  56%|█████▌    | 56/100 [05:13<04:07,  5.62s/it, train loss=0.5495, val ΔE00=2.525, best=1.925]Training (film/resnet18):  56%|█████▌    | 56/100 [05:13<04:07,  5.62s/it, train loss=0.6282, val ΔE00=2.223, best=1.925]Training (film/resnet18):  57%|█████▋    | 57/100 [05:19<04:00,  5.59s/it, train loss=0.6282, val ΔE00=2.223, best=1.925]Training (film/resnet18):  57%|█████▋    | 57/100 [05:19<04:00,  5.59s/it, train loss=0.7495, val ΔE00=2.422, best=1.925]Training (film/resnet18):  58%|█████▊    | 58/100 [05:25<03:54,  5.58s/it, train loss=0.7495, val ΔE00=2.422, best=1.925]Training (film/resnet18):  58%|█████▊    | 58/100 [05:25<03:54,  5.58s/it, train loss=0.6332, val ΔE00=2.124, best=1.925]Training (film/resnet18):  59%|█████▉    | 59/100 [05:30<03:48,  5.58s/it, train loss=0.6332, val ΔE00=2.124, best=1.925]Training (film/resnet18):  59%|█████▉    | 59/100 [05:30<03:48,  5.58s/it, train loss=0.6457, val ΔE00=1.918, best=1.918]Training (film/resnet18):  60%|██████    | 60/100 [05:36<03:45,  5.63s/it, train loss=0.6457, val ΔE00=1.918, best=1.918]Training (film/resnet18):  60%|██████    | 60/100 [05:36<03:45,  5.63s/it, train loss=0.6159, val ΔE00=2.038, best=1.918]Training (film/resnet18):  61%|██████    | 61/100 [05:41<03:39,  5.62s/it, train loss=0.6159, val ΔE00=2.038, best=1.918]Training (film/resnet18):  61%|██████    | 61/100 [05:41<03:39,  5.62s/it, train loss=0.6409, val ΔE00=2.040, best=1.918]Training (film/resnet18):  62%|██████▏   | 62/100 [05:47<03:33,  5.61s/it, train loss=0.6409, val ΔE00=2.040, best=1.918]Training (film/resnet18):  62%|██████▏   | 62/100 [05:47<03:33,  5.61s/it, train loss=0.7047, val ΔE00=1.887, best=1.887]Training (film/resnet18):  63%|██████▎   | 63/100 [05:53<03:26,  5.59s/it, train loss=0.7047, val ΔE00=1.887, best=1.887]Training (film/resnet18):  63%|██████▎   | 63/100 [05:53<03:26,  5.59s/it, train loss=0.6390, val ΔE00=2.006, best=1.887]Training (film/resnet18):  64%|██████▍   | 64/100 [05:58<03:20,  5.57s/it, train loss=0.6390, val ΔE00=2.006, best=1.887]Training (film/resnet18):  64%|██████▍   | 64/100 [05:58<03:20,  5.57s/it, train loss=0.7433, val ΔE00=2.036, best=1.887]Training (film/resnet18):  65%|██████▌   | 65/100 [06:04<03:16,  5.63s/it, train loss=0.7433, val ΔE00=2.036, best=1.887]Training (film/resnet18):  65%|██████▌   | 65/100 [06:04<03:16,  5.63s/it, train loss=0.6637, val ΔE00=2.146, best=1.887]Training (film/resnet18):  66%|██████▌   | 66/100 [06:09<03:11,  5.62s/it, train loss=0.6637, val ΔE00=2.146, best=1.887]Training (film/resnet18):  66%|██████▌   | 66/100 [06:09<03:11,  5.62s/it, train loss=0.7302, val ΔE00=1.916, best=1.887]Training (film/resnet18):  67%|██████▋   | 67/100 [06:15<03:05,  5.62s/it, train loss=0.7302, val ΔE00=1.916, best=1.887]Training (film/resnet18):  67%|██████▋   | 67/100 [06:15<03:05,  5.62s/it, train loss=0.7487, val ΔE00=1.876, best=1.876]Training (film/resnet18):  68%|██████▊   | 68/100 [06:21<02:59,  5.60s/it, train loss=0.7487, val ΔE00=1.876, best=1.876]Training (film/resnet18):  68%|██████▊   | 68/100 [06:21<02:59,  5.60s/it, train loss=0.7098, val ΔE00=2.139, best=1.876]Training (film/resnet18):  69%|██████▉   | 69/100 [06:26<02:52,  5.58s/it, train loss=0.7098, val ΔE00=2.139, best=1.876]Training (film/resnet18):  69%|██████▉   | 69/100 [06:26<02:52,  5.58s/it, train loss=0.6256, val ΔE00=1.937, best=1.876]Training (film/resnet18):  70%|███████   | 70/100 [06:32<02:48,  5.63s/it, train loss=0.6256, val ΔE00=1.937, best=1.876]Training (film/resnet18):  70%|███████   | 70/100 [06:32<02:48,  5.63s/it, train loss=0.5960, val ΔE00=2.090, best=1.876]Training (film/resnet18):  71%|███████   | 71/100 [06:37<02:42,  5.61s/it, train loss=0.5960, val ΔE00=2.090, best=1.876]Training (film/resnet18):  71%|███████   | 71/100 [06:37<02:42,  5.61s/it, train loss=0.6742, val ΔE00=1.983, best=1.876]Training (film/resnet18):  72%|███████▏  | 72/100 [06:43<02:36,  5.60s/it, train loss=0.6742, val ΔE00=1.983, best=1.876]Training (film/resnet18):  72%|███████▏  | 72/100 [06:43<02:36,  5.60s/it, train loss=0.5982, val ΔE00=2.095, best=1.876]Training (film/resnet18):  73%|███████▎  | 73/100 [06:49<02:30,  5.58s/it, train loss=0.5982, val ΔE00=2.095, best=1.876]Training (film/resnet18):  73%|███████▎  | 73/100 [06:49<02:30,  5.58s/it, train loss=0.6480, val ΔE00=2.038, best=1.876]Training (film/resnet18):  74%|███████▍  | 74/100 [06:54<02:24,  5.57s/it, train loss=0.6480, val ΔE00=2.038, best=1.876]Training (film/resnet18):  74%|███████▍  | 74/100 [06:54<02:24,  5.57s/it, train loss=0.6081, val ΔE00=2.216, best=1.876]Training (film/resnet18):  75%|███████▌  | 75/100 [07:00<02:20,  5.61s/it, train loss=0.6081, val ΔE00=2.216, best=1.876]Training (film/resnet18):  75%|███████▌  | 75/100 [07:00<02:20,  5.61s/it, train loss=0.6475, val ΔE00=2.105, best=1.876]Training (film/resnet18):  76%|███████▌  | 76/100 [07:05<02:14,  5.61s/it, train loss=0.6475, val ΔE00=2.105, best=1.876]Training (film/resnet18):  76%|███████▌  | 76/100 [07:05<02:14,  5.61s/it, train loss=0.6608, val ΔE00=2.088, best=1.876]Training (film/resnet18):  76%|███████▌  | 76/100 [07:11<02:14,  5.61s/it, train loss=0.7004, val ΔE00=2.139, early_stop=yes]Training (film/resnet18):  76%|███████▌  | 76/100 [07:11<02:16,  5.68s/it, train loss=0.7004, val ΔE00=2.139, early_stop=yes]
[early] stop at epoch 77 (best de00=1.8758 @ 67)
[done] best ΔE00=1.876 over 77 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/film__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 17/24 ===
[sweep] id=017_model=xattn__backbone=smallcnn__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model xattn --backbone smallcnn --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=smallcnn, features=image, meta_encoder=none
[run] model=xattn backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<08:54,  5.40s/it]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<08:54,  5.40s/it, train loss=0.0117, val ΔE00=12.753, best=12.753]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:20,  5.11s/it, train loss=0.0117, val ΔE00=12.753, best=12.753]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:20,  5.11s/it, train loss=0.0099, val ΔE00=7.225, best=7.225]  Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:05,  5.01s/it, train loss=0.0099, val ΔE00=7.225, best=7.225]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:05,  5.01s/it, train loss=0.0143, val ΔE00=5.751, best=5.751]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<07:56,  4.97s/it, train loss=0.0143, val ΔE00=5.751, best=5.751]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<07:56,  4.97s/it, train loss=0.0258, val ΔE00=5.677, best=5.677]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<07:56,  5.02s/it, train loss=0.0258, val ΔE00=5.677, best=5.677]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<07:56,  5.02s/it, train loss=0.0378, val ΔE00=7.393, best=5.677]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:30<07:52,  5.02s/it, train loss=0.0378, val ΔE00=7.393, best=5.677]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:30<07:52,  5.02s/it, train loss=0.0532, val ΔE00=5.695, best=5.677]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:35<07:43,  4.98s/it, train loss=0.0532, val ΔE00=5.695, best=5.677]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:35<07:43,  4.98s/it, train loss=0.0673, val ΔE00=7.182, best=5.677]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:40<07:36,  4.96s/it, train loss=0.0673, val ΔE00=7.182, best=5.677]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:40<07:36,  4.96s/it, train loss=0.0873, val ΔE00=4.198, best=4.198]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:44<07:29,  4.94s/it, train loss=0.0873, val ΔE00=4.198, best=4.198]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:44<07:29,  4.94s/it, train loss=0.1045, val ΔE00=4.250, best=4.198]Training (xattn/smallcnn):  10%|█         | 10/100 [00:50<07:29,  4.99s/it, train loss=0.1045, val ΔE00=4.250, best=4.198]Training (xattn/smallcnn):  10%|█         | 10/100 [00:50<07:29,  4.99s/it, train loss=0.1282, val ΔE00=5.597, best=4.198]Training (xattn/smallcnn):  11%|█         | 11/100 [00:55<07:25,  5.01s/it, train loss=0.1282, val ΔE00=5.597, best=4.198]Training (xattn/smallcnn):  11%|█         | 11/100 [00:55<07:25,  5.01s/it, train loss=0.1574, val ΔE00=3.985, best=3.985]Training (xattn/smallcnn):  12%|█▏        | 12/100 [00:59<07:17,  4.97s/it, train loss=0.1574, val ΔE00=3.985, best=3.985]Training (xattn/smallcnn):  12%|█▏        | 12/100 [00:59<07:17,  4.97s/it, train loss=0.1678, val ΔE00=3.907, best=3.907]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:04<07:10,  4.95s/it, train loss=0.1678, val ΔE00=3.907, best=3.907]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:04<07:10,  4.95s/it, train loss=0.1963, val ΔE00=4.155, best=3.907]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:09<07:04,  4.94s/it, train loss=0.1963, val ΔE00=4.155, best=3.907]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:09<07:04,  4.94s/it, train loss=0.2303, val ΔE00=3.604, best=3.604]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:14<07:04,  4.99s/it, train loss=0.2303, val ΔE00=3.604, best=3.604]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:14<07:04,  4.99s/it, train loss=0.2572, val ΔE00=3.862, best=3.604]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:19<07:00,  5.00s/it, train loss=0.2572, val ΔE00=3.862, best=3.604]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:19<07:00,  5.00s/it, train loss=0.2892, val ΔE00=4.336, best=3.604]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:24<06:52,  4.97s/it, train loss=0.2892, val ΔE00=4.336, best=3.604]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:24<06:52,  4.97s/it, train loss=0.3164, val ΔE00=3.794, best=3.604]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:29<06:45,  4.95s/it, train loss=0.3164, val ΔE00=3.794, best=3.604]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:29<06:45,  4.95s/it, train loss=0.3303, val ΔE00=3.449, best=3.449]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:34<06:39,  4.93s/it, train loss=0.3303, val ΔE00=3.449, best=3.449]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:34<06:39,  4.93s/it, train loss=0.3609, val ΔE00=4.280, best=3.449]Training (xattn/smallcnn):  20%|██        | 20/100 [01:39<06:39,  4.99s/it, train loss=0.3609, val ΔE00=4.280, best=3.449]Training (xattn/smallcnn):  20%|██        | 20/100 [01:39<06:39,  4.99s/it, train loss=0.4213, val ΔE00=3.936, best=3.449]Training (xattn/smallcnn):  21%|██        | 21/100 [01:44<06:35,  5.00s/it, train loss=0.4213, val ΔE00=3.936, best=3.449]Training (xattn/smallcnn):  21%|██        | 21/100 [01:44<06:35,  5.00s/it, train loss=0.4644, val ΔE00=3.287, best=3.287]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:49<06:27,  4.97s/it, train loss=0.4644, val ΔE00=3.287, best=3.287]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:49<06:27,  4.97s/it, train loss=0.4601, val ΔE00=3.323, best=3.287]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:54<06:20,  4.95s/it, train loss=0.4601, val ΔE00=3.323, best=3.287]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:54<06:20,  4.95s/it, train loss=0.5078, val ΔE00=4.700, best=3.287]Training (xattn/smallcnn):  24%|██▍       | 24/100 [01:59<06:14,  4.93s/it, train loss=0.5078, val ΔE00=4.700, best=3.287]Training (xattn/smallcnn):  24%|██▍       | 24/100 [01:59<06:14,  4.93s/it, train loss=0.5879, val ΔE00=3.256, best=3.256]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:04<06:13,  4.98s/it, train loss=0.5879, val ΔE00=3.256, best=3.256]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:04<06:13,  4.98s/it, train loss=0.6001, val ΔE00=3.189, best=3.189]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:09<06:09,  5.00s/it, train loss=0.6001, val ΔE00=3.189, best=3.189]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:09<06:09,  5.00s/it, train loss=0.5929, val ΔE00=3.734, best=3.189]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:14<06:02,  4.96s/it, train loss=0.5929, val ΔE00=3.734, best=3.189]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:14<06:02,  4.96s/it, train loss=0.6611, val ΔE00=3.516, best=3.189]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:19<05:55,  4.94s/it, train loss=0.6611, val ΔE00=3.516, best=3.189]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:19<05:55,  4.94s/it, train loss=0.6588, val ΔE00=3.225, best=3.189]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:24<05:50,  4.93s/it, train loss=0.6588, val ΔE00=3.225, best=3.189]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:24<05:50,  4.93s/it, train loss=0.7114, val ΔE00=3.732, best=3.189]Training (xattn/smallcnn):  30%|███       | 30/100 [02:29<05:49,  4.99s/it, train loss=0.7114, val ΔE00=3.732, best=3.189]Training (xattn/smallcnn):  30%|███       | 30/100 [02:29<05:49,  4.99s/it, train loss=0.7605, val ΔE00=3.285, best=3.189]Training (xattn/smallcnn):  31%|███       | 31/100 [02:34<05:44,  5.00s/it, train loss=0.7605, val ΔE00=3.285, best=3.189]Training (xattn/smallcnn):  31%|███       | 31/100 [02:34<05:44,  5.00s/it, train loss=0.7865, val ΔE00=3.673, best=3.189]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:39<05:37,  4.97s/it, train loss=0.7865, val ΔE00=3.673, best=3.189]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:39<05:37,  4.97s/it, train loss=0.8970, val ΔE00=3.407, best=3.189]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:44<05:31,  4.95s/it, train loss=0.8970, val ΔE00=3.407, best=3.189]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:44<05:31,  4.95s/it, train loss=0.8611, val ΔE00=4.920, best=3.189]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:49<05:25,  4.93s/it, train loss=0.8611, val ΔE00=4.920, best=3.189]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:49<05:25,  4.93s/it, train loss=0.8874, val ΔE00=2.661, best=2.661]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:54<05:24,  4.99s/it, train loss=0.8874, val ΔE00=2.661, best=2.661]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:54<05:24,  4.99s/it, train loss=1.0162, val ΔE00=3.563, best=2.661]Training (xattn/smallcnn):  36%|███▌      | 36/100 [02:59<05:20,  5.00s/it, train loss=1.0162, val ΔE00=3.563, best=2.661]Training (xattn/smallcnn):  36%|███▌      | 36/100 [02:59<05:20,  5.00s/it, train loss=0.9607, val ΔE00=3.584, best=2.661]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:04<05:13,  4.97s/it, train loss=0.9607, val ΔE00=3.584, best=2.661]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:04<05:13,  4.97s/it, train loss=1.0777, val ΔE00=3.340, best=2.661]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:09<05:06,  4.95s/it, train loss=1.0777, val ΔE00=3.340, best=2.661]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:09<05:06,  4.95s/it, train loss=1.0574, val ΔE00=2.753, best=2.661]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:13<05:01,  4.94s/it, train loss=1.0574, val ΔE00=2.753, best=2.661]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:13<05:01,  4.94s/it, train loss=1.0684, val ΔE00=2.634, best=2.634]Training (xattn/smallcnn):  40%|████      | 40/100 [03:19<04:59,  4.99s/it, train loss=1.0684, val ΔE00=2.634, best=2.634]Training (xattn/smallcnn):  40%|████      | 40/100 [03:19<04:59,  4.99s/it, train loss=1.1572, val ΔE00=3.119, best=2.634]Training (xattn/smallcnn):  41%|████      | 41/100 [03:24<04:54,  5.00s/it, train loss=1.1572, val ΔE00=3.119, best=2.634]Training (xattn/smallcnn):  41%|████      | 41/100 [03:24<04:54,  5.00s/it, train loss=1.1061, val ΔE00=2.913, best=2.634]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:29<04:48,  4.97s/it, train loss=1.1061, val ΔE00=2.913, best=2.634]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:29<04:48,  4.97s/it, train loss=1.2526, val ΔE00=3.752, best=2.634]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:33<04:41,  4.95s/it, train loss=1.2526, val ΔE00=3.752, best=2.634]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:33<04:41,  4.95s/it, train loss=1.2477, val ΔE00=3.627, best=2.634]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:38<04:36,  4.93s/it, train loss=1.2477, val ΔE00=3.627, best=2.634]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:38<04:36,  4.93s/it, train loss=1.2708, val ΔE00=2.954, best=2.634]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:43<04:33,  4.98s/it, train loss=1.2708, val ΔE00=2.954, best=2.634]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:43<04:33,  4.98s/it, train loss=1.3121, val ΔE00=3.094, best=2.634]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:48<04:29,  5.00s/it, train loss=1.3121, val ΔE00=3.094, best=2.634]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:48<04:29,  5.00s/it, train loss=1.2095, val ΔE00=2.607, best=2.607]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:53<04:22,  4.96s/it, train loss=1.2095, val ΔE00=2.607, best=2.607]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:53<04:22,  4.96s/it, train loss=1.2868, val ΔE00=4.110, best=2.607]Training (xattn/smallcnn):  48%|████▊     | 48/100 [03:58<04:16,  4.94s/it, train loss=1.2868, val ΔE00=4.110, best=2.607]Training (xattn/smallcnn):  48%|████▊     | 48/100 [03:58<04:16,  4.94s/it, train loss=1.3091, val ΔE00=2.679, best=2.607]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:03<04:11,  4.93s/it, train loss=1.3091, val ΔE00=2.679, best=2.607]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:03<04:11,  4.93s/it, train loss=1.3757, val ΔE00=3.002, best=2.607]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:08<04:09,  4.98s/it, train loss=1.3757, val ΔE00=3.002, best=2.607]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:08<04:09,  4.98s/it, train loss=1.4131, val ΔE00=2.577, best=2.577]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:13<04:04,  5.00s/it, train loss=1.4131, val ΔE00=2.577, best=2.577]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:13<04:04,  5.00s/it, train loss=1.4191, val ΔE00=3.269, best=2.577]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:18<03:58,  4.97s/it, train loss=1.4191, val ΔE00=3.269, best=2.577]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:18<03:58,  4.97s/it, train loss=1.4841, val ΔE00=2.597, best=2.577]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:23<03:52,  4.95s/it, train loss=1.4841, val ΔE00=2.597, best=2.577]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:23<03:52,  4.95s/it, train loss=1.5467, val ΔE00=3.182, best=2.577]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:28<03:46,  4.93s/it, train loss=1.5467, val ΔE00=3.182, best=2.577]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:28<03:46,  4.93s/it, train loss=1.5471, val ΔE00=2.515, best=2.515]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:33<03:44,  4.98s/it, train loss=1.5471, val ΔE00=2.515, best=2.515]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:33<03:44,  4.98s/it, train loss=1.5997, val ΔE00=3.391, best=2.515]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:38<03:39,  5.00s/it, train loss=1.5997, val ΔE00=3.391, best=2.515]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:38<03:39,  5.00s/it, train loss=1.5304, val ΔE00=3.231, best=2.515]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:43<03:33,  4.97s/it, train loss=1.5304, val ΔE00=3.231, best=2.515]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:43<03:33,  4.97s/it, train loss=1.6183, val ΔE00=3.708, best=2.515]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:48<03:27,  4.95s/it, train loss=1.6183, val ΔE00=3.708, best=2.515]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:48<03:27,  4.95s/it, train loss=1.5795, val ΔE00=2.472, best=2.472]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [04:53<03:22,  4.93s/it, train loss=1.5795, val ΔE00=2.472, best=2.472]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [04:53<03:22,  4.93s/it, train loss=1.7296, val ΔE00=3.562, best=2.472]Training (xattn/smallcnn):  60%|██████    | 60/100 [04:58<03:19,  4.98s/it, train loss=1.7296, val ΔE00=3.562, best=2.472]Training (xattn/smallcnn):  60%|██████    | 60/100 [04:58<03:19,  4.98s/it, train loss=1.6575, val ΔE00=2.705, best=2.472]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:03<03:14,  5.00s/it, train loss=1.6575, val ΔE00=2.705, best=2.472]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:03<03:14,  5.00s/it, train loss=1.6419, val ΔE00=2.751, best=2.472]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:08<03:08,  4.97s/it, train loss=1.6419, val ΔE00=2.751, best=2.472]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:08<03:08,  4.97s/it, train loss=1.5357, val ΔE00=2.511, best=2.472]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:13<03:02,  4.95s/it, train loss=1.5357, val ΔE00=2.511, best=2.472]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:13<03:02,  4.95s/it, train loss=1.7153, val ΔE00=2.824, best=2.472]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:18<02:57,  4.93s/it, train loss=1.7153, val ΔE00=2.824, best=2.472]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:18<02:57,  4.93s/it, train loss=1.6192, val ΔE00=2.736, best=2.472]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:23<02:54,  4.98s/it, train loss=1.6192, val ΔE00=2.736, best=2.472]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:23<02:54,  4.98s/it, train loss=1.7236, val ΔE00=2.771, best=2.472]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:28<02:49,  5.00s/it, train loss=1.7236, val ΔE00=2.771, best=2.472]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:28<02:49,  5.00s/it, train loss=1.7139, val ΔE00=3.422, best=2.472]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:33<02:43,  4.97s/it, train loss=1.7139, val ΔE00=3.422, best=2.472]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:33<02:43,  4.97s/it, train loss=1.6870, val ΔE00=2.407, best=2.407]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [05:38<02:38,  4.95s/it, train loss=1.6870, val ΔE00=2.407, best=2.407]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [05:38<02:38,  4.95s/it, train loss=1.6913, val ΔE00=2.970, best=2.407]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [05:42<02:32,  4.93s/it, train loss=1.6913, val ΔE00=2.970, best=2.407]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [05:42<02:32,  4.93s/it, train loss=1.6351, val ΔE00=2.511, best=2.407]Training (xattn/smallcnn):  70%|███████   | 70/100 [05:48<02:29,  4.98s/it, train loss=1.6351, val ΔE00=2.511, best=2.407]Training (xattn/smallcnn):  70%|███████   | 70/100 [05:48<02:29,  4.98s/it, train loss=1.6678, val ΔE00=2.339, best=2.339]Training (xattn/smallcnn):  71%|███████   | 71/100 [05:53<02:24,  5.00s/it, train loss=1.6678, val ΔE00=2.339, best=2.339]Training (xattn/smallcnn):  71%|███████   | 71/100 [05:53<02:24,  5.00s/it, train loss=1.6084, val ΔE00=2.562, best=2.339]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [05:57<02:19,  4.97s/it, train loss=1.6084, val ΔE00=2.562, best=2.339]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [05:57<02:19,  4.97s/it, train loss=1.5665, val ΔE00=2.308, best=2.308]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:02<02:13,  4.94s/it, train loss=1.5665, val ΔE00=2.308, best=2.308]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:02<02:13,  4.94s/it, train loss=1.6483, val ΔE00=2.648, best=2.308]Training (xattn/smallcnn):  74%|███████▍  | 74/100 [06:07<02:08,  4.93s/it, train loss=1.6483, val ΔE00=2.648, best=2.308]Training (xattn/smallcnn):  74%|███████▍  | 74/100 [06:07<02:08,  4.93s/it, train loss=1.6339, val ΔE00=2.965, best=2.308]Training (xattn/smallcnn):  75%|███████▌  | 75/100 [06:12<02:04,  5.00s/it, train loss=1.6339, val ΔE00=2.965, best=2.308]Training (xattn/smallcnn):  75%|███████▌  | 75/100 [06:12<02:04,  5.00s/it, train loss=1.7056, val ΔE00=3.162, best=2.308]Training (xattn/smallcnn):  76%|███████▌  | 76/100 [06:17<01:59,  5.00s/it, train loss=1.7056, val ΔE00=3.162, best=2.308]Training (xattn/smallcnn):  76%|███████▌  | 76/100 [06:17<01:59,  5.00s/it, train loss=1.8133, val ΔE00=2.597, best=2.308]Training (xattn/smallcnn):  77%|███████▋  | 77/100 [06:22<01:54,  4.97s/it, train loss=1.8133, val ΔE00=2.597, best=2.308]Training (xattn/smallcnn):  77%|███████▋  | 77/100 [06:22<01:54,  4.97s/it, train loss=1.7040, val ΔE00=2.487, best=2.308]Training (xattn/smallcnn):  78%|███████▊  | 78/100 [06:27<01:48,  4.95s/it, train loss=1.7040, val ΔE00=2.487, best=2.308]Training (xattn/smallcnn):  78%|███████▊  | 78/100 [06:27<01:48,  4.95s/it, train loss=1.8351, val ΔE00=2.562, best=2.308]Training (xattn/smallcnn):  79%|███████▉  | 79/100 [06:32<01:43,  4.93s/it, train loss=1.8351, val ΔE00=2.562, best=2.308]Training (xattn/smallcnn):  79%|███████▉  | 79/100 [06:32<01:43,  4.93s/it, train loss=1.8711, val ΔE00=2.781, best=2.308]Training (xattn/smallcnn):  80%|████████  | 80/100 [06:37<01:39,  4.99s/it, train loss=1.8711, val ΔE00=2.781, best=2.308]Training (xattn/smallcnn):  80%|████████  | 80/100 [06:37<01:39,  4.99s/it, train loss=1.6926, val ΔE00=2.614, best=2.308]Training (xattn/smallcnn):  81%|████████  | 81/100 [06:42<01:34,  5.00s/it, train loss=1.6926, val ΔE00=2.614, best=2.308]Training (xattn/smallcnn):  81%|████████  | 81/100 [06:42<01:34,  5.00s/it, train loss=1.6675, val ΔE00=3.316, best=2.308]Training (xattn/smallcnn):  81%|████████  | 81/100 [06:47<01:34,  5.00s/it, train loss=1.7001, val ΔE00=2.572, early_stop=yes]Training (xattn/smallcnn):  81%|████████  | 81/100 [06:47<01:35,  5.03s/it, train loss=1.7001, val ΔE00=2.572, early_stop=yes]
[early] stop at epoch 82 (best de00=2.3082 @ 72)
[done] best ΔE00=2.308 over 82 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/xattn__smallcnn__image__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image/final_summary.json (kind=val)
[sweep] === Run 18/24 ===
[sweep] id=018_model=xattn__backbone=smallcnn__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model xattn --backbone smallcnn --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=smallcnn, features=image+mean, meta_encoder=none
[run] model=xattn backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:09,  5.55s/it]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:09,  5.55s/it, train loss=0.0070, val ΔE00=8.417, best=8.417]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:33,  5.24s/it, train loss=0.0070, val ΔE00=8.417, best=8.417]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:33,  5.24s/it, train loss=0.0048, val ΔE00=4.549, best=4.549]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:18,  5.14s/it, train loss=0.0048, val ΔE00=4.549, best=4.549]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:18,  5.14s/it, train loss=0.0083, val ΔE00=4.312, best=4.312]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:08,  5.09s/it, train loss=0.0083, val ΔE00=4.312, best=4.312]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:08,  5.09s/it, train loss=0.0149, val ΔE00=3.779, best=3.779]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<08:08,  5.14s/it, train loss=0.0149, val ΔE00=3.779, best=3.779]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<08:08,  5.14s/it, train loss=0.0219, val ΔE00=3.414, best=3.414]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:30<08:03,  5.15s/it, train loss=0.0219, val ΔE00=3.414, best=3.414]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:30<08:03,  5.15s/it, train loss=0.0329, val ΔE00=3.505, best=3.414]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:36<07:54,  5.11s/it, train loss=0.0329, val ΔE00=3.505, best=3.414]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:36<07:54,  5.11s/it, train loss=0.0419, val ΔE00=3.404, best=3.404]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:41<07:47,  5.08s/it, train loss=0.0419, val ΔE00=3.404, best=3.404]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:41<07:47,  5.08s/it, train loss=0.0541, val ΔE00=2.760, best=2.760]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:46<07:40,  5.06s/it, train loss=0.0541, val ΔE00=2.760, best=2.760]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:46<07:40,  5.06s/it, train loss=0.0640, val ΔE00=2.967, best=2.760]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:40,  5.12s/it, train loss=0.0640, val ΔE00=2.967, best=2.760]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:40,  5.12s/it, train loss=0.0763, val ΔE00=2.481, best=2.481]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:36,  5.13s/it, train loss=0.0763, val ΔE00=2.481, best=2.481]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:36,  5.13s/it, train loss=0.0888, val ΔE00=2.957, best=2.481]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:01<07:27,  5.09s/it, train loss=0.0888, val ΔE00=2.957, best=2.481]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:01<07:27,  5.09s/it, train loss=0.1012, val ΔE00=2.877, best=2.481]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:06<07:20,  5.07s/it, train loss=0.1012, val ΔE00=2.877, best=2.481]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:06<07:20,  5.07s/it, train loss=0.1253, val ΔE00=2.985, best=2.481]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:11<07:14,  5.05s/it, train loss=0.1253, val ΔE00=2.985, best=2.481]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:11<07:14,  5.05s/it, train loss=0.1407, val ΔE00=2.564, best=2.481]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:16<07:14,  5.11s/it, train loss=0.1407, val ΔE00=2.564, best=2.481]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:16<07:14,  5.11s/it, train loss=0.1588, val ΔE00=2.655, best=2.481]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:21<07:10,  5.12s/it, train loss=0.1588, val ΔE00=2.655, best=2.481]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:21<07:10,  5.12s/it, train loss=0.1660, val ΔE00=2.607, best=2.481]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:26<07:02,  5.09s/it, train loss=0.1660, val ΔE00=2.607, best=2.481]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:26<07:02,  5.09s/it, train loss=0.1884, val ΔE00=2.360, best=2.360]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:31<06:55,  5.07s/it, train loss=0.1884, val ΔE00=2.360, best=2.360]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:31<06:55,  5.07s/it, train loss=0.2070, val ΔE00=3.223, best=2.360]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:36<06:49,  5.05s/it, train loss=0.2070, val ΔE00=3.223, best=2.360]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:36<06:49,  5.05s/it, train loss=0.2178, val ΔE00=2.383, best=2.360]Training (xattn/smallcnn):  20%|██        | 20/100 [01:42<06:48,  5.11s/it, train loss=0.2178, val ΔE00=2.383, best=2.360]Training (xattn/smallcnn):  20%|██        | 20/100 [01:42<06:48,  5.11s/it, train loss=0.2528, val ΔE00=2.980, best=2.360]Training (xattn/smallcnn):  21%|██        | 21/100 [01:47<06:44,  5.12s/it, train loss=0.2528, val ΔE00=2.980, best=2.360]Training (xattn/smallcnn):  21%|██        | 21/100 [01:47<06:44,  5.12s/it, train loss=0.2605, val ΔE00=2.433, best=2.360]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:52<06:36,  5.09s/it, train loss=0.2605, val ΔE00=2.433, best=2.360]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:52<06:36,  5.09s/it, train loss=0.2886, val ΔE00=2.216, best=2.216]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:57<06:30,  5.07s/it, train loss=0.2886, val ΔE00=2.216, best=2.216]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:57<06:30,  5.07s/it, train loss=0.3278, val ΔE00=2.377, best=2.216]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:02<06:23,  5.05s/it, train loss=0.3278, val ΔE00=2.377, best=2.216]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:02<06:23,  5.05s/it, train loss=0.3228, val ΔE00=2.080, best=2.080]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:07<06:23,  5.11s/it, train loss=0.3228, val ΔE00=2.080, best=2.080]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:07<06:23,  5.11s/it, train loss=0.3461, val ΔE00=2.272, best=2.080]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:12<06:18,  5.12s/it, train loss=0.3461, val ΔE00=2.272, best=2.080]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:12<06:18,  5.12s/it, train loss=0.3835, val ΔE00=2.076, best=2.076]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:17<06:11,  5.09s/it, train loss=0.3835, val ΔE00=2.076, best=2.076]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:17<06:11,  5.09s/it, train loss=0.3718, val ΔE00=2.074, best=2.074]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:22<06:04,  5.06s/it, train loss=0.3718, val ΔE00=2.074, best=2.074]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:22<06:04,  5.06s/it, train loss=0.4136, val ΔE00=2.492, best=2.074]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:27<05:58,  5.05s/it, train loss=0.4136, val ΔE00=2.492, best=2.074]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:27<05:58,  5.05s/it, train loss=0.4362, val ΔE00=2.521, best=2.074]Training (xattn/smallcnn):  30%|███       | 30/100 [02:33<05:57,  5.11s/it, train loss=0.4362, val ΔE00=2.521, best=2.074]Training (xattn/smallcnn):  30%|███       | 30/100 [02:33<05:57,  5.11s/it, train loss=0.4572, val ΔE00=2.305, best=2.074]Training (xattn/smallcnn):  31%|███       | 31/100 [02:38<05:53,  5.12s/it, train loss=0.4572, val ΔE00=2.305, best=2.074]Training (xattn/smallcnn):  31%|███       | 31/100 [02:38<05:53,  5.12s/it, train loss=0.4591, val ΔE00=2.243, best=2.074]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:43<05:45,  5.08s/it, train loss=0.4591, val ΔE00=2.243, best=2.074]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:43<05:45,  5.08s/it, train loss=0.5138, val ΔE00=2.451, best=2.074]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:48<05:39,  5.06s/it, train loss=0.5138, val ΔE00=2.451, best=2.074]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:48<05:39,  5.06s/it, train loss=0.4967, val ΔE00=2.048, best=2.048]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:53<05:33,  5.05s/it, train loss=0.4967, val ΔE00=2.048, best=2.048]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:53<05:33,  5.05s/it, train loss=0.5225, val ΔE00=2.244, best=2.048]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:58<05:31,  5.10s/it, train loss=0.5225, val ΔE00=2.244, best=2.048]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:58<05:31,  5.10s/it, train loss=0.5066, val ΔE00=2.203, best=2.048]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:03<05:27,  5.12s/it, train loss=0.5066, val ΔE00=2.203, best=2.048]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:03<05:27,  5.12s/it, train loss=0.5488, val ΔE00=1.962, best=1.962]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:08<05:20,  5.09s/it, train loss=0.5488, val ΔE00=1.962, best=1.962]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:08<05:20,  5.09s/it, train loss=0.5869, val ΔE00=2.186, best=1.962]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:13<05:13,  5.06s/it, train loss=0.5869, val ΔE00=2.186, best=1.962]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:13<05:13,  5.06s/it, train loss=0.5909, val ΔE00=2.171, best=1.962]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:18<05:07,  5.05s/it, train loss=0.5909, val ΔE00=2.171, best=1.962]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:18<05:07,  5.05s/it, train loss=0.6178, val ΔE00=1.918, best=1.918]Training (xattn/smallcnn):  40%|████      | 40/100 [03:23<05:07,  5.12s/it, train loss=0.6178, val ΔE00=1.918, best=1.918]Training (xattn/smallcnn):  40%|████      | 40/100 [03:23<05:07,  5.12s/it, train loss=0.6842, val ΔE00=2.374, best=1.918]Training (xattn/smallcnn):  41%|████      | 41/100 [03:29<05:01,  5.11s/it, train loss=0.6842, val ΔE00=2.374, best=1.918]Training (xattn/smallcnn):  41%|████      | 41/100 [03:29<05:01,  5.11s/it, train loss=0.6700, val ΔE00=2.284, best=1.918]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:34<04:54,  5.08s/it, train loss=0.6700, val ΔE00=2.284, best=1.918]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:34<04:54,  5.08s/it, train loss=0.6903, val ΔE00=2.165, best=1.918]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:39<04:48,  5.06s/it, train loss=0.6903, val ΔE00=2.165, best=1.918]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:39<04:48,  5.06s/it, train loss=0.6906, val ΔE00=2.121, best=1.918]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:44<04:42,  5.05s/it, train loss=0.6906, val ΔE00=2.121, best=1.918]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:44<04:42,  5.05s/it, train loss=0.6949, val ΔE00=1.895, best=1.895]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:49<04:40,  5.11s/it, train loss=0.6949, val ΔE00=1.895, best=1.895]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:49<04:40,  5.11s/it, train loss=0.6981, val ΔE00=2.005, best=1.895]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:54<04:36,  5.12s/it, train loss=0.6981, val ΔE00=2.005, best=1.895]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:54<04:36,  5.12s/it, train loss=0.7506, val ΔE00=2.369, best=1.895]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:59<04:29,  5.09s/it, train loss=0.7506, val ΔE00=2.369, best=1.895]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:59<04:29,  5.09s/it, train loss=0.7741, val ΔE00=2.063, best=1.895]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:04<04:24,  5.08s/it, train loss=0.7741, val ΔE00=2.063, best=1.895]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:04<04:24,  5.08s/it, train loss=0.7594, val ΔE00=1.867, best=1.867]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:09<04:18,  5.06s/it, train loss=0.7594, val ΔE00=1.867, best=1.867]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:09<04:18,  5.06s/it, train loss=0.7711, val ΔE00=2.035, best=1.867]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:14<04:15,  5.12s/it, train loss=0.7711, val ΔE00=2.035, best=1.867]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:14<04:15,  5.12s/it, train loss=0.7894, val ΔE00=2.078, best=1.867]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:19<04:11,  5.13s/it, train loss=0.7894, val ΔE00=2.078, best=1.867]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:19<04:11,  5.13s/it, train loss=0.7740, val ΔE00=2.179, best=1.867]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:24<04:04,  5.09s/it, train loss=0.7740, val ΔE00=2.179, best=1.867]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:24<04:04,  5.09s/it, train loss=0.8615, val ΔE00=2.236, best=1.867]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:29<03:58,  5.07s/it, train loss=0.8615, val ΔE00=2.236, best=1.867]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:29<03:58,  5.07s/it, train loss=0.8047, val ΔE00=2.069, best=1.867]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:34<03:52,  5.06s/it, train loss=0.8047, val ΔE00=2.069, best=1.867]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:34<03:52,  5.06s/it, train loss=0.8021, val ΔE00=2.082, best=1.867]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:40<03:50,  5.11s/it, train loss=0.8021, val ΔE00=2.082, best=1.867]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:40<03:50,  5.11s/it, train loss=0.7838, val ΔE00=1.921, best=1.867]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:45<03:45,  5.13s/it, train loss=0.7838, val ΔE00=1.921, best=1.867]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:45<03:45,  5.13s/it, train loss=0.8157, val ΔE00=2.038, best=1.867]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:50<03:39,  5.10s/it, train loss=0.8157, val ΔE00=2.038, best=1.867]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:50<03:39,  5.10s/it, train loss=0.7966, val ΔE00=2.145, best=1.867]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:55<03:33,  5.08s/it, train loss=0.7966, val ΔE00=2.145, best=1.867]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:55<03:33,  5.08s/it, train loss=0.8037, val ΔE00=2.123, best=1.867]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:00<03:27,  5.06s/it, train loss=0.8037, val ΔE00=2.123, best=1.867]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:00<03:27,  5.06s/it, train loss=0.8621, val ΔE00=1.821, best=1.821]Training (xattn/smallcnn):  60%|██████    | 60/100 [05:05<03:24,  5.12s/it, train loss=0.8621, val ΔE00=1.821, best=1.821]Training (xattn/smallcnn):  60%|██████    | 60/100 [05:05<03:24,  5.12s/it, train loss=0.8105, val ΔE00=1.952, best=1.821]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:10<03:19,  5.12s/it, train loss=0.8105, val ΔE00=1.952, best=1.821]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:10<03:19,  5.12s/it, train loss=0.8831, val ΔE00=2.062, best=1.821]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:15<03:13,  5.09s/it, train loss=0.8831, val ΔE00=2.062, best=1.821]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:15<03:13,  5.09s/it, train loss=0.9102, val ΔE00=1.974, best=1.821]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:20<03:07,  5.07s/it, train loss=0.9102, val ΔE00=1.974, best=1.821]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:20<03:07,  5.07s/it, train loss=0.9335, val ΔE00=2.174, best=1.821]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:25<03:01,  5.05s/it, train loss=0.9335, val ΔE00=2.174, best=1.821]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:25<03:01,  5.05s/it, train loss=0.8571, val ΔE00=1.970, best=1.821]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:31<02:58,  5.10s/it, train loss=0.8571, val ΔE00=1.970, best=1.821]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:31<02:58,  5.10s/it, train loss=0.8438, val ΔE00=1.982, best=1.821]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:36<02:53,  5.12s/it, train loss=0.8438, val ΔE00=1.982, best=1.821]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:36<02:53,  5.12s/it, train loss=0.8871, val ΔE00=2.288, best=1.821]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:41<02:47,  5.09s/it, train loss=0.8871, val ΔE00=2.288, best=1.821]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:41<02:47,  5.09s/it, train loss=0.9132, val ΔE00=1.797, best=1.797]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [05:46<02:42,  5.07s/it, train loss=0.9132, val ΔE00=1.797, best=1.797]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [05:46<02:42,  5.07s/it, train loss=0.8760, val ΔE00=1.905, best=1.797]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [05:51<02:36,  5.06s/it, train loss=0.8760, val ΔE00=1.905, best=1.797]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [05:51<02:36,  5.06s/it, train loss=0.8790, val ΔE00=1.954, best=1.797]Training (xattn/smallcnn):  70%|███████   | 70/100 [05:56<02:33,  5.13s/it, train loss=0.8790, val ΔE00=1.954, best=1.797]Training (xattn/smallcnn):  70%|███████   | 70/100 [05:56<02:33,  5.13s/it, train loss=0.8701, val ΔE00=1.874, best=1.797]Training (xattn/smallcnn):  71%|███████   | 71/100 [06:01<02:28,  5.12s/it, train loss=0.8701, val ΔE00=1.874, best=1.797]Training (xattn/smallcnn):  71%|███████   | 71/100 [06:01<02:28,  5.12s/it, train loss=0.8181, val ΔE00=2.103, best=1.797]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:06<02:22,  5.09s/it, train loss=0.8181, val ΔE00=2.103, best=1.797]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:06<02:22,  5.09s/it, train loss=0.8296, val ΔE00=1.901, best=1.797]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:11<02:16,  5.07s/it, train loss=0.8296, val ΔE00=1.901, best=1.797]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:11<02:16,  5.07s/it, train loss=0.8329, val ΔE00=2.048, best=1.797]Training (xattn/smallcnn):  74%|███████▍  | 74/100 [06:16<02:11,  5.05s/it, train loss=0.8329, val ΔE00=2.048, best=1.797]Training (xattn/smallcnn):  74%|███████▍  | 74/100 [06:16<02:11,  5.05s/it, train loss=0.8263, val ΔE00=2.084, best=1.797]Training (xattn/smallcnn):  75%|███████▌  | 75/100 [06:22<02:07,  5.11s/it, train loss=0.8263, val ΔE00=2.084, best=1.797]Training (xattn/smallcnn):  75%|███████▌  | 75/100 [06:22<02:07,  5.11s/it, train loss=0.8516, val ΔE00=2.000, best=1.797]Training (xattn/smallcnn):  76%|███████▌  | 76/100 [06:27<02:02,  5.12s/it, train loss=0.8516, val ΔE00=2.000, best=1.797]Training (xattn/smallcnn):  76%|███████▌  | 76/100 [06:27<02:02,  5.12s/it, train loss=0.8511, val ΔE00=2.000, best=1.797]Training (xattn/smallcnn):  76%|███████▌  | 76/100 [06:32<02:02,  5.12s/it, train loss=0.8142, val ΔE00=1.870, early_stop=yes]Training (xattn/smallcnn):  76%|███████▌  | 76/100 [06:32<02:03,  5.16s/it, train loss=0.8142, val ΔE00=1.870, early_stop=yes]
[early] stop at epoch 77 (best de00=1.7966 @ 67)
[done] best ΔE00=1.797 over 77 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/xattn__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 19/24 ===
[sweep] id=019_model=xattn__backbone=smallcnn__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model xattn --backbone smallcnn --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=smallcnn, features=image+meta, meta_encoder=none
[run] model=xattn backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:08,  5.54s/it]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:08,  5.54s/it, train loss=0.0112, val ΔE00=10.764, best=10.764]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:33,  5.24s/it, train loss=0.0112, val ΔE00=10.764, best=10.764]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:33,  5.24s/it, train loss=0.0080, val ΔE00=6.218, best=6.218]  Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:18,  5.14s/it, train loss=0.0080, val ΔE00=6.218, best=6.218]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:18,  5.14s/it, train loss=0.0131, val ΔE00=5.133, best=5.133]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:09,  5.10s/it, train loss=0.0131, val ΔE00=5.133, best=5.133]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:09,  5.10s/it, train loss=0.0180, val ΔE00=4.242, best=4.242]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<08:10,  5.16s/it, train loss=0.0180, val ΔE00=4.242, best=4.242]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<08:10,  5.16s/it, train loss=0.0292, val ΔE00=4.183, best=4.183]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:31<08:04,  5.16s/it, train loss=0.0292, val ΔE00=4.183, best=4.183]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:31<08:04,  5.16s/it, train loss=0.0383, val ΔE00=3.629, best=3.629]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:36<07:55,  5.11s/it, train loss=0.0383, val ΔE00=3.629, best=3.629]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:36<07:55,  5.11s/it, train loss=0.0505, val ΔE00=4.918, best=3.629]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:41<07:47,  5.08s/it, train loss=0.0505, val ΔE00=4.918, best=3.629]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:41<07:47,  5.08s/it, train loss=0.0650, val ΔE00=4.315, best=3.629]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:46<07:41,  5.07s/it, train loss=0.0650, val ΔE00=4.315, best=3.629]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:46<07:41,  5.07s/it, train loss=0.0827, val ΔE00=3.414, best=3.414]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:41,  5.13s/it, train loss=0.0827, val ΔE00=3.414, best=3.414]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:41,  5.13s/it, train loss=0.0972, val ΔE00=3.311, best=3.311]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:37,  5.14s/it, train loss=0.0972, val ΔE00=3.311, best=3.311]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:37,  5.14s/it, train loss=0.1142, val ΔE00=3.444, best=3.311]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:01<07:29,  5.11s/it, train loss=0.1142, val ΔE00=3.444, best=3.311]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:01<07:29,  5.11s/it, train loss=0.1334, val ΔE00=3.495, best=3.311]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:06<07:22,  5.09s/it, train loss=0.1334, val ΔE00=3.495, best=3.311]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:06<07:22,  5.09s/it, train loss=0.1457, val ΔE00=3.128, best=3.128]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:11<07:15,  5.07s/it, train loss=0.1457, val ΔE00=3.128, best=3.128]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:11<07:15,  5.07s/it, train loss=0.1843, val ΔE00=3.347, best=3.128]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:16<07:15,  5.13s/it, train loss=0.1843, val ΔE00=3.347, best=3.128]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:16<07:15,  5.13s/it, train loss=0.1882, val ΔE00=3.043, best=3.043]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:22<07:11,  5.14s/it, train loss=0.1882, val ΔE00=3.043, best=3.043]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:22<07:11,  5.14s/it, train loss=0.2016, val ΔE00=2.949, best=2.949]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:27<07:03,  5.11s/it, train loss=0.2016, val ΔE00=2.949, best=2.949]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:27<07:03,  5.11s/it, train loss=0.2222, val ΔE00=2.814, best=2.814]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:32<06:56,  5.08s/it, train loss=0.2222, val ΔE00=2.814, best=2.814]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:32<06:56,  5.08s/it, train loss=0.2522, val ΔE00=3.760, best=2.814]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:37<06:50,  5.07s/it, train loss=0.2522, val ΔE00=3.760, best=2.814]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:37<06:50,  5.07s/it, train loss=0.2780, val ΔE00=2.521, best=2.521]Training (xattn/smallcnn):  20%|██        | 20/100 [01:42<06:50,  5.14s/it, train loss=0.2780, val ΔE00=2.521, best=2.521]Training (xattn/smallcnn):  20%|██        | 20/100 [01:42<06:50,  5.14s/it, train loss=0.2994, val ΔE00=3.471, best=2.521]Training (xattn/smallcnn):  21%|██        | 21/100 [01:47<06:45,  5.13s/it, train loss=0.2994, val ΔE00=3.471, best=2.521]Training (xattn/smallcnn):  21%|██        | 21/100 [01:47<06:45,  5.13s/it, train loss=0.3360, val ΔE00=2.812, best=2.521]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:52<06:37,  5.10s/it, train loss=0.3360, val ΔE00=2.812, best=2.521]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:52<06:37,  5.10s/it, train loss=0.3415, val ΔE00=2.940, best=2.521]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:57<06:31,  5.08s/it, train loss=0.3415, val ΔE00=2.940, best=2.521]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:57<06:31,  5.08s/it, train loss=0.3663, val ΔE00=2.420, best=2.420]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:02<06:24,  5.06s/it, train loss=0.3663, val ΔE00=2.420, best=2.420]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:02<06:24,  5.06s/it, train loss=0.3836, val ΔE00=3.293, best=2.420]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:07<06:25,  5.14s/it, train loss=0.3836, val ΔE00=3.293, best=2.420]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:08<06:25,  5.14s/it, train loss=0.4368, val ΔE00=2.574, best=2.420]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:13<06:19,  5.13s/it, train loss=0.4368, val ΔE00=2.574, best=2.420]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:13<06:19,  5.13s/it, train loss=0.4512, val ΔE00=2.407, best=2.407]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:18<06:11,  5.10s/it, train loss=0.4512, val ΔE00=2.407, best=2.407]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:18<06:11,  5.10s/it, train loss=0.4773, val ΔE00=2.683, best=2.407]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:23<06:05,  5.08s/it, train loss=0.4773, val ΔE00=2.683, best=2.407]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:23<06:05,  5.08s/it, train loss=0.5339, val ΔE00=2.670, best=2.407]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:28<05:59,  5.06s/it, train loss=0.5339, val ΔE00=2.670, best=2.407]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:28<05:59,  5.06s/it, train loss=0.5382, val ΔE00=2.695, best=2.407]Training (xattn/smallcnn):  30%|███       | 30/100 [02:33<05:57,  5.11s/it, train loss=0.5382, val ΔE00=2.695, best=2.407]Training (xattn/smallcnn):  30%|███       | 30/100 [02:33<05:57,  5.11s/it, train loss=0.5472, val ΔE00=2.632, best=2.407]Training (xattn/smallcnn):  31%|███       | 31/100 [02:38<05:53,  5.13s/it, train loss=0.5472, val ΔE00=2.632, best=2.407]Training (xattn/smallcnn):  31%|███       | 31/100 [02:38<05:53,  5.13s/it, train loss=0.5845, val ΔE00=2.408, best=2.407]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:43<05:46,  5.10s/it, train loss=0.5845, val ΔE00=2.408, best=2.407]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:43<05:46,  5.10s/it, train loss=0.6255, val ΔE00=2.654, best=2.407]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:48<05:39,  5.07s/it, train loss=0.6255, val ΔE00=2.654, best=2.407]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:48<05:39,  5.07s/it, train loss=0.6358, val ΔE00=2.326, best=2.326]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:53<05:33,  5.06s/it, train loss=0.6358, val ΔE00=2.326, best=2.326]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:53<05:33,  5.06s/it, train loss=0.6578, val ΔE00=2.586, best=2.326]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:58<05:32,  5.12s/it, train loss=0.6578, val ΔE00=2.586, best=2.326]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:58<05:32,  5.12s/it, train loss=0.7217, val ΔE00=2.705, best=2.326]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:04<05:28,  5.13s/it, train loss=0.7217, val ΔE00=2.705, best=2.326]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:04<05:28,  5.13s/it, train loss=0.7644, val ΔE00=2.869, best=2.326]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:09<05:21,  5.10s/it, train loss=0.7644, val ΔE00=2.869, best=2.326]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:09<05:21,  5.10s/it, train loss=0.7833, val ΔE00=3.077, best=2.326]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:14<05:14,  5.08s/it, train loss=0.7833, val ΔE00=3.077, best=2.326]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:14<05:14,  5.08s/it, train loss=0.7939, val ΔE00=2.136, best=2.136]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:19<05:08,  5.06s/it, train loss=0.7939, val ΔE00=2.136, best=2.136]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:19<05:08,  5.06s/it, train loss=0.7640, val ΔE00=2.613, best=2.136]Training (xattn/smallcnn):  40%|████      | 40/100 [03:24<05:06,  5.11s/it, train loss=0.7640, val ΔE00=2.613, best=2.136]Training (xattn/smallcnn):  40%|████      | 40/100 [03:24<05:06,  5.11s/it, train loss=0.8117, val ΔE00=2.433, best=2.136]Training (xattn/smallcnn):  41%|████      | 41/100 [03:29<05:02,  5.13s/it, train loss=0.8117, val ΔE00=2.433, best=2.136]Training (xattn/smallcnn):  41%|████      | 41/100 [03:29<05:02,  5.13s/it, train loss=0.8445, val ΔE00=2.519, best=2.136]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:34<04:55,  5.10s/it, train loss=0.8445, val ΔE00=2.519, best=2.136]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:34<04:55,  5.10s/it, train loss=0.8766, val ΔE00=2.680, best=2.136]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:39<04:49,  5.07s/it, train loss=0.8766, val ΔE00=2.680, best=2.136]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:39<04:49,  5.07s/it, train loss=0.9392, val ΔE00=2.364, best=2.136]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:44<04:43,  5.06s/it, train loss=0.9392, val ΔE00=2.364, best=2.136]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:44<04:43,  5.06s/it, train loss=0.9361, val ΔE00=2.280, best=2.136]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:49<04:41,  5.12s/it, train loss=0.9361, val ΔE00=2.280, best=2.136]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:49<04:41,  5.12s/it, train loss=0.9225, val ΔE00=2.389, best=2.136]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:54<04:36,  5.12s/it, train loss=0.9225, val ΔE00=2.389, best=2.136]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:54<04:36,  5.12s/it, train loss=0.9635, val ΔE00=2.208, best=2.136]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:59<04:29,  5.09s/it, train loss=0.9635, val ΔE00=2.208, best=2.136]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:59<04:29,  5.09s/it, train loss=1.0138, val ΔE00=2.315, best=2.136]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:05<04:23,  5.07s/it, train loss=1.0138, val ΔE00=2.315, best=2.136]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:05<04:23,  5.07s/it, train loss=1.0274, val ΔE00=2.719, best=2.136]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:10<04:17,  5.06s/it, train loss=1.0274, val ΔE00=2.719, best=2.136]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:10<04:17,  5.06s/it, train loss=0.9529, val ΔE00=2.816, best=2.136]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:15<04:16,  5.13s/it, train loss=0.9529, val ΔE00=2.816, best=2.136]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:15<04:16,  5.13s/it, train loss=1.0615, val ΔE00=3.144, best=2.136]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:20<04:10,  5.12s/it, train loss=1.0615, val ΔE00=3.144, best=2.136]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:20<04:10,  5.12s/it, train loss=1.0968, val ΔE00=2.490, best=2.136]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:25<04:04,  5.09s/it, train loss=1.0968, val ΔE00=2.490, best=2.136]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:25<04:04,  5.09s/it, train loss=1.1169, val ΔE00=3.030, best=2.136]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:30<03:58,  5.07s/it, train loss=1.1169, val ΔE00=3.030, best=2.136]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:30<03:58,  5.07s/it, train loss=1.1631, val ΔE00=2.407, best=2.136]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:35<03:52,  5.05s/it, train loss=1.1631, val ΔE00=2.407, best=2.136]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:35<03:52,  5.05s/it, train loss=1.0816, val ΔE00=2.109, best=2.109]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:40<03:49,  5.11s/it, train loss=1.0816, val ΔE00=2.109, best=2.109]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:40<03:49,  5.11s/it, train loss=1.1039, val ΔE00=2.465, best=2.109]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:45<03:45,  5.12s/it, train loss=1.1039, val ΔE00=2.465, best=2.109]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:45<03:45,  5.12s/it, train loss=1.1179, val ΔE00=2.261, best=2.109]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:50<03:38,  5.09s/it, train loss=1.1179, val ΔE00=2.261, best=2.109]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:50<03:38,  5.09s/it, train loss=1.1122, val ΔE00=2.350, best=2.109]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:55<03:32,  5.07s/it, train loss=1.1122, val ΔE00=2.350, best=2.109]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:55<03:32,  5.07s/it, train loss=1.0852, val ΔE00=2.511, best=2.109]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:00<03:27,  5.05s/it, train loss=1.0852, val ΔE00=2.511, best=2.109]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:00<03:27,  5.05s/it, train loss=1.1627, val ΔE00=2.363, best=2.109]Training (xattn/smallcnn):  60%|██████    | 60/100 [05:06<03:24,  5.11s/it, train loss=1.1627, val ΔE00=2.363, best=2.109]Training (xattn/smallcnn):  60%|██████    | 60/100 [05:06<03:24,  5.11s/it, train loss=1.1784, val ΔE00=2.528, best=2.109]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:11<03:19,  5.13s/it, train loss=1.1784, val ΔE00=2.528, best=2.109]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:11<03:19,  5.13s/it, train loss=1.1765, val ΔE00=2.349, best=2.109]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:16<03:13,  5.10s/it, train loss=1.1765, val ΔE00=2.349, best=2.109]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:16<03:13,  5.10s/it, train loss=1.2543, val ΔE00=2.556, best=2.109]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:21<03:07,  5.07s/it, train loss=1.2543, val ΔE00=2.556, best=2.109]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:21<03:07,  5.07s/it, train loss=1.3024, val ΔE00=2.449, best=2.109]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:26<03:02,  5.06s/it, train loss=1.3024, val ΔE00=2.449, best=2.109]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:26<03:02,  5.06s/it, train loss=1.2290, val ΔE00=1.961, best=1.961]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:31<02:59,  5.12s/it, train loss=1.2290, val ΔE00=1.961, best=1.961]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:31<02:59,  5.12s/it, train loss=1.2101, val ΔE00=2.583, best=1.961]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:36<02:54,  5.13s/it, train loss=1.2101, val ΔE00=2.583, best=1.961]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:36<02:54,  5.13s/it, train loss=1.1824, val ΔE00=2.291, best=1.961]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:41<02:48,  5.10s/it, train loss=1.1824, val ΔE00=2.291, best=1.961]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:41<02:48,  5.10s/it, train loss=1.2033, val ΔE00=2.108, best=1.961]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [05:46<02:42,  5.08s/it, train loss=1.2033, val ΔE00=2.108, best=1.961]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [05:46<02:42,  5.08s/it, train loss=1.2413, val ΔE00=2.191, best=1.961]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [05:51<02:36,  5.06s/it, train loss=1.2413, val ΔE00=2.191, best=1.961]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [05:51<02:36,  5.06s/it, train loss=1.2998, val ΔE00=2.356, best=1.961]Training (xattn/smallcnn):  70%|███████   | 70/100 [05:57<02:33,  5.11s/it, train loss=1.2998, val ΔE00=2.356, best=1.961]Training (xattn/smallcnn):  70%|███████   | 70/100 [05:57<02:33,  5.11s/it, train loss=1.2041, val ΔE00=2.462, best=1.961]Training (xattn/smallcnn):  71%|███████   | 71/100 [06:02<02:28,  5.13s/it, train loss=1.2041, val ΔE00=2.462, best=1.961]Training (xattn/smallcnn):  71%|███████   | 71/100 [06:02<02:28,  5.13s/it, train loss=1.1744, val ΔE00=2.264, best=1.961]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:07<02:22,  5.10s/it, train loss=1.1744, val ΔE00=2.264, best=1.961]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:07<02:22,  5.10s/it, train loss=1.2515, val ΔE00=2.215, best=1.961]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:12<02:16,  5.07s/it, train loss=1.2515, val ΔE00=2.215, best=1.961]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:12<02:16,  5.07s/it, train loss=1.1408, val ΔE00=2.149, best=1.961]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:17<02:16,  5.07s/it, train loss=1.1903, val ΔE00=2.443, early_stop=yes]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:17<02:19,  5.17s/it, train loss=1.1903, val ΔE00=2.443, early_stop=yes]
[early] stop at epoch 74 (best de00=1.9614 @ 64)
[done] best ΔE00=1.961 over 74 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/xattn__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 20/24 ===
[sweep] id=020_model=xattn__backbone=smallcnn__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model xattn --backbone smallcnn --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=smallcnn, features=image+mean+meta, meta_encoder=none
[run] model=xattn backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:07,  5.53s/it]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:07,  5.53s/it, train loss=0.0074, val ΔE00=9.582, best=9.582]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:32,  5.23s/it, train loss=0.0074, val ΔE00=9.582, best=9.582]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:32,  5.23s/it, train loss=0.0045, val ΔE00=5.012, best=5.012]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:18,  5.14s/it, train loss=0.0045, val ΔE00=5.012, best=5.012]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:18,  5.14s/it, train loss=0.0083, val ΔE00=3.832, best=3.832]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:09,  5.10s/it, train loss=0.0083, val ΔE00=3.832, best=3.832]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:09,  5.10s/it, train loss=0.0155, val ΔE00=4.754, best=3.832]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<08:09,  5.15s/it, train loss=0.0155, val ΔE00=4.754, best=3.832]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<08:09,  5.15s/it, train loss=0.0206, val ΔE00=3.400, best=3.400]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:31<08:04,  5.16s/it, train loss=0.0206, val ΔE00=3.400, best=3.400]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:31<08:04,  5.16s/it, train loss=0.0301, val ΔE00=4.234, best=3.400]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:36<07:55,  5.11s/it, train loss=0.0301, val ΔE00=4.234, best=3.400]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:36<07:55,  5.11s/it, train loss=0.0416, val ΔE00=3.535, best=3.400]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:41<07:47,  5.08s/it, train loss=0.0416, val ΔE00=3.535, best=3.400]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:41<07:47,  5.08s/it, train loss=0.0519, val ΔE00=3.535, best=3.400]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:46<07:41,  5.07s/it, train loss=0.0519, val ΔE00=3.535, best=3.400]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:46<07:41,  5.07s/it, train loss=0.0666, val ΔE00=3.857, best=3.400]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:41,  5.12s/it, train loss=0.0666, val ΔE00=3.857, best=3.400]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:41,  5.12s/it, train loss=0.0772, val ΔE00=3.121, best=3.121]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:37,  5.14s/it, train loss=0.0772, val ΔE00=3.121, best=3.121]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:37,  5.14s/it, train loss=0.0871, val ΔE00=3.081, best=3.081]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:01<07:29,  5.11s/it, train loss=0.0871, val ΔE00=3.081, best=3.081]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:01<07:29,  5.11s/it, train loss=0.1092, val ΔE00=2.421, best=2.421]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:06<07:22,  5.08s/it, train loss=0.1092, val ΔE00=2.421, best=2.421]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:06<07:22,  5.08s/it, train loss=0.1233, val ΔE00=2.274, best=2.274]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:11<07:15,  5.07s/it, train loss=0.1233, val ΔE00=2.274, best=2.274]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:11<07:15,  5.07s/it, train loss=0.1320, val ΔE00=2.402, best=2.274]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:16<07:15,  5.12s/it, train loss=0.1320, val ΔE00=2.402, best=2.274]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:16<07:15,  5.12s/it, train loss=0.1440, val ΔE00=2.733, best=2.274]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:22<07:11,  5.13s/it, train loss=0.1440, val ΔE00=2.733, best=2.274]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:22<07:11,  5.13s/it, train loss=0.1657, val ΔE00=2.810, best=2.274]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:27<07:03,  5.10s/it, train loss=0.1657, val ΔE00=2.810, best=2.274]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:27<07:03,  5.10s/it, train loss=0.1791, val ΔE00=2.391, best=2.274]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:32<06:56,  5.08s/it, train loss=0.1791, val ΔE00=2.391, best=2.274]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:32<06:56,  5.08s/it, train loss=0.1995, val ΔE00=2.232, best=2.232]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:37<06:50,  5.06s/it, train loss=0.1995, val ΔE00=2.232, best=2.232]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:37<06:50,  5.06s/it, train loss=0.2225, val ΔE00=2.696, best=2.232]Training (xattn/smallcnn):  20%|██        | 20/100 [01:42<06:49,  5.12s/it, train loss=0.2225, val ΔE00=2.696, best=2.232]Training (xattn/smallcnn):  20%|██        | 20/100 [01:42<06:49,  5.12s/it, train loss=0.2284, val ΔE00=2.504, best=2.232]Training (xattn/smallcnn):  21%|██        | 21/100 [01:47<06:45,  5.13s/it, train loss=0.2284, val ΔE00=2.504, best=2.232]Training (xattn/smallcnn):  21%|██        | 21/100 [01:47<06:45,  5.13s/it, train loss=0.2549, val ΔE00=2.329, best=2.232]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:52<06:37,  5.10s/it, train loss=0.2549, val ΔE00=2.329, best=2.232]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:52<06:37,  5.10s/it, train loss=0.2630, val ΔE00=2.029, best=2.029]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:57<06:30,  5.08s/it, train loss=0.2630, val ΔE00=2.029, best=2.029]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:57<06:30,  5.08s/it, train loss=0.2837, val ΔE00=2.158, best=2.029]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:02<06:24,  5.06s/it, train loss=0.2837, val ΔE00=2.158, best=2.029]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:02<06:24,  5.06s/it, train loss=0.2936, val ΔE00=2.185, best=2.029]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:07<06:25,  5.14s/it, train loss=0.2936, val ΔE00=2.185, best=2.029]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:07<06:25,  5.14s/it, train loss=0.3331, val ΔE00=2.179, best=2.029]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:13<06:19,  5.13s/it, train loss=0.3331, val ΔE00=2.179, best=2.029]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:13<06:19,  5.13s/it, train loss=0.3494, val ΔE00=2.406, best=2.029]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:18<06:12,  5.10s/it, train loss=0.3494, val ΔE00=2.406, best=2.029]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:18<06:12,  5.10s/it, train loss=0.3704, val ΔE00=2.160, best=2.029]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:23<06:05,  5.08s/it, train loss=0.3704, val ΔE00=2.160, best=2.029]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:23<06:05,  5.08s/it, train loss=0.4115, val ΔE00=2.546, best=2.029]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:28<05:59,  5.06s/it, train loss=0.4115, val ΔE00=2.546, best=2.029]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:28<05:59,  5.06s/it, train loss=0.4156, val ΔE00=1.973, best=1.973]Training (xattn/smallcnn):  30%|███       | 30/100 [02:33<05:59,  5.14s/it, train loss=0.4156, val ΔE00=1.973, best=1.973]Training (xattn/smallcnn):  30%|███       | 30/100 [02:33<05:59,  5.14s/it, train loss=0.4333, val ΔE00=2.132, best=1.973]Training (xattn/smallcnn):  31%|███       | 31/100 [02:38<05:53,  5.13s/it, train loss=0.4333, val ΔE00=2.132, best=1.973]Training (xattn/smallcnn):  31%|███       | 31/100 [02:38<05:53,  5.13s/it, train loss=0.4528, val ΔE00=2.309, best=1.973]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:43<05:46,  5.10s/it, train loss=0.4528, val ΔE00=2.309, best=1.973]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:43<05:46,  5.10s/it, train loss=0.4671, val ΔE00=2.192, best=1.973]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:48<05:40,  5.08s/it, train loss=0.4671, val ΔE00=2.192, best=1.973]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:48<05:40,  5.08s/it, train loss=0.4868, val ΔE00=2.585, best=1.973]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:53<05:34,  5.07s/it, train loss=0.4868, val ΔE00=2.585, best=1.973]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:53<05:34,  5.07s/it, train loss=0.5358, val ΔE00=1.944, best=1.944]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:58<05:33,  5.12s/it, train loss=0.5358, val ΔE00=1.944, best=1.944]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:58<05:33,  5.12s/it, train loss=0.4966, val ΔE00=2.439, best=1.944]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:04<05:28,  5.13s/it, train loss=0.4966, val ΔE00=2.439, best=1.944]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:04<05:28,  5.13s/it, train loss=0.5521, val ΔE00=2.303, best=1.944]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:09<05:21,  5.10s/it, train loss=0.5521, val ΔE00=2.303, best=1.944]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:09<05:21,  5.10s/it, train loss=0.5807, val ΔE00=2.142, best=1.944]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:14<05:14,  5.08s/it, train loss=0.5807, val ΔE00=2.142, best=1.944]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:14<05:14,  5.08s/it, train loss=0.5828, val ΔE00=1.859, best=1.859]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:19<05:08,  5.06s/it, train loss=0.5828, val ΔE00=1.859, best=1.859]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:19<05:08,  5.06s/it, train loss=0.6274, val ΔE00=1.928, best=1.859]Training (xattn/smallcnn):  40%|████      | 40/100 [03:24<05:07,  5.12s/it, train loss=0.6274, val ΔE00=1.928, best=1.859]Training (xattn/smallcnn):  40%|████      | 40/100 [03:24<05:07,  5.12s/it, train loss=0.6274, val ΔE00=2.074, best=1.859]Training (xattn/smallcnn):  41%|████      | 41/100 [03:29<05:02,  5.13s/it, train loss=0.6274, val ΔE00=2.074, best=1.859]Training (xattn/smallcnn):  41%|████      | 41/100 [03:29<05:02,  5.13s/it, train loss=0.6198, val ΔE00=1.834, best=1.834]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:34<04:55,  5.10s/it, train loss=0.6198, val ΔE00=1.834, best=1.834]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:34<04:55,  5.10s/it, train loss=0.6655, val ΔE00=1.902, best=1.834]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:39<04:49,  5.08s/it, train loss=0.6655, val ΔE00=1.902, best=1.834]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:39<04:49,  5.08s/it, train loss=0.6650, val ΔE00=1.932, best=1.834]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:44<04:43,  5.06s/it, train loss=0.6650, val ΔE00=1.932, best=1.834]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:44<04:43,  5.06s/it, train loss=0.6523, val ΔE00=1.930, best=1.834]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:49<04:41,  5.12s/it, train loss=0.6523, val ΔE00=1.930, best=1.834]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:49<04:41,  5.12s/it, train loss=0.6775, val ΔE00=1.917, best=1.834]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:55<04:36,  5.13s/it, train loss=0.6775, val ΔE00=1.917, best=1.834]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:55<04:36,  5.13s/it, train loss=0.7361, val ΔE00=2.051, best=1.834]Training (xattn/smallcnn):  47%|████▋     | 47/100 [04:00<04:29,  5.09s/it, train loss=0.7361, val ΔE00=2.051, best=1.834]Training (xattn/smallcnn):  47%|████▋     | 47/100 [04:00<04:29,  5.09s/it, train loss=0.7273, val ΔE00=2.163, best=1.834]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:05<04:23,  5.07s/it, train loss=0.7273, val ΔE00=2.163, best=1.834]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:05<04:23,  5.07s/it, train loss=0.7470, val ΔE00=1.798, best=1.798]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:10<04:17,  5.06s/it, train loss=0.7470, val ΔE00=1.798, best=1.798]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:10<04:17,  5.06s/it, train loss=0.7349, val ΔE00=2.086, best=1.798]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:15<04:16,  5.12s/it, train loss=0.7349, val ΔE00=2.086, best=1.798]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:15<04:16,  5.12s/it, train loss=0.7345, val ΔE00=1.827, best=1.798]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:20<04:11,  5.13s/it, train loss=0.7345, val ΔE00=1.827, best=1.798]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:20<04:11,  5.13s/it, train loss=0.7327, val ΔE00=2.073, best=1.798]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:25<04:04,  5.10s/it, train loss=0.7327, val ΔE00=2.073, best=1.798]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:25<04:04,  5.10s/it, train loss=0.7306, val ΔE00=1.938, best=1.798]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:30<03:58,  5.08s/it, train loss=0.7306, val ΔE00=1.938, best=1.798]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:30<03:58,  5.08s/it, train loss=0.8034, val ΔE00=2.022, best=1.798]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:35<03:52,  5.06s/it, train loss=0.8034, val ΔE00=2.022, best=1.798]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:35<03:52,  5.06s/it, train loss=0.7774, val ΔE00=1.856, best=1.798]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:40<03:50,  5.12s/it, train loss=0.7774, val ΔE00=1.856, best=1.798]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:40<03:50,  5.12s/it, train loss=0.8210, val ΔE00=1.749, best=1.749]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:46<03:45,  5.13s/it, train loss=0.8210, val ΔE00=1.749, best=1.749]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:46<03:45,  5.13s/it, train loss=0.8202, val ΔE00=1.878, best=1.749]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:51<03:39,  5.10s/it, train loss=0.8202, val ΔE00=1.878, best=1.749]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:51<03:39,  5.10s/it, train loss=0.7808, val ΔE00=2.064, best=1.749]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:56<03:33,  5.08s/it, train loss=0.7808, val ΔE00=2.064, best=1.749]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:56<03:33,  5.08s/it, train loss=0.7818, val ΔE00=2.049, best=1.749]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:01<03:27,  5.07s/it, train loss=0.7818, val ΔE00=2.049, best=1.749]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:01<03:27,  5.07s/it, train loss=0.8371, val ΔE00=2.059, best=1.749]Training (xattn/smallcnn):  60%|██████    | 60/100 [05:06<03:24,  5.12s/it, train loss=0.8371, val ΔE00=2.059, best=1.749]Training (xattn/smallcnn):  60%|██████    | 60/100 [05:06<03:24,  5.12s/it, train loss=0.8440, val ΔE00=1.992, best=1.749]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:11<03:20,  5.14s/it, train loss=0.8440, val ΔE00=1.992, best=1.749]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:11<03:20,  5.14s/it, train loss=0.8483, val ΔE00=1.980, best=1.749]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:16<03:13,  5.10s/it, train loss=0.8483, val ΔE00=1.980, best=1.749]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:16<03:13,  5.10s/it, train loss=0.7876, val ΔE00=1.787, best=1.749]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:21<03:08,  5.08s/it, train loss=0.7876, val ΔE00=1.787, best=1.749]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:21<03:08,  5.08s/it, train loss=0.8165, val ΔE00=1.737, best=1.737]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:26<03:02,  5.07s/it, train loss=0.8165, val ΔE00=1.737, best=1.737]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:26<03:02,  5.07s/it, train loss=0.8085, val ΔE00=2.096, best=1.737]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:31<02:59,  5.13s/it, train loss=0.8085, val ΔE00=2.096, best=1.737]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:31<02:59,  5.13s/it, train loss=0.8581, val ΔE00=1.960, best=1.737]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:37<02:54,  5.14s/it, train loss=0.8581, val ΔE00=1.960, best=1.737]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:37<02:54,  5.14s/it, train loss=0.8902, val ΔE00=2.100, best=1.737]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:42<02:48,  5.10s/it, train loss=0.8902, val ΔE00=2.100, best=1.737]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:42<02:48,  5.10s/it, train loss=0.8622, val ΔE00=2.027, best=1.737]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [05:47<02:42,  5.08s/it, train loss=0.8622, val ΔE00=2.027, best=1.737]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [05:47<02:42,  5.08s/it, train loss=0.8384, val ΔE00=1.970, best=1.737]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [05:52<02:37,  5.06s/it, train loss=0.8384, val ΔE00=1.970, best=1.737]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [05:52<02:37,  5.06s/it, train loss=0.8300, val ΔE00=2.098, best=1.737]Training (xattn/smallcnn):  70%|███████   | 70/100 [05:57<02:33,  5.12s/it, train loss=0.8300, val ΔE00=2.098, best=1.737]Training (xattn/smallcnn):  70%|███████   | 70/100 [05:57<02:33,  5.12s/it, train loss=0.8712, val ΔE00=1.911, best=1.737]Training (xattn/smallcnn):  71%|███████   | 71/100 [06:02<02:28,  5.13s/it, train loss=0.8712, val ΔE00=1.911, best=1.737]Training (xattn/smallcnn):  71%|███████   | 71/100 [06:02<02:28,  5.13s/it, train loss=0.8390, val ΔE00=2.026, best=1.737]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:07<02:22,  5.10s/it, train loss=0.8390, val ΔE00=2.026, best=1.737]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:07<02:22,  5.10s/it, train loss=0.8443, val ΔE00=2.065, best=1.737]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:12<02:22,  5.10s/it, train loss=0.8417, val ΔE00=1.755, early_stop=yes]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:12<02:24,  5.17s/it, train loss=0.8417, val ΔE00=1.755, early_stop=yes]
[early] stop at epoch 73 (best de00=1.7373 @ 63)
[done] best ΔE00=1.737 over 73 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/xattn__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 21/24 ===
[sweep] id=021_model=xattn__backbone=resnet18__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model xattn --backbone resnet18 --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=resnet18, features=image, meta_encoder=none
[run] model=xattn backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:01,  6.08s/it]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:01,  6.08s/it, train loss=0.0117, val ΔE00=6.919, best=6.919]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:24,  5.76s/it, train loss=0.0117, val ΔE00=6.919, best=6.919]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:24,  5.76s/it, train loss=0.0064, val ΔE00=4.801, best=4.801]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:08,  5.66s/it, train loss=0.0064, val ΔE00=4.801, best=4.801]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:08,  5.66s/it, train loss=0.0090, val ΔE00=4.363, best=4.363]Training (xattn/resnet18):   4%|▍         | 4/100 [00:22<08:59,  5.62s/it, train loss=0.0090, val ΔE00=4.363, best=4.363]Training (xattn/resnet18):   4%|▍         | 4/100 [00:22<08:59,  5.62s/it, train loss=0.0165, val ΔE00=3.541, best=3.541]Training (xattn/resnet18):   5%|▌         | 5/100 [00:28<08:54,  5.63s/it, train loss=0.0165, val ΔE00=3.541, best=3.541]Training (xattn/resnet18):   5%|▌         | 5/100 [00:28<08:54,  5.63s/it, train loss=0.0239, val ΔE00=4.322, best=3.541]Training (xattn/resnet18):   6%|▌         | 6/100 [00:33<08:46,  5.60s/it, train loss=0.0239, val ΔE00=4.322, best=3.541]Training (xattn/resnet18):   6%|▌         | 6/100 [00:33<08:46,  5.60s/it, train loss=0.0374, val ΔE00=3.584, best=3.541]Training (xattn/resnet18):   7%|▋         | 7/100 [00:39<08:38,  5.58s/it, train loss=0.0374, val ΔE00=3.584, best=3.541]Training (xattn/resnet18):   7%|▋         | 7/100 [00:39<08:38,  5.58s/it, train loss=0.0437, val ΔE00=3.354, best=3.354]Training (xattn/resnet18):   8%|▊         | 8/100 [00:44<08:32,  5.57s/it, train loss=0.0437, val ΔE00=3.354, best=3.354]Training (xattn/resnet18):   8%|▊         | 8/100 [00:44<08:32,  5.57s/it, train loss=0.0546, val ΔE00=2.889, best=2.889]Training (xattn/resnet18):   9%|▉         | 9/100 [00:50<08:25,  5.56s/it, train loss=0.0546, val ΔE00=2.889, best=2.889]Training (xattn/resnet18):   9%|▉         | 9/100 [00:50<08:25,  5.56s/it, train loss=0.0695, val ΔE00=2.802, best=2.802]Training (xattn/resnet18):  10%|█         | 10/100 [00:56<08:22,  5.59s/it, train loss=0.0695, val ΔE00=2.802, best=2.802]Training (xattn/resnet18):  10%|█         | 10/100 [00:56<08:22,  5.59s/it, train loss=0.0803, val ΔE00=2.913, best=2.802]Training (xattn/resnet18):  11%|█         | 11/100 [01:01<08:15,  5.57s/it, train loss=0.0803, val ΔE00=2.913, best=2.802]Training (xattn/resnet18):  11%|█         | 11/100 [01:01<08:15,  5.57s/it, train loss=0.1028, val ΔE00=2.935, best=2.802]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:07<08:07,  5.54s/it, train loss=0.1028, val ΔE00=2.935, best=2.802]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:07<08:07,  5.54s/it, train loss=0.1082, val ΔE00=2.977, best=2.802]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:12<08:00,  5.52s/it, train loss=0.1082, val ΔE00=2.977, best=2.802]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:12<08:00,  5.52s/it, train loss=0.1284, val ΔE00=3.522, best=2.802]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:18<07:53,  5.51s/it, train loss=0.1284, val ΔE00=3.522, best=2.802]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:18<07:53,  5.51s/it, train loss=0.1374, val ΔE00=2.927, best=2.802]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:23<07:52,  5.56s/it, train loss=0.1374, val ΔE00=2.927, best=2.802]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:23<07:52,  5.56s/it, train loss=0.1510, val ΔE00=2.839, best=2.802]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:29<07:47,  5.57s/it, train loss=0.1510, val ΔE00=2.839, best=2.802]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:29<07:47,  5.57s/it, train loss=0.1652, val ΔE00=2.523, best=2.523]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:34<07:41,  5.56s/it, train loss=0.1652, val ΔE00=2.523, best=2.523]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:34<07:41,  5.56s/it, train loss=0.1687, val ΔE00=2.382, best=2.382]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:40<07:35,  5.55s/it, train loss=0.1687, val ΔE00=2.382, best=2.382]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:40<07:35,  5.55s/it, train loss=0.1943, val ΔE00=2.350, best=2.350]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:45<07:28,  5.53s/it, train loss=0.1943, val ΔE00=2.350, best=2.350]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:45<07:28,  5.53s/it, train loss=0.2035, val ΔE00=2.374, best=2.350]Training (xattn/resnet18):  20%|██        | 20/100 [01:51<07:27,  5.60s/it, train loss=0.2035, val ΔE00=2.374, best=2.350]Training (xattn/resnet18):  20%|██        | 20/100 [01:51<07:27,  5.60s/it, train loss=0.2299, val ΔE00=2.285, best=2.285]Training (xattn/resnet18):  21%|██        | 21/100 [01:57<07:21,  5.58s/it, train loss=0.2299, val ΔE00=2.285, best=2.285]Training (xattn/resnet18):  21%|██        | 21/100 [01:57<07:21,  5.58s/it, train loss=0.2564, val ΔE00=2.501, best=2.285]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:02<07:13,  5.55s/it, train loss=0.2564, val ΔE00=2.501, best=2.285]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:02<07:13,  5.55s/it, train loss=0.2658, val ΔE00=2.327, best=2.285]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:08<07:05,  5.53s/it, train loss=0.2658, val ΔE00=2.327, best=2.285]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:08<07:05,  5.53s/it, train loss=0.2916, val ΔE00=2.959, best=2.285]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:13<07:00,  5.54s/it, train loss=0.2916, val ΔE00=2.959, best=2.285]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:13<07:00,  5.54s/it, train loss=0.3183, val ΔE00=2.150, best=2.150]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:19<06:57,  5.57s/it, train loss=0.3183, val ΔE00=2.150, best=2.150]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:19<06:57,  5.57s/it, train loss=0.3095, val ΔE00=2.368, best=2.150]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:24<06:51,  5.56s/it, train loss=0.3095, val ΔE00=2.368, best=2.150]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:24<06:51,  5.56s/it, train loss=0.3298, val ΔE00=2.234, best=2.150]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:30<06:44,  5.54s/it, train loss=0.3298, val ΔE00=2.234, best=2.150]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:30<06:44,  5.54s/it, train loss=0.3866, val ΔE00=2.452, best=2.150]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:35<06:37,  5.52s/it, train loss=0.3866, val ΔE00=2.452, best=2.150]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:35<06:37,  5.52s/it, train loss=0.3343, val ΔE00=2.396, best=2.150]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:41<06:31,  5.52s/it, train loss=0.3343, val ΔE00=2.396, best=2.150]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:41<06:31,  5.52s/it, train loss=0.3652, val ΔE00=2.493, best=2.150]Training (xattn/resnet18):  30%|███       | 30/100 [02:47<06:29,  5.56s/it, train loss=0.3652, val ΔE00=2.493, best=2.150]Training (xattn/resnet18):  30%|███       | 30/100 [02:47<06:29,  5.56s/it, train loss=0.4313, val ΔE00=2.584, best=2.150]Training (xattn/resnet18):  31%|███       | 31/100 [02:52<06:23,  5.56s/it, train loss=0.4313, val ΔE00=2.584, best=2.150]Training (xattn/resnet18):  31%|███       | 31/100 [02:52<06:23,  5.56s/it, train loss=0.4637, val ΔE00=2.329, best=2.150]Training (xattn/resnet18):  32%|███▏      | 32/100 [02:58<06:16,  5.54s/it, train loss=0.4637, val ΔE00=2.329, best=2.150]Training (xattn/resnet18):  32%|███▏      | 32/100 [02:58<06:16,  5.54s/it, train loss=0.4970, val ΔE00=2.556, best=2.150]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:03<06:10,  5.53s/it, train loss=0.4970, val ΔE00=2.556, best=2.150]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:03<06:10,  5.53s/it, train loss=0.4400, val ΔE00=2.224, best=2.150]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:09<06:04,  5.52s/it, train loss=0.4400, val ΔE00=2.224, best=2.150]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:09<06:04,  5.52s/it, train loss=0.4603, val ΔE00=2.241, best=2.150]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:14<06:01,  5.56s/it, train loss=0.4603, val ΔE00=2.241, best=2.150]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:14<06:01,  5.56s/it, train loss=0.4612, val ΔE00=2.247, best=2.150]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:20<05:55,  5.56s/it, train loss=0.4612, val ΔE00=2.247, best=2.150]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:20<05:55,  5.56s/it, train loss=0.4640, val ΔE00=2.213, best=2.150]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:25<05:49,  5.54s/it, train loss=0.4640, val ΔE00=2.213, best=2.150]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:25<05:49,  5.54s/it, train loss=0.5076, val ΔE00=2.329, best=2.150]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:31<05:42,  5.52s/it, train loss=0.5076, val ΔE00=2.329, best=2.150]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:31<05:42,  5.52s/it, train loss=0.5825, val ΔE00=2.258, best=2.150]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:36<05:36,  5.51s/it, train loss=0.5825, val ΔE00=2.258, best=2.150]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:36<05:36,  5.51s/it, train loss=0.5420, val ΔE00=2.516, best=2.150]Training (xattn/resnet18):  40%|████      | 40/100 [03:42<05:33,  5.56s/it, train loss=0.5420, val ΔE00=2.516, best=2.150]Training (xattn/resnet18):  40%|████      | 40/100 [03:42<05:33,  5.56s/it, train loss=0.5870, val ΔE00=2.384, best=2.150]Training (xattn/resnet18):  41%|████      | 41/100 [03:48<05:27,  5.56s/it, train loss=0.5870, val ΔE00=2.384, best=2.150]Training (xattn/resnet18):  41%|████      | 41/100 [03:48<05:27,  5.56s/it, train loss=0.6583, val ΔE00=2.380, best=2.150]Training (xattn/resnet18):  42%|████▏     | 42/100 [03:53<05:21,  5.54s/it, train loss=0.6583, val ΔE00=2.380, best=2.150]Training (xattn/resnet18):  42%|████▏     | 42/100 [03:53<05:21,  5.54s/it, train loss=0.6025, val ΔE00=2.215, best=2.150]Training (xattn/resnet18):  43%|████▎     | 43/100 [03:59<05:15,  5.53s/it, train loss=0.6025, val ΔE00=2.215, best=2.150]Training (xattn/resnet18):  43%|████▎     | 43/100 [03:59<05:15,  5.53s/it, train loss=0.6141, val ΔE00=2.542, best=2.150]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:04<05:09,  5.52s/it, train loss=0.6141, val ΔE00=2.542, best=2.150]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:04<05:09,  5.52s/it, train loss=0.5403, val ΔE00=2.566, best=2.150]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:10<05:06,  5.56s/it, train loss=0.5403, val ΔE00=2.566, best=2.150]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:10<05:06,  5.56s/it, train loss=0.6645, val ΔE00=2.424, best=2.150]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:15<05:00,  5.56s/it, train loss=0.6645, val ΔE00=2.424, best=2.150]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:15<05:00,  5.56s/it, train loss=0.6787, val ΔE00=2.363, best=2.150]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:21<04:53,  5.54s/it, train loss=0.6787, val ΔE00=2.363, best=2.150]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:21<04:53,  5.54s/it, train loss=0.6968, val ΔE00=2.302, best=2.150]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:26<04:47,  5.52s/it, train loss=0.6968, val ΔE00=2.302, best=2.150]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:26<04:47,  5.52s/it, train loss=0.6083, val ΔE00=2.620, best=2.150]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:32<04:41,  5.52s/it, train loss=0.6083, val ΔE00=2.620, best=2.150]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:32<04:41,  5.52s/it, train loss=0.7149, val ΔE00=2.343, best=2.150]Training (xattn/resnet18):  50%|█████     | 50/100 [04:37<04:38,  5.56s/it, train loss=0.7149, val ΔE00=2.343, best=2.150]Training (xattn/resnet18):  50%|█████     | 50/100 [04:37<04:38,  5.56s/it, train loss=0.6501, val ΔE00=2.191, best=2.150]Training (xattn/resnet18):  51%|█████     | 51/100 [04:43<04:32,  5.56s/it, train loss=0.6501, val ΔE00=2.191, best=2.150]Training (xattn/resnet18):  51%|█████     | 51/100 [04:43<04:32,  5.56s/it, train loss=0.6210, val ΔE00=2.174, best=2.150]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:48<04:25,  5.54s/it, train loss=0.6210, val ΔE00=2.174, best=2.150]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:48<04:25,  5.54s/it, train loss=0.6974, val ΔE00=2.171, best=2.150]Training (xattn/resnet18):  53%|█████▎    | 53/100 [04:54<04:19,  5.52s/it, train loss=0.6974, val ΔE00=2.171, best=2.150]Training (xattn/resnet18):  53%|█████▎    | 53/100 [04:54<04:19,  5.52s/it, train loss=0.6376, val ΔE00=2.170, best=2.150]Training (xattn/resnet18):  54%|█████▍    | 54/100 [04:59<04:13,  5.51s/it, train loss=0.6376, val ΔE00=2.170, best=2.150]Training (xattn/resnet18):  54%|█████▍    | 54/100 [04:59<04:13,  5.51s/it, train loss=0.6776, val ΔE00=2.467, best=2.150]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:05<04:09,  5.55s/it, train loss=0.6776, val ΔE00=2.467, best=2.150]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:05<04:09,  5.55s/it, train loss=0.6462, val ΔE00=2.424, best=2.150]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:11<04:04,  5.55s/it, train loss=0.6462, val ΔE00=2.424, best=2.150]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:11<04:04,  5.55s/it, train loss=0.7396, val ΔE00=2.389, best=2.150]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:16<03:58,  5.54s/it, train loss=0.7396, val ΔE00=2.389, best=2.150]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:16<03:58,  5.54s/it, train loss=0.6852, val ΔE00=2.172, best=2.150]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:22<03:51,  5.52s/it, train loss=0.6852, val ΔE00=2.172, best=2.150]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:22<03:51,  5.52s/it, train loss=0.6252, val ΔE00=2.307, best=2.150]Training (xattn/resnet18):  59%|█████▉    | 59/100 [05:27<03:45,  5.51s/it, train loss=0.6252, val ΔE00=2.307, best=2.150]Training (xattn/resnet18):  59%|█████▉    | 59/100 [05:27<03:45,  5.51s/it, train loss=0.6399, val ΔE00=2.383, best=2.150]Training (xattn/resnet18):  60%|██████    | 60/100 [05:33<03:42,  5.56s/it, train loss=0.6399, val ΔE00=2.383, best=2.150]Training (xattn/resnet18):  60%|██████    | 60/100 [05:33<03:42,  5.56s/it, train loss=0.7466, val ΔE00=2.156, best=2.150]Training (xattn/resnet18):  61%|██████    | 61/100 [05:38<03:36,  5.55s/it, train loss=0.7466, val ΔE00=2.156, best=2.150]Training (xattn/resnet18):  61%|██████    | 61/100 [05:38<03:36,  5.55s/it, train loss=0.7424, val ΔE00=2.475, best=2.150]Training (xattn/resnet18):  62%|██████▏   | 62/100 [05:44<03:30,  5.53s/it, train loss=0.7424, val ΔE00=2.475, best=2.150]Training (xattn/resnet18):  62%|██████▏   | 62/100 [05:44<03:30,  5.53s/it, train loss=0.7123, val ΔE00=2.289, best=2.150]Training (xattn/resnet18):  63%|██████▎   | 63/100 [05:49<03:24,  5.52s/it, train loss=0.7123, val ΔE00=2.289, best=2.150]Training (xattn/resnet18):  63%|██████▎   | 63/100 [05:49<03:24,  5.52s/it, train loss=0.7374, val ΔE00=2.163, best=2.150]Training (xattn/resnet18):  64%|██████▍   | 64/100 [05:55<03:18,  5.51s/it, train loss=0.7374, val ΔE00=2.163, best=2.150]Training (xattn/resnet18):  64%|██████▍   | 64/100 [05:55<03:18,  5.51s/it, train loss=0.7703, val ΔE00=2.290, best=2.150]Training (xattn/resnet18):  65%|██████▌   | 65/100 [06:00<03:14,  5.56s/it, train loss=0.7703, val ΔE00=2.290, best=2.150]Training (xattn/resnet18):  65%|██████▌   | 65/100 [06:00<03:14,  5.56s/it, train loss=0.6615, val ΔE00=2.429, best=2.150]Training (xattn/resnet18):  66%|██████▌   | 66/100 [06:06<03:08,  5.55s/it, train loss=0.6615, val ΔE00=2.429, best=2.150]Training (xattn/resnet18):  66%|██████▌   | 66/100 [06:06<03:08,  5.55s/it, train loss=0.6907, val ΔE00=2.543, best=2.150]Training (xattn/resnet18):  67%|██████▋   | 67/100 [06:11<03:02,  5.53s/it, train loss=0.6907, val ΔE00=2.543, best=2.150]Training (xattn/resnet18):  67%|██████▋   | 67/100 [06:11<03:02,  5.53s/it, train loss=0.6959, val ΔE00=2.456, best=2.150]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:17<02:56,  5.52s/it, train loss=0.6959, val ΔE00=2.456, best=2.150]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:17<02:56,  5.52s/it, train loss=0.7410, val ΔE00=2.223, best=2.150]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:22<02:56,  5.52s/it, train loss=0.6160, val ΔE00=2.313, early_stop=yes]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:22<03:00,  5.63s/it, train loss=0.6160, val ΔE00=2.313, early_stop=yes]
[early] stop at epoch 69 (best de00=2.1505 @ 24)
[done] best ΔE00=2.150 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/xattn__resnet18__image__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image/final_summary.json (kind=val)
[sweep] === Run 22/24 ===
[sweep] id=022_model=xattn__backbone=resnet18__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model xattn --backbone resnet18 --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=resnet18, features=image+mean, meta_encoder=none
[run] model=xattn backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:23,  6.30s/it]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:23,  6.30s/it, train loss=0.0077, val ΔE00=5.680, best=5.680]Training (xattn/resnet18):   2%|▏         | 2/100 [00:12<09:43,  5.96s/it, train loss=0.0077, val ΔE00=5.680, best=5.680]Training (xattn/resnet18):   2%|▏         | 2/100 [00:12<09:43,  5.96s/it, train loss=0.0045, val ΔE00=4.345, best=4.345]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:27,  5.85s/it, train loss=0.0045, val ΔE00=4.345, best=4.345]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:27,  5.85s/it, train loss=0.0069, val ΔE00=3.565, best=3.565]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:17,  5.80s/it, train loss=0.0069, val ΔE00=3.565, best=3.565]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:17,  5.80s/it, train loss=0.0113, val ΔE00=2.908, best=2.908]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:17,  5.87s/it, train loss=0.0113, val ΔE00=2.908, best=2.908]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:17,  5.87s/it, train loss=0.0167, val ΔE00=2.816, best=2.816]Training (xattn/resnet18):   6%|▌         | 6/100 [00:35<09:05,  5.80s/it, train loss=0.0167, val ΔE00=2.816, best=2.816]Training (xattn/resnet18):   6%|▌         | 6/100 [00:35<09:05,  5.80s/it, train loss=0.0256, val ΔE00=3.383, best=2.816]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:57,  5.78s/it, train loss=0.0256, val ΔE00=3.383, best=2.816]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:57,  5.78s/it, train loss=0.0381, val ΔE00=2.749, best=2.749]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:48,  5.74s/it, train loss=0.0381, val ΔE00=2.749, best=2.749]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:48,  5.74s/it, train loss=0.0426, val ΔE00=2.890, best=2.749]Training (xattn/resnet18):   9%|▉         | 9/100 [00:52<08:42,  5.74s/it, train loss=0.0426, val ΔE00=2.890, best=2.749]Training (xattn/resnet18):   9%|▉         | 9/100 [00:52<08:42,  5.74s/it, train loss=0.0467, val ΔE00=2.700, best=2.700]Training (xattn/resnet18):  10%|█         | 10/100 [00:58<08:42,  5.80s/it, train loss=0.0467, val ΔE00=2.700, best=2.700]Training (xattn/resnet18):  10%|█         | 10/100 [00:58<08:42,  5.80s/it, train loss=0.0566, val ΔE00=2.642, best=2.642]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:33,  5.77s/it, train loss=0.0566, val ΔE00=2.642, best=2.642]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:33,  5.77s/it, train loss=0.0678, val ΔE00=2.646, best=2.642]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:09<08:27,  5.76s/it, train loss=0.0678, val ΔE00=2.646, best=2.642]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:09<08:27,  5.76s/it, train loss=0.0747, val ΔE00=2.433, best=2.433]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:15<08:18,  5.73s/it, train loss=0.0747, val ΔE00=2.433, best=2.433]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:15<08:18,  5.73s/it, train loss=0.0797, val ΔE00=2.495, best=2.433]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:21<08:13,  5.74s/it, train loss=0.0797, val ΔE00=2.495, best=2.433]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:21<08:13,  5.74s/it, train loss=0.0884, val ΔE00=2.313, best=2.313]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:11,  5.78s/it, train loss=0.0884, val ΔE00=2.313, best=2.313]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:11,  5.78s/it, train loss=0.1060, val ΔE00=2.516, best=2.313]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:32<08:03,  5.76s/it, train loss=0.1060, val ΔE00=2.516, best=2.313]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:32<08:03,  5.76s/it, train loss=0.1045, val ΔE00=2.364, best=2.313]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:38<07:55,  5.73s/it, train loss=0.1045, val ΔE00=2.364, best=2.313]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:38<07:55,  5.73s/it, train loss=0.1123, val ΔE00=2.349, best=2.313]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:44<07:50,  5.73s/it, train loss=0.1123, val ΔE00=2.349, best=2.313]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:44<07:50,  5.73s/it, train loss=0.1258, val ΔE00=2.299, best=2.299]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:49<07:44,  5.74s/it, train loss=0.1258, val ΔE00=2.299, best=2.299]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:49<07:44,  5.74s/it, train loss=0.1264, val ΔE00=2.227, best=2.227]Training (xattn/resnet18):  20%|██        | 20/100 [01:55<07:44,  5.80s/it, train loss=0.1264, val ΔE00=2.227, best=2.227]Training (xattn/resnet18):  20%|██        | 20/100 [01:55<07:44,  5.80s/it, train loss=0.1323, val ΔE00=2.106, best=2.106]Training (xattn/resnet18):  21%|██        | 21/100 [02:01<07:45,  5.89s/it, train loss=0.1323, val ΔE00=2.106, best=2.106]Training (xattn/resnet18):  21%|██        | 21/100 [02:01<07:45,  5.89s/it, train loss=0.1541, val ΔE00=2.146, best=2.106]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:07<07:35,  5.84s/it, train loss=0.1541, val ΔE00=2.146, best=2.106]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:07<07:35,  5.84s/it, train loss=0.1531, val ΔE00=2.259, best=2.106]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:13<07:29,  5.84s/it, train loss=0.1531, val ΔE00=2.259, best=2.106]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:13<07:29,  5.84s/it, train loss=0.1664, val ΔE00=2.328, best=2.106]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:19<07:23,  5.83s/it, train loss=0.1664, val ΔE00=2.328, best=2.106]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:19<07:23,  5.83s/it, train loss=0.1833, val ΔE00=2.071, best=2.071]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:25<07:18,  5.85s/it, train loss=0.1833, val ΔE00=2.071, best=2.071]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:25<07:18,  5.85s/it, train loss=0.1853, val ΔE00=2.199, best=2.071]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:30<07:09,  5.80s/it, train loss=0.1853, val ΔE00=2.199, best=2.071]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:30<07:09,  5.80s/it, train loss=0.1899, val ΔE00=2.168, best=2.071]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:36<07:01,  5.77s/it, train loss=0.1899, val ΔE00=2.168, best=2.071]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:36<07:01,  5.77s/it, train loss=0.1838, val ΔE00=2.127, best=2.071]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:42<06:53,  5.74s/it, train loss=0.1838, val ΔE00=2.127, best=2.071]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:42<06:53,  5.74s/it, train loss=0.2079, val ΔE00=2.273, best=2.071]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:47<06:48,  5.75s/it, train loss=0.2079, val ΔE00=2.273, best=2.071]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:47<06:48,  5.75s/it, train loss=0.2277, val ΔE00=2.029, best=2.029]Training (xattn/resnet18):  30%|███       | 30/100 [02:53<06:45,  5.79s/it, train loss=0.2277, val ΔE00=2.029, best=2.029]Training (xattn/resnet18):  30%|███       | 30/100 [02:53<06:45,  5.79s/it, train loss=0.2188, val ΔE00=2.240, best=2.029]Training (xattn/resnet18):  31%|███       | 31/100 [02:59<06:37,  5.76s/it, train loss=0.2188, val ΔE00=2.240, best=2.029]Training (xattn/resnet18):  31%|███       | 31/100 [02:59<06:37,  5.76s/it, train loss=0.2365, val ΔE00=2.150, best=2.029]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:05<06:30,  5.74s/it, train loss=0.2365, val ΔE00=2.150, best=2.029]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:05<06:30,  5.74s/it, train loss=0.2443, val ΔE00=2.057, best=2.029]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:10<06:22,  5.72s/it, train loss=0.2443, val ΔE00=2.057, best=2.029]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:10<06:22,  5.72s/it, train loss=0.2444, val ΔE00=2.049, best=2.029]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:16<06:16,  5.71s/it, train loss=0.2444, val ΔE00=2.049, best=2.029]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:16<06:16,  5.71s/it, train loss=0.2381, val ΔE00=2.239, best=2.029]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:22<06:14,  5.76s/it, train loss=0.2381, val ΔE00=2.239, best=2.029]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:22<06:14,  5.76s/it, train loss=0.2525, val ΔE00=2.065, best=2.029]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:28<06:07,  5.74s/it, train loss=0.2525, val ΔE00=2.065, best=2.029]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:28<06:07,  5.74s/it, train loss=0.2545, val ΔE00=2.200, best=2.029]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:33<06:02,  5.75s/it, train loss=0.2545, val ΔE00=2.200, best=2.029]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:33<06:02,  5.75s/it, train loss=0.2883, val ΔE00=1.999, best=1.999]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:39<05:55,  5.73s/it, train loss=0.2883, val ΔE00=1.999, best=1.999]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:39<05:55,  5.73s/it, train loss=0.2793, val ΔE00=2.038, best=1.999]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:45<05:49,  5.73s/it, train loss=0.2793, val ΔE00=2.038, best=1.999]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:45<05:49,  5.73s/it, train loss=0.2968, val ΔE00=1.966, best=1.966]Training (xattn/resnet18):  40%|████      | 40/100 [03:51<05:46,  5.78s/it, train loss=0.2968, val ΔE00=1.966, best=1.966]Training (xattn/resnet18):  40%|████      | 40/100 [03:51<05:46,  5.78s/it, train loss=0.3118, val ΔE00=2.094, best=1.966]Training (xattn/resnet18):  41%|████      | 41/100 [03:56<05:39,  5.76s/it, train loss=0.3118, val ΔE00=2.094, best=1.966]Training (xattn/resnet18):  41%|████      | 41/100 [03:56<05:39,  5.76s/it, train loss=0.3076, val ΔE00=1.978, best=1.966]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:02<05:32,  5.73s/it, train loss=0.3076, val ΔE00=1.978, best=1.966]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:02<05:32,  5.73s/it, train loss=0.3219, val ΔE00=2.063, best=1.966]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:08<05:25,  5.71s/it, train loss=0.3219, val ΔE00=2.063, best=1.966]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:08<05:25,  5.71s/it, train loss=0.3317, val ΔE00=2.256, best=1.966]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:13<05:18,  5.70s/it, train loss=0.3317, val ΔE00=2.256, best=1.966]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:13<05:18,  5.70s/it, train loss=0.3688, val ΔE00=2.075, best=1.966]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:19<05:16,  5.75s/it, train loss=0.3688, val ΔE00=2.075, best=1.966]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:19<05:16,  5.75s/it, train loss=0.2906, val ΔE00=2.124, best=1.966]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:25<05:09,  5.74s/it, train loss=0.2906, val ΔE00=2.124, best=1.966]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:25<05:09,  5.74s/it, train loss=0.3425, val ΔE00=2.055, best=1.966]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:31<05:02,  5.72s/it, train loss=0.3425, val ΔE00=2.055, best=1.966]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:31<05:02,  5.72s/it, train loss=0.3613, val ΔE00=2.090, best=1.966]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:36<04:57,  5.72s/it, train loss=0.3613, val ΔE00=2.090, best=1.966]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:36<04:57,  5.72s/it, train loss=0.3085, val ΔE00=1.935, best=1.935]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:42<04:51,  5.71s/it, train loss=0.3085, val ΔE00=1.935, best=1.935]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:42<04:51,  5.71s/it, train loss=0.2947, val ΔE00=2.012, best=1.935]Training (xattn/resnet18):  50%|█████     | 50/100 [04:48<04:48,  5.76s/it, train loss=0.2947, val ΔE00=2.012, best=1.935]Training (xattn/resnet18):  50%|█████     | 50/100 [04:48<04:48,  5.76s/it, train loss=0.3209, val ΔE00=2.119, best=1.935]Training (xattn/resnet18):  51%|█████     | 51/100 [04:54<04:41,  5.74s/it, train loss=0.3209, val ΔE00=2.119, best=1.935]Training (xattn/resnet18):  51%|█████     | 51/100 [04:54<04:41,  5.74s/it, train loss=0.3785, val ΔE00=2.010, best=1.935]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:59<04:34,  5.72s/it, train loss=0.3785, val ΔE00=2.010, best=1.935]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:59<04:34,  5.72s/it, train loss=0.3727, val ΔE00=2.031, best=1.935]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:05<04:28,  5.71s/it, train loss=0.3727, val ΔE00=2.031, best=1.935]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:05<04:28,  5.71s/it, train loss=0.3984, val ΔE00=2.108, best=1.935]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:11<04:22,  5.70s/it, train loss=0.3984, val ΔE00=2.108, best=1.935]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:11<04:22,  5.70s/it, train loss=0.4218, val ΔE00=2.016, best=1.935]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:17<04:18,  5.75s/it, train loss=0.4218, val ΔE00=2.016, best=1.935]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:17<04:18,  5.75s/it, train loss=0.3596, val ΔE00=2.192, best=1.935]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:22<04:12,  5.74s/it, train loss=0.3596, val ΔE00=2.192, best=1.935]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:22<04:12,  5.74s/it, train loss=0.3698, val ΔE00=2.148, best=1.935]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:28<04:05,  5.72s/it, train loss=0.3698, val ΔE00=2.148, best=1.935]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:28<04:05,  5.72s/it, train loss=0.3243, val ΔE00=2.064, best=1.935]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:34<03:59,  5.71s/it, train loss=0.3243, val ΔE00=2.064, best=1.935]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:34<03:59,  5.71s/it, train loss=0.3722, val ΔE00=2.220, best=1.935]Training (xattn/resnet18):  59%|█████▉    | 59/100 [05:39<03:53,  5.69s/it, train loss=0.3722, val ΔE00=2.220, best=1.935]Training (xattn/resnet18):  59%|█████▉    | 59/100 [05:39<03:53,  5.69s/it, train loss=0.4017, val ΔE00=2.037, best=1.935]Training (xattn/resnet18):  60%|██████    | 60/100 [05:45<03:49,  5.75s/it, train loss=0.4017, val ΔE00=2.037, best=1.935]Training (xattn/resnet18):  60%|██████    | 60/100 [05:45<03:49,  5.75s/it, train loss=0.3583, val ΔE00=2.036, best=1.935]Training (xattn/resnet18):  61%|██████    | 61/100 [05:51<03:44,  5.76s/it, train loss=0.3583, val ΔE00=2.036, best=1.935]Training (xattn/resnet18):  61%|██████    | 61/100 [05:51<03:44,  5.76s/it, train loss=0.3621, val ΔE00=1.908, best=1.908]Training (xattn/resnet18):  62%|██████▏   | 62/100 [05:57<03:37,  5.73s/it, train loss=0.3621, val ΔE00=1.908, best=1.908]Training (xattn/resnet18):  62%|██████▏   | 62/100 [05:57<03:37,  5.73s/it, train loss=0.3764, val ΔE00=1.964, best=1.908]Training (xattn/resnet18):  63%|██████▎   | 63/100 [06:02<03:31,  5.71s/it, train loss=0.3764, val ΔE00=1.964, best=1.908]Training (xattn/resnet18):  63%|██████▎   | 63/100 [06:02<03:31,  5.71s/it, train loss=0.3769, val ΔE00=2.042, best=1.908]Training (xattn/resnet18):  64%|██████▍   | 64/100 [06:08<03:25,  5.71s/it, train loss=0.3769, val ΔE00=2.042, best=1.908]Training (xattn/resnet18):  64%|██████▍   | 64/100 [06:08<03:25,  5.71s/it, train loss=0.3355, val ΔE00=2.174, best=1.908]Training (xattn/resnet18):  65%|██████▌   | 65/100 [06:14<03:21,  5.77s/it, train loss=0.3355, val ΔE00=2.174, best=1.908]Training (xattn/resnet18):  65%|██████▌   | 65/100 [06:14<03:21,  5.77s/it, train loss=0.3550, val ΔE00=2.252, best=1.908]Training (xattn/resnet18):  66%|██████▌   | 66/100 [06:20<03:15,  5.75s/it, train loss=0.3550, val ΔE00=2.252, best=1.908]Training (xattn/resnet18):  66%|██████▌   | 66/100 [06:20<03:15,  5.75s/it, train loss=0.3547, val ΔE00=2.051, best=1.908]Training (xattn/resnet18):  67%|██████▋   | 67/100 [06:25<03:09,  5.73s/it, train loss=0.3547, val ΔE00=2.051, best=1.908]Training (xattn/resnet18):  67%|██████▋   | 67/100 [06:25<03:09,  5.73s/it, train loss=0.3562, val ΔE00=2.226, best=1.908]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:31<03:02,  5.72s/it, train loss=0.3562, val ΔE00=2.226, best=1.908]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:31<03:02,  5.72s/it, train loss=0.3356, val ΔE00=2.089, best=1.908]Training (xattn/resnet18):  69%|██████▉   | 69/100 [06:37<02:56,  5.71s/it, train loss=0.3356, val ΔE00=2.089, best=1.908]Training (xattn/resnet18):  69%|██████▉   | 69/100 [06:37<02:56,  5.71s/it, train loss=0.3361, val ΔE00=2.032, best=1.908]Training (xattn/resnet18):  70%|███████   | 70/100 [06:43<02:53,  5.77s/it, train loss=0.3361, val ΔE00=2.032, best=1.908]Training (xattn/resnet18):  70%|███████   | 70/100 [06:43<02:53,  5.77s/it, train loss=0.3808, val ΔE00=2.107, best=1.908]Training (xattn/resnet18):  70%|███████   | 70/100 [06:48<02:53,  5.77s/it, train loss=0.3329, val ΔE00=2.039, early_stop=yes]Training (xattn/resnet18):  70%|███████   | 70/100 [06:48<02:55,  5.84s/it, train loss=0.3329, val ΔE00=2.039, early_stop=yes]
[early] stop at epoch 71 (best de00=1.9077 @ 61)
[done] best ΔE00=1.908 over 71 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/xattn__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 23/24 ===
[sweep] id=023_model=xattn__backbone=resnet18__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model xattn --backbone resnet18 --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=resnet18, features=image+meta, meta_encoder=none
[run] model=xattn backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:25,  6.32s/it]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:25,  6.32s/it, train loss=0.0109, val ΔE00=5.792, best=5.792]Training (xattn/resnet18):   2%|▏         | 2/100 [00:12<09:47,  6.00s/it, train loss=0.0109, val ΔE00=5.792, best=5.792]Training (xattn/resnet18):   2%|▏         | 2/100 [00:12<09:47,  6.00s/it, train loss=0.0048, val ΔE00=4.546, best=4.546]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:31,  5.89s/it, train loss=0.0048, val ΔE00=4.546, best=4.546]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:31,  5.89s/it, train loss=0.0097, val ΔE00=3.859, best=3.859]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:19,  5.83s/it, train loss=0.0097, val ΔE00=3.859, best=3.859]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:19,  5.83s/it, train loss=0.0142, val ΔE00=3.671, best=3.671]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:16,  5.86s/it, train loss=0.0142, val ΔE00=3.671, best=3.671]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:16,  5.86s/it, train loss=0.0231, val ΔE00=3.872, best=3.671]Training (xattn/resnet18):   6%|▌         | 6/100 [00:35<09:06,  5.81s/it, train loss=0.0231, val ΔE00=3.872, best=3.671]Training (xattn/resnet18):   6%|▌         | 6/100 [00:35<09:06,  5.81s/it, train loss=0.0326, val ΔE00=3.532, best=3.532]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:56,  5.77s/it, train loss=0.0326, val ΔE00=3.532, best=3.532]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:56,  5.77s/it, train loss=0.0397, val ΔE00=4.106, best=3.532]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:49,  5.75s/it, train loss=0.0397, val ΔE00=4.106, best=3.532]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:49,  5.75s/it, train loss=0.0518, val ΔE00=3.235, best=3.235]Training (xattn/resnet18):   9%|▉         | 9/100 [00:52<08:42,  5.74s/it, train loss=0.0518, val ΔE00=3.235, best=3.235]Training (xattn/resnet18):   9%|▉         | 9/100 [00:52<08:42,  5.74s/it, train loss=0.0594, val ΔE00=2.847, best=2.847]Training (xattn/resnet18):  10%|█         | 10/100 [00:58<08:39,  5.78s/it, train loss=0.0594, val ΔE00=2.847, best=2.847]Training (xattn/resnet18):  10%|█         | 10/100 [00:58<08:39,  5.78s/it, train loss=0.0729, val ΔE00=3.283, best=2.847]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:32,  5.76s/it, train loss=0.0729, val ΔE00=3.283, best=2.847]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:32,  5.76s/it, train loss=0.0813, val ΔE00=2.866, best=2.847]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:09<08:25,  5.75s/it, train loss=0.0813, val ΔE00=2.866, best=2.847]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:09<08:25,  5.75s/it, train loss=0.1035, val ΔE00=2.791, best=2.791]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:15<08:19,  5.74s/it, train loss=0.1035, val ΔE00=2.791, best=2.791]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:15<08:19,  5.74s/it, train loss=0.1094, val ΔE00=2.701, best=2.701]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:21<08:13,  5.74s/it, train loss=0.1094, val ΔE00=2.701, best=2.701]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:21<08:13,  5.74s/it, train loss=0.1280, val ΔE00=2.299, best=2.299]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:10,  5.77s/it, train loss=0.1280, val ΔE00=2.299, best=2.299]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:10,  5.77s/it, train loss=0.1322, val ΔE00=2.473, best=2.299]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:32<08:03,  5.76s/it, train loss=0.1322, val ΔE00=2.473, best=2.299]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:32<08:03,  5.76s/it, train loss=0.1392, val ΔE00=2.478, best=2.299]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:38<07:55,  5.73s/it, train loss=0.1392, val ΔE00=2.478, best=2.299]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:38<07:55,  5.73s/it, train loss=0.1776, val ΔE00=2.715, best=2.299]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:43<07:48,  5.71s/it, train loss=0.1776, val ΔE00=2.715, best=2.299]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:43<07:48,  5.71s/it, train loss=0.1878, val ΔE00=3.064, best=2.299]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:49<07:41,  5.69s/it, train loss=0.1878, val ΔE00=3.064, best=2.299]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:49<07:41,  5.69s/it, train loss=0.2030, val ΔE00=2.742, best=2.299]Training (xattn/resnet18):  20%|██        | 20/100 [01:55<07:41,  5.76s/it, train loss=0.2030, val ΔE00=2.742, best=2.299]Training (xattn/resnet18):  20%|██        | 20/100 [01:55<07:41,  5.76s/it, train loss=0.1791, val ΔE00=2.140, best=2.140]Training (xattn/resnet18):  21%|██        | 21/100 [02:01<07:34,  5.75s/it, train loss=0.1791, val ΔE00=2.140, best=2.140]Training (xattn/resnet18):  21%|██        | 21/100 [02:01<07:34,  5.75s/it, train loss=0.2047, val ΔE00=2.552, best=2.140]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:06<07:26,  5.73s/it, train loss=0.2047, val ΔE00=2.552, best=2.140]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:06<07:26,  5.73s/it, train loss=0.2210, val ΔE00=2.426, best=2.140]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:12<07:19,  5.71s/it, train loss=0.2210, val ΔE00=2.426, best=2.140]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:12<07:19,  5.71s/it, train loss=0.2462, val ΔE00=2.354, best=2.140]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:18<07:13,  5.70s/it, train loss=0.2462, val ΔE00=2.354, best=2.140]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:18<07:13,  5.70s/it, train loss=0.3030, val ΔE00=2.474, best=2.140]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:24<07:11,  5.75s/it, train loss=0.3030, val ΔE00=2.474, best=2.140]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:24<07:11,  5.75s/it, train loss=0.2999, val ΔE00=2.308, best=2.140]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:29<07:05,  5.75s/it, train loss=0.2999, val ΔE00=2.308, best=2.140]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:29<07:05,  5.75s/it, train loss=0.2880, val ΔE00=2.636, best=2.140]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:35<06:57,  5.72s/it, train loss=0.2880, val ΔE00=2.636, best=2.140]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:35<06:57,  5.72s/it, train loss=0.2957, val ΔE00=2.172, best=2.140]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:41<06:50,  5.70s/it, train loss=0.2957, val ΔE00=2.172, best=2.140]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:41<06:50,  5.70s/it, train loss=0.3300, val ΔE00=2.409, best=2.140]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:46<06:44,  5.69s/it, train loss=0.3300, val ΔE00=2.409, best=2.140]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:46<06:44,  5.69s/it, train loss=0.3328, val ΔE00=2.387, best=2.140]Training (xattn/resnet18):  30%|███       | 30/100 [02:52<06:42,  5.75s/it, train loss=0.3328, val ΔE00=2.387, best=2.140]Training (xattn/resnet18):  30%|███       | 30/100 [02:52<06:42,  5.75s/it, train loss=0.3493, val ΔE00=2.314, best=2.140]Training (xattn/resnet18):  31%|███       | 31/100 [02:58<06:37,  5.76s/it, train loss=0.3493, val ΔE00=2.314, best=2.140]Training (xattn/resnet18):  31%|███       | 31/100 [02:58<06:37,  5.76s/it, train loss=0.4203, val ΔE00=2.035, best=2.035]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:04<06:29,  5.73s/it, train loss=0.4203, val ΔE00=2.035, best=2.035]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:04<06:29,  5.73s/it, train loss=0.3962, val ΔE00=2.233, best=2.035]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:09<06:22,  5.71s/it, train loss=0.3962, val ΔE00=2.233, best=2.035]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:09<06:22,  5.71s/it, train loss=0.4042, val ΔE00=2.412, best=2.035]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:15<06:15,  5.69s/it, train loss=0.4042, val ΔE00=2.412, best=2.035]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:15<06:15,  5.69s/it, train loss=0.4213, val ΔE00=2.337, best=2.035]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:21<06:13,  5.75s/it, train loss=0.4213, val ΔE00=2.337, best=2.035]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:21<06:13,  5.75s/it, train loss=0.4118, val ΔE00=2.650, best=2.035]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:27<06:06,  5.73s/it, train loss=0.4118, val ΔE00=2.650, best=2.035]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:27<06:06,  5.73s/it, train loss=0.4374, val ΔE00=2.432, best=2.035]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:32<05:59,  5.71s/it, train loss=0.4374, val ΔE00=2.432, best=2.035]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:32<05:59,  5.71s/it, train loss=0.5190, val ΔE00=2.573, best=2.035]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:38<05:53,  5.70s/it, train loss=0.5190, val ΔE00=2.573, best=2.035]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:38<05:53,  5.70s/it, train loss=0.4303, val ΔE00=2.246, best=2.035]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:44<05:46,  5.69s/it, train loss=0.4303, val ΔE00=2.246, best=2.035]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:44<05:46,  5.69s/it, train loss=0.4676, val ΔE00=2.316, best=2.035]Training (xattn/resnet18):  40%|████      | 40/100 [03:49<05:44,  5.73s/it, train loss=0.4676, val ΔE00=2.316, best=2.035]Training (xattn/resnet18):  40%|████      | 40/100 [03:49<05:44,  5.73s/it, train loss=0.4560, val ΔE00=2.359, best=2.035]Training (xattn/resnet18):  41%|████      | 41/100 [03:55<05:38,  5.73s/it, train loss=0.4560, val ΔE00=2.359, best=2.035]Training (xattn/resnet18):  41%|████      | 41/100 [03:55<05:38,  5.73s/it, train loss=0.4690, val ΔE00=2.403, best=2.035]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:01<05:31,  5.71s/it, train loss=0.4690, val ΔE00=2.403, best=2.035]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:01<05:31,  5.71s/it, train loss=0.5212, val ΔE00=2.145, best=2.035]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:06<05:24,  5.69s/it, train loss=0.5212, val ΔE00=2.145, best=2.035]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:06<05:24,  5.69s/it, train loss=0.5093, val ΔE00=2.649, best=2.035]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:12<05:18,  5.68s/it, train loss=0.5093, val ΔE00=2.649, best=2.035]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:12<05:18,  5.68s/it, train loss=0.5549, val ΔE00=2.357, best=2.035]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:18<05:15,  5.73s/it, train loss=0.5549, val ΔE00=2.357, best=2.035]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:18<05:15,  5.73s/it, train loss=0.5554, val ΔE00=2.132, best=2.035]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:24<05:09,  5.72s/it, train loss=0.5554, val ΔE00=2.132, best=2.035]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:24<05:09,  5.72s/it, train loss=0.5085, val ΔE00=2.260, best=2.035]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:29<05:02,  5.70s/it, train loss=0.5085, val ΔE00=2.260, best=2.035]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:29<05:02,  5.70s/it, train loss=0.5405, val ΔE00=2.309, best=2.035]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:35<04:55,  5.68s/it, train loss=0.5405, val ΔE00=2.309, best=2.035]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:35<04:55,  5.68s/it, train loss=0.5550, val ΔE00=2.433, best=2.035]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:41<04:49,  5.68s/it, train loss=0.5550, val ΔE00=2.433, best=2.035]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:41<04:49,  5.68s/it, train loss=0.5174, val ΔE00=2.295, best=2.035]Training (xattn/resnet18):  50%|█████     | 50/100 [04:47<04:46,  5.73s/it, train loss=0.5174, val ΔE00=2.295, best=2.035]Training (xattn/resnet18):  50%|█████     | 50/100 [04:47<04:46,  5.73s/it, train loss=0.5087, val ΔE00=2.178, best=2.035]Training (xattn/resnet18):  51%|█████     | 51/100 [04:52<04:40,  5.73s/it, train loss=0.5087, val ΔE00=2.178, best=2.035]Training (xattn/resnet18):  51%|█████     | 51/100 [04:52<04:40,  5.73s/it, train loss=0.5348, val ΔE00=2.208, best=2.035]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:58<04:33,  5.71s/it, train loss=0.5348, val ΔE00=2.208, best=2.035]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:58<04:33,  5.71s/it, train loss=0.5789, val ΔE00=2.422, best=2.035]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:04<04:27,  5.69s/it, train loss=0.5789, val ΔE00=2.422, best=2.035]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:04<04:27,  5.69s/it, train loss=0.5500, val ΔE00=2.076, best=2.035]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:09<04:21,  5.68s/it, train loss=0.5500, val ΔE00=2.076, best=2.035]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:09<04:21,  5.68s/it, train loss=0.5933, val ΔE00=2.405, best=2.035]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:15<04:18,  5.73s/it, train loss=0.5933, val ΔE00=2.405, best=2.035]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:15<04:18,  5.73s/it, train loss=0.6571, val ΔE00=2.284, best=2.035]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:21<04:11,  5.72s/it, train loss=0.6571, val ΔE00=2.284, best=2.035]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:21<04:11,  5.72s/it, train loss=0.5594, val ΔE00=2.162, best=2.035]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:26<04:05,  5.70s/it, train loss=0.5594, val ΔE00=2.162, best=2.035]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:26<04:05,  5.70s/it, train loss=0.6136, val ΔE00=2.292, best=2.035]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:32<03:59,  5.69s/it, train loss=0.6136, val ΔE00=2.292, best=2.035]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:32<03:59,  5.69s/it, train loss=0.6101, val ΔE00=2.201, best=2.035]Training (xattn/resnet18):  59%|█████▉    | 59/100 [05:38<03:52,  5.68s/it, train loss=0.6101, val ΔE00=2.201, best=2.035]Training (xattn/resnet18):  59%|█████▉    | 59/100 [05:38<03:52,  5.68s/it, train loss=0.6856, val ΔE00=2.586, best=2.035]Training (xattn/resnet18):  60%|██████    | 60/100 [05:44<03:49,  5.73s/it, train loss=0.6856, val ΔE00=2.586, best=2.035]Training (xattn/resnet18):  60%|██████    | 60/100 [05:44<03:49,  5.73s/it, train loss=0.5976, val ΔE00=2.156, best=2.035]Training (xattn/resnet18):  61%|██████    | 61/100 [05:49<03:43,  5.73s/it, train loss=0.5976, val ΔE00=2.156, best=2.035]Training (xattn/resnet18):  61%|██████    | 61/100 [05:49<03:43,  5.73s/it, train loss=0.6300, val ΔE00=2.217, best=2.035]Training (xattn/resnet18):  62%|██████▏   | 62/100 [05:55<03:37,  5.71s/it, train loss=0.6300, val ΔE00=2.217, best=2.035]Training (xattn/resnet18):  62%|██████▏   | 62/100 [05:55<03:37,  5.71s/it, train loss=0.5527, val ΔE00=2.356, best=2.035]Training (xattn/resnet18):  63%|██████▎   | 63/100 [06:01<03:30,  5.70s/it, train loss=0.5527, val ΔE00=2.356, best=2.035]Training (xattn/resnet18):  63%|██████▎   | 63/100 [06:01<03:30,  5.70s/it, train loss=0.6196, val ΔE00=2.241, best=2.035]Training (xattn/resnet18):  64%|██████▍   | 64/100 [06:06<03:24,  5.68s/it, train loss=0.6196, val ΔE00=2.241, best=2.035]Training (xattn/resnet18):  64%|██████▍   | 64/100 [06:06<03:24,  5.68s/it, train loss=0.6524, val ΔE00=2.195, best=2.035]Training (xattn/resnet18):  65%|██████▌   | 65/100 [06:12<03:21,  5.74s/it, train loss=0.6524, val ΔE00=2.195, best=2.035]Training (xattn/resnet18):  65%|██████▌   | 65/100 [06:12<03:21,  5.74s/it, train loss=0.6831, val ΔE00=2.380, best=2.035]Training (xattn/resnet18):  66%|██████▌   | 66/100 [06:18<03:14,  5.72s/it, train loss=0.6831, val ΔE00=2.380, best=2.035]Training (xattn/resnet18):  66%|██████▌   | 66/100 [06:18<03:14,  5.72s/it, train loss=0.5752, val ΔE00=2.262, best=2.035]Training (xattn/resnet18):  67%|██████▋   | 67/100 [06:23<03:08,  5.70s/it, train loss=0.5752, val ΔE00=2.262, best=2.035]Training (xattn/resnet18):  67%|██████▋   | 67/100 [06:23<03:08,  5.70s/it, train loss=0.6621, val ΔE00=2.511, best=2.035]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:29<03:01,  5.69s/it, train loss=0.6621, val ΔE00=2.511, best=2.035]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:29<03:01,  5.69s/it, train loss=0.6571, val ΔE00=2.425, best=2.035]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:35<03:01,  5.69s/it, train loss=0.7200, val ΔE00=2.031, early_stop=yes]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:35<03:06,  5.81s/it, train loss=0.7200, val ΔE00=2.031, early_stop=yes]
[early] stop at epoch 69 (best de00=2.0349 @ 31)
[done] best ΔE00=2.035 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/xattn__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 24/24 ===
[sweep] id=024_model=xattn__backbone=resnet18__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/bg2/full --logdir ./runs/results/bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 60 --restore_best_on_stop --model xattn --backbone resnet18 --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=resnet18, features=image+mean+meta, meta_encoder=none
[run] model=xattn backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:17,  6.24s/it]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:17,  6.24s/it, train loss=0.0077, val ΔE00=4.941, best=4.941]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:39,  5.92s/it, train loss=0.0077, val ΔE00=4.941, best=4.941]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:39,  5.92s/it, train loss=0.0038, val ΔE00=3.627, best=3.627]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:23,  5.81s/it, train loss=0.0038, val ΔE00=3.627, best=3.627]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:23,  5.81s/it, train loss=0.0071, val ΔE00=3.487, best=3.487]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:11,  5.74s/it, train loss=0.0071, val ΔE00=3.487, best=3.487]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:11,  5.74s/it, train loss=0.0111, val ΔE00=3.496, best=3.487]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:11,  5.81s/it, train loss=0.0111, val ΔE00=3.496, best=3.487]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:11,  5.81s/it, train loss=0.0189, val ΔE00=3.298, best=3.298]Training (xattn/resnet18):   6%|▌         | 6/100 [00:34<09:04,  5.79s/it, train loss=0.0189, val ΔE00=3.298, best=3.298]Training (xattn/resnet18):   6%|▌         | 6/100 [00:34<09:04,  5.79s/it, train loss=0.0262, val ΔE00=2.979, best=2.979]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:55,  5.76s/it, train loss=0.0262, val ΔE00=2.979, best=2.979]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:55,  5.76s/it, train loss=0.0352, val ΔE00=2.671, best=2.671]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:46,  5.73s/it, train loss=0.0352, val ΔE00=2.671, best=2.671]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:46,  5.73s/it, train loss=0.0441, val ΔE00=3.138, best=2.671]Training (xattn/resnet18):   9%|▉         | 9/100 [00:51<08:40,  5.72s/it, train loss=0.0441, val ΔE00=3.138, best=2.671]Training (xattn/resnet18):   9%|▉         | 9/100 [00:51<08:40,  5.72s/it, train loss=0.0515, val ΔE00=2.630, best=2.630]Training (xattn/resnet18):  10%|█         | 10/100 [00:57<08:37,  5.75s/it, train loss=0.0515, val ΔE00=2.630, best=2.630]Training (xattn/resnet18):  10%|█         | 10/100 [00:57<08:37,  5.75s/it, train loss=0.0602, val ΔE00=2.957, best=2.630]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:31,  5.74s/it, train loss=0.0602, val ΔE00=2.957, best=2.630]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:31,  5.74s/it, train loss=0.0691, val ΔE00=2.508, best=2.508]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:09<08:24,  5.73s/it, train loss=0.0691, val ΔE00=2.508, best=2.508]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:09<08:24,  5.73s/it, train loss=0.0721, val ΔE00=2.488, best=2.488]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:14<08:15,  5.70s/it, train loss=0.0721, val ΔE00=2.488, best=2.488]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:14<08:15,  5.70s/it, train loss=0.0839, val ΔE00=2.534, best=2.488]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:20<08:09,  5.70s/it, train loss=0.0839, val ΔE00=2.534, best=2.488]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:20<08:09,  5.70s/it, train loss=0.0926, val ΔE00=2.362, best=2.362]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:07,  5.73s/it, train loss=0.0926, val ΔE00=2.362, best=2.362]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:07,  5.73s/it, train loss=0.1062, val ΔE00=2.685, best=2.362]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:32<08:01,  5.74s/it, train loss=0.1062, val ΔE00=2.685, best=2.362]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:32<08:01,  5.74s/it, train loss=0.1140, val ΔE00=2.324, best=2.324]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:37<07:55,  5.73s/it, train loss=0.1140, val ΔE00=2.324, best=2.324]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:37<07:55,  5.73s/it, train loss=0.1297, val ΔE00=2.272, best=2.272]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:43<07:48,  5.72s/it, train loss=0.1297, val ΔE00=2.272, best=2.272]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:43<07:48,  5.72s/it, train loss=0.1322, val ΔE00=2.268, best=2.268]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:49<07:42,  5.71s/it, train loss=0.1322, val ΔE00=2.268, best=2.268]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:49<07:42,  5.71s/it, train loss=0.1294, val ΔE00=2.190, best=2.190]Training (xattn/resnet18):  20%|██        | 20/100 [01:55<07:39,  5.74s/it, train loss=0.1294, val ΔE00=2.190, best=2.190]Training (xattn/resnet18):  20%|██        | 20/100 [01:55<07:39,  5.74s/it, train loss=0.1397, val ΔE00=2.469, best=2.190]Training (xattn/resnet18):  21%|██        | 21/100 [02:00<07:32,  5.73s/it, train loss=0.1397, val ΔE00=2.469, best=2.190]Training (xattn/resnet18):  21%|██        | 21/100 [02:00<07:32,  5.73s/it, train loss=0.1576, val ΔE00=2.295, best=2.190]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:06<07:24,  5.70s/it, train loss=0.1576, val ΔE00=2.295, best=2.190]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:06<07:24,  5.70s/it, train loss=0.1747, val ΔE00=2.441, best=2.190]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:12<07:17,  5.68s/it, train loss=0.1747, val ΔE00=2.441, best=2.190]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:12<07:17,  5.68s/it, train loss=0.1724, val ΔE00=2.487, best=2.190]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:17<07:10,  5.67s/it, train loss=0.1724, val ΔE00=2.487, best=2.190]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:17<07:10,  5.67s/it, train loss=0.1874, val ΔE00=2.329, best=2.190]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:23<07:09,  5.72s/it, train loss=0.1874, val ΔE00=2.329, best=2.190]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:23<07:09,  5.72s/it, train loss=0.1814, val ΔE00=2.581, best=2.190]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:29<07:01,  5.70s/it, train loss=0.1814, val ΔE00=2.581, best=2.190]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:29<07:01,  5.70s/it, train loss=0.1979, val ΔE00=2.324, best=2.190]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:34<06:54,  5.68s/it, train loss=0.1979, val ΔE00=2.324, best=2.190]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:34<06:54,  5.68s/it, train loss=0.2127, val ΔE00=2.315, best=2.190]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:40<06:47,  5.66s/it, train loss=0.2127, val ΔE00=2.315, best=2.190]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:40<06:47,  5.66s/it, train loss=0.2163, val ΔE00=2.526, best=2.190]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:46<06:41,  5.66s/it, train loss=0.2163, val ΔE00=2.526, best=2.190]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:46<06:41,  5.66s/it, train loss=0.2173, val ΔE00=2.204, best=2.190]Training (xattn/resnet18):  30%|███       | 30/100 [02:51<06:39,  5.71s/it, train loss=0.2173, val ΔE00=2.204, best=2.190]Training (xattn/resnet18):  30%|███       | 30/100 [02:51<06:39,  5.71s/it, train loss=0.2695, val ΔE00=2.329, best=2.190]Training (xattn/resnet18):  31%|███       | 31/100 [02:57<06:33,  5.70s/it, train loss=0.2695, val ΔE00=2.329, best=2.190]Training (xattn/resnet18):  31%|███       | 31/100 [02:57<06:33,  5.70s/it, train loss=0.2416, val ΔE00=2.191, best=2.190]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:03<06:27,  5.70s/it, train loss=0.2416, val ΔE00=2.191, best=2.190]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:03<06:27,  5.70s/it, train loss=0.2533, val ΔE00=2.115, best=2.115]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:08<06:20,  5.68s/it, train loss=0.2533, val ΔE00=2.115, best=2.115]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:08<06:20,  5.68s/it, train loss=0.2642, val ΔE00=2.169, best=2.115]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:14<06:14,  5.67s/it, train loss=0.2642, val ΔE00=2.169, best=2.115]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:14<06:14,  5.67s/it, train loss=0.2675, val ΔE00=2.304, best=2.115]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:20<06:11,  5.72s/it, train loss=0.2675, val ΔE00=2.304, best=2.115]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:20<06:11,  5.72s/it, train loss=0.3083, val ΔE00=2.165, best=2.115]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:26<06:05,  5.71s/it, train loss=0.3083, val ΔE00=2.165, best=2.115]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:26<06:05,  5.71s/it, train loss=0.3017, val ΔE00=2.126, best=2.115]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:31<05:57,  5.68s/it, train loss=0.3017, val ΔE00=2.126, best=2.115]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:31<05:57,  5.68s/it, train loss=0.2937, val ΔE00=2.257, best=2.115]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:37<05:52,  5.68s/it, train loss=0.2937, val ΔE00=2.257, best=2.115]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:37<05:52,  5.68s/it, train loss=0.2714, val ΔE00=2.080, best=2.080]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:42<05:45,  5.67s/it, train loss=0.2714, val ΔE00=2.080, best=2.080]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:42<05:45,  5.67s/it, train loss=0.2881, val ΔE00=2.413, best=2.080]Training (xattn/resnet18):  40%|████      | 40/100 [03:48<05:43,  5.72s/it, train loss=0.2881, val ΔE00=2.413, best=2.080]Training (xattn/resnet18):  40%|████      | 40/100 [03:48<05:43,  5.72s/it, train loss=0.3010, val ΔE00=2.267, best=2.080]Training (xattn/resnet18):  41%|████      | 41/100 [03:54<05:36,  5.70s/it, train loss=0.3010, val ΔE00=2.267, best=2.080]Training (xattn/resnet18):  41%|████      | 41/100 [03:54<05:36,  5.70s/it, train loss=0.3036, val ΔE00=2.250, best=2.080]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:00<05:29,  5.68s/it, train loss=0.3036, val ΔE00=2.250, best=2.080]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:00<05:29,  5.68s/it, train loss=0.3485, val ΔE00=2.294, best=2.080]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:05<05:23,  5.67s/it, train loss=0.3485, val ΔE00=2.294, best=2.080]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:05<05:23,  5.67s/it, train loss=0.3275, val ΔE00=2.230, best=2.080]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:11<05:16,  5.65s/it, train loss=0.3275, val ΔE00=2.230, best=2.080]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:11<05:16,  5.65s/it, train loss=0.3218, val ΔE00=2.137, best=2.080]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:17<05:14,  5.72s/it, train loss=0.3218, val ΔE00=2.137, best=2.080]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:17<05:14,  5.72s/it, train loss=0.2941, val ΔE00=2.232, best=2.080]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:22<05:07,  5.70s/it, train loss=0.2941, val ΔE00=2.232, best=2.080]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:22<05:07,  5.70s/it, train loss=0.3795, val ΔE00=2.190, best=2.080]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:28<05:00,  5.68s/it, train loss=0.3795, val ΔE00=2.190, best=2.080]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:28<05:00,  5.68s/it, train loss=0.3594, val ΔE00=2.119, best=2.080]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:34<04:54,  5.67s/it, train loss=0.3594, val ΔE00=2.119, best=2.080]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:34<04:54,  5.67s/it, train loss=0.3707, val ΔE00=2.267, best=2.080]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:39<04:48,  5.66s/it, train loss=0.3707, val ΔE00=2.267, best=2.080]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:39<04:48,  5.66s/it, train loss=0.4247, val ΔE00=2.129, best=2.080]Training (xattn/resnet18):  50%|█████     | 50/100 [04:45<04:45,  5.71s/it, train loss=0.4247, val ΔE00=2.129, best=2.080]Training (xattn/resnet18):  50%|█████     | 50/100 [04:45<04:45,  5.71s/it, train loss=0.3420, val ΔE00=2.153, best=2.080]Training (xattn/resnet18):  51%|█████     | 51/100 [04:51<04:39,  5.70s/it, train loss=0.3420, val ΔE00=2.153, best=2.080]Training (xattn/resnet18):  51%|█████     | 51/100 [04:51<04:39,  5.70s/it, train loss=0.3998, val ΔE00=2.160, best=2.080]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:56<04:32,  5.68s/it, train loss=0.3998, val ΔE00=2.160, best=2.080]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:56<04:32,  5.68s/it, train loss=0.3641, val ΔE00=2.101, best=2.080]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:02<04:26,  5.67s/it, train loss=0.3641, val ΔE00=2.101, best=2.080]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:02<04:26,  5.67s/it, train loss=0.3715, val ΔE00=2.208, best=2.080]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:08<04:20,  5.66s/it, train loss=0.3715, val ΔE00=2.208, best=2.080]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:08<04:20,  5.66s/it, train loss=0.3355, val ΔE00=2.139, best=2.080]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:14<04:16,  5.71s/it, train loss=0.3355, val ΔE00=2.139, best=2.080]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:14<04:16,  5.71s/it, train loss=0.3456, val ΔE00=2.190, best=2.080]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:19<04:10,  5.69s/it, train loss=0.3456, val ΔE00=2.190, best=2.080]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:19<04:10,  5.69s/it, train loss=0.3538, val ΔE00=2.157, best=2.080]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:25<04:04,  5.68s/it, train loss=0.3538, val ΔE00=2.157, best=2.080]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:25<04:04,  5.68s/it, train loss=0.3637, val ΔE00=2.260, best=2.080]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:31<03:57,  5.67s/it, train loss=0.3637, val ΔE00=2.260, best=2.080]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:31<03:57,  5.67s/it, train loss=0.3697, val ΔE00=2.233, best=2.080]Training (xattn/resnet18):  59%|█████▉    | 59/100 [05:36<03:51,  5.65s/it, train loss=0.3697, val ΔE00=2.233, best=2.080]Training (xattn/resnet18):  59%|█████▉    | 59/100 [05:36<03:51,  5.65s/it, train loss=0.3631, val ΔE00=2.159, best=2.080]Training (xattn/resnet18):  60%|██████    | 60/100 [05:42<03:48,  5.71s/it, train loss=0.3631, val ΔE00=2.159, best=2.080]Training (xattn/resnet18):  60%|██████    | 60/100 [05:42<03:48,  5.71s/it, train loss=0.3873, val ΔE00=2.091, best=2.080]Training (xattn/resnet18):  61%|██████    | 61/100 [05:48<03:42,  5.71s/it, train loss=0.3873, val ΔE00=2.091, best=2.080]Training (xattn/resnet18):  61%|██████    | 61/100 [05:48<03:42,  5.71s/it, train loss=0.3609, val ΔE00=2.067, best=2.067]Training (xattn/resnet18):  62%|██████▏   | 62/100 [05:53<03:36,  5.69s/it, train loss=0.3609, val ΔE00=2.067, best=2.067]Training (xattn/resnet18):  62%|██████▏   | 62/100 [05:53<03:36,  5.69s/it, train loss=0.4192, val ΔE00=2.081, best=2.067]Training (xattn/resnet18):  63%|██████▎   | 63/100 [05:59<03:29,  5.67s/it, train loss=0.4192, val ΔE00=2.081, best=2.067]Training (xattn/resnet18):  63%|██████▎   | 63/100 [05:59<03:29,  5.67s/it, train loss=0.3750, val ΔE00=2.096, best=2.067]Training (xattn/resnet18):  64%|██████▍   | 64/100 [06:05<03:23,  5.66s/it, train loss=0.3750, val ΔE00=2.096, best=2.067]Training (xattn/resnet18):  64%|██████▍   | 64/100 [06:05<03:23,  5.66s/it, train loss=0.3372, val ΔE00=2.111, best=2.067]Training (xattn/resnet18):  65%|██████▌   | 65/100 [06:10<03:19,  5.71s/it, train loss=0.3372, val ΔE00=2.111, best=2.067]Training (xattn/resnet18):  65%|██████▌   | 65/100 [06:10<03:19,  5.71s/it, train loss=0.3477, val ΔE00=2.277, best=2.067]Training (xattn/resnet18):  66%|██████▌   | 66/100 [06:16<03:13,  5.69s/it, train loss=0.3477, val ΔE00=2.277, best=2.067]Training (xattn/resnet18):  66%|██████▌   | 66/100 [06:16<03:13,  5.69s/it, train loss=0.3758, val ΔE00=2.088, best=2.067]Training (xattn/resnet18):  67%|██████▋   | 67/100 [06:22<03:07,  5.67s/it, train loss=0.3758, val ΔE00=2.088, best=2.067]Training (xattn/resnet18):  67%|██████▋   | 67/100 [06:22<03:07,  5.67s/it, train loss=0.3632, val ΔE00=2.087, best=2.067]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:27<03:01,  5.66s/it, train loss=0.3632, val ΔE00=2.087, best=2.067]Training (xattn/resnet18):  68%|██████▊   | 68/100 [06:27<03:01,  5.66s/it, train loss=0.3306, val ΔE00=2.188, best=2.067]Training (xattn/resnet18):  69%|██████▉   | 69/100 [06:33<02:55,  5.65s/it, train loss=0.3306, val ΔE00=2.188, best=2.067]Training (xattn/resnet18):  69%|██████▉   | 69/100 [06:33<02:55,  5.65s/it, train loss=0.3958, val ΔE00=2.095, best=2.067]Training (xattn/resnet18):  70%|███████   | 70/100 [06:39<02:51,  5.73s/it, train loss=0.3958, val ΔE00=2.095, best=2.067]Training (xattn/resnet18):  70%|███████   | 70/100 [06:39<02:51,  5.73s/it, train loss=0.3410, val ΔE00=2.052, best=2.052]Training (xattn/resnet18):  71%|███████   | 71/100 [06:45<02:45,  5.71s/it, train loss=0.3410, val ΔE00=2.052, best=2.052]Training (xattn/resnet18):  71%|███████   | 71/100 [06:45<02:45,  5.71s/it, train loss=0.3742, val ΔE00=2.317, best=2.052]Training (xattn/resnet18):  72%|███████▏  | 72/100 [06:50<02:39,  5.69s/it, train loss=0.3742, val ΔE00=2.317, best=2.052]Training (xattn/resnet18):  72%|███████▏  | 72/100 [06:50<02:39,  5.69s/it, train loss=0.3433, val ΔE00=2.350, best=2.052]Training (xattn/resnet18):  73%|███████▎  | 73/100 [06:56<02:33,  5.67s/it, train loss=0.3433, val ΔE00=2.350, best=2.052]Training (xattn/resnet18):  73%|███████▎  | 73/100 [06:56<02:33,  5.67s/it, train loss=0.3585, val ΔE00=2.055, best=2.052]Training (xattn/resnet18):  74%|███████▍  | 74/100 [07:01<02:27,  5.66s/it, train loss=0.3585, val ΔE00=2.055, best=2.052]Training (xattn/resnet18):  74%|███████▍  | 74/100 [07:01<02:27,  5.66s/it, train loss=0.3575, val ΔE00=2.131, best=2.052]Training (xattn/resnet18):  75%|███████▌  | 75/100 [07:07<02:22,  5.71s/it, train loss=0.3575, val ΔE00=2.131, best=2.052]Training (xattn/resnet18):  75%|███████▌  | 75/100 [07:07<02:22,  5.71s/it, train loss=0.3595, val ΔE00=2.145, best=2.052]Training (xattn/resnet18):  76%|███████▌  | 76/100 [07:13<02:16,  5.71s/it, train loss=0.3595, val ΔE00=2.145, best=2.052]Training (xattn/resnet18):  76%|███████▌  | 76/100 [07:13<02:16,  5.71s/it, train loss=0.3581, val ΔE00=2.083, best=2.052]Training (xattn/resnet18):  77%|███████▋  | 77/100 [07:19<02:10,  5.68s/it, train loss=0.3581, val ΔE00=2.083, best=2.052]Training (xattn/resnet18):  77%|███████▋  | 77/100 [07:19<02:10,  5.68s/it, train loss=0.3426, val ΔE00=2.093, best=2.052]Training (xattn/resnet18):  78%|███████▊  | 78/100 [07:24<02:04,  5.67s/it, train loss=0.3426, val ΔE00=2.093, best=2.052]Training (xattn/resnet18):  78%|███████▊  | 78/100 [07:24<02:04,  5.67s/it, train loss=0.3900, val ΔE00=2.192, best=2.052]Training (xattn/resnet18):  79%|███████▉  | 79/100 [07:30<01:58,  5.66s/it, train loss=0.3900, val ΔE00=2.192, best=2.052]Training (xattn/resnet18):  79%|███████▉  | 79/100 [07:30<01:58,  5.66s/it, train loss=0.3489, val ΔE00=2.174, best=2.052]Training (xattn/resnet18):  79%|███████▉  | 79/100 [07:36<01:58,  5.66s/it, train loss=0.3876, val ΔE00=2.095, early_stop=yes]Training (xattn/resnet18):  79%|███████▉  | 79/100 [07:36<02:01,  5.77s/it, train loss=0.3876, val ΔE00=2.095, early_stop=yes]
[early] stop at epoch 80 (best de00=2.0523 @ 70)
[done] best ΔE00=2.052 over 80 epochs
[eval] Wrote final summary → ./checkpoints/results/bg2/full/xattn__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean+meta/final_summary.json (kind=val)
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/bg2/full --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/bg2/bg2_full_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/bg2/bg2_full_summary_groups.csv --md_report /home/dominik/repo/results/results/bg2/bg2_full_summary_report.md --grid_keys backbone features model --prefer_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 24 checkpoint files and 24 json summaries.
[diag] loaded records by kind: {'val': 48}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/bg2/bg2_full_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/bg2/bg2_full_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/bg2/bg2_full_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/bg2/bg2_full_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/bg2/bg2_full_summary_report.md

[ELIMINATION CANDIDATES]
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/bg2/full --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/bg2/bg2_full_pretest_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/bg2/bg2_full_pretest_summary_groups.csv --md_report /home/dominik/repo/results/results/bg2/bg2_full_pretest_summary_report.md --grid_keys backbone features model --prefer_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 24 checkpoint files and 24 json summaries.
[diag] loaded records by kind: {'val': 48}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/bg2/bg2_full_pretest_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/bg2/bg2_full_pretest_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/bg2/bg2_full_pretest_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/bg2/bg2_full_pretest_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/bg2/bg2_full_pretest_summary_report.md

[ELIMINATION CANDIDATES]
[eval] Selecting up to top_k=20 unique group winner(s) for TEST in FULL-only mode.
[eval][debug] winners (grouped): [{'model': 'xattn', 'backbone': 'smallcnn', 'features': 'image+mean+meta'}, {'model': 'xattn', 'backbone': 'smallcnn', 'features': 'image+mean'}, {'model': 'film', 'backbone': 'resnet18', 'features': 'image+mean+meta'}, {'model': 'film', 'backbone': 'smallcnn', 'features': 'image+mean+meta'}, {'model': 'film', 'backbone': 'resnet18', 'features': 'image'}, {'model': 'xattn', 'backbone': 'resnet18', 'features': 'image+mean'}, {'model': 'film', 'backbone': 'resnet18', 'features': 'image+mean'}, {'model': 'xattn', 'backbone': 'smallcnn', 'features': 'image+meta'}, {'model': 'film', 'backbone': 'smallcnn', 'features': 'image+mean'}, {'model': 'film', 'backbone': 'resnet18', 'features': 'image+meta'}, {'model': 'xattn', 'backbone': 'resnet18', 'features': 'image+meta'}, {'model': 'xattn', 'backbone': 'resnet18', 'features': 'image+mean+meta'}, {'model': 'late', 'backbone': 'resnet18', 'features': 'image+mean'}, {'model': 'late', 'backbone': 'resnet18', 'features': 'image+mean+meta'}, {'model': 'late', 'backbone': 'smallcnn', 'features': 'image+mean+meta'}, {'model': 'late', 'backbone': 'resnet18', 'features': 'image'}, {'model': 'late', 'backbone': 'resnet18', 'features': 'image+meta'}, {'model': 'xattn', 'backbone': 'resnet18', 'features': 'image'}, {'model': 'late', 'backbone': 'smallcnn', 'features': 'image+mean'}, {'model': 'film', 'backbone': 'smallcnn', 'features': 'image'}]
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/xattn__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+mean+meta/xattn_smallcnn_e063_de001.7373.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/6e87c305e854/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval] inferred attn_dim=256 from checkpoint.
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/6e87c305e854/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/xattn__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+mean/xattn_smallcnn_e067_de001.7966.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/14159ef67ff2/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval] inferred attn_dim=256 from checkpoint.
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/14159ef67ff2/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/film__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+mean+meta/film_resnet18_e067_de001.8758.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/359cb7704fca/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/359cb7704fca/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/film__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean+meta/film_smallcnn_e042_de001.8847.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/caf256c9b8a9/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/caf256c9b8a9/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/film__resnet18__image__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image/film_resnet18_e044_de001.8992.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/21a0190ee6f1/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/21a0190ee6f1/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/xattn__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean+meta/xattn_resnet18_e070_de002.0523.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/1f834ddfeef4/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval] inferred attn_dim=256 from checkpoint.
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/1f834ddfeef4/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/film__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+mean/film_resnet18_e058_de001.9341.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/d44325f74475/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/d44325f74475/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/xattn__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+meta/xattn_smallcnn_e064_de001.9614.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/4a5fd0d3a900/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval] inferred attn_dim=256 from checkpoint.
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/4a5fd0d3a900/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/film__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean/film_smallcnn_e057_de001.9742.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/45720b8dd8be/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/45720b8dd8be/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/film__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+meta/film_resnet18_e055_de001.9745.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/493fa80601ab/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/493fa80601ab/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/xattn__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+meta/xattn_resnet18_e069_de002.0307.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/657b7d8e311f/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval] inferred attn_dim=256 from checkpoint.
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/657b7d8e311f/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/xattn__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean+meta/xattn_resnet18_e070_de002.0523.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/6796011c5534/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval] inferred attn_dim=256 from checkpoint.
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/6796011c5534/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/late__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean/late_resnet18_e061_de002.0746.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/09e5536fc9a0/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/09e5536fc9a0/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/late__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean+meta/late_resnet18_e069_de002.0799.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/55fac85d0c33/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/55fac85d0c33/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/late__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean+meta/late_smallcnn_e057_de002.1169.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/89c22698f5c6/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/89c22698f5c6/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/late__resnet18__image__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image/late_resnet18_e055_de002.1335.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/0f27f23429e2/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/0f27f23429e2/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/late__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+meta/late_resnet18_e056_de002.1443.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/ee46c590a383/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/ee46c590a383/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/xattn__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean+meta/xattn_resnet18_e070_de002.0523.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/c86f05b55952/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval] inferred attn_dim=256 from checkpoint.
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/c86f05b55952/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/late__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean/late_smallcnn_e080_de002.1979.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/04855dd162f4/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/04855dd162f4/final_summary.json
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/bg2/full/film__smallcnn__image__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image/film_smallcnn_e057_de002.2229.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/bg2/full/final_test/dcb8c5ba1a3c/final_summary.json --token_stage -2.0
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[eval][ok] Test eval complete. Wrote → ./checkpoints/results/bg2/full/final_test/dcb8c5ba1a3c/final_summary.json
[eval] winners(full-only): ok=20 fail=0
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/bg2/full --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/bg2/bg2_single_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/bg2/bg2_single_summary_groups.csv --md_report /home/dominik/repo/results/results/bg2/bg2_single_summary_report.md --grid_keys backbone features model --prefer_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 24 checkpoint files and 24 json summaries.
[diag] loaded records by kind: {'val': 48}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/bg2/bg2_single_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/bg2/bg2_single_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/bg2/bg2_single_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/bg2/bg2_single_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/bg2/bg2_single_summary_report.md

[ELIMINATION CANDIDATES]
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/bg2/full ./checkpoints/results/bg2/full/final_test --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/bg2/bg2_test_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/bg2/bg2_test_summary_groups.csv --md_report /home/dominik/repo/results/results/bg2/bg2_test_summary_report.md --grid_keys backbone features model --prefer_test --only_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 24 checkpoint files and 44 json summaries.
[diag] loaded records by kind: {'val': 48, 'test': 20}
[diag] sample TEST rows:
        0.8064 <- ./checkpoints/results/bg2/full/final_test/1f834ddfeef4/final_summary.json
        0.8510 <- ./checkpoints/results/bg2/full/final_test/d44325f74475/final_summary.json
        0.8768 <- ./checkpoints/results/bg2/full/final_test/09e5536fc9a0/final_summary.json
[ok] Wrote per-run summary: /home/dominik/repo/results/results/bg2/bg2_test_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/bg2/bg2_test_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/bg2/bg2_test_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/bg2/bg2_test_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/bg2/bg2_test_summary_report.md

[ELIMINATION CANDIDATES]
- by backbone: top 1 worst vs best median
backbone  count   median     mean      std  delta_vs_best
smallcnn      8 1.763014 1.678875 0.290654       0.748217
[analysis] runs_csv=/home/dominik/repo/results/results/bg2/analysis/analysis_input.csv
[analysis] mode=both test_split_file=./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json outdir=/home/dominik/repo/results/results/bg2/analysis
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/217021d3d0a9/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/217021d3d0a9/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/2087425f8cd4/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/2087425f8cd4/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/212bdf2b6e71/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/212bdf2b6e71/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/712fb3604eae/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/712fb3604eae/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/41a62ec7ec80/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/41a62ec7ec80/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/b1c5369cde43/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/b1c5369cde43/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/70f6bb681e64/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/70f6bb681e64/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/590915ceb157/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/590915ceb157/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/fae892177eee/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/fae892177eee/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/5d334d895b08/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/5d334d895b08/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/367246e9d25c/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/367246e9d25c/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/0654a58f64b4/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/0654a58f64b4/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/615299a2596e/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/615299a2596e/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/14a793874137/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/14a793874137/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/286cb3e3ee11/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/286cb3e3ee11/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/227058fa5f99/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/227058fa5f99/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/3dcd3ae4334e/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/3dcd3ae4334e/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/279595b9fed2/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/279595b9fed2/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/56cfe7d9bf07/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/56cfe7d9bf07/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/935b052f29ae/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/935b052f29ae/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/387375c050e7/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/387375c050e7/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/0d2f4f535cbb/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/0d2f4f535cbb/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/87039354abfa/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/87039354abfa/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/16235f199369/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/bg2/analysis/16235f199369/test_report.html
[ok] Wrote manifest: /home/dominik/repo/results/results/bg2/analysis/analysis_manifest.csv
[sweep] FULL-only mode complete.
[sweep] OK: ./configs/results/bg2.yaml

