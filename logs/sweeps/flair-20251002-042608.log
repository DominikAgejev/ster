[sweep] === ./configs/results/flair.yaml ===
[sweep] cmd: python [sweep] cmd: -u [sweep] cmd: -m [sweep] cmd: src.engine.sweep [sweep] cmd: --config [sweep] cmd: ./configs/results/flair.yaml [sweep] cmd: --only_full [sweep] cmd: --auto-summary [sweep] cmd: --analysis [sweep] cmd: --eval-winners [sweep] cmd: --test_split_file [sweep] cmd: AUTO [sweep] cmd: --skip-existing 
[sweep] FULL-only mode: training full stage for all runs.
[sweep] === Run 1/12 ===
[sweep] id=001_model=late__backbone=smallcnn__features=image+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone smallcnn --features image+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=late, backbone=smallcnn, features=image+meta, meta_encoder=flair
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:58,  5.44s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:58,  5.44s/it, train loss=0.0122, val ΔE00=12.366, best=12.366]Training (late/smallcnn):   2%|▏         | 2/100 [00:10<08:29,  5.20s/it, train loss=0.0122, val ΔE00=12.366, best=12.366]Training (late/smallcnn):   2%|▏         | 2/100 [00:10<08:29,  5.20s/it, train loss=0.0102, val ΔE00=9.993, best=9.993]  Training (late/smallcnn):   3%|▎         | 3/100 [00:15<08:17,  5.12s/it, train loss=0.0102, val ΔE00=9.993, best=9.993]Training (late/smallcnn):   3%|▎         | 3/100 [00:15<08:17,  5.12s/it, train loss=0.0150, val ΔE00=5.919, best=5.919]Training (late/smallcnn):   4%|▍         | 4/100 [00:20<08:10,  5.11s/it, train loss=0.0150, val ΔE00=5.919, best=5.919]Training (late/smallcnn):   4%|▍         | 4/100 [00:20<08:10,  5.11s/it, train loss=0.0238, val ΔE00=8.256, best=5.919]Training (late/smallcnn):   5%|▌         | 5/100 [00:25<08:13,  5.19s/it, train loss=0.0238, val ΔE00=8.256, best=5.919]Training (late/smallcnn):   5%|▌         | 5/100 [00:25<08:13,  5.19s/it, train loss=0.0360, val ΔE00=7.037, best=5.919]Training (late/smallcnn):   6%|▌         | 6/100 [00:31<08:06,  5.18s/it, train loss=0.0360, val ΔE00=7.037, best=5.919]Training (late/smallcnn):   6%|▌         | 6/100 [00:31<08:06,  5.18s/it, train loss=0.0515, val ΔE00=5.677, best=5.677]Training (late/smallcnn):   7%|▋         | 7/100 [00:36<07:56,  5.12s/it, train loss=0.0515, val ΔE00=5.677, best=5.677]Training (late/smallcnn):   7%|▋         | 7/100 [00:36<07:56,  5.12s/it, train loss=0.0665, val ΔE00=5.127, best=5.127]Training (late/smallcnn):   8%|▊         | 8/100 [00:41<07:48,  5.09s/it, train loss=0.0665, val ΔE00=5.127, best=5.127]Training (late/smallcnn):   8%|▊         | 8/100 [00:41<07:48,  5.09s/it, train loss=0.0839, val ΔE00=5.008, best=5.008]Training (late/smallcnn):   9%|▉         | 9/100 [00:46<07:41,  5.07s/it, train loss=0.0839, val ΔE00=5.008, best=5.008]Training (late/smallcnn):   9%|▉         | 9/100 [00:46<07:41,  5.07s/it, train loss=0.1048, val ΔE00=5.543, best=5.008]Training (late/smallcnn):  10%|█         | 10/100 [00:51<07:42,  5.14s/it, train loss=0.1048, val ΔE00=5.543, best=5.008]Training (late/smallcnn):  10%|█         | 10/100 [00:51<07:42,  5.14s/it, train loss=0.1245, val ΔE00=3.821, best=3.821]Training (late/smallcnn):  11%|█         | 11/100 [00:56<07:37,  5.14s/it, train loss=0.1245, val ΔE00=3.821, best=3.821]Training (late/smallcnn):  11%|█         | 11/100 [00:56<07:37,  5.14s/it, train loss=0.1456, val ΔE00=5.466, best=3.821]Training (late/smallcnn):  12%|█▏        | 12/100 [01:01<07:29,  5.11s/it, train loss=0.1456, val ΔE00=5.466, best=3.821]Training (late/smallcnn):  12%|█▏        | 12/100 [01:01<07:29,  5.11s/it, train loss=0.1722, val ΔE00=3.503, best=3.503]Training (late/smallcnn):  13%|█▎        | 13/100 [01:06<07:22,  5.08s/it, train loss=0.1722, val ΔE00=3.503, best=3.503]Training (late/smallcnn):  13%|█▎        | 13/100 [01:06<07:22,  5.08s/it, train loss=0.1927, val ΔE00=4.179, best=3.503]Training (late/smallcnn):  14%|█▍        | 14/100 [01:11<07:15,  5.06s/it, train loss=0.1927, val ΔE00=4.179, best=3.503]Training (late/smallcnn):  14%|█▍        | 14/100 [01:11<07:15,  5.06s/it, train loss=0.2144, val ΔE00=3.550, best=3.503]Training (late/smallcnn):  15%|█▌        | 15/100 [01:16<07:17,  5.15s/it, train loss=0.2144, val ΔE00=3.550, best=3.503]Training (late/smallcnn):  15%|█▌        | 15/100 [01:16<07:17,  5.15s/it, train loss=0.2599, val ΔE00=4.450, best=3.503]Training (late/smallcnn):  16%|█▌        | 16/100 [01:22<07:12,  5.15s/it, train loss=0.2599, val ΔE00=4.450, best=3.503]Training (late/smallcnn):  16%|█▌        | 16/100 [01:22<07:12,  5.15s/it, train loss=0.2917, val ΔE00=4.164, best=3.503]Training (late/smallcnn):  17%|█▋        | 17/100 [01:27<07:04,  5.11s/it, train loss=0.2917, val ΔE00=4.164, best=3.503]Training (late/smallcnn):  17%|█▋        | 17/100 [01:27<07:04,  5.11s/it, train loss=0.2981, val ΔE00=5.005, best=3.503]Training (late/smallcnn):  18%|█▊        | 18/100 [01:32<06:56,  5.08s/it, train loss=0.2981, val ΔE00=5.005, best=3.503]Training (late/smallcnn):  18%|█▊        | 18/100 [01:32<06:56,  5.08s/it, train loss=0.3412, val ΔE00=4.390, best=3.503]Training (late/smallcnn):  19%|█▉        | 19/100 [01:37<06:49,  5.06s/it, train loss=0.3412, val ΔE00=4.390, best=3.503]Training (late/smallcnn):  19%|█▉        | 19/100 [01:37<06:49,  5.06s/it, train loss=0.3688, val ΔE00=7.362, best=3.503]Training (late/smallcnn):  20%|██        | 20/100 [01:42<06:50,  5.13s/it, train loss=0.3688, val ΔE00=7.362, best=3.503]Training (late/smallcnn):  20%|██        | 20/100 [01:42<06:50,  5.13s/it, train loss=0.4212, val ΔE00=5.714, best=3.503]Training (late/smallcnn):  21%|██        | 21/100 [01:47<06:45,  5.14s/it, train loss=0.4212, val ΔE00=5.714, best=3.503]Training (late/smallcnn):  21%|██        | 21/100 [01:47<06:45,  5.14s/it, train loss=0.4334, val ΔE00=4.333, best=3.503]Training (late/smallcnn):  22%|██▏       | 22/100 [01:52<06:38,  5.11s/it, train loss=0.4334, val ΔE00=4.333, best=3.503]Training (late/smallcnn):  22%|██▏       | 22/100 [01:52<06:38,  5.11s/it, train loss=0.4900, val ΔE00=3.278, best=3.278]Training (late/smallcnn):  23%|██▎       | 23/100 [01:57<06:31,  5.08s/it, train loss=0.4900, val ΔE00=3.278, best=3.278]Training (late/smallcnn):  23%|██▎       | 23/100 [01:57<06:31,  5.08s/it, train loss=0.5323, val ΔE00=3.720, best=3.278]Training (late/smallcnn):  24%|██▍       | 24/100 [02:02<06:25,  5.07s/it, train loss=0.5323, val ΔE00=3.720, best=3.278]Training (late/smallcnn):  24%|██▍       | 24/100 [02:02<06:25,  5.07s/it, train loss=0.5644, val ΔE00=3.714, best=3.278]Training (late/smallcnn):  25%|██▌       | 25/100 [02:08<06:25,  5.14s/it, train loss=0.5644, val ΔE00=3.714, best=3.278]Training (late/smallcnn):  25%|██▌       | 25/100 [02:08<06:25,  5.14s/it, train loss=0.5700, val ΔE00=3.674, best=3.278]Training (late/smallcnn):  26%|██▌       | 26/100 [02:13<06:20,  5.14s/it, train loss=0.5700, val ΔE00=3.674, best=3.278]Training (late/smallcnn):  26%|██▌       | 26/100 [02:13<06:20,  5.14s/it, train loss=0.6251, val ΔE00=3.699, best=3.278]Training (late/smallcnn):  27%|██▋       | 27/100 [02:18<06:12,  5.11s/it, train loss=0.6251, val ΔE00=3.699, best=3.278]Training (late/smallcnn):  27%|██▋       | 27/100 [02:18<06:12,  5.11s/it, train loss=0.7047, val ΔE00=5.438, best=3.278]Training (late/smallcnn):  28%|██▊       | 28/100 [02:23<06:06,  5.08s/it, train loss=0.7047, val ΔE00=5.438, best=3.278]Training (late/smallcnn):  28%|██▊       | 28/100 [02:23<06:06,  5.08s/it, train loss=0.7291, val ΔE00=3.201, best=3.201]Training (late/smallcnn):  29%|██▉       | 29/100 [02:28<05:59,  5.07s/it, train loss=0.7291, val ΔE00=3.201, best=3.201]Training (late/smallcnn):  29%|██▉       | 29/100 [02:28<05:59,  5.07s/it, train loss=0.7323, val ΔE00=4.956, best=3.201]Training (late/smallcnn):  30%|███       | 30/100 [02:33<05:58,  5.12s/it, train loss=0.7323, val ΔE00=4.956, best=3.201]Training (late/smallcnn):  30%|███       | 30/100 [02:33<05:58,  5.12s/it, train loss=0.7910, val ΔE00=3.365, best=3.201]Training (late/smallcnn):  31%|███       | 31/100 [02:38<05:55,  5.15s/it, train loss=0.7910, val ΔE00=3.365, best=3.201]Training (late/smallcnn):  31%|███       | 31/100 [02:38<05:55,  5.15s/it, train loss=0.8578, val ΔE00=4.023, best=3.201]Training (late/smallcnn):  32%|███▏      | 32/100 [02:43<05:48,  5.13s/it, train loss=0.8578, val ΔE00=4.023, best=3.201]Training (late/smallcnn):  32%|███▏      | 32/100 [02:43<05:48,  5.13s/it, train loss=0.8842, val ΔE00=3.428, best=3.201]Training (late/smallcnn):  33%|███▎      | 33/100 [02:48<05:42,  5.12s/it, train loss=0.8842, val ΔE00=3.428, best=3.201]Training (late/smallcnn):  33%|███▎      | 33/100 [02:48<05:42,  5.12s/it, train loss=0.9354, val ΔE00=2.970, best=2.970]Training (late/smallcnn):  34%|███▍      | 34/100 [02:54<05:37,  5.11s/it, train loss=0.9354, val ΔE00=2.970, best=2.970]Training (late/smallcnn):  34%|███▍      | 34/100 [02:54<05:37,  5.11s/it, train loss=1.0248, val ΔE00=3.982, best=2.970]Training (late/smallcnn):  35%|███▌      | 35/100 [02:59<05:35,  5.16s/it, train loss=1.0248, val ΔE00=3.982, best=2.970]Training (late/smallcnn):  35%|███▌      | 35/100 [02:59<05:35,  5.16s/it, train loss=1.0228, val ΔE00=3.114, best=2.970]Training (late/smallcnn):  36%|███▌      | 36/100 [03:04<05:30,  5.16s/it, train loss=1.0228, val ΔE00=3.114, best=2.970]Training (late/smallcnn):  36%|███▌      | 36/100 [03:04<05:30,  5.16s/it, train loss=1.0833, val ΔE00=3.922, best=2.970]Training (late/smallcnn):  37%|███▋      | 37/100 [03:09<05:23,  5.13s/it, train loss=1.0833, val ΔE00=3.922, best=2.970]Training (late/smallcnn):  37%|███▋      | 37/100 [03:09<05:23,  5.13s/it, train loss=1.0876, val ΔE00=3.019, best=2.970]Training (late/smallcnn):  38%|███▊      | 38/100 [03:14<05:15,  5.10s/it, train loss=1.0876, val ΔE00=3.019, best=2.970]Training (late/smallcnn):  38%|███▊      | 38/100 [03:14<05:15,  5.10s/it, train loss=1.0959, val ΔE00=6.079, best=2.970]Training (late/smallcnn):  39%|███▉      | 39/100 [03:19<05:09,  5.08s/it, train loss=1.0959, val ΔE00=6.079, best=2.970]Training (late/smallcnn):  39%|███▉      | 39/100 [03:19<05:09,  5.08s/it, train loss=1.1713, val ΔE00=4.276, best=2.970]Training (late/smallcnn):  40%|████      | 40/100 [03:24<05:08,  5.15s/it, train loss=1.1713, val ΔE00=4.276, best=2.970]Training (late/smallcnn):  40%|████      | 40/100 [03:24<05:08,  5.15s/it, train loss=1.2366, val ΔE00=3.561, best=2.970]Training (late/smallcnn):  41%|████      | 41/100 [03:29<05:03,  5.14s/it, train loss=1.2366, val ΔE00=3.561, best=2.970]Training (late/smallcnn):  41%|████      | 41/100 [03:29<05:03,  5.14s/it, train loss=1.2116, val ΔE00=3.196, best=2.970]Training (late/smallcnn):  42%|████▏     | 42/100 [03:35<04:57,  5.13s/it, train loss=1.2116, val ΔE00=3.196, best=2.970]Training (late/smallcnn):  42%|████▏     | 42/100 [03:35<04:57,  5.13s/it, train loss=1.2792, val ΔE00=2.790, best=2.790]Training (late/smallcnn):  43%|████▎     | 43/100 [03:40<04:51,  5.12s/it, train loss=1.2792, val ΔE00=2.790, best=2.790]Training (late/smallcnn):  43%|████▎     | 43/100 [03:40<04:51,  5.12s/it, train loss=1.3651, val ΔE00=3.449, best=2.790]Training (late/smallcnn):  44%|████▍     | 44/100 [03:45<04:44,  5.09s/it, train loss=1.3651, val ΔE00=3.449, best=2.790]Training (late/smallcnn):  44%|████▍     | 44/100 [03:45<04:44,  5.09s/it, train loss=1.4279, val ΔE00=3.103, best=2.790]Training (late/smallcnn):  45%|████▌     | 45/100 [03:50<04:43,  5.15s/it, train loss=1.4279, val ΔE00=3.103, best=2.790]Training (late/smallcnn):  45%|████▌     | 45/100 [03:50<04:43,  5.15s/it, train loss=1.3630, val ΔE00=3.967, best=2.790]Training (late/smallcnn):  46%|████▌     | 46/100 [03:55<04:38,  5.16s/it, train loss=1.3630, val ΔE00=3.967, best=2.790]Training (late/smallcnn):  46%|████▌     | 46/100 [03:55<04:38,  5.16s/it, train loss=1.4978, val ΔE00=3.029, best=2.790]Training (late/smallcnn):  47%|████▋     | 47/100 [04:00<04:32,  5.13s/it, train loss=1.4978, val ΔE00=3.029, best=2.790]Training (late/smallcnn):  47%|████▋     | 47/100 [04:00<04:32,  5.13s/it, train loss=1.5692, val ΔE00=4.107, best=2.790]Training (late/smallcnn):  48%|████▊     | 48/100 [04:05<04:25,  5.12s/it, train loss=1.5692, val ΔE00=4.107, best=2.790]Training (late/smallcnn):  48%|████▊     | 48/100 [04:05<04:25,  5.12s/it, train loss=1.6049, val ΔE00=2.844, best=2.790]Training (late/smallcnn):  49%|████▉     | 49/100 [04:10<04:19,  5.10s/it, train loss=1.6049, val ΔE00=2.844, best=2.790]Training (late/smallcnn):  49%|████▉     | 49/100 [04:10<04:19,  5.10s/it, train loss=1.5815, val ΔE00=2.974, best=2.790]Training (late/smallcnn):  50%|█████     | 50/100 [04:16<04:17,  5.16s/it, train loss=1.5815, val ΔE00=2.974, best=2.790]Training (late/smallcnn):  50%|█████     | 50/100 [04:16<04:17,  5.16s/it, train loss=1.6579, val ΔE00=4.106, best=2.790]Training (late/smallcnn):  51%|█████     | 51/100 [04:21<04:13,  5.17s/it, train loss=1.6579, val ΔE00=4.106, best=2.790]Training (late/smallcnn):  51%|█████     | 51/100 [04:21<04:13,  5.17s/it, train loss=1.6093, val ΔE00=2.786, best=2.786]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:26<04:06,  5.13s/it, train loss=1.6093, val ΔE00=2.786, best=2.786]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:26<04:06,  5.13s/it, train loss=1.7846, val ΔE00=3.113, best=2.786]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:31<04:00,  5.13s/it, train loss=1.7846, val ΔE00=3.113, best=2.786]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:31<04:00,  5.13s/it, train loss=1.7724, val ΔE00=3.245, best=2.786]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:36<03:54,  5.10s/it, train loss=1.7724, val ΔE00=3.245, best=2.786]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:36<03:54,  5.10s/it, train loss=1.7211, val ΔE00=2.469, best=2.469]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:41<03:51,  5.15s/it, train loss=1.7211, val ΔE00=2.469, best=2.469]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:41<03:51,  5.15s/it, train loss=1.7287, val ΔE00=5.727, best=2.469]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:47<03:46,  5.16s/it, train loss=1.7287, val ΔE00=5.727, best=2.469]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:47<03:46,  5.16s/it, train loss=1.7908, val ΔE00=3.141, best=2.469]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:52<03:40,  5.12s/it, train loss=1.7908, val ΔE00=3.141, best=2.469]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:52<03:40,  5.12s/it, train loss=1.8209, val ΔE00=3.918, best=2.469]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:57<03:33,  5.09s/it, train loss=1.8209, val ΔE00=3.918, best=2.469]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:57<03:33,  5.09s/it, train loss=1.8575, val ΔE00=3.334, best=2.469]Training (late/smallcnn):  59%|█████▉    | 59/100 [05:02<03:28,  5.08s/it, train loss=1.8575, val ΔE00=3.334, best=2.469]Training (late/smallcnn):  59%|█████▉    | 59/100 [05:02<03:28,  5.08s/it, train loss=1.7632, val ΔE00=3.031, best=2.469]Training (late/smallcnn):  60%|██████    | 60/100 [05:07<03:26,  5.15s/it, train loss=1.7632, val ΔE00=3.031, best=2.469]Training (late/smallcnn):  60%|██████    | 60/100 [05:07<03:26,  5.15s/it, train loss=1.9227, val ΔE00=3.545, best=2.469]Training (late/smallcnn):  61%|██████    | 61/100 [05:12<03:21,  5.17s/it, train loss=1.9227, val ΔE00=3.545, best=2.469]Training (late/smallcnn):  61%|██████    | 61/100 [05:12<03:21,  5.17s/it, train loss=1.9911, val ΔE00=4.455, best=2.469]Training (late/smallcnn):  62%|██████▏   | 62/100 [05:17<03:15,  5.13s/it, train loss=1.9911, val ΔE00=4.455, best=2.469]Training (late/smallcnn):  62%|██████▏   | 62/100 [05:17<03:15,  5.13s/it, train loss=1.8793, val ΔE00=3.061, best=2.469]Training (late/smallcnn):  63%|██████▎   | 63/100 [05:22<03:08,  5.10s/it, train loss=1.8793, val ΔE00=3.061, best=2.469]Training (late/smallcnn):  63%|██████▎   | 63/100 [05:22<03:08,  5.10s/it, train loss=1.8368, val ΔE00=2.850, best=2.469]Training (late/smallcnn):  63%|██████▎   | 63/100 [05:27<03:08,  5.10s/it, train loss=1.9275, val ΔE00=3.760, early_stop=yes]Training (late/smallcnn):  63%|██████▎   | 63/100 [05:27<03:12,  5.20s/it, train loss=1.9275, val ΔE00=3.760, early_stop=yes]
[early] stop at epoch 64 (best de00=2.4694 @ 54)
[done] best ΔE00=2.469 over 64 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/late__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 2/12 ===
[sweep] id=002_model=late__backbone=smallcnn__features=image+mean+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone smallcnn --features image+mean+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=late, backbone=smallcnn, features=image+mean+meta, meta_encoder=flair
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:59,  5.45s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:59,  5.45s/it, train loss=0.0122, val ΔE00=12.366, best=12.366]Training (late/smallcnn):   2%|▏         | 2/100 [00:10<08:30,  5.21s/it, train loss=0.0122, val ΔE00=12.366, best=12.366]Training (late/smallcnn):   2%|▏         | 2/100 [00:10<08:30,  5.21s/it, train loss=0.0102, val ΔE00=9.993, best=9.993]  Training (late/smallcnn):   3%|▎         | 3/100 [00:15<08:19,  5.15s/it, train loss=0.0102, val ΔE00=9.993, best=9.993]Training (late/smallcnn):   3%|▎         | 3/100 [00:15<08:19,  5.15s/it, train loss=0.0150, val ΔE00=5.919, best=5.919]Training (late/smallcnn):   4%|▍         | 4/100 [00:20<08:10,  5.11s/it, train loss=0.0150, val ΔE00=5.919, best=5.919]Training (late/smallcnn):   4%|▍         | 4/100 [00:20<08:10,  5.11s/it, train loss=0.0238, val ΔE00=8.256, best=5.919]Training (late/smallcnn):   5%|▌         | 5/100 [00:25<08:11,  5.17s/it, train loss=0.0238, val ΔE00=8.256, best=5.919]Training (late/smallcnn):   5%|▌         | 5/100 [00:25<08:11,  5.17s/it, train loss=0.0360, val ΔE00=7.037, best=5.919]Training (late/smallcnn):   6%|▌         | 6/100 [00:31<08:06,  5.18s/it, train loss=0.0360, val ΔE00=7.037, best=5.919]Training (late/smallcnn):   6%|▌         | 6/100 [00:31<08:06,  5.18s/it, train loss=0.0515, val ΔE00=5.677, best=5.677]Training (late/smallcnn):   7%|▋         | 7/100 [00:36<07:57,  5.14s/it, train loss=0.0515, val ΔE00=5.677, best=5.677]Training (late/smallcnn):   7%|▋         | 7/100 [00:36<07:57,  5.14s/it, train loss=0.0665, val ΔE00=5.127, best=5.127]Training (late/smallcnn):   8%|▊         | 8/100 [00:41<07:49,  5.11s/it, train loss=0.0665, val ΔE00=5.127, best=5.127]Training (late/smallcnn):   8%|▊         | 8/100 [00:41<07:49,  5.11s/it, train loss=0.0839, val ΔE00=5.008, best=5.008]Training (late/smallcnn):   9%|▉         | 9/100 [00:46<07:42,  5.08s/it, train loss=0.0839, val ΔE00=5.008, best=5.008]Training (late/smallcnn):   9%|▉         | 9/100 [00:46<07:42,  5.08s/it, train loss=0.1048, val ΔE00=5.543, best=5.008]Training (late/smallcnn):  10%|█         | 10/100 [00:51<07:43,  5.15s/it, train loss=0.1048, val ΔE00=5.543, best=5.008]Training (late/smallcnn):  10%|█         | 10/100 [00:51<07:43,  5.15s/it, train loss=0.1245, val ΔE00=3.821, best=3.821]Training (late/smallcnn):  11%|█         | 11/100 [00:56<07:40,  5.17s/it, train loss=0.1245, val ΔE00=3.821, best=3.821]Training (late/smallcnn):  11%|█         | 11/100 [00:56<07:40,  5.17s/it, train loss=0.1456, val ΔE00=5.466, best=3.821]Training (late/smallcnn):  12%|█▏        | 12/100 [01:01<07:32,  5.14s/it, train loss=0.1456, val ΔE00=5.466, best=3.821]Training (late/smallcnn):  12%|█▏        | 12/100 [01:01<07:32,  5.14s/it, train loss=0.1722, val ΔE00=3.503, best=3.503]Training (late/smallcnn):  13%|█▎        | 13/100 [01:06<07:23,  5.10s/it, train loss=0.1722, val ΔE00=3.503, best=3.503]Training (late/smallcnn):  13%|█▎        | 13/100 [01:06<07:23,  5.10s/it, train loss=0.1927, val ΔE00=4.179, best=3.503]Training (late/smallcnn):  14%|█▍        | 14/100 [01:11<07:16,  5.08s/it, train loss=0.1927, val ΔE00=4.179, best=3.503]Training (late/smallcnn):  14%|█▍        | 14/100 [01:11<07:16,  5.08s/it, train loss=0.2144, val ΔE00=3.550, best=3.503]Training (late/smallcnn):  15%|█▌        | 15/100 [01:17<07:15,  5.13s/it, train loss=0.2144, val ΔE00=3.550, best=3.503]Training (late/smallcnn):  15%|█▌        | 15/100 [01:17<07:15,  5.13s/it, train loss=0.2599, val ΔE00=4.450, best=3.503]Training (late/smallcnn):  16%|█▌        | 16/100 [01:22<07:11,  5.13s/it, train loss=0.2599, val ΔE00=4.450, best=3.503]Training (late/smallcnn):  16%|█▌        | 16/100 [01:22<07:11,  5.13s/it, train loss=0.2917, val ΔE00=4.164, best=3.503]Training (late/smallcnn):  17%|█▋        | 17/100 [01:27<07:03,  5.10s/it, train loss=0.2917, val ΔE00=4.164, best=3.503]Training (late/smallcnn):  17%|█▋        | 17/100 [01:27<07:03,  5.10s/it, train loss=0.2981, val ΔE00=5.005, best=3.503]Training (late/smallcnn):  18%|█▊        | 18/100 [01:32<06:56,  5.08s/it, train loss=0.2981, val ΔE00=5.005, best=3.503]Training (late/smallcnn):  18%|█▊        | 18/100 [01:32<06:56,  5.08s/it, train loss=0.3412, val ΔE00=4.390, best=3.503]Training (late/smallcnn):  19%|█▉        | 19/100 [01:37<06:50,  5.06s/it, train loss=0.3412, val ΔE00=4.390, best=3.503]Training (late/smallcnn):  19%|█▉        | 19/100 [01:37<06:50,  5.06s/it, train loss=0.3688, val ΔE00=7.362, best=3.503]Training (late/smallcnn):  20%|██        | 20/100 [01:42<06:49,  5.11s/it, train loss=0.3688, val ΔE00=7.362, best=3.503]Training (late/smallcnn):  20%|██        | 20/100 [01:42<06:49,  5.11s/it, train loss=0.4212, val ΔE00=5.714, best=3.503]Training (late/smallcnn):  21%|██        | 21/100 [01:47<06:45,  5.13s/it, train loss=0.4212, val ΔE00=5.714, best=3.503]Training (late/smallcnn):  21%|██        | 21/100 [01:47<06:45,  5.13s/it, train loss=0.4334, val ΔE00=4.333, best=3.503]Training (late/smallcnn):  22%|██▏       | 22/100 [01:52<06:37,  5.10s/it, train loss=0.4334, val ΔE00=4.333, best=3.503]Training (late/smallcnn):  22%|██▏       | 22/100 [01:52<06:37,  5.10s/it, train loss=0.4900, val ΔE00=3.278, best=3.278]Training (late/smallcnn):  23%|██▎       | 23/100 [01:57<06:31,  5.08s/it, train loss=0.4900, val ΔE00=3.278, best=3.278]Training (late/smallcnn):  23%|██▎       | 23/100 [01:57<06:31,  5.08s/it, train loss=0.5323, val ΔE00=3.720, best=3.278]Training (late/smallcnn):  24%|██▍       | 24/100 [02:02<06:25,  5.07s/it, train loss=0.5323, val ΔE00=3.720, best=3.278]Training (late/smallcnn):  24%|██▍       | 24/100 [02:02<06:25,  5.07s/it, train loss=0.5644, val ΔE00=3.714, best=3.278]Training (late/smallcnn):  25%|██▌       | 25/100 [02:08<06:26,  5.15s/it, train loss=0.5644, val ΔE00=3.714, best=3.278]Training (late/smallcnn):  25%|██▌       | 25/100 [02:08<06:26,  5.15s/it, train loss=0.5700, val ΔE00=3.674, best=3.278]Training (late/smallcnn):  26%|██▌       | 26/100 [02:13<06:22,  5.17s/it, train loss=0.5700, val ΔE00=3.674, best=3.278]Training (late/smallcnn):  26%|██▌       | 26/100 [02:13<06:22,  5.17s/it, train loss=0.6251, val ΔE00=3.699, best=3.278]Training (late/smallcnn):  27%|██▋       | 27/100 [02:18<06:14,  5.13s/it, train loss=0.6251, val ΔE00=3.699, best=3.278]Training (late/smallcnn):  27%|██▋       | 27/100 [02:18<06:14,  5.13s/it, train loss=0.7047, val ΔE00=5.438, best=3.278]Training (late/smallcnn):  28%|██▊       | 28/100 [02:23<06:07,  5.10s/it, train loss=0.7047, val ΔE00=5.438, best=3.278]Training (late/smallcnn):  28%|██▊       | 28/100 [02:23<06:07,  5.10s/it, train loss=0.7291, val ΔE00=3.201, best=3.201]Training (late/smallcnn):  29%|██▉       | 29/100 [02:28<06:00,  5.08s/it, train loss=0.7291, val ΔE00=3.201, best=3.201]Training (late/smallcnn):  29%|██▉       | 29/100 [02:28<06:00,  5.08s/it, train loss=0.7323, val ΔE00=4.956, best=3.201]Training (late/smallcnn):  30%|███       | 30/100 [02:33<05:59,  5.13s/it, train loss=0.7323, val ΔE00=4.956, best=3.201]Training (late/smallcnn):  30%|███       | 30/100 [02:33<05:59,  5.13s/it, train loss=0.7910, val ΔE00=3.365, best=3.201]Training (late/smallcnn):  31%|███       | 31/100 [02:38<05:54,  5.14s/it, train loss=0.7910, val ΔE00=3.365, best=3.201]Training (late/smallcnn):  31%|███       | 31/100 [02:38<05:54,  5.14s/it, train loss=0.8578, val ΔE00=4.023, best=3.201]Training (late/smallcnn):  32%|███▏      | 32/100 [02:43<05:47,  5.11s/it, train loss=0.8578, val ΔE00=4.023, best=3.201]Training (late/smallcnn):  32%|███▏      | 32/100 [02:43<05:47,  5.11s/it, train loss=0.8842, val ΔE00=3.428, best=3.201]Training (late/smallcnn):  33%|███▎      | 33/100 [02:48<05:40,  5.09s/it, train loss=0.8842, val ΔE00=3.428, best=3.201]Training (late/smallcnn):  33%|███▎      | 33/100 [02:48<05:40,  5.09s/it, train loss=0.9354, val ΔE00=2.970, best=2.970]Training (late/smallcnn):  34%|███▍      | 34/100 [02:53<05:34,  5.07s/it, train loss=0.9354, val ΔE00=2.970, best=2.970]Training (late/smallcnn):  34%|███▍      | 34/100 [02:53<05:34,  5.07s/it, train loss=1.0248, val ΔE00=3.982, best=2.970]Training (late/smallcnn):  35%|███▌      | 35/100 [02:59<05:33,  5.13s/it, train loss=1.0248, val ΔE00=3.982, best=2.970]Training (late/smallcnn):  35%|███▌      | 35/100 [02:59<05:33,  5.13s/it, train loss=1.0228, val ΔE00=3.114, best=2.970]Training (late/smallcnn):  36%|███▌      | 36/100 [03:04<05:29,  5.14s/it, train loss=1.0228, val ΔE00=3.114, best=2.970]Training (late/smallcnn):  36%|███▌      | 36/100 [03:04<05:29,  5.14s/it, train loss=1.0833, val ΔE00=3.922, best=2.970]Training (late/smallcnn):  37%|███▋      | 37/100 [03:09<05:21,  5.11s/it, train loss=1.0833, val ΔE00=3.922, best=2.970]Training (late/smallcnn):  37%|███▋      | 37/100 [03:09<05:21,  5.11s/it, train loss=1.0876, val ΔE00=3.019, best=2.970]Training (late/smallcnn):  38%|███▊      | 38/100 [03:14<05:15,  5.08s/it, train loss=1.0876, val ΔE00=3.019, best=2.970]Training (late/smallcnn):  38%|███▊      | 38/100 [03:14<05:15,  5.08s/it, train loss=1.0959, val ΔE00=6.079, best=2.970]Training (late/smallcnn):  39%|███▉      | 39/100 [03:19<05:09,  5.07s/it, train loss=1.0959, val ΔE00=6.079, best=2.970]Training (late/smallcnn):  39%|███▉      | 39/100 [03:19<05:09,  5.07s/it, train loss=1.1713, val ΔE00=4.276, best=2.970]Training (late/smallcnn):  40%|████      | 40/100 [03:24<05:08,  5.15s/it, train loss=1.1713, val ΔE00=4.276, best=2.970]Training (late/smallcnn):  40%|████      | 40/100 [03:24<05:08,  5.15s/it, train loss=1.2366, val ΔE00=3.561, best=2.970]Training (late/smallcnn):  41%|████      | 41/100 [03:30<05:04,  5.16s/it, train loss=1.2366, val ΔE00=3.561, best=2.970]Training (late/smallcnn):  41%|████      | 41/100 [03:30<05:04,  5.16s/it, train loss=1.2116, val ΔE00=3.196, best=2.970]Training (late/smallcnn):  42%|████▏     | 42/100 [03:35<04:58,  5.14s/it, train loss=1.2116, val ΔE00=3.196, best=2.970]Training (late/smallcnn):  42%|████▏     | 42/100 [03:35<04:58,  5.14s/it, train loss=1.2792, val ΔE00=2.790, best=2.790]Training (late/smallcnn):  43%|████▎     | 43/100 [03:40<04:52,  5.13s/it, train loss=1.2792, val ΔE00=2.790, best=2.790]Training (late/smallcnn):  43%|████▎     | 43/100 [03:40<04:52,  5.13s/it, train loss=1.3651, val ΔE00=3.449, best=2.790]Training (late/smallcnn):  44%|████▍     | 44/100 [03:45<04:46,  5.12s/it, train loss=1.3651, val ΔE00=3.449, best=2.790]Training (late/smallcnn):  44%|████▍     | 44/100 [03:45<04:46,  5.12s/it, train loss=1.4279, val ΔE00=3.103, best=2.790]Training (late/smallcnn):  45%|████▌     | 45/100 [03:50<04:45,  5.18s/it, train loss=1.4279, val ΔE00=3.103, best=2.790]Training (late/smallcnn):  45%|████▌     | 45/100 [03:50<04:45,  5.18s/it, train loss=1.3630, val ΔE00=3.967, best=2.790]Training (late/smallcnn):  46%|████▌     | 46/100 [03:55<04:39,  5.18s/it, train loss=1.3630, val ΔE00=3.967, best=2.790]Training (late/smallcnn):  46%|████▌     | 46/100 [03:55<04:39,  5.18s/it, train loss=1.4978, val ΔE00=3.029, best=2.790]Training (late/smallcnn):  47%|████▋     | 47/100 [04:00<04:32,  5.14s/it, train loss=1.4978, val ΔE00=3.029, best=2.790]Training (late/smallcnn):  47%|████▋     | 47/100 [04:00<04:32,  5.14s/it, train loss=1.5692, val ΔE00=4.107, best=2.790]Training (late/smallcnn):  48%|████▊     | 48/100 [04:05<04:25,  5.11s/it, train loss=1.5692, val ΔE00=4.107, best=2.790]Training (late/smallcnn):  48%|████▊     | 48/100 [04:05<04:25,  5.11s/it, train loss=1.6049, val ΔE00=2.844, best=2.790]Training (late/smallcnn):  49%|████▉     | 49/100 [04:11<04:20,  5.11s/it, train loss=1.6049, val ΔE00=2.844, best=2.790]Training (late/smallcnn):  49%|████▉     | 49/100 [04:11<04:20,  5.11s/it, train loss=1.5815, val ΔE00=2.974, best=2.790]Training (late/smallcnn):  50%|█████     | 50/100 [04:16<04:18,  5.18s/it, train loss=1.5815, val ΔE00=2.974, best=2.790]Training (late/smallcnn):  50%|█████     | 50/100 [04:16<04:18,  5.18s/it, train loss=1.6579, val ΔE00=4.106, best=2.790]Training (late/smallcnn):  51%|█████     | 51/100 [04:21<04:14,  5.19s/it, train loss=1.6579, val ΔE00=4.106, best=2.790]Training (late/smallcnn):  51%|█████     | 51/100 [04:21<04:14,  5.19s/it, train loss=1.6093, val ΔE00=2.786, best=2.786]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:26<04:06,  5.14s/it, train loss=1.6093, val ΔE00=2.786, best=2.786]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:26<04:06,  5.14s/it, train loss=1.7846, val ΔE00=3.113, best=2.786]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:31<04:00,  5.11s/it, train loss=1.7846, val ΔE00=3.113, best=2.786]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:31<04:00,  5.11s/it, train loss=1.7724, val ΔE00=3.245, best=2.786]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:36<03:54,  5.09s/it, train loss=1.7724, val ΔE00=3.245, best=2.786]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:36<03:54,  5.09s/it, train loss=1.7211, val ΔE00=2.469, best=2.469]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:41<03:51,  5.14s/it, train loss=1.7211, val ΔE00=2.469, best=2.469]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:41<03:51,  5.14s/it, train loss=1.7287, val ΔE00=5.727, best=2.469]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:47<03:46,  5.15s/it, train loss=1.7287, val ΔE00=5.727, best=2.469]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:47<03:46,  5.15s/it, train loss=1.7908, val ΔE00=3.141, best=2.469]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:52<03:41,  5.14s/it, train loss=1.7908, val ΔE00=3.141, best=2.469]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:52<03:41,  5.14s/it, train loss=1.8209, val ΔE00=3.918, best=2.469]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:57<03:35,  5.13s/it, train loss=1.8209, val ΔE00=3.918, best=2.469]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:57<03:35,  5.13s/it, train loss=1.8575, val ΔE00=3.334, best=2.469]Training (late/smallcnn):  59%|█████▉    | 59/100 [05:02<03:29,  5.12s/it, train loss=1.8575, val ΔE00=3.334, best=2.469]Training (late/smallcnn):  59%|█████▉    | 59/100 [05:02<03:29,  5.12s/it, train loss=1.7632, val ΔE00=3.031, best=2.469]Training (late/smallcnn):  60%|██████    | 60/100 [05:07<03:27,  5.18s/it, train loss=1.7632, val ΔE00=3.031, best=2.469]Training (late/smallcnn):  60%|██████    | 60/100 [05:07<03:27,  5.18s/it, train loss=1.9227, val ΔE00=3.545, best=2.469]Training (late/smallcnn):  61%|██████    | 61/100 [05:12<03:21,  5.16s/it, train loss=1.9227, val ΔE00=3.545, best=2.469]Training (late/smallcnn):  61%|██████    | 61/100 [05:12<03:21,  5.16s/it, train loss=1.9911, val ΔE00=4.455, best=2.469]Training (late/smallcnn):  62%|██████▏   | 62/100 [05:17<03:15,  5.14s/it, train loss=1.9911, val ΔE00=4.455, best=2.469]Training (late/smallcnn):  62%|██████▏   | 62/100 [05:17<03:15,  5.14s/it, train loss=1.8793, val ΔE00=3.061, best=2.469]Training (late/smallcnn):  63%|██████▎   | 63/100 [05:23<03:09,  5.13s/it, train loss=1.8793, val ΔE00=3.061, best=2.469]Training (late/smallcnn):  63%|██████▎   | 63/100 [05:23<03:09,  5.13s/it, train loss=1.8368, val ΔE00=2.850, best=2.469]Training (late/smallcnn):  63%|██████▎   | 63/100 [05:28<03:09,  5.13s/it, train loss=1.9275, val ΔE00=3.760, early_stop=yes]Training (late/smallcnn):  63%|██████▎   | 63/100 [05:28<03:12,  5.21s/it, train loss=1.9275, val ΔE00=3.760, early_stop=yes]
[early] stop at epoch 64 (best de00=2.4694 @ 54)
[done] best ΔE00=2.469 over 64 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/late__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 3/12 ===
[sweep] id=003_model=late__backbone=resnet18__features=image+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone resnet18 --features image+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=late, backbone=resnet18, features=image+meta, meta_encoder=flair
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:53,  7.21s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:53,  7.21s/it, train loss=0.0122, val ΔE00=7.001, best=7.001]Training (late/resnet18):   2%|▏         | 2/100 [00:14<11:23,  6.97s/it, train loss=0.0122, val ΔE00=7.001, best=7.001]Training (late/resnet18):   2%|▏         | 2/100 [00:14<11:23,  6.97s/it, train loss=0.0052, val ΔE00=4.702, best=4.702]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:07,  6.88s/it, train loss=0.0052, val ΔE00=4.702, best=4.702]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:07,  6.88s/it, train loss=0.0086, val ΔE00=4.225, best=4.225]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:56,  6.84s/it, train loss=0.0086, val ΔE00=4.225, best=4.225]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:56,  6.84s/it, train loss=0.0164, val ΔE00=3.792, best=3.792]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:52,  6.87s/it, train loss=0.0164, val ΔE00=3.792, best=3.792]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:52,  6.87s/it, train loss=0.0241, val ΔE00=3.806, best=3.792]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:42,  6.84s/it, train loss=0.0241, val ΔE00=3.806, best=3.792]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:42,  6.84s/it, train loss=0.0343, val ΔE00=3.851, best=3.792]Training (late/resnet18):   7%|▋         | 7/100 [00:48<10:34,  6.83s/it, train loss=0.0343, val ΔE00=3.851, best=3.792]Training (late/resnet18):   7%|▋         | 7/100 [00:48<10:34,  6.83s/it, train loss=0.0459, val ΔE00=3.245, best=3.245]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:26,  6.81s/it, train loss=0.0459, val ΔE00=3.245, best=3.245]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:26,  6.81s/it, train loss=0.0515, val ΔE00=3.152, best=3.152]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:17,  6.79s/it, train loss=0.0515, val ΔE00=3.152, best=3.152]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:17,  6.79s/it, train loss=0.0677, val ΔE00=3.395, best=3.152]Training (late/resnet18):  10%|█         | 10/100 [01:08<10:16,  6.85s/it, train loss=0.0677, val ΔE00=3.395, best=3.152]Training (late/resnet18):  10%|█         | 10/100 [01:08<10:16,  6.85s/it, train loss=0.0772, val ΔE00=2.788, best=2.788]Training (late/resnet18):  11%|█         | 11/100 [01:15<10:08,  6.83s/it, train loss=0.0772, val ΔE00=2.788, best=2.788]Training (late/resnet18):  11%|█         | 11/100 [01:15<10:08,  6.83s/it, train loss=0.0951, val ΔE00=3.178, best=2.788]Training (late/resnet18):  12%|█▏        | 12/100 [01:22<10:00,  6.82s/it, train loss=0.0951, val ΔE00=3.178, best=2.788]Training (late/resnet18):  12%|█▏        | 12/100 [01:22<10:00,  6.82s/it, train loss=0.1052, val ΔE00=2.545, best=2.545]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:50,  6.79s/it, train loss=0.1052, val ΔE00=2.545, best=2.545]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:50,  6.79s/it, train loss=0.1143, val ΔE00=2.562, best=2.545]Training (late/resnet18):  14%|█▍        | 14/100 [01:35<09:42,  6.77s/it, train loss=0.1143, val ΔE00=2.562, best=2.545]Training (late/resnet18):  14%|█▍        | 14/100 [01:35<09:42,  6.77s/it, train loss=0.1434, val ΔE00=2.875, best=2.545]Training (late/resnet18):  15%|█▌        | 15/100 [01:42<09:39,  6.82s/it, train loss=0.1434, val ΔE00=2.875, best=2.545]Training (late/resnet18):  15%|█▌        | 15/100 [01:42<09:39,  6.82s/it, train loss=0.1481, val ΔE00=2.734, best=2.545]Training (late/resnet18):  16%|█▌        | 16/100 [01:49<09:31,  6.81s/it, train loss=0.1481, val ΔE00=2.734, best=2.545]Training (late/resnet18):  16%|█▌        | 16/100 [01:49<09:31,  6.81s/it, train loss=0.1836, val ΔE00=2.743, best=2.545]Training (late/resnet18):  17%|█▋        | 17/100 [01:56<09:23,  6.79s/it, train loss=0.1836, val ΔE00=2.743, best=2.545]Training (late/resnet18):  17%|█▋        | 17/100 [01:56<09:23,  6.79s/it, train loss=0.2115, val ΔE00=2.781, best=2.545]Training (late/resnet18):  18%|█▊        | 18/100 [02:02<09:16,  6.79s/it, train loss=0.2115, val ΔE00=2.781, best=2.545]Training (late/resnet18):  18%|█▊        | 18/100 [02:02<09:16,  6.79s/it, train loss=0.2096, val ΔE00=2.451, best=2.451]Training (late/resnet18):  19%|█▉        | 19/100 [02:09<09:08,  6.77s/it, train loss=0.2096, val ΔE00=2.451, best=2.451]Training (late/resnet18):  19%|█▉        | 19/100 [02:09<09:08,  6.77s/it, train loss=0.2177, val ΔE00=2.630, best=2.451]Training (late/resnet18):  20%|██        | 20/100 [02:16<09:08,  6.85s/it, train loss=0.2177, val ΔE00=2.630, best=2.451]Training (late/resnet18):  20%|██        | 20/100 [02:16<09:08,  6.85s/it, train loss=0.2347, val ΔE00=2.330, best=2.330]Training (late/resnet18):  21%|██        | 21/100 [02:23<08:58,  6.81s/it, train loss=0.2347, val ΔE00=2.330, best=2.330]Training (late/resnet18):  21%|██        | 21/100 [02:23<08:58,  6.81s/it, train loss=0.2522, val ΔE00=2.683, best=2.330]Training (late/resnet18):  22%|██▏       | 22/100 [02:30<08:49,  6.79s/it, train loss=0.2522, val ΔE00=2.683, best=2.330]Training (late/resnet18):  22%|██▏       | 22/100 [02:30<08:49,  6.79s/it, train loss=0.2769, val ΔE00=2.622, best=2.330]Training (late/resnet18):  23%|██▎       | 23/100 [02:36<08:41,  6.77s/it, train loss=0.2769, val ΔE00=2.622, best=2.330]Training (late/resnet18):  23%|██▎       | 23/100 [02:36<08:41,  6.77s/it, train loss=0.3011, val ΔE00=2.467, best=2.330]Training (late/resnet18):  24%|██▍       | 24/100 [02:43<08:33,  6.75s/it, train loss=0.3011, val ΔE00=2.467, best=2.330]Training (late/resnet18):  24%|██▍       | 24/100 [02:43<08:33,  6.75s/it, train loss=0.3006, val ΔE00=2.685, best=2.330]Training (late/resnet18):  25%|██▌       | 25/100 [02:50<08:29,  6.80s/it, train loss=0.3006, val ΔE00=2.685, best=2.330]Training (late/resnet18):  25%|██▌       | 25/100 [02:50<08:29,  6.80s/it, train loss=0.3437, val ΔE00=2.739, best=2.330]Training (late/resnet18):  26%|██▌       | 26/100 [02:57<08:22,  6.80s/it, train loss=0.3437, val ΔE00=2.739, best=2.330]Training (late/resnet18):  26%|██▌       | 26/100 [02:57<08:22,  6.80s/it, train loss=0.3423, val ΔE00=2.346, best=2.330]Training (late/resnet18):  27%|██▋       | 27/100 [03:03<08:16,  6.79s/it, train loss=0.3423, val ΔE00=2.346, best=2.330]Training (late/resnet18):  27%|██▋       | 27/100 [03:03<08:16,  6.79s/it, train loss=0.3627, val ΔE00=2.246, best=2.246]Training (late/resnet18):  28%|██▊       | 28/100 [03:10<08:07,  6.78s/it, train loss=0.3627, val ΔE00=2.246, best=2.246]Training (late/resnet18):  28%|██▊       | 28/100 [03:10<08:07,  6.78s/it, train loss=0.3864, val ΔE00=2.384, best=2.246]Training (late/resnet18):  29%|██▉       | 29/100 [03:17<08:00,  6.77s/it, train loss=0.3864, val ΔE00=2.384, best=2.246]Training (late/resnet18):  29%|██▉       | 29/100 [03:17<08:00,  6.77s/it, train loss=0.4202, val ΔE00=2.553, best=2.246]Training (late/resnet18):  30%|███       | 30/100 [03:24<07:56,  6.81s/it, train loss=0.4202, val ΔE00=2.553, best=2.246]Training (late/resnet18):  30%|███       | 30/100 [03:24<07:56,  6.81s/it, train loss=0.4192, val ΔE00=2.435, best=2.246]Training (late/resnet18):  31%|███       | 31/100 [03:31<07:49,  6.80s/it, train loss=0.4192, val ΔE00=2.435, best=2.246]Training (late/resnet18):  31%|███       | 31/100 [03:31<07:49,  6.80s/it, train loss=0.4434, val ΔE00=2.361, best=2.246]Training (late/resnet18):  32%|███▏      | 32/100 [03:37<07:42,  6.79s/it, train loss=0.4434, val ΔE00=2.361, best=2.246]Training (late/resnet18):  32%|███▏      | 32/100 [03:37<07:42,  6.79s/it, train loss=0.4429, val ΔE00=2.163, best=2.163]Training (late/resnet18):  33%|███▎      | 33/100 [03:44<07:34,  6.78s/it, train loss=0.4429, val ΔE00=2.163, best=2.163]Training (late/resnet18):  33%|███▎      | 33/100 [03:44<07:34,  6.78s/it, train loss=0.4555, val ΔE00=2.338, best=2.163]Training (late/resnet18):  34%|███▍      | 34/100 [03:51<07:26,  6.77s/it, train loss=0.4555, val ΔE00=2.338, best=2.163]Training (late/resnet18):  34%|███▍      | 34/100 [03:51<07:26,  6.77s/it, train loss=0.5026, val ΔE00=2.289, best=2.163]Training (late/resnet18):  35%|███▌      | 35/100 [03:58<07:23,  6.82s/it, train loss=0.5026, val ΔE00=2.289, best=2.163]Training (late/resnet18):  35%|███▌      | 35/100 [03:58<07:23,  6.82s/it, train loss=0.5757, val ΔE00=2.868, best=2.163]Training (late/resnet18):  36%|███▌      | 36/100 [04:05<07:15,  6.81s/it, train loss=0.5757, val ΔE00=2.868, best=2.163]Training (late/resnet18):  36%|███▌      | 36/100 [04:05<07:15,  6.81s/it, train loss=0.5520, val ΔE00=2.570, best=2.163]Training (late/resnet18):  37%|███▋      | 37/100 [04:11<07:07,  6.79s/it, train loss=0.5520, val ΔE00=2.570, best=2.163]Training (late/resnet18):  37%|███▋      | 37/100 [04:11<07:07,  6.79s/it, train loss=0.6019, val ΔE00=2.501, best=2.163]Training (late/resnet18):  38%|███▊      | 38/100 [04:18<07:00,  6.77s/it, train loss=0.6019, val ΔE00=2.501, best=2.163]Training (late/resnet18):  38%|███▊      | 38/100 [04:18<07:00,  6.77s/it, train loss=0.5959, val ΔE00=2.484, best=2.163]Training (late/resnet18):  39%|███▉      | 39/100 [04:25<06:52,  6.77s/it, train loss=0.5959, val ΔE00=2.484, best=2.163]Training (late/resnet18):  39%|███▉      | 39/100 [04:25<06:52,  6.77s/it, train loss=0.5795, val ΔE00=2.183, best=2.163]Training (late/resnet18):  40%|████      | 40/100 [04:32<06:48,  6.81s/it, train loss=0.5795, val ΔE00=2.183, best=2.163]Training (late/resnet18):  40%|████      | 40/100 [04:32<06:48,  6.81s/it, train loss=0.5989, val ΔE00=2.323, best=2.163]Training (late/resnet18):  41%|████      | 41/100 [04:39<06:41,  6.80s/it, train loss=0.5989, val ΔE00=2.323, best=2.163]Training (late/resnet18):  41%|████      | 41/100 [04:39<06:41,  6.80s/it, train loss=0.6477, val ΔE00=2.395, best=2.163]Training (late/resnet18):  42%|████▏     | 42/100 [04:45<06:33,  6.78s/it, train loss=0.6477, val ΔE00=2.395, best=2.163]Training (late/resnet18):  42%|████▏     | 42/100 [04:45<06:33,  6.78s/it, train loss=0.6299, val ΔE00=2.412, best=2.163]Training (late/resnet18):  43%|████▎     | 43/100 [04:52<06:25,  6.77s/it, train loss=0.6299, val ΔE00=2.412, best=2.163]Training (late/resnet18):  43%|████▎     | 43/100 [04:52<06:25,  6.77s/it, train loss=0.6423, val ΔE00=2.421, best=2.163]Training (late/resnet18):  44%|████▍     | 44/100 [04:59<06:18,  6.76s/it, train loss=0.6423, val ΔE00=2.421, best=2.163]Training (late/resnet18):  44%|████▍     | 44/100 [04:59<06:18,  6.76s/it, train loss=0.6798, val ΔE00=2.487, best=2.163]Training (late/resnet18):  45%|████▌     | 45/100 [05:06<06:14,  6.81s/it, train loss=0.6798, val ΔE00=2.487, best=2.163]Training (late/resnet18):  45%|████▌     | 45/100 [05:06<06:14,  6.81s/it, train loss=0.6872, val ΔE00=2.284, best=2.163]Training (late/resnet18):  46%|████▌     | 46/100 [05:13<06:07,  6.80s/it, train loss=0.6872, val ΔE00=2.284, best=2.163]Training (late/resnet18):  46%|████▌     | 46/100 [05:13<06:07,  6.80s/it, train loss=0.7343, val ΔE00=2.388, best=2.163]Training (late/resnet18):  47%|████▋     | 47/100 [05:19<05:59,  6.78s/it, train loss=0.7343, val ΔE00=2.388, best=2.163]Training (late/resnet18):  47%|████▋     | 47/100 [05:19<05:59,  6.78s/it, train loss=0.7015, val ΔE00=2.413, best=2.163]Training (late/resnet18):  48%|████▊     | 48/100 [05:26<05:51,  6.76s/it, train loss=0.7015, val ΔE00=2.413, best=2.163]Training (late/resnet18):  48%|████▊     | 48/100 [05:26<05:51,  6.76s/it, train loss=0.7207, val ΔE00=2.279, best=2.163]Training (late/resnet18):  49%|████▉     | 49/100 [05:33<05:44,  6.76s/it, train loss=0.7207, val ΔE00=2.279, best=2.163]Training (late/resnet18):  49%|████▉     | 49/100 [05:33<05:44,  6.76s/it, train loss=0.7759, val ΔE00=2.237, best=2.163]Training (late/resnet18):  50%|█████     | 50/100 [05:40<05:40,  6.81s/it, train loss=0.7759, val ΔE00=2.237, best=2.163]Training (late/resnet18):  50%|█████     | 50/100 [05:40<05:40,  6.81s/it, train loss=0.7862, val ΔE00=2.194, best=2.163]Training (late/resnet18):  51%|█████     | 51/100 [05:46<05:33,  6.80s/it, train loss=0.7862, val ΔE00=2.194, best=2.163]Training (late/resnet18):  51%|█████     | 51/100 [05:46<05:33,  6.80s/it, train loss=0.7538, val ΔE00=2.371, best=2.163]Training (late/resnet18):  52%|█████▏    | 52/100 [05:53<05:25,  6.78s/it, train loss=0.7538, val ΔE00=2.371, best=2.163]Training (late/resnet18):  52%|█████▏    | 52/100 [05:53<05:25,  6.78s/it, train loss=0.8060, val ΔE00=2.551, best=2.163]Training (late/resnet18):  53%|█████▎    | 53/100 [06:00<05:17,  6.77s/it, train loss=0.8060, val ΔE00=2.551, best=2.163]Training (late/resnet18):  53%|█████▎    | 53/100 [06:00<05:17,  6.77s/it, train loss=0.8264, val ΔE00=2.526, best=2.163]Training (late/resnet18):  54%|█████▍    | 54/100 [06:07<05:10,  6.76s/it, train loss=0.8264, val ΔE00=2.526, best=2.163]Training (late/resnet18):  54%|█████▍    | 54/100 [06:07<05:10,  6.76s/it, train loss=0.8661, val ΔE00=2.690, best=2.163]Training (late/resnet18):  55%|█████▌    | 55/100 [06:14<05:06,  6.81s/it, train loss=0.8661, val ΔE00=2.690, best=2.163]Training (late/resnet18):  55%|█████▌    | 55/100 [06:14<05:06,  6.81s/it, train loss=0.8704, val ΔE00=2.360, best=2.163]Training (late/resnet18):  56%|█████▌    | 56/100 [06:20<04:59,  6.80s/it, train loss=0.8704, val ΔE00=2.360, best=2.163]Training (late/resnet18):  56%|█████▌    | 56/100 [06:20<04:59,  6.80s/it, train loss=0.8282, val ΔE00=2.343, best=2.163]Training (late/resnet18):  57%|█████▋    | 57/100 [06:27<04:51,  6.78s/it, train loss=0.8282, val ΔE00=2.343, best=2.163]Training (late/resnet18):  57%|█████▋    | 57/100 [06:27<04:51,  6.78s/it, train loss=0.8444, val ΔE00=2.197, best=2.163]Training (late/resnet18):  58%|█████▊    | 58/100 [06:34<04:44,  6.76s/it, train loss=0.8444, val ΔE00=2.197, best=2.163]Training (late/resnet18):  58%|█████▊    | 58/100 [06:34<04:44,  6.76s/it, train loss=0.8040, val ΔE00=2.587, best=2.163]Training (late/resnet18):  58%|█████▊    | 58/100 [06:41<04:44,  6.76s/it, train loss=0.8988, val ΔE00=2.243, early_stop=yes]Training (late/resnet18):  58%|█████▊    | 58/100 [06:41<04:50,  6.91s/it, train loss=0.8988, val ΔE00=2.243, early_stop=yes]
[early] stop at epoch 59 (best de00=2.1634 @ 32)
[done] best ΔE00=2.163 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/late__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 4/12 ===
[sweep] id=004_model=late__backbone=resnet18__features=image+mean+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone resnet18 --features image+mean+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=late, backbone=resnet18, features=image+mean+meta, meta_encoder=flair
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:53,  7.21s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:53,  7.21s/it, train loss=0.0122, val ΔE00=7.001, best=7.001]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:22,  6.96s/it, train loss=0.0122, val ΔE00=7.001, best=7.001]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:22,  6.96s/it, train loss=0.0052, val ΔE00=4.702, best=4.702]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:07,  6.89s/it, train loss=0.0052, val ΔE00=4.702, best=4.702]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:07,  6.89s/it, train loss=0.0086, val ΔE00=4.225, best=4.225]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:57,  6.85s/it, train loss=0.0086, val ΔE00=4.225, best=4.225]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:57,  6.85s/it, train loss=0.0164, val ΔE00=3.792, best=3.792]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:53,  6.88s/it, train loss=0.0164, val ΔE00=3.792, best=3.792]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:53,  6.88s/it, train loss=0.0241, val ΔE00=3.806, best=3.792]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:43,  6.84s/it, train loss=0.0241, val ΔE00=3.806, best=3.792]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:43,  6.84s/it, train loss=0.0343, val ΔE00=3.851, best=3.792]Training (late/resnet18):   7%|▋         | 7/100 [00:48<10:34,  6.83s/it, train loss=0.0343, val ΔE00=3.851, best=3.792]Training (late/resnet18):   7%|▋         | 7/100 [00:48<10:34,  6.83s/it, train loss=0.0459, val ΔE00=3.245, best=3.245]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:26,  6.81s/it, train loss=0.0459, val ΔE00=3.245, best=3.245]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:26,  6.81s/it, train loss=0.0515, val ΔE00=3.152, best=3.152]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:17,  6.78s/it, train loss=0.0515, val ΔE00=3.152, best=3.152]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:17,  6.78s/it, train loss=0.0677, val ΔE00=3.395, best=3.152]Training (late/resnet18):  10%|█         | 10/100 [01:08<10:17,  6.86s/it, train loss=0.0677, val ΔE00=3.395, best=3.152]Training (late/resnet18):  10%|█         | 10/100 [01:08<10:17,  6.86s/it, train loss=0.0772, val ΔE00=2.788, best=2.788]Training (late/resnet18):  11%|█         | 11/100 [01:15<10:08,  6.83s/it, train loss=0.0772, val ΔE00=2.788, best=2.788]Training (late/resnet18):  11%|█         | 11/100 [01:15<10:08,  6.83s/it, train loss=0.0951, val ΔE00=3.178, best=2.788]Training (late/resnet18):  12%|█▏        | 12/100 [01:22<10:00,  6.82s/it, train loss=0.0951, val ΔE00=3.178, best=2.788]Training (late/resnet18):  12%|█▏        | 12/100 [01:22<10:00,  6.82s/it, train loss=0.1052, val ΔE00=2.545, best=2.545]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:50,  6.79s/it, train loss=0.1052, val ΔE00=2.545, best=2.545]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:50,  6.79s/it, train loss=0.1143, val ΔE00=2.562, best=2.545]Training (late/resnet18):  14%|█▍        | 14/100 [01:35<09:42,  6.77s/it, train loss=0.1143, val ΔE00=2.562, best=2.545]Training (late/resnet18):  14%|█▍        | 14/100 [01:35<09:42,  6.77s/it, train loss=0.1434, val ΔE00=2.875, best=2.545]Training (late/resnet18):  15%|█▌        | 15/100 [01:42<09:40,  6.83s/it, train loss=0.1434, val ΔE00=2.875, best=2.545]Training (late/resnet18):  15%|█▌        | 15/100 [01:42<09:40,  6.83s/it, train loss=0.1481, val ΔE00=2.734, best=2.545]Training (late/resnet18):  16%|█▌        | 16/100 [01:49<09:32,  6.81s/it, train loss=0.1481, val ΔE00=2.734, best=2.545]Training (late/resnet18):  16%|█▌        | 16/100 [01:49<09:32,  6.81s/it, train loss=0.1836, val ΔE00=2.743, best=2.545]Training (late/resnet18):  17%|█▋        | 17/100 [01:56<09:23,  6.79s/it, train loss=0.1836, val ΔE00=2.743, best=2.545]Training (late/resnet18):  17%|█▋        | 17/100 [01:56<09:23,  6.79s/it, train loss=0.2115, val ΔE00=2.781, best=2.545]Training (late/resnet18):  18%|█▊        | 18/100 [02:02<09:16,  6.79s/it, train loss=0.2115, val ΔE00=2.781, best=2.545]Training (late/resnet18):  18%|█▊        | 18/100 [02:02<09:16,  6.79s/it, train loss=0.2096, val ΔE00=2.451, best=2.451]Training (late/resnet18):  19%|█▉        | 19/100 [02:09<09:08,  6.77s/it, train loss=0.2096, val ΔE00=2.451, best=2.451]Training (late/resnet18):  19%|█▉        | 19/100 [02:09<09:08,  6.77s/it, train loss=0.2177, val ΔE00=2.630, best=2.451]Training (late/resnet18):  20%|██        | 20/100 [02:16<09:08,  6.86s/it, train loss=0.2177, val ΔE00=2.630, best=2.451]Training (late/resnet18):  20%|██        | 20/100 [02:16<09:08,  6.86s/it, train loss=0.2347, val ΔE00=2.330, best=2.330]Training (late/resnet18):  21%|██        | 21/100 [02:23<08:59,  6.83s/it, train loss=0.2347, val ΔE00=2.330, best=2.330]Training (late/resnet18):  21%|██        | 21/100 [02:23<08:59,  6.83s/it, train loss=0.2522, val ΔE00=2.683, best=2.330]Training (late/resnet18):  22%|██▏       | 22/100 [02:30<08:50,  6.80s/it, train loss=0.2522, val ΔE00=2.683, best=2.330]Training (late/resnet18):  22%|██▏       | 22/100 [02:30<08:50,  6.80s/it, train loss=0.2769, val ΔE00=2.622, best=2.330]Training (late/resnet18):  23%|██▎       | 23/100 [02:36<08:41,  6.78s/it, train loss=0.2769, val ΔE00=2.622, best=2.330]Training (late/resnet18):  23%|██▎       | 23/100 [02:36<08:41,  6.78s/it, train loss=0.3011, val ΔE00=2.467, best=2.330]Training (late/resnet18):  24%|██▍       | 24/100 [02:43<08:34,  6.77s/it, train loss=0.3011, val ΔE00=2.467, best=2.330]Training (late/resnet18):  24%|██▍       | 24/100 [02:43<08:34,  6.77s/it, train loss=0.3006, val ΔE00=2.685, best=2.330]Training (late/resnet18):  25%|██▌       | 25/100 [02:50<08:31,  6.82s/it, train loss=0.3006, val ΔE00=2.685, best=2.330]Training (late/resnet18):  25%|██▌       | 25/100 [02:50<08:31,  6.82s/it, train loss=0.3437, val ΔE00=2.739, best=2.330]Training (late/resnet18):  26%|██▌       | 26/100 [02:57<08:23,  6.80s/it, train loss=0.3437, val ΔE00=2.739, best=2.330]Training (late/resnet18):  26%|██▌       | 26/100 [02:57<08:23,  6.80s/it, train loss=0.3423, val ΔE00=2.346, best=2.330]Training (late/resnet18):  27%|██▋       | 27/100 [03:04<08:17,  6.81s/it, train loss=0.3423, val ΔE00=2.346, best=2.330]Training (late/resnet18):  27%|██▋       | 27/100 [03:04<08:17,  6.81s/it, train loss=0.3627, val ΔE00=2.246, best=2.246]Training (late/resnet18):  28%|██▊       | 28/100 [03:10<08:08,  6.79s/it, train loss=0.3627, val ΔE00=2.246, best=2.246]Training (late/resnet18):  28%|██▊       | 28/100 [03:10<08:08,  6.79s/it, train loss=0.3864, val ΔE00=2.384, best=2.246]Training (late/resnet18):  29%|██▉       | 29/100 [03:17<08:00,  6.77s/it, train loss=0.3864, val ΔE00=2.384, best=2.246]Training (late/resnet18):  29%|██▉       | 29/100 [03:17<08:00,  6.77s/it, train loss=0.4202, val ΔE00=2.553, best=2.246]Training (late/resnet18):  30%|███       | 30/100 [03:24<07:57,  6.82s/it, train loss=0.4202, val ΔE00=2.553, best=2.246]Training (late/resnet18):  30%|███       | 30/100 [03:24<07:57,  6.82s/it, train loss=0.4192, val ΔE00=2.435, best=2.246]Training (late/resnet18):  31%|███       | 31/100 [03:31<07:49,  6.81s/it, train loss=0.4192, val ΔE00=2.435, best=2.246]Training (late/resnet18):  31%|███       | 31/100 [03:31<07:49,  6.81s/it, train loss=0.4434, val ΔE00=2.361, best=2.246]Training (late/resnet18):  32%|███▏      | 32/100 [03:38<07:42,  6.81s/it, train loss=0.4434, val ΔE00=2.361, best=2.246]Training (late/resnet18):  32%|███▏      | 32/100 [03:38<07:42,  6.81s/it, train loss=0.4429, val ΔE00=2.163, best=2.163]Training (late/resnet18):  33%|███▎      | 33/100 [03:44<07:34,  6.79s/it, train loss=0.4429, val ΔE00=2.163, best=2.163]Training (late/resnet18):  33%|███▎      | 33/100 [03:44<07:34,  6.79s/it, train loss=0.4555, val ΔE00=2.338, best=2.163]Training (late/resnet18):  34%|███▍      | 34/100 [03:51<07:26,  6.77s/it, train loss=0.4555, val ΔE00=2.338, best=2.163]Training (late/resnet18):  34%|███▍      | 34/100 [03:51<07:26,  6.77s/it, train loss=0.5026, val ΔE00=2.289, best=2.163]Training (late/resnet18):  35%|███▌      | 35/100 [03:58<07:23,  6.83s/it, train loss=0.5026, val ΔE00=2.289, best=2.163]Training (late/resnet18):  35%|███▌      | 35/100 [03:58<07:23,  6.83s/it, train loss=0.5757, val ΔE00=2.868, best=2.163]Training (late/resnet18):  36%|███▌      | 36/100 [04:05<07:16,  6.81s/it, train loss=0.5757, val ΔE00=2.868, best=2.163]Training (late/resnet18):  36%|███▌      | 36/100 [04:05<07:16,  6.81s/it, train loss=0.5520, val ΔE00=2.570, best=2.163]Training (late/resnet18):  37%|███▋      | 37/100 [04:12<07:07,  6.79s/it, train loss=0.5520, val ΔE00=2.570, best=2.163]Training (late/resnet18):  37%|███▋      | 37/100 [04:12<07:07,  6.79s/it, train loss=0.6019, val ΔE00=2.501, best=2.163]Training (late/resnet18):  38%|███▊      | 38/100 [04:18<07:00,  6.78s/it, train loss=0.6019, val ΔE00=2.501, best=2.163]Training (late/resnet18):  38%|███▊      | 38/100 [04:18<07:00,  6.78s/it, train loss=0.5959, val ΔE00=2.484, best=2.163]Training (late/resnet18):  39%|███▉      | 39/100 [04:25<06:52,  6.77s/it, train loss=0.5959, val ΔE00=2.484, best=2.163]Training (late/resnet18):  39%|███▉      | 39/100 [04:25<06:52,  6.77s/it, train loss=0.5795, val ΔE00=2.183, best=2.163]Training (late/resnet18):  40%|████      | 40/100 [04:32<06:49,  6.82s/it, train loss=0.5795, val ΔE00=2.183, best=2.163]Training (late/resnet18):  40%|████      | 40/100 [04:32<06:49,  6.82s/it, train loss=0.5989, val ΔE00=2.323, best=2.163]Training (late/resnet18):  41%|████      | 41/100 [04:39<06:42,  6.81s/it, train loss=0.5989, val ΔE00=2.323, best=2.163]Training (late/resnet18):  41%|████      | 41/100 [04:39<06:42,  6.81s/it, train loss=0.6477, val ΔE00=2.395, best=2.163]Training (late/resnet18):  42%|████▏     | 42/100 [04:46<06:33,  6.79s/it, train loss=0.6477, val ΔE00=2.395, best=2.163]Training (late/resnet18):  42%|████▏     | 42/100 [04:46<06:33,  6.79s/it, train loss=0.6299, val ΔE00=2.412, best=2.163]Training (late/resnet18):  43%|████▎     | 43/100 [04:52<06:26,  6.77s/it, train loss=0.6299, val ΔE00=2.412, best=2.163]Training (late/resnet18):  43%|████▎     | 43/100 [04:52<06:26,  6.77s/it, train loss=0.6423, val ΔE00=2.421, best=2.163]Training (late/resnet18):  44%|████▍     | 44/100 [04:59<06:18,  6.76s/it, train loss=0.6423, val ΔE00=2.421, best=2.163]Training (late/resnet18):  44%|████▍     | 44/100 [04:59<06:18,  6.76s/it, train loss=0.6798, val ΔE00=2.487, best=2.163]Training (late/resnet18):  45%|████▌     | 45/100 [05:06<06:15,  6.82s/it, train loss=0.6798, val ΔE00=2.487, best=2.163]Training (late/resnet18):  45%|████▌     | 45/100 [05:06<06:15,  6.82s/it, train loss=0.6872, val ΔE00=2.284, best=2.163]Training (late/resnet18):  46%|████▌     | 46/100 [05:13<06:07,  6.80s/it, train loss=0.6872, val ΔE00=2.284, best=2.163]Training (late/resnet18):  46%|████▌     | 46/100 [05:13<06:07,  6.80s/it, train loss=0.7343, val ΔE00=2.388, best=2.163]Training (late/resnet18):  47%|████▋     | 47/100 [05:20<05:59,  6.78s/it, train loss=0.7343, val ΔE00=2.388, best=2.163]Training (late/resnet18):  47%|████▋     | 47/100 [05:20<05:59,  6.78s/it, train loss=0.7015, val ΔE00=2.413, best=2.163]Training (late/resnet18):  48%|████▊     | 48/100 [05:26<05:52,  6.77s/it, train loss=0.7015, val ΔE00=2.413, best=2.163]Training (late/resnet18):  48%|████▊     | 48/100 [05:26<05:52,  6.77s/it, train loss=0.7207, val ΔE00=2.279, best=2.163]Training (late/resnet18):  49%|████▉     | 49/100 [05:33<05:44,  6.76s/it, train loss=0.7207, val ΔE00=2.279, best=2.163]Training (late/resnet18):  49%|████▉     | 49/100 [05:33<05:44,  6.76s/it, train loss=0.7759, val ΔE00=2.237, best=2.163]Training (late/resnet18):  50%|█████     | 50/100 [05:40<05:40,  6.81s/it, train loss=0.7759, val ΔE00=2.237, best=2.163]Training (late/resnet18):  50%|█████     | 50/100 [05:40<05:40,  6.81s/it, train loss=0.7862, val ΔE00=2.194, best=2.163]Training (late/resnet18):  51%|█████     | 51/100 [05:47<05:33,  6.80s/it, train loss=0.7862, val ΔE00=2.194, best=2.163]Training (late/resnet18):  51%|█████     | 51/100 [05:47<05:33,  6.80s/it, train loss=0.7538, val ΔE00=2.371, best=2.163]Training (late/resnet18):  52%|█████▏    | 52/100 [05:53<05:25,  6.79s/it, train loss=0.7538, val ΔE00=2.371, best=2.163]Training (late/resnet18):  52%|█████▏    | 52/100 [05:53<05:25,  6.79s/it, train loss=0.8060, val ΔE00=2.551, best=2.163]Training (late/resnet18):  53%|█████▎    | 53/100 [06:00<05:18,  6.77s/it, train loss=0.8060, val ΔE00=2.551, best=2.163]Training (late/resnet18):  53%|█████▎    | 53/100 [06:00<05:18,  6.77s/it, train loss=0.8264, val ΔE00=2.526, best=2.163]Training (late/resnet18):  54%|█████▍    | 54/100 [06:07<05:11,  6.77s/it, train loss=0.8264, val ΔE00=2.526, best=2.163]Training (late/resnet18):  54%|█████▍    | 54/100 [06:07<05:11,  6.77s/it, train loss=0.8661, val ΔE00=2.690, best=2.163]Training (late/resnet18):  55%|█████▌    | 55/100 [06:14<05:07,  6.82s/it, train loss=0.8661, val ΔE00=2.690, best=2.163]Training (late/resnet18):  55%|█████▌    | 55/100 [06:14<05:07,  6.82s/it, train loss=0.8704, val ΔE00=2.360, best=2.163]Training (late/resnet18):  56%|█████▌    | 56/100 [06:21<04:59,  6.81s/it, train loss=0.8704, val ΔE00=2.360, best=2.163]Training (late/resnet18):  56%|█████▌    | 56/100 [06:21<04:59,  6.81s/it, train loss=0.8282, val ΔE00=2.343, best=2.163]Training (late/resnet18):  57%|█████▋    | 57/100 [06:27<04:51,  6.79s/it, train loss=0.8282, val ΔE00=2.343, best=2.163]Training (late/resnet18):  57%|█████▋    | 57/100 [06:27<04:51,  6.79s/it, train loss=0.8444, val ΔE00=2.197, best=2.163]Training (late/resnet18):  58%|█████▊    | 58/100 [06:34<04:44,  6.77s/it, train loss=0.8444, val ΔE00=2.197, best=2.163]Training (late/resnet18):  58%|█████▊    | 58/100 [06:34<04:44,  6.77s/it, train loss=0.8040, val ΔE00=2.587, best=2.163]Training (late/resnet18):  58%|█████▊    | 58/100 [06:41<04:44,  6.77s/it, train loss=0.8988, val ΔE00=2.243, early_stop=yes]Training (late/resnet18):  58%|█████▊    | 58/100 [06:41<04:50,  6.92s/it, train loss=0.8988, val ΔE00=2.243, early_stop=yes]
[early] stop at epoch 59 (best de00=2.1634 @ 32)
[done] best ΔE00=2.163 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/late__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 5/12 ===
[sweep] id=005_model=film__backbone=smallcnn__features=image+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone smallcnn --features image+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=film, backbone=smallcnn, features=image+meta, meta_encoder=flair
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<09:02,  5.48s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<09:02,  5.48s/it, train loss=0.0118, val ΔE00=15.690, best=15.690]Training (film/smallcnn):   2%|▏         | 2/100 [00:10<08:33,  5.24s/it, train loss=0.0118, val ΔE00=15.690, best=15.690]Training (film/smallcnn):   2%|▏         | 2/100 [00:10<08:33,  5.24s/it, train loss=0.0101, val ΔE00=6.862, best=6.862]  Training (film/smallcnn):   3%|▎         | 3/100 [00:15<08:20,  5.16s/it, train loss=0.0101, val ΔE00=6.862, best=6.862]Training (film/smallcnn):   3%|▎         | 3/100 [00:15<08:20,  5.16s/it, train loss=0.0158, val ΔE00=8.829, best=6.862]Training (film/smallcnn):   4%|▍         | 4/100 [00:20<08:11,  5.12s/it, train loss=0.0158, val ΔE00=8.829, best=6.862]Training (film/smallcnn):   4%|▍         | 4/100 [00:20<08:11,  5.12s/it, train loss=0.0251, val ΔE00=6.292, best=6.292]Training (film/smallcnn):   5%|▌         | 5/100 [00:25<08:12,  5.18s/it, train loss=0.0251, val ΔE00=6.292, best=6.292]Training (film/smallcnn):   5%|▌         | 5/100 [00:25<08:12,  5.18s/it, train loss=0.0389, val ΔE00=7.311, best=6.292]Training (film/smallcnn):   6%|▌         | 6/100 [00:31<08:07,  5.19s/it, train loss=0.0389, val ΔE00=7.311, best=6.292]Training (film/smallcnn):   6%|▌         | 6/100 [00:31<08:07,  5.19s/it, train loss=0.0533, val ΔE00=5.425, best=5.425]Training (film/smallcnn):   7%|▋         | 7/100 [00:36<07:58,  5.14s/it, train loss=0.0533, val ΔE00=5.425, best=5.425]Training (film/smallcnn):   7%|▋         | 7/100 [00:36<07:58,  5.14s/it, train loss=0.0663, val ΔE00=4.747, best=4.747]Training (film/smallcnn):   8%|▊         | 8/100 [00:41<07:50,  5.12s/it, train loss=0.0663, val ΔE00=4.747, best=4.747]Training (film/smallcnn):   8%|▊         | 8/100 [00:41<07:50,  5.12s/it, train loss=0.0862, val ΔE00=4.923, best=4.747]Training (film/smallcnn):   9%|▉         | 9/100 [00:46<07:45,  5.11s/it, train loss=0.0862, val ΔE00=4.923, best=4.747]Training (film/smallcnn):   9%|▉         | 9/100 [00:46<07:45,  5.11s/it, train loss=0.1049, val ΔE00=4.999, best=4.747]Training (film/smallcnn):  10%|█         | 10/100 [00:51<07:45,  5.17s/it, train loss=0.1049, val ΔE00=4.999, best=4.747]Training (film/smallcnn):  10%|█         | 10/100 [00:51<07:45,  5.17s/it, train loss=0.1336, val ΔE00=9.463, best=4.747]Training (film/smallcnn):  11%|█         | 11/100 [00:56<07:40,  5.18s/it, train loss=0.1336, val ΔE00=9.463, best=4.747]Training (film/smallcnn):  11%|█         | 11/100 [00:56<07:40,  5.18s/it, train loss=0.1601, val ΔE00=4.135, best=4.135]Training (film/smallcnn):  12%|█▏        | 12/100 [01:01<07:32,  5.14s/it, train loss=0.1601, val ΔE00=4.135, best=4.135]Training (film/smallcnn):  12%|█▏        | 12/100 [01:01<07:32,  5.14s/it, train loss=0.1647, val ΔE00=3.914, best=3.914]Training (film/smallcnn):  13%|█▎        | 13/100 [01:07<07:25,  5.12s/it, train loss=0.1647, val ΔE00=3.914, best=3.914]Training (film/smallcnn):  13%|█▎        | 13/100 [01:07<07:25,  5.12s/it, train loss=0.2103, val ΔE00=4.566, best=3.914]Training (film/smallcnn):  14%|█▍        | 14/100 [01:12<07:20,  5.13s/it, train loss=0.2103, val ΔE00=4.566, best=3.914]Training (film/smallcnn):  14%|█▍        | 14/100 [01:12<07:20,  5.13s/it, train loss=0.2433, val ΔE00=4.960, best=3.914]Training (film/smallcnn):  15%|█▌        | 15/100 [01:17<07:23,  5.21s/it, train loss=0.2433, val ΔE00=4.960, best=3.914]Training (film/smallcnn):  15%|█▌        | 15/100 [01:17<07:23,  5.21s/it, train loss=0.2524, val ΔE00=4.131, best=3.914]Training (film/smallcnn):  16%|█▌        | 16/100 [01:22<07:17,  5.21s/it, train loss=0.2524, val ΔE00=4.131, best=3.914]Training (film/smallcnn):  16%|█▌        | 16/100 [01:22<07:17,  5.21s/it, train loss=0.2706, val ΔE00=3.787, best=3.787]Training (film/smallcnn):  17%|█▋        | 17/100 [01:27<07:09,  5.18s/it, train loss=0.2706, val ΔE00=3.787, best=3.787]Training (film/smallcnn):  17%|█▋        | 17/100 [01:27<07:09,  5.18s/it, train loss=0.3206, val ΔE00=3.434, best=3.434]Training (film/smallcnn):  18%|█▊        | 18/100 [01:32<07:02,  5.16s/it, train loss=0.3206, val ΔE00=3.434, best=3.434]Training (film/smallcnn):  18%|█▊        | 18/100 [01:32<07:02,  5.16s/it, train loss=0.3415, val ΔE00=4.850, best=3.434]Training (film/smallcnn):  19%|█▉        | 19/100 [01:38<06:55,  5.14s/it, train loss=0.3415, val ΔE00=4.850, best=3.434]Training (film/smallcnn):  19%|█▉        | 19/100 [01:38<06:55,  5.14s/it, train loss=0.4149, val ΔE00=3.570, best=3.434]Training (film/smallcnn):  20%|██        | 20/100 [01:43<06:54,  5.19s/it, train loss=0.4149, val ΔE00=3.570, best=3.434]Training (film/smallcnn):  20%|██        | 20/100 [01:43<06:54,  5.19s/it, train loss=0.4616, val ΔE00=4.905, best=3.434]Training (film/smallcnn):  21%|██        | 21/100 [01:48<06:50,  5.20s/it, train loss=0.4616, val ΔE00=4.905, best=3.434]Training (film/smallcnn):  21%|██        | 21/100 [01:48<06:50,  5.20s/it, train loss=0.4605, val ΔE00=3.665, best=3.434]Training (film/smallcnn):  22%|██▏       | 22/100 [01:53<06:42,  5.16s/it, train loss=0.4605, val ΔE00=3.665, best=3.434]Training (film/smallcnn):  22%|██▏       | 22/100 [01:53<06:42,  5.16s/it, train loss=0.4902, val ΔE00=4.248, best=3.434]Training (film/smallcnn):  23%|██▎       | 23/100 [01:58<06:35,  5.14s/it, train loss=0.4902, val ΔE00=4.248, best=3.434]Training (film/smallcnn):  23%|██▎       | 23/100 [01:58<06:35,  5.14s/it, train loss=0.5454, val ΔE00=4.113, best=3.434]Training (film/smallcnn):  24%|██▍       | 24/100 [02:03<06:28,  5.12s/it, train loss=0.5454, val ΔE00=4.113, best=3.434]Training (film/smallcnn):  24%|██▍       | 24/100 [02:03<06:28,  5.12s/it, train loss=0.6240, val ΔE00=3.808, best=3.434]Training (film/smallcnn):  25%|██▌       | 25/100 [02:09<06:27,  5.17s/it, train loss=0.6240, val ΔE00=3.808, best=3.434]Training (film/smallcnn):  25%|██▌       | 25/100 [02:09<06:27,  5.17s/it, train loss=0.6349, val ΔE00=3.543, best=3.434]Training (film/smallcnn):  26%|██▌       | 26/100 [02:14<06:24,  5.19s/it, train loss=0.6349, val ΔE00=3.543, best=3.434]Training (film/smallcnn):  26%|██▌       | 26/100 [02:14<06:24,  5.19s/it, train loss=0.6898, val ΔE00=4.683, best=3.434]Training (film/smallcnn):  27%|██▋       | 27/100 [02:19<06:16,  5.16s/it, train loss=0.6898, val ΔE00=4.683, best=3.434]Training (film/smallcnn):  27%|██▋       | 27/100 [02:19<06:16,  5.16s/it, train loss=0.7403, val ΔE00=4.369, best=3.434]Training (film/smallcnn):  28%|██▊       | 28/100 [02:24<06:09,  5.13s/it, train loss=0.7403, val ΔE00=4.369, best=3.434]Training (film/smallcnn):  28%|██▊       | 28/100 [02:24<06:09,  5.13s/it, train loss=0.7593, val ΔE00=3.689, best=3.434]Training (film/smallcnn):  29%|██▉       | 29/100 [02:29<06:03,  5.12s/it, train loss=0.7593, val ΔE00=3.689, best=3.434]Training (film/smallcnn):  29%|██▉       | 29/100 [02:29<06:03,  5.12s/it, train loss=0.7759, val ΔE00=3.653, best=3.434]Training (film/smallcnn):  30%|███       | 30/100 [02:34<06:01,  5.17s/it, train loss=0.7759, val ΔE00=3.653, best=3.434]Training (film/smallcnn):  30%|███       | 30/100 [02:34<06:01,  5.17s/it, train loss=0.8009, val ΔE00=3.056, best=3.056]Training (film/smallcnn):  31%|███       | 31/100 [02:40<05:56,  5.17s/it, train loss=0.8009, val ΔE00=3.056, best=3.056]Training (film/smallcnn):  31%|███       | 31/100 [02:40<05:56,  5.17s/it, train loss=0.8991, val ΔE00=3.642, best=3.056]Training (film/smallcnn):  32%|███▏      | 32/100 [02:45<05:49,  5.14s/it, train loss=0.8991, val ΔE00=3.642, best=3.056]Training (film/smallcnn):  32%|███▏      | 32/100 [02:45<05:49,  5.14s/it, train loss=0.8588, val ΔE00=3.069, best=3.056]Training (film/smallcnn):  33%|███▎      | 33/100 [02:50<05:42,  5.12s/it, train loss=0.8588, val ΔE00=3.069, best=3.056]Training (film/smallcnn):  33%|███▎      | 33/100 [02:50<05:42,  5.12s/it, train loss=0.9820, val ΔE00=3.440, best=3.056]Training (film/smallcnn):  34%|███▍      | 34/100 [02:55<05:36,  5.10s/it, train loss=0.9820, val ΔE00=3.440, best=3.056]Training (film/smallcnn):  34%|███▍      | 34/100 [02:55<05:36,  5.10s/it, train loss=0.9703, val ΔE00=4.148, best=3.056]Training (film/smallcnn):  35%|███▌      | 35/100 [03:00<05:35,  5.17s/it, train loss=0.9703, val ΔE00=4.148, best=3.056]Training (film/smallcnn):  35%|███▌      | 35/100 [03:00<05:35,  5.17s/it, train loss=1.0289, val ΔE00=3.758, best=3.056]Training (film/smallcnn):  36%|███▌      | 36/100 [03:05<05:31,  5.17s/it, train loss=1.0289, val ΔE00=3.758, best=3.056]Training (film/smallcnn):  36%|███▌      | 36/100 [03:05<05:31,  5.17s/it, train loss=1.0292, val ΔE00=3.339, best=3.056]Training (film/smallcnn):  37%|███▋      | 37/100 [03:10<05:24,  5.14s/it, train loss=1.0292, val ΔE00=3.339, best=3.056]Training (film/smallcnn):  37%|███▋      | 37/100 [03:10<05:24,  5.14s/it, train loss=1.1798, val ΔE00=3.192, best=3.056]Training (film/smallcnn):  38%|███▊      | 38/100 [03:15<05:17,  5.13s/it, train loss=1.1798, val ΔE00=3.192, best=3.056]Training (film/smallcnn):  38%|███▊      | 38/100 [03:15<05:17,  5.13s/it, train loss=1.1346, val ΔE00=3.861, best=3.056]Training (film/smallcnn):  39%|███▉      | 39/100 [03:21<05:12,  5.13s/it, train loss=1.1346, val ΔE00=3.861, best=3.056]Training (film/smallcnn):  39%|███▉      | 39/100 [03:21<05:12,  5.13s/it, train loss=1.1850, val ΔE00=3.585, best=3.056]Training (film/smallcnn):  40%|████      | 40/100 [03:26<05:11,  5.20s/it, train loss=1.1850, val ΔE00=3.585, best=3.056]Training (film/smallcnn):  40%|████      | 40/100 [03:26<05:11,  5.20s/it, train loss=1.2665, val ΔE00=3.325, best=3.056]Training (film/smallcnn):  41%|████      | 41/100 [03:31<05:08,  5.22s/it, train loss=1.2665, val ΔE00=3.325, best=3.056]Training (film/smallcnn):  41%|████      | 41/100 [03:31<05:08,  5.22s/it, train loss=1.3425, val ΔE00=2.766, best=2.766]Training (film/smallcnn):  42%|████▏     | 42/100 [03:36<05:00,  5.18s/it, train loss=1.3425, val ΔE00=2.766, best=2.766]Training (film/smallcnn):  42%|████▏     | 42/100 [03:36<05:00,  5.18s/it, train loss=1.3396, val ΔE00=2.801, best=2.766]Training (film/smallcnn):  43%|████▎     | 43/100 [03:41<04:53,  5.14s/it, train loss=1.3396, val ΔE00=2.801, best=2.766]Training (film/smallcnn):  43%|████▎     | 43/100 [03:41<04:53,  5.14s/it, train loss=1.2886, val ΔE00=3.637, best=2.766]Training (film/smallcnn):  44%|████▍     | 44/100 [03:46<04:46,  5.12s/it, train loss=1.2886, val ΔE00=3.637, best=2.766]Training (film/smallcnn):  44%|████▍     | 44/100 [03:46<04:46,  5.12s/it, train loss=1.3312, val ΔE00=3.191, best=2.766]Training (film/smallcnn):  45%|████▌     | 45/100 [03:52<04:44,  5.17s/it, train loss=1.3312, val ΔE00=3.191, best=2.766]Training (film/smallcnn):  45%|████▌     | 45/100 [03:52<04:44,  5.17s/it, train loss=1.4238, val ΔE00=2.771, best=2.766]Training (film/smallcnn):  46%|████▌     | 46/100 [03:57<04:39,  5.18s/it, train loss=1.4238, val ΔE00=2.771, best=2.766]Training (film/smallcnn):  46%|████▌     | 46/100 [03:57<04:39,  5.18s/it, train loss=1.4344, val ΔE00=2.946, best=2.766]Training (film/smallcnn):  47%|████▋     | 47/100 [04:02<04:32,  5.14s/it, train loss=1.4344, val ΔE00=2.946, best=2.766]Training (film/smallcnn):  47%|████▋     | 47/100 [04:02<04:32,  5.14s/it, train loss=1.4258, val ΔE00=4.230, best=2.766]Training (film/smallcnn):  48%|████▊     | 48/100 [04:07<04:25,  5.11s/it, train loss=1.4258, val ΔE00=4.230, best=2.766]Training (film/smallcnn):  48%|████▊     | 48/100 [04:07<04:25,  5.11s/it, train loss=1.6174, val ΔE00=3.375, best=2.766]Training (film/smallcnn):  49%|████▉     | 49/100 [04:12<04:20,  5.11s/it, train loss=1.6174, val ΔE00=3.375, best=2.766]Training (film/smallcnn):  49%|████▉     | 49/100 [04:12<04:20,  5.11s/it, train loss=1.5241, val ΔE00=3.687, best=2.766]Training (film/smallcnn):  50%|█████     | 50/100 [04:17<04:18,  5.16s/it, train loss=1.5241, val ΔE00=3.687, best=2.766]Training (film/smallcnn):  50%|█████     | 50/100 [04:17<04:18,  5.16s/it, train loss=1.5536, val ΔE00=3.040, best=2.766]Training (film/smallcnn):  51%|█████     | 51/100 [04:23<04:13,  5.17s/it, train loss=1.5536, val ΔE00=3.040, best=2.766]Training (film/smallcnn):  51%|█████     | 51/100 [04:23<04:13,  5.17s/it, train loss=1.6575, val ΔE00=4.521, best=2.766]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:28<04:06,  5.14s/it, train loss=1.6575, val ΔE00=4.521, best=2.766]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:28<04:06,  5.14s/it, train loss=1.7998, val ΔE00=2.308, best=2.308]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:33<04:00,  5.12s/it, train loss=1.7998, val ΔE00=2.308, best=2.308]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:33<04:00,  5.12s/it, train loss=1.6847, val ΔE00=3.894, best=2.308]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:38<03:55,  5.11s/it, train loss=1.6847, val ΔE00=3.894, best=2.308]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:38<03:55,  5.11s/it, train loss=1.7388, val ΔE00=2.869, best=2.308]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:43<03:53,  5.19s/it, train loss=1.7388, val ΔE00=2.869, best=2.308]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:43<03:53,  5.19s/it, train loss=1.7073, val ΔE00=2.515, best=2.308]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:48<03:49,  5.22s/it, train loss=1.7073, val ΔE00=2.515, best=2.308]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:48<03:49,  5.22s/it, train loss=1.7141, val ΔE00=3.177, best=2.308]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:54<03:43,  5.19s/it, train loss=1.7141, val ΔE00=3.177, best=2.308]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:54<03:43,  5.19s/it, train loss=1.7301, val ΔE00=3.099, best=2.308]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:59<03:37,  5.17s/it, train loss=1.7301, val ΔE00=3.099, best=2.308]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:59<03:37,  5.17s/it, train loss=1.7113, val ΔE00=3.521, best=2.308]Training (film/smallcnn):  59%|█████▉    | 59/100 [05:04<03:30,  5.14s/it, train loss=1.7113, val ΔE00=3.521, best=2.308]Training (film/smallcnn):  59%|█████▉    | 59/100 [05:04<03:30,  5.14s/it, train loss=1.8774, val ΔE00=3.429, best=2.308]Training (film/smallcnn):  60%|██████    | 60/100 [05:09<03:28,  5.20s/it, train loss=1.8774, val ΔE00=3.429, best=2.308]Training (film/smallcnn):  60%|██████    | 60/100 [05:09<03:28,  5.20s/it, train loss=1.6608, val ΔE00=2.727, best=2.308]Training (film/smallcnn):  61%|██████    | 61/100 [05:14<03:22,  5.18s/it, train loss=1.6608, val ΔE00=2.727, best=2.308]Training (film/smallcnn):  61%|██████    | 61/100 [05:14<03:22,  5.18s/it, train loss=1.8319, val ΔE00=3.223, best=2.308]Training (film/smallcnn):  61%|██████    | 61/100 [05:19<03:22,  5.18s/it, train loss=1.8883, val ΔE00=2.816, early_stop=yes]Training (film/smallcnn):  61%|██████    | 61/100 [05:19<03:24,  5.24s/it, train loss=1.8883, val ΔE00=2.816, early_stop=yes]
[early] stop at epoch 62 (best de00=2.3076 @ 52)
[done] best ΔE00=2.308 over 62 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/film__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 6/12 ===
[sweep] id=006_model=film__backbone=smallcnn__features=image+mean+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone smallcnn --features image+mean+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=film, backbone=smallcnn, features=image+mean+meta, meta_encoder=flair
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<09:08,  5.54s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<09:08,  5.54s/it, train loss=0.0118, val ΔE00=15.690, best=15.690]Training (film/smallcnn):   2%|▏         | 2/100 [00:10<08:40,  5.31s/it, train loss=0.0118, val ΔE00=15.690, best=15.690]Training (film/smallcnn):   2%|▏         | 2/100 [00:10<08:40,  5.31s/it, train loss=0.0101, val ΔE00=6.862, best=6.862]  Training (film/smallcnn):   3%|▎         | 3/100 [00:15<08:29,  5.26s/it, train loss=0.0101, val ΔE00=6.862, best=6.862]Training (film/smallcnn):   3%|▎         | 3/100 [00:15<08:29,  5.26s/it, train loss=0.0158, val ΔE00=8.829, best=6.862]Training (film/smallcnn):   4%|▍         | 4/100 [00:21<08:20,  5.21s/it, train loss=0.0158, val ΔE00=8.829, best=6.862]Training (film/smallcnn):   4%|▍         | 4/100 [00:21<08:20,  5.21s/it, train loss=0.0251, val ΔE00=6.292, best=6.292]Training (film/smallcnn):   5%|▌         | 5/100 [00:26<08:20,  5.27s/it, train loss=0.0251, val ΔE00=6.292, best=6.292]Training (film/smallcnn):   5%|▌         | 5/100 [00:26<08:20,  5.27s/it, train loss=0.0389, val ΔE00=7.311, best=6.292]Training (film/smallcnn):   6%|▌         | 6/100 [00:31<08:15,  5.28s/it, train loss=0.0389, val ΔE00=7.311, best=6.292]Training (film/smallcnn):   6%|▌         | 6/100 [00:31<08:15,  5.28s/it, train loss=0.0533, val ΔE00=5.425, best=5.425]Training (film/smallcnn):   7%|▋         | 7/100 [00:36<08:06,  5.23s/it, train loss=0.0533, val ΔE00=5.425, best=5.425]Training (film/smallcnn):   7%|▋         | 7/100 [00:36<08:06,  5.23s/it, train loss=0.0663, val ΔE00=4.747, best=4.747]Training (film/smallcnn):   8%|▊         | 8/100 [00:41<07:58,  5.20s/it, train loss=0.0663, val ΔE00=4.747, best=4.747]Training (film/smallcnn):   8%|▊         | 8/100 [00:41<07:58,  5.20s/it, train loss=0.0862, val ΔE00=4.923, best=4.747]Training (film/smallcnn):   9%|▉         | 9/100 [00:47<07:52,  5.19s/it, train loss=0.0862, val ΔE00=4.923, best=4.747]Training (film/smallcnn):   9%|▉         | 9/100 [00:47<07:52,  5.19s/it, train loss=0.1049, val ΔE00=4.999, best=4.747]Training (film/smallcnn):  10%|█         | 10/100 [00:52<07:52,  5.25s/it, train loss=0.1049, val ΔE00=4.999, best=4.747]Training (film/smallcnn):  10%|█         | 10/100 [00:52<07:52,  5.25s/it, train loss=0.1336, val ΔE00=9.463, best=4.747]Training (film/smallcnn):  11%|█         | 11/100 [00:57<07:48,  5.26s/it, train loss=0.1336, val ΔE00=9.463, best=4.747]Training (film/smallcnn):  11%|█         | 11/100 [00:57<07:48,  5.26s/it, train loss=0.1601, val ΔE00=4.135, best=4.135]Training (film/smallcnn):  12%|█▏        | 12/100 [01:02<07:40,  5.23s/it, train loss=0.1601, val ΔE00=4.135, best=4.135]Training (film/smallcnn):  12%|█▏        | 12/100 [01:02<07:40,  5.23s/it, train loss=0.1647, val ΔE00=3.914, best=3.914]Training (film/smallcnn):  13%|█▎        | 13/100 [01:08<07:32,  5.21s/it, train loss=0.1647, val ΔE00=3.914, best=3.914]Training (film/smallcnn):  13%|█▎        | 13/100 [01:08<07:32,  5.21s/it, train loss=0.2103, val ΔE00=4.566, best=3.914]Training (film/smallcnn):  14%|█▍        | 14/100 [01:13<07:26,  5.19s/it, train loss=0.2103, val ΔE00=4.566, best=3.914]Training (film/smallcnn):  14%|█▍        | 14/100 [01:13<07:26,  5.19s/it, train loss=0.2433, val ΔE00=4.960, best=3.914]Training (film/smallcnn):  15%|█▌        | 15/100 [01:18<07:26,  5.25s/it, train loss=0.2433, val ΔE00=4.960, best=3.914]Training (film/smallcnn):  15%|█▌        | 15/100 [01:18<07:26,  5.25s/it, train loss=0.2524, val ΔE00=4.131, best=3.914]Training (film/smallcnn):  16%|█▌        | 16/100 [01:23<07:21,  5.26s/it, train loss=0.2524, val ΔE00=4.131, best=3.914]Training (film/smallcnn):  16%|█▌        | 16/100 [01:23<07:21,  5.26s/it, train loss=0.2706, val ΔE00=3.787, best=3.787]Training (film/smallcnn):  17%|█▋        | 17/100 [01:29<07:13,  5.23s/it, train loss=0.2706, val ΔE00=3.787, best=3.787]Training (film/smallcnn):  17%|█▋        | 17/100 [01:29<07:13,  5.23s/it, train loss=0.3206, val ΔE00=3.434, best=3.434]Training (film/smallcnn):  18%|█▊        | 18/100 [01:34<07:06,  5.20s/it, train loss=0.3206, val ΔE00=3.434, best=3.434]Training (film/smallcnn):  18%|█▊        | 18/100 [01:34<07:06,  5.20s/it, train loss=0.3415, val ΔE00=4.850, best=3.434]Training (film/smallcnn):  19%|█▉        | 19/100 [01:39<06:59,  5.18s/it, train loss=0.3415, val ΔE00=4.850, best=3.434]Training (film/smallcnn):  19%|█▉        | 19/100 [01:39<06:59,  5.18s/it, train loss=0.4149, val ΔE00=3.570, best=3.434]Training (film/smallcnn):  20%|██        | 20/100 [01:44<06:58,  5.23s/it, train loss=0.4149, val ΔE00=3.570, best=3.434]Training (film/smallcnn):  20%|██        | 20/100 [01:44<06:58,  5.23s/it, train loss=0.4616, val ΔE00=4.905, best=3.434]Training (film/smallcnn):  21%|██        | 21/100 [01:49<06:54,  5.25s/it, train loss=0.4616, val ΔE00=4.905, best=3.434]Training (film/smallcnn):  21%|██        | 21/100 [01:49<06:54,  5.25s/it, train loss=0.4605, val ΔE00=3.665, best=3.434]Training (film/smallcnn):  22%|██▏       | 22/100 [01:55<06:46,  5.21s/it, train loss=0.4605, val ΔE00=3.665, best=3.434]Training (film/smallcnn):  22%|██▏       | 22/100 [01:55<06:46,  5.21s/it, train loss=0.4902, val ΔE00=4.248, best=3.434]Training (film/smallcnn):  23%|██▎       | 23/100 [02:00<06:40,  5.20s/it, train loss=0.4902, val ΔE00=4.248, best=3.434]Training (film/smallcnn):  23%|██▎       | 23/100 [02:00<06:40,  5.20s/it, train loss=0.5454, val ΔE00=4.113, best=3.434]Training (film/smallcnn):  24%|██▍       | 24/100 [02:05<06:35,  5.21s/it, train loss=0.5454, val ΔE00=4.113, best=3.434]Training (film/smallcnn):  24%|██▍       | 24/100 [02:05<06:35,  5.21s/it, train loss=0.6240, val ΔE00=3.808, best=3.434]Training (film/smallcnn):  25%|██▌       | 25/100 [02:11<06:37,  5.29s/it, train loss=0.6240, val ΔE00=3.808, best=3.434]Training (film/smallcnn):  25%|██▌       | 25/100 [02:11<06:37,  5.29s/it, train loss=0.6349, val ΔE00=3.543, best=3.434]Training (film/smallcnn):  26%|██▌       | 26/100 [02:16<06:31,  5.29s/it, train loss=0.6349, val ΔE00=3.543, best=3.434]Training (film/smallcnn):  26%|██▌       | 26/100 [02:16<06:31,  5.29s/it, train loss=0.6898, val ΔE00=4.683, best=3.434]Training (film/smallcnn):  27%|██▋       | 27/100 [02:21<06:22,  5.24s/it, train loss=0.6898, val ΔE00=4.683, best=3.434]Training (film/smallcnn):  27%|██▋       | 27/100 [02:21<06:22,  5.24s/it, train loss=0.7403, val ΔE00=4.369, best=3.434]Training (film/smallcnn):  28%|██▊       | 28/100 [02:26<06:15,  5.22s/it, train loss=0.7403, val ΔE00=4.369, best=3.434]Training (film/smallcnn):  28%|██▊       | 28/100 [02:26<06:15,  5.22s/it, train loss=0.7593, val ΔE00=3.689, best=3.434]Training (film/smallcnn):  29%|██▉       | 29/100 [02:31<06:10,  5.21s/it, train loss=0.7593, val ΔE00=3.689, best=3.434]Training (film/smallcnn):  29%|██▉       | 29/100 [02:31<06:10,  5.21s/it, train loss=0.7759, val ΔE00=3.653, best=3.434]Training (film/smallcnn):  30%|███       | 30/100 [02:37<06:10,  5.30s/it, train loss=0.7759, val ΔE00=3.653, best=3.434]Training (film/smallcnn):  30%|███       | 30/100 [02:37<06:10,  5.30s/it, train loss=0.8009, val ΔE00=3.056, best=3.056]Training (film/smallcnn):  31%|███       | 31/100 [02:42<06:04,  5.28s/it, train loss=0.8009, val ΔE00=3.056, best=3.056]Training (film/smallcnn):  31%|███       | 31/100 [02:42<06:04,  5.28s/it, train loss=0.8991, val ΔE00=3.642, best=3.056]Training (film/smallcnn):  32%|███▏      | 32/100 [02:47<05:56,  5.24s/it, train loss=0.8991, val ΔE00=3.642, best=3.056]Training (film/smallcnn):  32%|███▏      | 32/100 [02:47<05:56,  5.24s/it, train loss=0.8588, val ΔE00=3.069, best=3.056]Training (film/smallcnn):  33%|███▎      | 33/100 [02:52<05:48,  5.20s/it, train loss=0.8588, val ΔE00=3.069, best=3.056]Training (film/smallcnn):  33%|███▎      | 33/100 [02:52<05:48,  5.20s/it, train loss=0.9820, val ΔE00=3.440, best=3.056]Training (film/smallcnn):  34%|███▍      | 34/100 [02:57<05:41,  5.18s/it, train loss=0.9820, val ΔE00=3.440, best=3.056]Training (film/smallcnn):  34%|███▍      | 34/100 [02:57<05:41,  5.18s/it, train loss=0.9703, val ΔE00=4.148, best=3.056]Training (film/smallcnn):  35%|███▌      | 35/100 [03:03<05:40,  5.23s/it, train loss=0.9703, val ΔE00=4.148, best=3.056]Training (film/smallcnn):  35%|███▌      | 35/100 [03:03<05:40,  5.23s/it, train loss=1.0289, val ΔE00=3.758, best=3.056]Training (film/smallcnn):  36%|███▌      | 36/100 [03:08<05:35,  5.24s/it, train loss=1.0289, val ΔE00=3.758, best=3.056]Training (film/smallcnn):  36%|███▌      | 36/100 [03:08<05:35,  5.24s/it, train loss=1.0292, val ΔE00=3.339, best=3.056]Training (film/smallcnn):  37%|███▋      | 37/100 [03:13<05:28,  5.21s/it, train loss=1.0292, val ΔE00=3.339, best=3.056]Training (film/smallcnn):  37%|███▋      | 37/100 [03:13<05:28,  5.21s/it, train loss=1.1798, val ΔE00=3.192, best=3.056]Training (film/smallcnn):  38%|███▊      | 38/100 [03:18<05:21,  5.18s/it, train loss=1.1798, val ΔE00=3.192, best=3.056]Training (film/smallcnn):  38%|███▊      | 38/100 [03:18<05:21,  5.18s/it, train loss=1.1346, val ΔE00=3.861, best=3.056]Training (film/smallcnn):  39%|███▉      | 39/100 [03:23<05:15,  5.17s/it, train loss=1.1346, val ΔE00=3.861, best=3.056]Training (film/smallcnn):  39%|███▉      | 39/100 [03:23<05:15,  5.17s/it, train loss=1.1850, val ΔE00=3.585, best=3.056]Training (film/smallcnn):  40%|████      | 40/100 [03:29<05:13,  5.22s/it, train loss=1.1850, val ΔE00=3.585, best=3.056]Training (film/smallcnn):  40%|████      | 40/100 [03:29<05:13,  5.22s/it, train loss=1.2665, val ΔE00=3.325, best=3.056]Training (film/smallcnn):  41%|████      | 41/100 [03:34<05:09,  5.24s/it, train loss=1.2665, val ΔE00=3.325, best=3.056]Training (film/smallcnn):  41%|████      | 41/100 [03:34<05:09,  5.24s/it, train loss=1.3425, val ΔE00=2.766, best=2.766]Training (film/smallcnn):  42%|████▏     | 42/100 [03:39<05:02,  5.21s/it, train loss=1.3425, val ΔE00=2.766, best=2.766]Training (film/smallcnn):  42%|████▏     | 42/100 [03:39<05:02,  5.21s/it, train loss=1.3396, val ΔE00=2.801, best=2.766]Training (film/smallcnn):  43%|████▎     | 43/100 [03:44<04:56,  5.20s/it, train loss=1.3396, val ΔE00=2.801, best=2.766]Training (film/smallcnn):  43%|████▎     | 43/100 [03:44<04:56,  5.20s/it, train loss=1.2886, val ΔE00=3.637, best=2.766]Training (film/smallcnn):  44%|████▍     | 44/100 [03:50<04:51,  5.20s/it, train loss=1.2886, val ΔE00=3.637, best=2.766]Training (film/smallcnn):  44%|████▍     | 44/100 [03:50<04:51,  5.20s/it, train loss=1.3312, val ΔE00=3.191, best=2.766]Training (film/smallcnn):  45%|████▌     | 45/100 [03:55<04:48,  5.25s/it, train loss=1.3312, val ΔE00=3.191, best=2.766]Training (film/smallcnn):  45%|████▌     | 45/100 [03:55<04:48,  5.25s/it, train loss=1.4238, val ΔE00=2.771, best=2.766]Training (film/smallcnn):  46%|████▌     | 46/100 [04:00<04:43,  5.25s/it, train loss=1.4238, val ΔE00=2.771, best=2.766]Training (film/smallcnn):  46%|████▌     | 46/100 [04:00<04:43,  5.25s/it, train loss=1.4344, val ΔE00=2.946, best=2.766]Training (film/smallcnn):  47%|████▋     | 47/100 [04:05<04:36,  5.21s/it, train loss=1.4344, val ΔE00=2.946, best=2.766]Training (film/smallcnn):  47%|████▋     | 47/100 [04:05<04:36,  5.21s/it, train loss=1.4258, val ΔE00=4.230, best=2.766]Training (film/smallcnn):  48%|████▊     | 48/100 [04:10<04:29,  5.19s/it, train loss=1.4258, val ΔE00=4.230, best=2.766]Training (film/smallcnn):  48%|████▊     | 48/100 [04:10<04:29,  5.19s/it, train loss=1.6174, val ΔE00=3.375, best=2.766]Training (film/smallcnn):  49%|████▉     | 49/100 [04:16<04:24,  5.19s/it, train loss=1.6174, val ΔE00=3.375, best=2.766]Training (film/smallcnn):  49%|████▉     | 49/100 [04:16<04:24,  5.19s/it, train loss=1.5241, val ΔE00=3.687, best=2.766]Training (film/smallcnn):  50%|█████     | 50/100 [04:21<04:23,  5.26s/it, train loss=1.5241, val ΔE00=3.687, best=2.766]Training (film/smallcnn):  50%|█████     | 50/100 [04:21<04:23,  5.26s/it, train loss=1.5536, val ΔE00=3.040, best=2.766]Training (film/smallcnn):  51%|█████     | 51/100 [04:26<04:18,  5.28s/it, train loss=1.5536, val ΔE00=3.040, best=2.766]Training (film/smallcnn):  51%|█████     | 51/100 [04:26<04:18,  5.28s/it, train loss=1.6575, val ΔE00=4.521, best=2.766]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:32<04:11,  5.25s/it, train loss=1.6575, val ΔE00=4.521, best=2.766]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:32<04:11,  5.25s/it, train loss=1.7998, val ΔE00=2.308, best=2.308]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:37<04:05,  5.22s/it, train loss=1.7998, val ΔE00=2.308, best=2.308]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:37<04:05,  5.22s/it, train loss=1.6847, val ΔE00=3.894, best=2.308]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:42<03:59,  5.20s/it, train loss=1.6847, val ΔE00=3.894, best=2.308]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:42<03:59,  5.20s/it, train loss=1.7388, val ΔE00=2.869, best=2.308]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:47<03:57,  5.27s/it, train loss=1.7388, val ΔE00=2.869, best=2.308]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:47<03:57,  5.27s/it, train loss=1.7073, val ΔE00=2.515, best=2.308]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:53<03:52,  5.29s/it, train loss=1.7073, val ΔE00=2.515, best=2.308]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:53<03:52,  5.29s/it, train loss=1.7141, val ΔE00=3.177, best=2.308]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:58<03:46,  5.26s/it, train loss=1.7141, val ΔE00=3.177, best=2.308]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:58<03:46,  5.26s/it, train loss=1.7301, val ΔE00=3.099, best=2.308]Training (film/smallcnn):  58%|█████▊    | 58/100 [05:03<03:39,  5.23s/it, train loss=1.7301, val ΔE00=3.099, best=2.308]Training (film/smallcnn):  58%|█████▊    | 58/100 [05:03<03:39,  5.23s/it, train loss=1.7113, val ΔE00=3.521, best=2.308]Training (film/smallcnn):  59%|█████▉    | 59/100 [05:08<03:33,  5.21s/it, train loss=1.7113, val ΔE00=3.521, best=2.308]Training (film/smallcnn):  59%|█████▉    | 59/100 [05:08<03:33,  5.21s/it, train loss=1.8774, val ΔE00=3.429, best=2.308]Training (film/smallcnn):  60%|██████    | 60/100 [05:14<03:31,  5.28s/it, train loss=1.8774, val ΔE00=3.429, best=2.308]Training (film/smallcnn):  60%|██████    | 60/100 [05:14<03:31,  5.28s/it, train loss=1.6608, val ΔE00=2.727, best=2.308]Training (film/smallcnn):  61%|██████    | 61/100 [05:19<03:26,  5.30s/it, train loss=1.6608, val ΔE00=2.727, best=2.308]Training (film/smallcnn):  61%|██████    | 61/100 [05:19<03:26,  5.30s/it, train loss=1.8319, val ΔE00=3.223, best=2.308]Training (film/smallcnn):  61%|██████    | 61/100 [05:24<03:26,  5.30s/it, train loss=1.8883, val ΔE00=2.816, early_stop=yes]Training (film/smallcnn):  61%|██████    | 61/100 [05:24<03:27,  5.32s/it, train loss=1.8883, val ΔE00=2.816, early_stop=yes]
[early] stop at epoch 62 (best de00=2.3076 @ 52)
[done] best ΔE00=2.308 over 62 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/film__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 7/12 ===
[sweep] id=007_model=film__backbone=resnet18__features=image+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone resnet18 --features image+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=film, backbone=resnet18, features=image+meta, meta_encoder=flair
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:06<10:23,  6.30s/it]Training (film/resnet18):   1%|          | 1/100 [00:06<10:23,  6.30s/it, train loss=0.0139, val ΔE00=7.618, best=7.618]Training (film/resnet18):   2%|▏         | 2/100 [00:12<09:50,  6.03s/it, train loss=0.0139, val ΔE00=7.618, best=7.618]Training (film/resnet18):   2%|▏         | 2/100 [00:12<09:50,  6.03s/it, train loss=0.0070, val ΔE00=7.675, best=7.618]Training (film/resnet18):   3%|▎         | 3/100 [00:18<09:41,  5.99s/it, train loss=0.0070, val ΔE00=7.675, best=7.618]Training (film/resnet18):   3%|▎         | 3/100 [00:18<09:41,  5.99s/it, train loss=0.0105, val ΔE00=5.474, best=5.474]Training (film/resnet18):   4%|▍         | 4/100 [00:23<09:30,  5.94s/it, train loss=0.0105, val ΔE00=5.474, best=5.474]Training (film/resnet18):   4%|▍         | 4/100 [00:23<09:30,  5.94s/it, train loss=0.0151, val ΔE00=3.714, best=3.714]Training (film/resnet18):   5%|▌         | 5/100 [00:29<09:25,  5.95s/it, train loss=0.0151, val ΔE00=3.714, best=3.714]Training (film/resnet18):   5%|▌         | 5/100 [00:29<09:25,  5.95s/it, train loss=0.0235, val ΔE00=5.482, best=3.714]Training (film/resnet18):   6%|▌         | 6/100 [00:35<09:17,  5.93s/it, train loss=0.0235, val ΔE00=5.482, best=3.714]Training (film/resnet18):   6%|▌         | 6/100 [00:35<09:17,  5.93s/it, train loss=0.0328, val ΔE00=3.058, best=3.058]Training (film/resnet18):   7%|▋         | 7/100 [00:41<09:07,  5.89s/it, train loss=0.0328, val ΔE00=3.058, best=3.058]Training (film/resnet18):   7%|▋         | 7/100 [00:41<09:07,  5.89s/it, train loss=0.0539, val ΔE00=5.796, best=3.058]Training (film/resnet18):   8%|▊         | 8/100 [00:47<09:00,  5.87s/it, train loss=0.0539, val ΔE00=5.796, best=3.058]Training (film/resnet18):   8%|▊         | 8/100 [00:47<09:00,  5.87s/it, train loss=0.0649, val ΔE00=3.988, best=3.058]Training (film/resnet18):   9%|▉         | 9/100 [00:53<08:53,  5.87s/it, train loss=0.0649, val ΔE00=3.988, best=3.058]Training (film/resnet18):   9%|▉         | 9/100 [00:53<08:53,  5.87s/it, train loss=0.0714, val ΔE00=2.723, best=2.723]Training (film/resnet18):  10%|█         | 10/100 [00:59<08:50,  5.89s/it, train loss=0.0714, val ΔE00=2.723, best=2.723]Training (film/resnet18):  10%|█         | 10/100 [00:59<08:50,  5.89s/it, train loss=0.0806, val ΔE00=3.232, best=2.723]Training (film/resnet18):  11%|█         | 11/100 [01:05<08:42,  5.87s/it, train loss=0.0806, val ΔE00=3.232, best=2.723]Training (film/resnet18):  11%|█         | 11/100 [01:05<08:42,  5.87s/it, train loss=0.1042, val ΔE00=3.716, best=2.723]Training (film/resnet18):  12%|█▏        | 12/100 [01:10<08:36,  5.86s/it, train loss=0.1042, val ΔE00=3.716, best=2.723]Training (film/resnet18):  12%|█▏        | 12/100 [01:10<08:36,  5.86s/it, train loss=0.1212, val ΔE00=3.227, best=2.723]Training (film/resnet18):  13%|█▎        | 13/100 [01:16<08:31,  5.87s/it, train loss=0.1212, val ΔE00=3.227, best=2.723]Training (film/resnet18):  13%|█▎        | 13/100 [01:16<08:31,  5.87s/it, train loss=0.1233, val ΔE00=2.555, best=2.555]Training (film/resnet18):  14%|█▍        | 14/100 [01:22<08:23,  5.85s/it, train loss=0.1233, val ΔE00=2.555, best=2.555]Training (film/resnet18):  14%|█▍        | 14/100 [01:22<08:23,  5.85s/it, train loss=0.1610, val ΔE00=3.305, best=2.555]Training (film/resnet18):  15%|█▌        | 15/100 [01:28<08:22,  5.91s/it, train loss=0.1610, val ΔE00=3.305, best=2.555]Training (film/resnet18):  15%|█▌        | 15/100 [01:28<08:22,  5.91s/it, train loss=0.1740, val ΔE00=3.112, best=2.555]Training (film/resnet18):  16%|█▌        | 16/100 [01:34<08:16,  5.91s/it, train loss=0.1740, val ΔE00=3.112, best=2.555]Training (film/resnet18):  16%|█▌        | 16/100 [01:34<08:16,  5.91s/it, train loss=0.2060, val ΔE00=2.483, best=2.483]Training (film/resnet18):  17%|█▋        | 17/100 [01:40<08:07,  5.87s/it, train loss=0.2060, val ΔE00=2.483, best=2.483]Training (film/resnet18):  17%|█▋        | 17/100 [01:40<08:07,  5.87s/it, train loss=0.2143, val ΔE00=3.556, best=2.483]Training (film/resnet18):  18%|█▊        | 18/100 [01:46<07:58,  5.83s/it, train loss=0.2143, val ΔE00=3.556, best=2.483]Training (film/resnet18):  18%|█▊        | 18/100 [01:46<07:58,  5.83s/it, train loss=0.2563, val ΔE00=2.802, best=2.483]Training (film/resnet18):  19%|█▉        | 19/100 [01:51<07:50,  5.81s/it, train loss=0.2563, val ΔE00=2.802, best=2.483]Training (film/resnet18):  19%|█▉        | 19/100 [01:51<07:50,  5.81s/it, train loss=0.2446, val ΔE00=2.498, best=2.483]Training (film/resnet18):  20%|██        | 20/100 [01:57<07:50,  5.88s/it, train loss=0.2446, val ΔE00=2.498, best=2.483]Training (film/resnet18):  20%|██        | 20/100 [01:57<07:50,  5.88s/it, train loss=0.2708, val ΔE00=2.417, best=2.417]Training (film/resnet18):  21%|██        | 21/100 [02:03<07:42,  5.86s/it, train loss=0.2708, val ΔE00=2.417, best=2.417]Training (film/resnet18):  21%|██        | 21/100 [02:03<07:42,  5.86s/it, train loss=0.2965, val ΔE00=2.785, best=2.417]Training (film/resnet18):  22%|██▏       | 22/100 [02:09<07:36,  5.85s/it, train loss=0.2965, val ΔE00=2.785, best=2.417]Training (film/resnet18):  22%|██▏       | 22/100 [02:09<07:36,  5.85s/it, train loss=0.3406, val ΔE00=2.836, best=2.417]Training (film/resnet18):  23%|██▎       | 23/100 [02:15<07:29,  5.84s/it, train loss=0.3406, val ΔE00=2.836, best=2.417]Training (film/resnet18):  23%|██▎       | 23/100 [02:15<07:29,  5.84s/it, train loss=0.3656, val ΔE00=2.531, best=2.417]Training (film/resnet18):  24%|██▍       | 24/100 [02:21<07:21,  5.81s/it, train loss=0.3656, val ΔE00=2.531, best=2.417]Training (film/resnet18):  24%|██▍       | 24/100 [02:21<07:21,  5.81s/it, train loss=0.3851, val ΔE00=2.658, best=2.417]Training (film/resnet18):  25%|██▌       | 25/100 [02:27<07:18,  5.85s/it, train loss=0.3851, val ΔE00=2.658, best=2.417]Training (film/resnet18):  25%|██▌       | 25/100 [02:27<07:18,  5.85s/it, train loss=0.3939, val ΔE00=2.478, best=2.417]Training (film/resnet18):  26%|██▌       | 26/100 [02:32<07:13,  5.86s/it, train loss=0.3939, val ΔE00=2.478, best=2.417]Training (film/resnet18):  26%|██▌       | 26/100 [02:32<07:13,  5.86s/it, train loss=0.4296, val ΔE00=2.276, best=2.276]Training (film/resnet18):  27%|██▋       | 27/100 [02:38<07:05,  5.83s/it, train loss=0.4296, val ΔE00=2.276, best=2.276]Training (film/resnet18):  27%|██▋       | 27/100 [02:38<07:05,  5.83s/it, train loss=0.4064, val ΔE00=2.588, best=2.276]Training (film/resnet18):  28%|██▊       | 28/100 [02:44<06:57,  5.80s/it, train loss=0.4064, val ΔE00=2.588, best=2.276]Training (film/resnet18):  28%|██▊       | 28/100 [02:44<06:57,  5.80s/it, train loss=0.4715, val ΔE00=2.808, best=2.276]Training (film/resnet18):  29%|██▉       | 29/100 [02:50<06:53,  5.82s/it, train loss=0.4715, val ΔE00=2.808, best=2.276]Training (film/resnet18):  29%|██▉       | 29/100 [02:50<06:53,  5.82s/it, train loss=0.5100, val ΔE00=2.889, best=2.276]Training (film/resnet18):  30%|███       | 30/100 [02:56<06:52,  5.89s/it, train loss=0.5100, val ΔE00=2.889, best=2.276]Training (film/resnet18):  30%|███       | 30/100 [02:56<06:52,  5.89s/it, train loss=0.4703, val ΔE00=2.170, best=2.170]Training (film/resnet18):  31%|███       | 31/100 [03:02<06:44,  5.86s/it, train loss=0.4703, val ΔE00=2.170, best=2.170]Training (film/resnet18):  31%|███       | 31/100 [03:02<06:44,  5.86s/it, train loss=0.5588, val ΔE00=2.392, best=2.170]Training (film/resnet18):  32%|███▏      | 32/100 [03:07<06:36,  5.83s/it, train loss=0.5588, val ΔE00=2.392, best=2.170]Training (film/resnet18):  32%|███▏      | 32/100 [03:07<06:36,  5.83s/it, train loss=0.5386, val ΔE00=2.576, best=2.170]Training (film/resnet18):  33%|███▎      | 33/100 [03:13<06:30,  5.82s/it, train loss=0.5386, val ΔE00=2.576, best=2.170]Training (film/resnet18):  33%|███▎      | 33/100 [03:13<06:30,  5.82s/it, train loss=0.6066, val ΔE00=3.021, best=2.170]Training (film/resnet18):  34%|███▍      | 34/100 [03:19<06:24,  5.83s/it, train loss=0.6066, val ΔE00=3.021, best=2.170]Training (film/resnet18):  34%|███▍      | 34/100 [03:19<06:24,  5.83s/it, train loss=0.5977, val ΔE00=2.681, best=2.170]Training (film/resnet18):  35%|███▌      | 35/100 [03:25<06:23,  5.90s/it, train loss=0.5977, val ΔE00=2.681, best=2.170]Training (film/resnet18):  35%|███▌      | 35/100 [03:25<06:23,  5.90s/it, train loss=0.6807, val ΔE00=2.657, best=2.170]Training (film/resnet18):  36%|███▌      | 36/100 [03:31<06:15,  5.86s/it, train loss=0.6807, val ΔE00=2.657, best=2.170]Training (film/resnet18):  36%|███▌      | 36/100 [03:31<06:15,  5.86s/it, train loss=0.6803, val ΔE00=2.985, best=2.170]Training (film/resnet18):  37%|███▋      | 37/100 [03:37<06:07,  5.83s/it, train loss=0.6803, val ΔE00=2.985, best=2.170]Training (film/resnet18):  37%|███▋      | 37/100 [03:37<06:07,  5.83s/it, train loss=0.6814, val ΔE00=2.278, best=2.170]Training (film/resnet18):  38%|███▊      | 38/100 [03:42<06:00,  5.81s/it, train loss=0.6814, val ΔE00=2.278, best=2.170]Training (film/resnet18):  38%|███▊      | 38/100 [03:42<06:00,  5.81s/it, train loss=0.6475, val ΔE00=2.221, best=2.170]Training (film/resnet18):  39%|███▉      | 39/100 [03:48<05:53,  5.79s/it, train loss=0.6475, val ΔE00=2.221, best=2.170]Training (film/resnet18):  39%|███▉      | 39/100 [03:48<05:53,  5.79s/it, train loss=0.6970, val ΔE00=2.265, best=2.170]Training (film/resnet18):  40%|████      | 40/100 [03:54<05:50,  5.84s/it, train loss=0.6970, val ΔE00=2.265, best=2.170]Training (film/resnet18):  40%|████      | 40/100 [03:54<05:50,  5.84s/it, train loss=0.7334, val ΔE00=2.636, best=2.170]Training (film/resnet18):  41%|████      | 41/100 [04:00<05:43,  5.82s/it, train loss=0.7334, val ΔE00=2.636, best=2.170]Training (film/resnet18):  41%|████      | 41/100 [04:00<05:43,  5.82s/it, train loss=0.7227, val ΔE00=2.255, best=2.170]Training (film/resnet18):  42%|████▏     | 42/100 [04:06<05:36,  5.81s/it, train loss=0.7227, val ΔE00=2.255, best=2.170]Training (film/resnet18):  42%|████▏     | 42/100 [04:06<05:36,  5.81s/it, train loss=0.7510, val ΔE00=2.439, best=2.170]Training (film/resnet18):  43%|████▎     | 43/100 [04:11<05:29,  5.79s/it, train loss=0.7510, val ΔE00=2.439, best=2.170]Training (film/resnet18):  43%|████▎     | 43/100 [04:11<05:29,  5.79s/it, train loss=0.7684, val ΔE00=2.240, best=2.170]Training (film/resnet18):  44%|████▍     | 44/100 [04:17<05:23,  5.78s/it, train loss=0.7684, val ΔE00=2.240, best=2.170]Training (film/resnet18):  44%|████▍     | 44/100 [04:17<05:23,  5.78s/it, train loss=0.8150, val ΔE00=2.220, best=2.170]Training (film/resnet18):  45%|████▌     | 45/100 [04:23<05:20,  5.83s/it, train loss=0.8150, val ΔE00=2.220, best=2.170]Training (film/resnet18):  45%|████▌     | 45/100 [04:23<05:20,  5.83s/it, train loss=0.8074, val ΔE00=2.501, best=2.170]Training (film/resnet18):  46%|████▌     | 46/100 [04:29<05:14,  5.82s/it, train loss=0.8074, val ΔE00=2.501, best=2.170]Training (film/resnet18):  46%|████▌     | 46/100 [04:29<05:14,  5.82s/it, train loss=0.9007, val ΔE00=2.270, best=2.170]Training (film/resnet18):  47%|████▋     | 47/100 [04:35<05:07,  5.81s/it, train loss=0.9007, val ΔE00=2.270, best=2.170]Training (film/resnet18):  47%|████▋     | 47/100 [04:35<05:07,  5.81s/it, train loss=0.8875, val ΔE00=2.219, best=2.170]Training (film/resnet18):  48%|████▊     | 48/100 [04:40<05:00,  5.79s/it, train loss=0.8875, val ΔE00=2.219, best=2.170]Training (film/resnet18):  48%|████▊     | 48/100 [04:40<05:00,  5.79s/it, train loss=0.8817, val ΔE00=2.205, best=2.170]Training (film/resnet18):  49%|████▉     | 49/100 [04:46<04:55,  5.79s/it, train loss=0.8817, val ΔE00=2.205, best=2.170]Training (film/resnet18):  49%|████▉     | 49/100 [04:46<04:55,  5.79s/it, train loss=0.8485, val ΔE00=2.168, best=2.168]Training (film/resnet18):  50%|█████     | 50/100 [04:52<04:52,  5.85s/it, train loss=0.8485, val ΔE00=2.168, best=2.168]Training (film/resnet18):  50%|█████     | 50/100 [04:52<04:52,  5.85s/it, train loss=1.0085, val ΔE00=2.839, best=2.168]Training (film/resnet18):  51%|█████     | 51/100 [04:58<04:45,  5.83s/it, train loss=1.0085, val ΔE00=2.839, best=2.168]Training (film/resnet18):  51%|█████     | 51/100 [04:58<04:45,  5.83s/it, train loss=0.9078, val ΔE00=2.241, best=2.168]Training (film/resnet18):  52%|█████▏    | 52/100 [05:04<04:40,  5.84s/it, train loss=0.9078, val ΔE00=2.241, best=2.168]Training (film/resnet18):  52%|█████▏    | 52/100 [05:04<04:40,  5.84s/it, train loss=0.9917, val ΔE00=2.554, best=2.168]Training (film/resnet18):  53%|█████▎    | 53/100 [05:10<04:33,  5.82s/it, train loss=0.9917, val ΔE00=2.554, best=2.168]Training (film/resnet18):  53%|█████▎    | 53/100 [05:10<04:33,  5.82s/it, train loss=1.0136, val ΔE00=2.406, best=2.168]Training (film/resnet18):  54%|█████▍    | 54/100 [05:15<04:26,  5.80s/it, train loss=1.0136, val ΔE00=2.406, best=2.168]Training (film/resnet18):  54%|█████▍    | 54/100 [05:15<04:26,  5.80s/it, train loss=0.9207, val ΔE00=2.268, best=2.168]Training (film/resnet18):  55%|█████▌    | 55/100 [05:22<04:28,  5.97s/it, train loss=0.9207, val ΔE00=2.268, best=2.168]Training (film/resnet18):  55%|█████▌    | 55/100 [05:22<04:28,  5.97s/it, train loss=1.0280, val ΔE00=2.087, best=2.087]Training (film/resnet18):  56%|█████▌    | 56/100 [05:28<04:20,  5.92s/it, train loss=1.0280, val ΔE00=2.087, best=2.087]Training (film/resnet18):  56%|█████▌    | 56/100 [05:28<04:20,  5.92s/it, train loss=0.8919, val ΔE00=2.677, best=2.087]Training (film/resnet18):  57%|█████▋    | 57/100 [05:33<04:12,  5.87s/it, train loss=0.8919, val ΔE00=2.677, best=2.087]Training (film/resnet18):  57%|█████▋    | 57/100 [05:33<04:12,  5.87s/it, train loss=0.9867, val ΔE00=2.322, best=2.087]Training (film/resnet18):  58%|█████▊    | 58/100 [05:39<04:05,  5.84s/it, train loss=0.9867, val ΔE00=2.322, best=2.087]Training (film/resnet18):  58%|█████▊    | 58/100 [05:39<04:05,  5.84s/it, train loss=1.0970, val ΔE00=2.100, best=2.087]Training (film/resnet18):  59%|█████▉    | 59/100 [05:45<03:58,  5.81s/it, train loss=1.0970, val ΔE00=2.100, best=2.087]Training (film/resnet18):  59%|█████▉    | 59/100 [05:45<03:58,  5.81s/it, train loss=0.9424, val ΔE00=2.215, best=2.087]Training (film/resnet18):  60%|██████    | 60/100 [05:51<03:54,  5.85s/it, train loss=0.9424, val ΔE00=2.215, best=2.087]Training (film/resnet18):  60%|██████    | 60/100 [05:51<03:54,  5.85s/it, train loss=0.9927, val ΔE00=2.194, best=2.087]Training (film/resnet18):  61%|██████    | 61/100 [05:57<03:47,  5.84s/it, train loss=0.9927, val ΔE00=2.194, best=2.087]Training (film/resnet18):  61%|██████    | 61/100 [05:57<03:47,  5.84s/it, train loss=0.9154, val ΔE00=2.310, best=2.087]Training (film/resnet18):  62%|██████▏   | 62/100 [06:02<03:40,  5.81s/it, train loss=0.9154, val ΔE00=2.310, best=2.087]Training (film/resnet18):  62%|██████▏   | 62/100 [06:02<03:40,  5.81s/it, train loss=0.9829, val ΔE00=2.405, best=2.087]Training (film/resnet18):  63%|██████▎   | 63/100 [06:08<03:34,  5.80s/it, train loss=0.9829, val ΔE00=2.405, best=2.087]Training (film/resnet18):  63%|██████▎   | 63/100 [06:08<03:34,  5.80s/it, train loss=1.1454, val ΔE00=2.502, best=2.087]Training (film/resnet18):  64%|██████▍   | 64/100 [06:14<03:28,  5.78s/it, train loss=1.1454, val ΔE00=2.502, best=2.087]Training (film/resnet18):  64%|██████▍   | 64/100 [06:14<03:28,  5.78s/it, train loss=0.9932, val ΔE00=2.195, best=2.087]Training (film/resnet18):  64%|██████▍   | 64/100 [06:20<03:28,  5.78s/it, train loss=1.0722, val ΔE00=2.482, early_stop=yes]Training (film/resnet18):  64%|██████▍   | 64/100 [06:20<03:33,  5.94s/it, train loss=1.0722, val ΔE00=2.482, early_stop=yes]
[early] stop at epoch 65 (best de00=2.0866 @ 55)
[done] best ΔE00=2.087 over 65 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/film__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 8/12 ===
[sweep] id=008_model=film__backbone=resnet18__features=image+mean+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone resnet18 --features image+mean+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=film, backbone=resnet18, features=image+mean+meta, meta_encoder=flair
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:06<10:16,  6.23s/it]Training (film/resnet18):   1%|          | 1/100 [00:06<10:16,  6.23s/it, train loss=0.0139, val ΔE00=7.618, best=7.618]Training (film/resnet18):   2%|▏         | 2/100 [00:12<09:47,  5.99s/it, train loss=0.0139, val ΔE00=7.618, best=7.618]Training (film/resnet18):   2%|▏         | 2/100 [00:12<09:47,  5.99s/it, train loss=0.0070, val ΔE00=7.675, best=7.618]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:37,  5.96s/it, train loss=0.0070, val ΔE00=7.675, best=7.618]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:37,  5.96s/it, train loss=0.0105, val ΔE00=5.474, best=5.474]Training (film/resnet18):   4%|▍         | 4/100 [00:23<09:25,  5.89s/it, train loss=0.0105, val ΔE00=5.474, best=5.474]Training (film/resnet18):   4%|▍         | 4/100 [00:23<09:25,  5.89s/it, train loss=0.0151, val ΔE00=3.714, best=3.714]Training (film/resnet18):   5%|▌         | 5/100 [00:29<09:23,  5.93s/it, train loss=0.0151, val ΔE00=3.714, best=3.714]Training (film/resnet18):   5%|▌         | 5/100 [00:29<09:23,  5.93s/it, train loss=0.0235, val ΔE00=5.482, best=3.714]Training (film/resnet18):   6%|▌         | 6/100 [00:35<09:16,  5.92s/it, train loss=0.0235, val ΔE00=5.482, best=3.714]Training (film/resnet18):   6%|▌         | 6/100 [00:35<09:16,  5.92s/it, train loss=0.0328, val ΔE00=3.058, best=3.058]Training (film/resnet18):   7%|▋         | 7/100 [00:41<09:07,  5.89s/it, train loss=0.0328, val ΔE00=3.058, best=3.058]Training (film/resnet18):   7%|▋         | 7/100 [00:41<09:07,  5.89s/it, train loss=0.0539, val ΔE00=5.796, best=3.058]Training (film/resnet18):   8%|▊         | 8/100 [00:47<08:58,  5.86s/it, train loss=0.0539, val ΔE00=5.796, best=3.058]Training (film/resnet18):   8%|▊         | 8/100 [00:47<08:58,  5.86s/it, train loss=0.0649, val ΔE00=3.988, best=3.058]Training (film/resnet18):   9%|▉         | 9/100 [00:53<08:53,  5.86s/it, train loss=0.0649, val ΔE00=3.988, best=3.058]Training (film/resnet18):   9%|▉         | 9/100 [00:53<08:53,  5.86s/it, train loss=0.0714, val ΔE00=2.723, best=2.723]Training (film/resnet18):  10%|█         | 10/100 [00:59<08:51,  5.90s/it, train loss=0.0714, val ΔE00=2.723, best=2.723]Training (film/resnet18):  10%|█         | 10/100 [00:59<08:51,  5.90s/it, train loss=0.0806, val ΔE00=3.232, best=2.723]Training (film/resnet18):  11%|█         | 11/100 [01:04<08:43,  5.89s/it, train loss=0.0806, val ΔE00=3.232, best=2.723]Training (film/resnet18):  11%|█         | 11/100 [01:04<08:43,  5.89s/it, train loss=0.1042, val ΔE00=3.716, best=2.723]Training (film/resnet18):  12%|█▏        | 12/100 [01:10<08:37,  5.88s/it, train loss=0.1042, val ΔE00=3.716, best=2.723]Training (film/resnet18):  12%|█▏        | 12/100 [01:10<08:37,  5.88s/it, train loss=0.1212, val ΔE00=3.227, best=2.723]Training (film/resnet18):  13%|█▎        | 13/100 [01:16<08:33,  5.90s/it, train loss=0.1212, val ΔE00=3.227, best=2.723]Training (film/resnet18):  13%|█▎        | 13/100 [01:16<08:33,  5.90s/it, train loss=0.1233, val ΔE00=2.555, best=2.555]Training (film/resnet18):  14%|█▍        | 14/100 [01:22<08:26,  5.89s/it, train loss=0.1233, val ΔE00=2.555, best=2.555]Training (film/resnet18):  14%|█▍        | 14/100 [01:22<08:26,  5.89s/it, train loss=0.1610, val ΔE00=3.305, best=2.555]Training (film/resnet18):  15%|█▌        | 15/100 [01:28<08:22,  5.92s/it, train loss=0.1610, val ΔE00=3.305, best=2.555]Training (film/resnet18):  15%|█▌        | 15/100 [01:28<08:22,  5.92s/it, train loss=0.1740, val ΔE00=3.112, best=2.555]Training (film/resnet18):  16%|█▌        | 16/100 [01:34<08:18,  5.94s/it, train loss=0.1740, val ΔE00=3.112, best=2.555]Training (film/resnet18):  16%|█▌        | 16/100 [01:34<08:18,  5.94s/it, train loss=0.2060, val ΔE00=2.483, best=2.483]Training (film/resnet18):  17%|█▋        | 17/100 [01:40<08:11,  5.92s/it, train loss=0.2060, val ΔE00=2.483, best=2.483]Training (film/resnet18):  17%|█▋        | 17/100 [01:40<08:11,  5.92s/it, train loss=0.2143, val ΔE00=3.556, best=2.483]Training (film/resnet18):  18%|█▊        | 18/100 [01:46<08:01,  5.88s/it, train loss=0.2143, val ΔE00=3.556, best=2.483]Training (film/resnet18):  18%|█▊        | 18/100 [01:46<08:01,  5.88s/it, train loss=0.2563, val ΔE00=2.802, best=2.483]Training (film/resnet18):  19%|█▉        | 19/100 [01:52<07:54,  5.85s/it, train loss=0.2563, val ΔE00=2.802, best=2.483]Training (film/resnet18):  19%|█▉        | 19/100 [01:52<07:54,  5.85s/it, train loss=0.2446, val ΔE00=2.498, best=2.483]Training (film/resnet18):  20%|██        | 20/100 [01:58<07:53,  5.92s/it, train loss=0.2446, val ΔE00=2.498, best=2.483]Training (film/resnet18):  20%|██        | 20/100 [01:58<07:53,  5.92s/it, train loss=0.2708, val ΔE00=2.417, best=2.417]Training (film/resnet18):  21%|██        | 21/100 [02:04<07:45,  5.90s/it, train loss=0.2708, val ΔE00=2.417, best=2.417]Training (film/resnet18):  21%|██        | 21/100 [02:04<07:45,  5.90s/it, train loss=0.2965, val ΔE00=2.785, best=2.417]Training (film/resnet18):  22%|██▏       | 22/100 [02:09<07:38,  5.88s/it, train loss=0.2965, val ΔE00=2.785, best=2.417]Training (film/resnet18):  22%|██▏       | 22/100 [02:09<07:38,  5.88s/it, train loss=0.3406, val ΔE00=2.836, best=2.417]Training (film/resnet18):  23%|██▎       | 23/100 [02:15<07:33,  5.89s/it, train loss=0.3406, val ΔE00=2.836, best=2.417]Training (film/resnet18):  23%|██▎       | 23/100 [02:15<07:33,  5.89s/it, train loss=0.3656, val ΔE00=2.531, best=2.417]Training (film/resnet18):  24%|██▍       | 24/100 [02:21<07:25,  5.87s/it, train loss=0.3656, val ΔE00=2.531, best=2.417]Training (film/resnet18):  24%|██▍       | 24/100 [02:21<07:25,  5.87s/it, train loss=0.3851, val ΔE00=2.658, best=2.417]Training (film/resnet18):  25%|██▌       | 25/100 [02:27<07:22,  5.90s/it, train loss=0.3851, val ΔE00=2.658, best=2.417]Training (film/resnet18):  25%|██▌       | 25/100 [02:27<07:22,  5.90s/it, train loss=0.3939, val ΔE00=2.478, best=2.417]Training (film/resnet18):  26%|██▌       | 26/100 [02:33<07:16,  5.90s/it, train loss=0.3939, val ΔE00=2.478, best=2.417]Training (film/resnet18):  26%|██▌       | 26/100 [02:33<07:16,  5.90s/it, train loss=0.4296, val ΔE00=2.276, best=2.276]Training (film/resnet18):  27%|██▋       | 27/100 [02:39<07:09,  5.88s/it, train loss=0.4296, val ΔE00=2.276, best=2.276]Training (film/resnet18):  27%|██▋       | 27/100 [02:39<07:09,  5.88s/it, train loss=0.4064, val ΔE00=2.588, best=2.276]Training (film/resnet18):  28%|██▊       | 28/100 [02:45<07:03,  5.88s/it, train loss=0.4064, val ΔE00=2.588, best=2.276]Training (film/resnet18):  28%|██▊       | 28/100 [02:45<07:03,  5.88s/it, train loss=0.4715, val ΔE00=2.808, best=2.276]Training (film/resnet18):  29%|██▉       | 29/100 [02:50<06:56,  5.86s/it, train loss=0.4715, val ΔE00=2.808, best=2.276]Training (film/resnet18):  29%|██▉       | 29/100 [02:50<06:56,  5.86s/it, train loss=0.5100, val ΔE00=2.889, best=2.276]Training (film/resnet18):  30%|███       | 30/100 [02:57<06:55,  5.94s/it, train loss=0.5100, val ΔE00=2.889, best=2.276]Training (film/resnet18):  30%|███       | 30/100 [02:57<06:55,  5.94s/it, train loss=0.4703, val ΔE00=2.170, best=2.170]Training (film/resnet18):  31%|███       | 31/100 [03:02<06:48,  5.92s/it, train loss=0.4703, val ΔE00=2.170, best=2.170]Training (film/resnet18):  31%|███       | 31/100 [03:02<06:48,  5.92s/it, train loss=0.5588, val ΔE00=2.392, best=2.170]Training (film/resnet18):  32%|███▏      | 32/100 [03:08<06:40,  5.89s/it, train loss=0.5588, val ΔE00=2.392, best=2.170]Training (film/resnet18):  32%|███▏      | 32/100 [03:08<06:40,  5.89s/it, train loss=0.5386, val ΔE00=2.576, best=2.170]Training (film/resnet18):  33%|███▎      | 33/100 [03:14<06:35,  5.90s/it, train loss=0.5386, val ΔE00=2.576, best=2.170]Training (film/resnet18):  33%|███▎      | 33/100 [03:14<06:35,  5.90s/it, train loss=0.6066, val ΔE00=3.021, best=2.170]Training (film/resnet18):  34%|███▍      | 34/100 [03:20<06:30,  5.91s/it, train loss=0.6066, val ΔE00=3.021, best=2.170]Training (film/resnet18):  34%|███▍      | 34/100 [03:20<06:30,  5.91s/it, train loss=0.5977, val ΔE00=2.681, best=2.170]Training (film/resnet18):  35%|███▌      | 35/100 [03:26<06:27,  5.97s/it, train loss=0.5977, val ΔE00=2.681, best=2.170]Training (film/resnet18):  35%|███▌      | 35/100 [03:26<06:27,  5.97s/it, train loss=0.6807, val ΔE00=2.657, best=2.170]Training (film/resnet18):  36%|███▌      | 36/100 [03:32<06:20,  5.94s/it, train loss=0.6807, val ΔE00=2.657, best=2.170]Training (film/resnet18):  36%|███▌      | 36/100 [03:32<06:20,  5.94s/it, train loss=0.6803, val ΔE00=2.985, best=2.170]Training (film/resnet18):  37%|███▋      | 37/100 [03:38<06:11,  5.90s/it, train loss=0.6803, val ΔE00=2.985, best=2.170]Training (film/resnet18):  37%|███▋      | 37/100 [03:38<06:11,  5.90s/it, train loss=0.6814, val ΔE00=2.278, best=2.170]Training (film/resnet18):  38%|███▊      | 38/100 [03:44<06:04,  5.89s/it, train loss=0.6814, val ΔE00=2.278, best=2.170]Training (film/resnet18):  38%|███▊      | 38/100 [03:44<06:04,  5.89s/it, train loss=0.6475, val ΔE00=2.221, best=2.170]Training (film/resnet18):  39%|███▉      | 39/100 [03:50<05:58,  5.88s/it, train loss=0.6475, val ΔE00=2.221, best=2.170]Training (film/resnet18):  39%|███▉      | 39/100 [03:50<05:58,  5.88s/it, train loss=0.6970, val ΔE00=2.265, best=2.170]Training (film/resnet18):  40%|████      | 40/100 [03:56<05:56,  5.93s/it, train loss=0.6970, val ΔE00=2.265, best=2.170]Training (film/resnet18):  40%|████      | 40/100 [03:56<05:56,  5.93s/it, train loss=0.7334, val ΔE00=2.636, best=2.170]Training (film/resnet18):  41%|████      | 41/100 [04:02<05:48,  5.91s/it, train loss=0.7334, val ΔE00=2.636, best=2.170]Training (film/resnet18):  41%|████      | 41/100 [04:02<05:48,  5.91s/it, train loss=0.7227, val ΔE00=2.255, best=2.170]Training (film/resnet18):  42%|████▏     | 42/100 [04:07<05:40,  5.88s/it, train loss=0.7227, val ΔE00=2.255, best=2.170]Training (film/resnet18):  42%|████▏     | 42/100 [04:07<05:40,  5.88s/it, train loss=0.7510, val ΔE00=2.439, best=2.170]Training (film/resnet18):  43%|████▎     | 43/100 [04:13<05:33,  5.86s/it, train loss=0.7510, val ΔE00=2.439, best=2.170]Training (film/resnet18):  43%|████▎     | 43/100 [04:13<05:33,  5.86s/it, train loss=0.7684, val ΔE00=2.240, best=2.170]Training (film/resnet18):  44%|████▍     | 44/100 [04:19<05:26,  5.83s/it, train loss=0.7684, val ΔE00=2.240, best=2.170]Training (film/resnet18):  44%|████▍     | 44/100 [04:19<05:26,  5.83s/it, train loss=0.8150, val ΔE00=2.220, best=2.170]Training (film/resnet18):  45%|████▌     | 45/100 [04:25<05:23,  5.88s/it, train loss=0.8150, val ΔE00=2.220, best=2.170]Training (film/resnet18):  45%|████▌     | 45/100 [04:25<05:23,  5.88s/it, train loss=0.8074, val ΔE00=2.501, best=2.170]Training (film/resnet18):  46%|████▌     | 46/100 [04:31<05:16,  5.86s/it, train loss=0.8074, val ΔE00=2.501, best=2.170]Training (film/resnet18):  46%|████▌     | 46/100 [04:31<05:16,  5.86s/it, train loss=0.9007, val ΔE00=2.270, best=2.170]Training (film/resnet18):  47%|████▋     | 47/100 [04:37<05:09,  5.84s/it, train loss=0.9007, val ΔE00=2.270, best=2.170]Training (film/resnet18):  47%|████▋     | 47/100 [04:37<05:09,  5.84s/it, train loss=0.8875, val ΔE00=2.219, best=2.170]Training (film/resnet18):  48%|████▊     | 48/100 [04:42<05:04,  5.85s/it, train loss=0.8875, val ΔE00=2.219, best=2.170]Training (film/resnet18):  48%|████▊     | 48/100 [04:42<05:04,  5.85s/it, train loss=0.8817, val ΔE00=2.205, best=2.170]Training (film/resnet18):  49%|████▉     | 49/100 [04:48<04:58,  5.85s/it, train loss=0.8817, val ΔE00=2.205, best=2.170]Training (film/resnet18):  49%|████▉     | 49/100 [04:48<04:58,  5.85s/it, train loss=0.8485, val ΔE00=2.168, best=2.168]Training (film/resnet18):  50%|█████     | 50/100 [04:54<04:54,  5.89s/it, train loss=0.8485, val ΔE00=2.168, best=2.168]Training (film/resnet18):  50%|█████     | 50/100 [04:54<04:54,  5.89s/it, train loss=1.0085, val ΔE00=2.839, best=2.168]Training (film/resnet18):  51%|█████     | 51/100 [05:00<04:47,  5.87s/it, train loss=1.0085, val ΔE00=2.839, best=2.168]Training (film/resnet18):  51%|█████     | 51/100 [05:00<04:47,  5.87s/it, train loss=0.9078, val ΔE00=2.241, best=2.168]Training (film/resnet18):  52%|█████▏    | 52/100 [05:06<04:40,  5.84s/it, train loss=0.9078, val ΔE00=2.241, best=2.168]Training (film/resnet18):  52%|█████▏    | 52/100 [05:06<04:40,  5.84s/it, train loss=0.9917, val ΔE00=2.554, best=2.168]Training (film/resnet18):  53%|█████▎    | 53/100 [05:12<04:33,  5.83s/it, train loss=0.9917, val ΔE00=2.554, best=2.168]Training (film/resnet18):  53%|█████▎    | 53/100 [05:12<04:33,  5.83s/it, train loss=1.0136, val ΔE00=2.406, best=2.168]Training (film/resnet18):  54%|█████▍    | 54/100 [05:18<04:28,  5.84s/it, train loss=1.0136, val ΔE00=2.406, best=2.168]Training (film/resnet18):  54%|█████▍    | 54/100 [05:18<04:28,  5.84s/it, train loss=0.9207, val ΔE00=2.268, best=2.168]Training (film/resnet18):  55%|█████▌    | 55/100 [05:24<04:27,  5.94s/it, train loss=0.9207, val ΔE00=2.268, best=2.168]Training (film/resnet18):  55%|█████▌    | 55/100 [05:24<04:27,  5.94s/it, train loss=1.0280, val ΔE00=2.087, best=2.087]Training (film/resnet18):  56%|█████▌    | 56/100 [05:30<04:21,  5.93s/it, train loss=1.0280, val ΔE00=2.087, best=2.087]Training (film/resnet18):  56%|█████▌    | 56/100 [05:30<04:21,  5.93s/it, train loss=0.8919, val ΔE00=2.677, best=2.087]Training (film/resnet18):  57%|█████▋    | 57/100 [05:35<04:13,  5.90s/it, train loss=0.8919, val ΔE00=2.677, best=2.087]Training (film/resnet18):  57%|█████▋    | 57/100 [05:35<04:13,  5.90s/it, train loss=0.9867, val ΔE00=2.322, best=2.087]Training (film/resnet18):  58%|█████▊    | 58/100 [05:41<04:06,  5.87s/it, train loss=0.9867, val ΔE00=2.322, best=2.087]Training (film/resnet18):  58%|█████▊    | 58/100 [05:41<04:06,  5.87s/it, train loss=1.0970, val ΔE00=2.100, best=2.087]Training (film/resnet18):  59%|█████▉    | 59/100 [05:47<04:00,  5.87s/it, train loss=1.0970, val ΔE00=2.100, best=2.087]Training (film/resnet18):  59%|█████▉    | 59/100 [05:47<04:00,  5.87s/it, train loss=0.9424, val ΔE00=2.215, best=2.087]Training (film/resnet18):  60%|██████    | 60/100 [05:53<03:57,  5.93s/it, train loss=0.9424, val ΔE00=2.215, best=2.087]Training (film/resnet18):  60%|██████    | 60/100 [05:53<03:57,  5.93s/it, train loss=0.9927, val ΔE00=2.194, best=2.087]Training (film/resnet18):  61%|██████    | 61/100 [05:59<03:50,  5.92s/it, train loss=0.9927, val ΔE00=2.194, best=2.087]Training (film/resnet18):  61%|██████    | 61/100 [05:59<03:50,  5.92s/it, train loss=0.9154, val ΔE00=2.310, best=2.087]Training (film/resnet18):  62%|██████▏   | 62/100 [06:05<03:43,  5.88s/it, train loss=0.9154, val ΔE00=2.310, best=2.087]Training (film/resnet18):  62%|██████▏   | 62/100 [06:05<03:43,  5.88s/it, train loss=0.9829, val ΔE00=2.405, best=2.087]Training (film/resnet18):  63%|██████▎   | 63/100 [06:11<03:36,  5.86s/it, train loss=0.9829, val ΔE00=2.405, best=2.087]Training (film/resnet18):  63%|██████▎   | 63/100 [06:11<03:36,  5.86s/it, train loss=1.1454, val ΔE00=2.502, best=2.087]Training (film/resnet18):  64%|██████▍   | 64/100 [06:16<03:30,  5.84s/it, train loss=1.1454, val ΔE00=2.502, best=2.087]Training (film/resnet18):  64%|██████▍   | 64/100 [06:16<03:30,  5.84s/it, train loss=0.9932, val ΔE00=2.195, best=2.087]Training (film/resnet18):  64%|██████▍   | 64/100 [06:22<03:30,  5.84s/it, train loss=1.0722, val ΔE00=2.482, early_stop=yes]Training (film/resnet18):  64%|██████▍   | 64/100 [06:22<03:35,  5.98s/it, train loss=1.0722, val ΔE00=2.482, early_stop=yes]
[early] stop at epoch 65 (best de00=2.0866 @ 55)
[done] best ΔE00=2.087 over 65 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/film__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+mean+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 9/12 ===
[sweep] id=009_model=xattn__backbone=smallcnn__features=image+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone smallcnn --features image+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=xattn, backbone=smallcnn, features=image+meta, meta_encoder=flair
[run] model=xattn backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:14,  5.60s/it]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:14,  5.60s/it, train loss=0.0109, val ΔE00=8.861, best=8.861]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:44,  5.35s/it, train loss=0.0109, val ΔE00=8.861, best=8.861]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:44,  5.35s/it, train loss=0.0089, val ΔE00=5.727, best=5.727]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:31,  5.28s/it, train loss=0.0089, val ΔE00=5.727, best=5.727]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:31,  5.28s/it, train loss=0.0139, val ΔE00=6.058, best=5.727]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:21<08:23,  5.24s/it, train loss=0.0139, val ΔE00=6.058, best=5.727]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:21<08:23,  5.24s/it, train loss=0.0224, val ΔE00=5.042, best=5.042]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:26<08:25,  5.32s/it, train loss=0.0224, val ΔE00=5.042, best=5.042]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:26<08:25,  5.32s/it, train loss=0.0353, val ΔE00=6.623, best=5.042]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:31<08:19,  5.31s/it, train loss=0.0353, val ΔE00=6.623, best=5.042]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:31<08:19,  5.31s/it, train loss=0.0465, val ΔE00=4.605, best=4.605]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:37<08:11,  5.29s/it, train loss=0.0465, val ΔE00=4.605, best=4.605]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:37<08:11,  5.29s/it, train loss=0.0610, val ΔE00=5.655, best=4.605]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:42<08:03,  5.26s/it, train loss=0.0610, val ΔE00=5.655, best=4.605]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:42<08:03,  5.26s/it, train loss=0.0750, val ΔE00=4.307, best=4.307]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:47<07:58,  5.26s/it, train loss=0.0750, val ΔE00=4.307, best=4.307]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:47<07:58,  5.26s/it, train loss=0.0889, val ΔE00=3.374, best=3.374]Training (xattn/smallcnn):  10%|█         | 10/100 [00:53<07:58,  5.31s/it, train loss=0.0889, val ΔE00=3.374, best=3.374]Training (xattn/smallcnn):  10%|█         | 10/100 [00:53<07:58,  5.31s/it, train loss=0.1104, val ΔE00=4.019, best=3.374]Training (xattn/smallcnn):  11%|█         | 11/100 [00:58<07:52,  5.31s/it, train loss=0.1104, val ΔE00=4.019, best=3.374]Training (xattn/smallcnn):  11%|█         | 11/100 [00:58<07:52,  5.31s/it, train loss=0.1199, val ΔE00=3.177, best=3.177]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:03<07:43,  5.27s/it, train loss=0.1199, val ΔE00=3.177, best=3.177]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:03<07:43,  5.27s/it, train loss=0.1413, val ΔE00=3.679, best=3.177]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:08<07:36,  5.24s/it, train loss=0.1413, val ΔE00=3.679, best=3.177]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:08<07:36,  5.24s/it, train loss=0.1690, val ΔE00=3.606, best=3.177]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:13<07:30,  5.24s/it, train loss=0.1690, val ΔE00=3.606, best=3.177]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:13<07:30,  5.24s/it, train loss=0.1943, val ΔE00=3.454, best=3.177]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:19<07:32,  5.32s/it, train loss=0.1943, val ΔE00=3.454, best=3.177]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:19<07:32,  5.32s/it, train loss=0.2179, val ΔE00=4.005, best=3.177]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:24<07:27,  5.32s/it, train loss=0.2179, val ΔE00=4.005, best=3.177]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:24<07:27,  5.32s/it, train loss=0.2264, val ΔE00=3.792, best=3.177]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:29<07:17,  5.28s/it, train loss=0.2264, val ΔE00=3.792, best=3.177]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:29<07:17,  5.28s/it, train loss=0.2652, val ΔE00=3.382, best=3.177]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:35<07:10,  5.25s/it, train loss=0.2652, val ΔE00=3.382, best=3.177]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:35<07:10,  5.25s/it, train loss=0.2897, val ΔE00=3.014, best=3.014]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:40<07:02,  5.22s/it, train loss=0.2897, val ΔE00=3.014, best=3.014]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:40<07:02,  5.22s/it, train loss=0.3508, val ΔE00=3.030, best=3.014]Training (xattn/smallcnn):  20%|██        | 20/100 [01:45<07:02,  5.28s/it, train loss=0.3508, val ΔE00=3.030, best=3.014]Training (xattn/smallcnn):  20%|██        | 20/100 [01:45<07:02,  5.28s/it, train loss=0.3427, val ΔE00=3.205, best=3.014]Training (xattn/smallcnn):  21%|██        | 21/100 [01:50<06:57,  5.28s/it, train loss=0.3427, val ΔE00=3.205, best=3.014]Training (xattn/smallcnn):  21%|██        | 21/100 [01:50<06:57,  5.28s/it, train loss=0.3703, val ΔE00=3.412, best=3.014]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:56<06:49,  5.25s/it, train loss=0.3703, val ΔE00=3.412, best=3.014]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:56<06:49,  5.25s/it, train loss=0.3957, val ΔE00=3.119, best=3.014]Training (xattn/smallcnn):  23%|██▎       | 23/100 [02:01<06:44,  5.25s/it, train loss=0.3957, val ΔE00=3.119, best=3.014]Training (xattn/smallcnn):  23%|██▎       | 23/100 [02:01<06:44,  5.25s/it, train loss=0.4333, val ΔE00=2.798, best=2.798]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:06<06:39,  5.26s/it, train loss=0.4333, val ΔE00=2.798, best=2.798]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:06<06:39,  5.26s/it, train loss=0.4351, val ΔE00=3.078, best=2.798]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:12<06:38,  5.31s/it, train loss=0.4351, val ΔE00=3.078, best=2.798]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:12<06:38,  5.31s/it, train loss=0.4792, val ΔE00=3.016, best=2.798]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:17<06:35,  5.34s/it, train loss=0.4792, val ΔE00=3.016, best=2.798]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:17<06:35,  5.34s/it, train loss=0.5012, val ΔE00=2.597, best=2.597]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:22<06:28,  5.32s/it, train loss=0.5012, val ΔE00=2.597, best=2.597]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:22<06:28,  5.32s/it, train loss=0.5318, val ΔE00=2.955, best=2.597]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:28<06:20,  5.29s/it, train loss=0.5318, val ΔE00=2.955, best=2.597]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:28<06:20,  5.29s/it, train loss=0.5683, val ΔE00=2.953, best=2.597]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:33<06:13,  5.26s/it, train loss=0.5683, val ΔE00=2.953, best=2.597]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:33<06:13,  5.26s/it, train loss=0.5940, val ΔE00=3.617, best=2.597]Training (xattn/smallcnn):  30%|███       | 30/100 [02:38<06:12,  5.32s/it, train loss=0.5940, val ΔE00=3.617, best=2.597]Training (xattn/smallcnn):  30%|███       | 30/100 [02:38<06:12,  5.32s/it, train loss=0.6648, val ΔE00=2.534, best=2.534]Training (xattn/smallcnn):  31%|███       | 31/100 [02:43<06:06,  5.32s/it, train loss=0.6648, val ΔE00=2.534, best=2.534]Training (xattn/smallcnn):  31%|███       | 31/100 [02:43<06:06,  5.32s/it, train loss=0.7012, val ΔE00=4.808, best=2.534]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:49<05:59,  5.28s/it, train loss=0.7012, val ΔE00=4.808, best=2.534]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:49<05:59,  5.28s/it, train loss=0.7818, val ΔE00=2.668, best=2.534]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:54<05:51,  5.25s/it, train loss=0.7818, val ΔE00=2.668, best=2.534]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:54<05:51,  5.25s/it, train loss=0.7377, val ΔE00=2.993, best=2.534]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:59<05:45,  5.23s/it, train loss=0.7377, val ΔE00=2.993, best=2.534]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:59<05:45,  5.23s/it, train loss=0.7298, val ΔE00=2.499, best=2.499]Training (xattn/smallcnn):  35%|███▌      | 35/100 [03:04<05:43,  5.29s/it, train loss=0.7298, val ΔE00=2.499, best=2.499]Training (xattn/smallcnn):  35%|███▌      | 35/100 [03:04<05:43,  5.29s/it, train loss=0.7464, val ΔE00=2.686, best=2.499]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:10<05:38,  5.29s/it, train loss=0.7464, val ΔE00=2.686, best=2.499]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:10<05:38,  5.29s/it, train loss=0.7856, val ΔE00=2.963, best=2.499]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:15<05:31,  5.26s/it, train loss=0.7856, val ΔE00=2.963, best=2.499]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:15<05:31,  5.26s/it, train loss=0.8253, val ΔE00=2.873, best=2.499]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:20<05:23,  5.23s/it, train loss=0.8253, val ΔE00=2.873, best=2.499]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:20<05:23,  5.23s/it, train loss=0.8516, val ΔE00=3.019, best=2.499]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:25<05:19,  5.24s/it, train loss=0.8516, val ΔE00=3.019, best=2.499]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:25<05:19,  5.24s/it, train loss=0.9040, val ΔE00=2.961, best=2.499]Training (xattn/smallcnn):  40%|████      | 40/100 [03:31<05:19,  5.32s/it, train loss=0.9040, val ΔE00=2.961, best=2.499]Training (xattn/smallcnn):  40%|████      | 40/100 [03:31<05:19,  5.32s/it, train loss=0.9199, val ΔE00=2.639, best=2.499]Training (xattn/smallcnn):  41%|████      | 41/100 [03:36<05:14,  5.33s/it, train loss=0.9199, val ΔE00=2.639, best=2.499]Training (xattn/smallcnn):  41%|████      | 41/100 [03:36<05:14,  5.33s/it, train loss=0.9716, val ΔE00=2.421, best=2.421]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:41<05:06,  5.28s/it, train loss=0.9716, val ΔE00=2.421, best=2.421]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:41<05:06,  5.28s/it, train loss=0.9499, val ΔE00=2.758, best=2.421]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:47<04:59,  5.25s/it, train loss=0.9499, val ΔE00=2.758, best=2.421]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:47<04:59,  5.25s/it, train loss=0.9977, val ΔE00=2.664, best=2.421]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:52<04:52,  5.23s/it, train loss=0.9977, val ΔE00=2.664, best=2.421]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:52<04:52,  5.23s/it, train loss=0.9790, val ΔE00=2.544, best=2.421]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:57<04:50,  5.29s/it, train loss=0.9790, val ΔE00=2.544, best=2.421]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:57<04:50,  5.29s/it, train loss=1.0520, val ΔE00=2.752, best=2.421]Training (xattn/smallcnn):  46%|████▌     | 46/100 [04:03<04:47,  5.32s/it, train loss=1.0520, val ΔE00=2.752, best=2.421]Training (xattn/smallcnn):  46%|████▌     | 46/100 [04:03<04:47,  5.32s/it, train loss=1.0661, val ΔE00=2.712, best=2.421]Training (xattn/smallcnn):  47%|████▋     | 47/100 [04:08<04:41,  5.31s/it, train loss=1.0661, val ΔE00=2.712, best=2.421]Training (xattn/smallcnn):  47%|████▋     | 47/100 [04:08<04:41,  5.31s/it, train loss=1.0761, val ΔE00=2.682, best=2.421]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:13<04:34,  5.27s/it, train loss=1.0761, val ΔE00=2.682, best=2.421]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:13<04:34,  5.27s/it, train loss=1.1736, val ΔE00=2.578, best=2.421]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:18<04:27,  5.25s/it, train loss=1.1736, val ΔE00=2.578, best=2.421]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:18<04:27,  5.25s/it, train loss=1.1870, val ΔE00=2.589, best=2.421]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:24<04:25,  5.30s/it, train loss=1.1870, val ΔE00=2.589, best=2.421]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:24<04:25,  5.30s/it, train loss=1.1777, val ΔE00=2.511, best=2.421]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:29<04:19,  5.30s/it, train loss=1.1777, val ΔE00=2.511, best=2.421]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:29<04:19,  5.30s/it, train loss=1.1794, val ΔE00=2.428, best=2.421]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:34<04:12,  5.27s/it, train loss=1.1794, val ΔE00=2.428, best=2.421]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:34<04:12,  5.27s/it, train loss=1.1719, val ΔE00=3.087, best=2.421]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:39<04:06,  5.25s/it, train loss=1.1719, val ΔE00=3.087, best=2.421]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:39<04:06,  5.25s/it, train loss=1.2073, val ΔE00=2.368, best=2.368]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:45<04:01,  5.24s/it, train loss=1.2073, val ΔE00=2.368, best=2.368]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:45<04:01,  5.24s/it, train loss=1.1718, val ΔE00=2.706, best=2.368]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:50<03:58,  5.31s/it, train loss=1.1718, val ΔE00=2.706, best=2.368]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:50<03:58,  5.31s/it, train loss=1.2131, val ΔE00=2.814, best=2.368]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:55<03:53,  5.31s/it, train loss=1.2131, val ΔE00=2.814, best=2.368]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:55<03:53,  5.31s/it, train loss=1.2377, val ΔE00=2.474, best=2.368]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [05:01<03:46,  5.27s/it, train loss=1.2377, val ΔE00=2.474, best=2.368]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [05:01<03:46,  5.27s/it, train loss=1.3184, val ΔE00=2.523, best=2.368]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [05:06<03:41,  5.27s/it, train loss=1.3184, val ΔE00=2.523, best=2.368]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [05:06<03:41,  5.27s/it, train loss=1.3220, val ΔE00=2.882, best=2.368]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:11<03:35,  5.27s/it, train loss=1.3220, val ΔE00=2.882, best=2.368]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:11<03:35,  5.27s/it, train loss=1.3468, val ΔE00=2.339, best=2.339]Training (xattn/smallcnn):  60%|██████    | 60/100 [05:16<03:32,  5.30s/it, train loss=1.3468, val ΔE00=2.339, best=2.339]Training (xattn/smallcnn):  60%|██████    | 60/100 [05:16<03:32,  5.30s/it, train loss=1.3224, val ΔE00=2.459, best=2.339]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:22<03:27,  5.31s/it, train loss=1.3224, val ΔE00=2.459, best=2.339]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:22<03:27,  5.31s/it, train loss=1.3352, val ΔE00=2.931, best=2.339]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:27<03:21,  5.30s/it, train loss=1.3352, val ΔE00=2.931, best=2.339]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:27<03:21,  5.30s/it, train loss=1.2934, val ΔE00=2.659, best=2.339]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:32<03:15,  5.27s/it, train loss=1.2934, val ΔE00=2.659, best=2.339]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:32<03:15,  5.27s/it, train loss=1.3421, val ΔE00=2.536, best=2.339]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:37<03:08,  5.25s/it, train loss=1.3421, val ΔE00=2.536, best=2.339]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:37<03:08,  5.25s/it, train loss=1.3226, val ΔE00=2.275, best=2.275]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:43<03:05,  5.30s/it, train loss=1.3226, val ΔE00=2.275, best=2.275]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:43<03:05,  5.30s/it, train loss=1.3536, val ΔE00=3.303, best=2.275]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:48<03:00,  5.30s/it, train loss=1.3536, val ΔE00=3.303, best=2.275]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:48<03:00,  5.30s/it, train loss=1.3984, val ΔE00=2.515, best=2.275]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:53<02:53,  5.27s/it, train loss=1.3984, val ΔE00=2.515, best=2.275]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:53<02:53,  5.27s/it, train loss=1.3162, val ΔE00=2.374, best=2.275]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [05:59<02:47,  5.24s/it, train loss=1.3162, val ΔE00=2.374, best=2.275]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [05:59<02:47,  5.24s/it, train loss=1.4021, val ΔE00=2.479, best=2.275]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [06:04<02:41,  5.22s/it, train loss=1.4021, val ΔE00=2.479, best=2.275]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [06:04<02:41,  5.22s/it, train loss=1.2916, val ΔE00=2.469, best=2.275]Training (xattn/smallcnn):  70%|███████   | 70/100 [06:09<02:38,  5.27s/it, train loss=1.2916, val ΔE00=2.469, best=2.275]Training (xattn/smallcnn):  70%|███████   | 70/100 [06:09<02:38,  5.27s/it, train loss=1.3660, val ΔE00=2.337, best=2.275]Training (xattn/smallcnn):  71%|███████   | 71/100 [06:14<02:33,  5.28s/it, train loss=1.3660, val ΔE00=2.337, best=2.275]Training (xattn/smallcnn):  71%|███████   | 71/100 [06:14<02:33,  5.28s/it, train loss=1.4394, val ΔE00=2.748, best=2.275]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:20<02:26,  5.25s/it, train loss=1.4394, val ΔE00=2.748, best=2.275]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:20<02:26,  5.25s/it, train loss=1.3259, val ΔE00=2.363, best=2.275]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:25<02:21,  5.23s/it, train loss=1.3259, val ΔE00=2.363, best=2.275]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:25<02:21,  5.23s/it, train loss=1.2567, val ΔE00=2.545, best=2.275]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:30<02:21,  5.23s/it, train loss=1.2877, val ΔE00=2.632, early_stop=yes]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:30<02:24,  5.35s/it, train loss=1.2877, val ΔE00=2.632, early_stop=yes]
[early] stop at epoch 74 (best de00=2.2751 @ 64)
[done] best ΔE00=2.275 over 74 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/xattn__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 10/12 ===
[sweep] id=010_model=xattn__backbone=smallcnn__features=image+mean+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone smallcnn --features image+mean+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=xattn, backbone=smallcnn, features=image+mean+meta, meta_encoder=flair
[run] model=xattn backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:12,  5.58s/it]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:12,  5.58s/it, train loss=0.0109, val ΔE00=8.861, best=8.861]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:45,  5.36s/it, train loss=0.0109, val ΔE00=8.861, best=8.861]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:45,  5.36s/it, train loss=0.0089, val ΔE00=5.727, best=5.727]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:33,  5.29s/it, train loss=0.0089, val ΔE00=5.727, best=5.727]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:33,  5.29s/it, train loss=0.0139, val ΔE00=6.058, best=5.727]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:21<08:25,  5.26s/it, train loss=0.0139, val ΔE00=6.058, best=5.727]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:21<08:25,  5.26s/it, train loss=0.0224, val ΔE00=5.042, best=5.042]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:26<08:26,  5.33s/it, train loss=0.0224, val ΔE00=5.042, best=5.042]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:26<08:26,  5.33s/it, train loss=0.0353, val ΔE00=6.623, best=5.042]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:32<08:21,  5.34s/it, train loss=0.0353, val ΔE00=6.623, best=5.042]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:32<08:21,  5.34s/it, train loss=0.0465, val ΔE00=4.605, best=4.605]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:37<08:12,  5.30s/it, train loss=0.0465, val ΔE00=4.605, best=4.605]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:37<08:12,  5.30s/it, train loss=0.0610, val ΔE00=5.655, best=4.605]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:42<08:07,  5.30s/it, train loss=0.0610, val ΔE00=5.655, best=4.605]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:42<08:07,  5.30s/it, train loss=0.0750, val ΔE00=4.307, best=4.307]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:47<08:00,  5.28s/it, train loss=0.0750, val ΔE00=4.307, best=4.307]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:47<08:00,  5.28s/it, train loss=0.0889, val ΔE00=3.374, best=3.374]Training (xattn/smallcnn):  10%|█         | 10/100 [00:53<07:59,  5.32s/it, train loss=0.0889, val ΔE00=3.374, best=3.374]Training (xattn/smallcnn):  10%|█         | 10/100 [00:53<07:59,  5.32s/it, train loss=0.1104, val ΔE00=4.019, best=3.374]Training (xattn/smallcnn):  11%|█         | 11/100 [00:58<07:53,  5.33s/it, train loss=0.1104, val ΔE00=4.019, best=3.374]Training (xattn/smallcnn):  11%|█         | 11/100 [00:58<07:53,  5.33s/it, train loss=0.1199, val ΔE00=3.177, best=3.177]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:03<07:44,  5.28s/it, train loss=0.1199, val ΔE00=3.177, best=3.177]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:03<07:44,  5.28s/it, train loss=0.1413, val ΔE00=3.679, best=3.177]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:08<07:36,  5.25s/it, train loss=0.1413, val ΔE00=3.679, best=3.177]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:08<07:36,  5.25s/it, train loss=0.1690, val ΔE00=3.606, best=3.177]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:14<07:32,  5.26s/it, train loss=0.1690, val ΔE00=3.606, best=3.177]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:14<07:32,  5.26s/it, train loss=0.1943, val ΔE00=3.454, best=3.177]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:19<07:33,  5.33s/it, train loss=0.1943, val ΔE00=3.454, best=3.177]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:19<07:33,  5.33s/it, train loss=0.2179, val ΔE00=4.005, best=3.177]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:25<07:29,  5.35s/it, train loss=0.2179, val ΔE00=4.005, best=3.177]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:25<07:29,  5.35s/it, train loss=0.2264, val ΔE00=3.792, best=3.177]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:30<07:19,  5.30s/it, train loss=0.2264, val ΔE00=3.792, best=3.177]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:30<07:19,  5.30s/it, train loss=0.2652, val ΔE00=3.382, best=3.177]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:35<07:11,  5.26s/it, train loss=0.2652, val ΔE00=3.382, best=3.177]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:35<07:11,  5.26s/it, train loss=0.2897, val ΔE00=3.014, best=3.014]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:40<07:06,  5.26s/it, train loss=0.2897, val ΔE00=3.014, best=3.014]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:40<07:06,  5.26s/it, train loss=0.3508, val ΔE00=3.030, best=3.014]Training (xattn/smallcnn):  20%|██        | 20/100 [01:46<07:06,  5.33s/it, train loss=0.3508, val ΔE00=3.030, best=3.014]Training (xattn/smallcnn):  20%|██        | 20/100 [01:46<07:06,  5.33s/it, train loss=0.3427, val ΔE00=3.205, best=3.014]Training (xattn/smallcnn):  21%|██        | 21/100 [01:51<07:00,  5.32s/it, train loss=0.3427, val ΔE00=3.205, best=3.014]Training (xattn/smallcnn):  21%|██        | 21/100 [01:51<07:00,  5.32s/it, train loss=0.3703, val ΔE00=3.412, best=3.014]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:56<06:51,  5.28s/it, train loss=0.3703, val ΔE00=3.412, best=3.014]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:56<06:51,  5.28s/it, train loss=0.3957, val ΔE00=3.119, best=3.014]Training (xattn/smallcnn):  23%|██▎       | 23/100 [02:01<06:44,  5.26s/it, train loss=0.3957, val ΔE00=3.119, best=3.014]Training (xattn/smallcnn):  23%|██▎       | 23/100 [02:01<06:44,  5.26s/it, train loss=0.4333, val ΔE00=2.798, best=2.798]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:07<06:39,  5.26s/it, train loss=0.4333, val ΔE00=2.798, best=2.798]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:07<06:39,  5.26s/it, train loss=0.4351, val ΔE00=3.078, best=2.798]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:12<06:39,  5.32s/it, train loss=0.4351, val ΔE00=3.078, best=2.798]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:12<06:39,  5.32s/it, train loss=0.4792, val ΔE00=3.016, best=2.798]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:18<06:36,  5.35s/it, train loss=0.4792, val ΔE00=3.016, best=2.798]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:18<06:36,  5.35s/it, train loss=0.5012, val ΔE00=2.597, best=2.597]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:23<06:28,  5.33s/it, train loss=0.5012, val ΔE00=2.597, best=2.597]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:23<06:28,  5.33s/it, train loss=0.5318, val ΔE00=2.955, best=2.597]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:28<06:22,  5.31s/it, train loss=0.5318, val ΔE00=2.955, best=2.597]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:28<06:22,  5.31s/it, train loss=0.5683, val ΔE00=2.953, best=2.597]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:33<06:14,  5.28s/it, train loss=0.5683, val ΔE00=2.953, best=2.597]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:33<06:14,  5.28s/it, train loss=0.5940, val ΔE00=3.617, best=2.597]Training (xattn/smallcnn):  30%|███       | 30/100 [02:39<06:12,  5.33s/it, train loss=0.5940, val ΔE00=3.617, best=2.597]Training (xattn/smallcnn):  30%|███       | 30/100 [02:39<06:12,  5.33s/it, train loss=0.6648, val ΔE00=2.534, best=2.534]Training (xattn/smallcnn):  31%|███       | 31/100 [02:44<06:07,  5.32s/it, train loss=0.6648, val ΔE00=2.534, best=2.534]Training (xattn/smallcnn):  31%|███       | 31/100 [02:44<06:07,  5.32s/it, train loss=0.7012, val ΔE00=4.808, best=2.534]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:49<05:59,  5.29s/it, train loss=0.7012, val ΔE00=4.808, best=2.534]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:49<05:59,  5.29s/it, train loss=0.7818, val ΔE00=2.668, best=2.534]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:54<05:53,  5.28s/it, train loss=0.7818, val ΔE00=2.668, best=2.534]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:54<05:53,  5.28s/it, train loss=0.7377, val ΔE00=2.993, best=2.534]Training (xattn/smallcnn):  34%|███▍      | 34/100 [03:00<05:48,  5.28s/it, train loss=0.7377, val ΔE00=2.993, best=2.534]Training (xattn/smallcnn):  34%|███▍      | 34/100 [03:00<05:48,  5.28s/it, train loss=0.7298, val ΔE00=2.499, best=2.499]Training (xattn/smallcnn):  35%|███▌      | 35/100 [03:05<05:47,  5.35s/it, train loss=0.7298, val ΔE00=2.499, best=2.499]Training (xattn/smallcnn):  35%|███▌      | 35/100 [03:05<05:47,  5.35s/it, train loss=0.7464, val ΔE00=2.686, best=2.499]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:11<05:42,  5.35s/it, train loss=0.7464, val ΔE00=2.686, best=2.499]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:11<05:42,  5.35s/it, train loss=0.7856, val ΔE00=2.963, best=2.499]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:16<05:33,  5.30s/it, train loss=0.7856, val ΔE00=2.963, best=2.499]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:16<05:33,  5.30s/it, train loss=0.8253, val ΔE00=2.873, best=2.499]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:21<05:25,  5.26s/it, train loss=0.8253, val ΔE00=2.873, best=2.499]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:21<05:25,  5.26s/it, train loss=0.8516, val ΔE00=3.019, best=2.499]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:26<05:19,  5.23s/it, train loss=0.8516, val ΔE00=3.019, best=2.499]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:26<05:19,  5.23s/it, train loss=0.9040, val ΔE00=2.961, best=2.499]Training (xattn/smallcnn):  40%|████      | 40/100 [03:32<05:18,  5.30s/it, train loss=0.9040, val ΔE00=2.961, best=2.499]Training (xattn/smallcnn):  40%|████      | 40/100 [03:32<05:18,  5.30s/it, train loss=0.9199, val ΔE00=2.639, best=2.499]Training (xattn/smallcnn):  41%|████      | 41/100 [03:37<05:12,  5.30s/it, train loss=0.9199, val ΔE00=2.639, best=2.499]Training (xattn/smallcnn):  41%|████      | 41/100 [03:37<05:12,  5.30s/it, train loss=0.9716, val ΔE00=2.421, best=2.421]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:42<05:05,  5.26s/it, train loss=0.9716, val ΔE00=2.421, best=2.421]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:42<05:05,  5.26s/it, train loss=0.9499, val ΔE00=2.758, best=2.421]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:47<04:58,  5.23s/it, train loss=0.9499, val ΔE00=2.758, best=2.421]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:47<04:58,  5.23s/it, train loss=0.9977, val ΔE00=2.664, best=2.421]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:52<04:51,  5.20s/it, train loss=0.9977, val ΔE00=2.664, best=2.421]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:52<04:51,  5.20s/it, train loss=0.9790, val ΔE00=2.544, best=2.421]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:58<04:50,  5.28s/it, train loss=0.9790, val ΔE00=2.544, best=2.421]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:58<04:50,  5.28s/it, train loss=1.0520, val ΔE00=2.752, best=2.421]Training (xattn/smallcnn):  46%|████▌     | 46/100 [04:03<04:46,  5.31s/it, train loss=1.0520, val ΔE00=2.752, best=2.421]Training (xattn/smallcnn):  46%|████▌     | 46/100 [04:03<04:46,  5.31s/it, train loss=1.0661, val ΔE00=2.712, best=2.421]Training (xattn/smallcnn):  47%|████▋     | 47/100 [04:08<04:39,  5.28s/it, train loss=1.0661, val ΔE00=2.712, best=2.421]Training (xattn/smallcnn):  47%|████▋     | 47/100 [04:08<04:39,  5.28s/it, train loss=1.0761, val ΔE00=2.682, best=2.421]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:14<04:32,  5.24s/it, train loss=1.0761, val ΔE00=2.682, best=2.421]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:14<04:32,  5.24s/it, train loss=1.1736, val ΔE00=2.578, best=2.421]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:19<04:27,  5.24s/it, train loss=1.1736, val ΔE00=2.578, best=2.421]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:19<04:27,  5.24s/it, train loss=1.1870, val ΔE00=2.589, best=2.421]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:24<04:25,  5.31s/it, train loss=1.1870, val ΔE00=2.589, best=2.421]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:24<04:25,  5.31s/it, train loss=1.1777, val ΔE00=2.511, best=2.421]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:30<04:20,  5.31s/it, train loss=1.1777, val ΔE00=2.511, best=2.421]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:30<04:20,  5.31s/it, train loss=1.1794, val ΔE00=2.428, best=2.421]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:35<04:12,  5.27s/it, train loss=1.1794, val ΔE00=2.428, best=2.421]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:35<04:12,  5.27s/it, train loss=1.1719, val ΔE00=3.087, best=2.421]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:40<04:06,  5.24s/it, train loss=1.1719, val ΔE00=3.087, best=2.421]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:40<04:06,  5.24s/it, train loss=1.2073, val ΔE00=2.368, best=2.368]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:45<04:01,  5.26s/it, train loss=1.2073, val ΔE00=2.368, best=2.368]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:45<04:01,  5.26s/it, train loss=1.1718, val ΔE00=2.706, best=2.368]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:51<04:00,  5.33s/it, train loss=1.1718, val ΔE00=2.706, best=2.368]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:51<04:00,  5.33s/it, train loss=1.2131, val ΔE00=2.814, best=2.368]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:56<03:54,  5.34s/it, train loss=1.2131, val ΔE00=2.814, best=2.368]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:56<03:54,  5.34s/it, train loss=1.2377, val ΔE00=2.474, best=2.368]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [05:01<03:47,  5.30s/it, train loss=1.2377, val ΔE00=2.474, best=2.368]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [05:01<03:47,  5.30s/it, train loss=1.3184, val ΔE00=2.523, best=2.368]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [05:07<03:42,  5.29s/it, train loss=1.3184, val ΔE00=2.523, best=2.368]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [05:07<03:42,  5.29s/it, train loss=1.3220, val ΔE00=2.882, best=2.368]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:12<03:36,  5.29s/it, train loss=1.3220, val ΔE00=2.882, best=2.368]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:12<03:36,  5.29s/it, train loss=1.3468, val ΔE00=2.339, best=2.339]Training (xattn/smallcnn):  60%|██████    | 60/100 [05:17<03:33,  5.34s/it, train loss=1.3468, val ΔE00=2.339, best=2.339]Training (xattn/smallcnn):  60%|██████    | 60/100 [05:17<03:33,  5.34s/it, train loss=1.3224, val ΔE00=2.459, best=2.339]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:23<03:29,  5.36s/it, train loss=1.3224, val ΔE00=2.459, best=2.339]Training (xattn/smallcnn):  61%|██████    | 61/100 [05:23<03:29,  5.36s/it, train loss=1.3352, val ΔE00=2.931, best=2.339]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:28<03:22,  5.34s/it, train loss=1.3352, val ΔE00=2.931, best=2.339]Training (xattn/smallcnn):  62%|██████▏   | 62/100 [05:28<03:22,  5.34s/it, train loss=1.2934, val ΔE00=2.659, best=2.339]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:33<03:16,  5.32s/it, train loss=1.2934, val ΔE00=2.659, best=2.339]Training (xattn/smallcnn):  63%|██████▎   | 63/100 [05:33<03:16,  5.32s/it, train loss=1.3421, val ΔE00=2.536, best=2.339]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:39<03:11,  5.32s/it, train loss=1.3421, val ΔE00=2.536, best=2.339]Training (xattn/smallcnn):  64%|██████▍   | 64/100 [05:39<03:11,  5.32s/it, train loss=1.3226, val ΔE00=2.275, best=2.275]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:44<03:08,  5.37s/it, train loss=1.3226, val ΔE00=2.275, best=2.275]Training (xattn/smallcnn):  65%|██████▌   | 65/100 [05:44<03:08,  5.37s/it, train loss=1.3536, val ΔE00=3.303, best=2.275]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:49<03:02,  5.36s/it, train loss=1.3536, val ΔE00=3.303, best=2.275]Training (xattn/smallcnn):  66%|██████▌   | 66/100 [05:49<03:02,  5.36s/it, train loss=1.3984, val ΔE00=2.515, best=2.275]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:55<02:55,  5.31s/it, train loss=1.3984, val ΔE00=2.515, best=2.275]Training (xattn/smallcnn):  67%|██████▋   | 67/100 [05:55<02:55,  5.31s/it, train loss=1.3162, val ΔE00=2.374, best=2.275]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [06:00<02:49,  5.30s/it, train loss=1.3162, val ΔE00=2.374, best=2.275]Training (xattn/smallcnn):  68%|██████▊   | 68/100 [06:00<02:49,  5.30s/it, train loss=1.4021, val ΔE00=2.479, best=2.275]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [06:05<02:44,  5.30s/it, train loss=1.4021, val ΔE00=2.479, best=2.275]Training (xattn/smallcnn):  69%|██████▉   | 69/100 [06:05<02:44,  5.30s/it, train loss=1.2916, val ΔE00=2.469, best=2.275]Training (xattn/smallcnn):  70%|███████   | 70/100 [06:11<02:40,  5.35s/it, train loss=1.2916, val ΔE00=2.469, best=2.275]Training (xattn/smallcnn):  70%|███████   | 70/100 [06:11<02:40,  5.35s/it, train loss=1.3660, val ΔE00=2.337, best=2.275]Training (xattn/smallcnn):  71%|███████   | 71/100 [06:16<02:35,  5.36s/it, train loss=1.3660, val ΔE00=2.337, best=2.275]Training (xattn/smallcnn):  71%|███████   | 71/100 [06:16<02:35,  5.36s/it, train loss=1.4394, val ΔE00=2.748, best=2.275]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:21<02:28,  5.31s/it, train loss=1.4394, val ΔE00=2.748, best=2.275]Training (xattn/smallcnn):  72%|███████▏  | 72/100 [06:21<02:28,  5.31s/it, train loss=1.3259, val ΔE00=2.363, best=2.275]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:26<02:22,  5.28s/it, train loss=1.3259, val ΔE00=2.363, best=2.275]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:26<02:22,  5.28s/it, train loss=1.2567, val ΔE00=2.545, best=2.275]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:32<02:22,  5.28s/it, train loss=1.2877, val ΔE00=2.632, early_stop=yes]Training (xattn/smallcnn):  73%|███████▎  | 73/100 [06:32<02:25,  5.37s/it, train loss=1.2877, val ΔE00=2.632, early_stop=yes]
[early] stop at epoch 74 (best de00=2.2751 @ 64)
[done] best ΔE00=2.275 over 74 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/xattn__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+mean+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 11/12 ===
[sweep] id=011_model=xattn__backbone=resnet18__features=image+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone resnet18 --features image+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=xattn, backbone=resnet18, features=image+meta, meta_encoder=flair
[run] model=xattn backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:28,  6.35s/it]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:28,  6.35s/it, train loss=0.0110, val ΔE00=6.603, best=6.603]Training (xattn/resnet18):   2%|▏         | 2/100 [00:12<09:57,  6.10s/it, train loss=0.0110, val ΔE00=6.603, best=6.603]Training (xattn/resnet18):   2%|▏         | 2/100 [00:12<09:57,  6.10s/it, train loss=0.0054, val ΔE00=4.295, best=4.295]Training (xattn/resnet18):   3%|▎         | 3/100 [00:18<09:41,  6.00s/it, train loss=0.0054, val ΔE00=4.295, best=4.295]Training (xattn/resnet18):   3%|▎         | 3/100 [00:18<09:41,  6.00s/it, train loss=0.0091, val ΔE00=4.104, best=4.104]Training (xattn/resnet18):   4%|▍         | 4/100 [00:24<09:31,  5.95s/it, train loss=0.0091, val ΔE00=4.104, best=4.104]Training (xattn/resnet18):   4%|▍         | 4/100 [00:24<09:31,  5.95s/it, train loss=0.0164, val ΔE00=3.875, best=3.875]Training (xattn/resnet18):   5%|▌         | 5/100 [00:30<09:27,  5.98s/it, train loss=0.0164, val ΔE00=3.875, best=3.875]Training (xattn/resnet18):   5%|▌         | 5/100 [00:30<09:27,  5.98s/it, train loss=0.0259, val ΔE00=4.672, best=3.875]Training (xattn/resnet18):   6%|▌         | 6/100 [00:35<09:17,  5.93s/it, train loss=0.0259, val ΔE00=4.672, best=3.875]Training (xattn/resnet18):   6%|▌         | 6/100 [00:35<09:17,  5.93s/it, train loss=0.0334, val ΔE00=4.029, best=3.875]Training (xattn/resnet18):   7%|▋         | 7/100 [00:41<09:09,  5.91s/it, train loss=0.0334, val ΔE00=4.029, best=3.875]Training (xattn/resnet18):   7%|▋         | 7/100 [00:41<09:09,  5.91s/it, train loss=0.0430, val ΔE00=3.334, best=3.334]Training (xattn/resnet18):   8%|▊         | 8/100 [00:47<08:59,  5.87s/it, train loss=0.0430, val ΔE00=3.334, best=3.334]Training (xattn/resnet18):   8%|▊         | 8/100 [00:47<08:59,  5.87s/it, train loss=0.0578, val ΔE00=4.069, best=3.334]Training (xattn/resnet18):   9%|▉         | 9/100 [00:53<08:51,  5.84s/it, train loss=0.0578, val ΔE00=4.069, best=3.334]Training (xattn/resnet18):   9%|▉         | 9/100 [00:53<08:51,  5.84s/it, train loss=0.0698, val ΔE00=3.341, best=3.334]Training (xattn/resnet18):  10%|█         | 10/100 [00:59<08:51,  5.91s/it, train loss=0.0698, val ΔE00=3.341, best=3.334]Training (xattn/resnet18):  10%|█         | 10/100 [00:59<08:51,  5.91s/it, train loss=0.0887, val ΔE00=2.776, best=2.776]Training (xattn/resnet18):  11%|█         | 11/100 [01:05<08:44,  5.90s/it, train loss=0.0887, val ΔE00=2.776, best=2.776]Training (xattn/resnet18):  11%|█         | 11/100 [01:05<08:44,  5.90s/it, train loss=0.0902, val ΔE00=3.167, best=2.776]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:11<08:39,  5.91s/it, train loss=0.0902, val ΔE00=3.167, best=2.776]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:11<08:39,  5.91s/it, train loss=0.1010, val ΔE00=3.558, best=2.776]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:17<08:34,  5.91s/it, train loss=0.1010, val ΔE00=3.558, best=2.776]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:17<08:34,  5.91s/it, train loss=0.1119, val ΔE00=2.910, best=2.776]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:22<08:26,  5.89s/it, train loss=0.1119, val ΔE00=2.910, best=2.776]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:22<08:26,  5.89s/it, train loss=0.1337, val ΔE00=3.220, best=2.776]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:28<08:23,  5.93s/it, train loss=0.1337, val ΔE00=3.220, best=2.776]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:28<08:23,  5.93s/it, train loss=0.1455, val ΔE00=2.833, best=2.776]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:34<08:16,  5.92s/it, train loss=0.1455, val ΔE00=2.833, best=2.776]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:34<08:16,  5.92s/it, train loss=0.1552, val ΔE00=3.095, best=2.776]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:40<08:09,  5.89s/it, train loss=0.1552, val ΔE00=3.095, best=2.776]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:40<08:09,  5.89s/it, train loss=0.1715, val ΔE00=2.814, best=2.776]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:46<08:01,  5.87s/it, train loss=0.1715, val ΔE00=2.814, best=2.776]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:46<08:01,  5.87s/it, train loss=0.1906, val ΔE00=3.245, best=2.776]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:52<07:54,  5.86s/it, train loss=0.1906, val ΔE00=3.245, best=2.776]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:52<07:54,  5.86s/it, train loss=0.2024, val ΔE00=2.885, best=2.776]Training (xattn/resnet18):  20%|██        | 20/100 [01:58<07:55,  5.94s/it, train loss=0.2024, val ΔE00=2.885, best=2.776]Training (xattn/resnet18):  20%|██        | 20/100 [01:58<07:55,  5.94s/it, train loss=0.2190, val ΔE00=2.691, best=2.691]Training (xattn/resnet18):  21%|██        | 21/100 [02:04<07:47,  5.92s/it, train loss=0.2190, val ΔE00=2.691, best=2.691]Training (xattn/resnet18):  21%|██        | 21/100 [02:04<07:47,  5.92s/it, train loss=0.2213, val ΔE00=2.814, best=2.691]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:10<07:41,  5.92s/it, train loss=0.2213, val ΔE00=2.814, best=2.691]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:10<07:41,  5.92s/it, train loss=0.2331, val ΔE00=3.020, best=2.691]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:16<07:35,  5.91s/it, train loss=0.2331, val ΔE00=3.020, best=2.691]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:16<07:35,  5.91s/it, train loss=0.2572, val ΔE00=2.982, best=2.691]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:21<07:27,  5.88s/it, train loss=0.2572, val ΔE00=2.982, best=2.691]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:21<07:27,  5.88s/it, train loss=0.2840, val ΔE00=2.912, best=2.691]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:27<07:23,  5.92s/it, train loss=0.2840, val ΔE00=2.912, best=2.691]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:27<07:23,  5.92s/it, train loss=0.2958, val ΔE00=2.871, best=2.691]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:33<07:17,  5.92s/it, train loss=0.2958, val ΔE00=2.871, best=2.691]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:33<07:17,  5.92s/it, train loss=0.2899, val ΔE00=2.794, best=2.691]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:39<07:10,  5.90s/it, train loss=0.2899, val ΔE00=2.794, best=2.691]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:39<07:10,  5.90s/it, train loss=0.2937, val ΔE00=2.687, best=2.687]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:45<07:02,  5.87s/it, train loss=0.2937, val ΔE00=2.687, best=2.687]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:45<07:02,  5.87s/it, train loss=0.3159, val ΔE00=3.023, best=2.687]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:51<06:55,  5.86s/it, train loss=0.3159, val ΔE00=3.023, best=2.687]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:51<06:55,  5.86s/it, train loss=0.3154, val ΔE00=2.766, best=2.687]Training (xattn/resnet18):  30%|███       | 30/100 [02:57<06:53,  5.91s/it, train loss=0.3154, val ΔE00=2.766, best=2.687]Training (xattn/resnet18):  30%|███       | 30/100 [02:57<06:53,  5.91s/it, train loss=0.3381, val ΔE00=2.969, best=2.687]Training (xattn/resnet18):  31%|███       | 31/100 [03:03<06:48,  5.92s/it, train loss=0.3381, val ΔE00=2.969, best=2.687]Training (xattn/resnet18):  31%|███       | 31/100 [03:03<06:48,  5.92s/it, train loss=0.3760, val ΔE00=2.679, best=2.679]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:09<06:39,  5.88s/it, train loss=0.3760, val ΔE00=2.679, best=2.679]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:09<06:39,  5.88s/it, train loss=0.3653, val ΔE00=2.977, best=2.679]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:14<06:31,  5.85s/it, train loss=0.3653, val ΔE00=2.977, best=2.679]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:14<06:31,  5.85s/it, train loss=0.3725, val ΔE00=2.823, best=2.679]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:20<06:24,  5.83s/it, train loss=0.3725, val ΔE00=2.823, best=2.679]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:20<06:24,  5.83s/it, train loss=0.3951, val ΔE00=2.900, best=2.679]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:26<06:25,  5.93s/it, train loss=0.3951, val ΔE00=2.900, best=2.679]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:26<06:25,  5.93s/it, train loss=0.3802, val ΔE00=2.661, best=2.661]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:32<06:20,  5.95s/it, train loss=0.3802, val ΔE00=2.661, best=2.661]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:32<06:20,  5.95s/it, train loss=0.3999, val ΔE00=2.649, best=2.649]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:38<06:13,  5.92s/it, train loss=0.3999, val ΔE00=2.649, best=2.649]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:38<06:13,  5.92s/it, train loss=0.4571, val ΔE00=2.625, best=2.625]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:44<06:04,  5.88s/it, train loss=0.4571, val ΔE00=2.625, best=2.625]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:44<06:04,  5.88s/it, train loss=0.4261, val ΔE00=2.865, best=2.625]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:50<05:57,  5.86s/it, train loss=0.4261, val ΔE00=2.865, best=2.625]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:50<05:57,  5.86s/it, train loss=0.4658, val ΔE00=2.864, best=2.625]Training (xattn/resnet18):  40%|████      | 40/100 [03:56<05:54,  5.91s/it, train loss=0.4658, val ΔE00=2.864, best=2.625]Training (xattn/resnet18):  40%|████      | 40/100 [03:56<05:54,  5.91s/it, train loss=0.4605, val ΔE00=2.680, best=2.625]Training (xattn/resnet18):  41%|████      | 41/100 [04:02<05:47,  5.89s/it, train loss=0.4605, val ΔE00=2.680, best=2.625]Training (xattn/resnet18):  41%|████      | 41/100 [04:02<05:47,  5.89s/it, train loss=0.4799, val ΔE00=2.784, best=2.625]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:07<05:40,  5.86s/it, train loss=0.4799, val ΔE00=2.784, best=2.625]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:07<05:40,  5.86s/it, train loss=0.4568, val ΔE00=2.673, best=2.625]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:13<05:33,  5.85s/it, train loss=0.4568, val ΔE00=2.673, best=2.625]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:13<05:33,  5.85s/it, train loss=0.5322, val ΔE00=2.805, best=2.625]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:19<05:26,  5.84s/it, train loss=0.5322, val ΔE00=2.805, best=2.625]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:19<05:26,  5.84s/it, train loss=0.4999, val ΔE00=2.739, best=2.625]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:25<05:25,  5.91s/it, train loss=0.4999, val ΔE00=2.739, best=2.625]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:25<05:25,  5.91s/it, train loss=0.5585, val ΔE00=2.596, best=2.596]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:31<05:18,  5.90s/it, train loss=0.5585, val ΔE00=2.596, best=2.596]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:31<05:18,  5.90s/it, train loss=0.5457, val ΔE00=2.828, best=2.596]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:37<05:11,  5.88s/it, train loss=0.5457, val ΔE00=2.828, best=2.596]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:37<05:11,  5.88s/it, train loss=0.5431, val ΔE00=2.662, best=2.596]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:43<05:05,  5.87s/it, train loss=0.5431, val ΔE00=2.662, best=2.596]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:43<05:05,  5.87s/it, train loss=0.5540, val ΔE00=2.774, best=2.596]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:49<05:00,  5.90s/it, train loss=0.5540, val ΔE00=2.774, best=2.596]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:49<05:00,  5.90s/it, train loss=0.4831, val ΔE00=2.434, best=2.434]Training (xattn/resnet18):  50%|█████     | 50/100 [04:55<04:57,  5.95s/it, train loss=0.4831, val ΔE00=2.434, best=2.434]Training (xattn/resnet18):  50%|█████     | 50/100 [04:55<04:57,  5.95s/it, train loss=0.5332, val ΔE00=2.652, best=2.434]Training (xattn/resnet18):  51%|█████     | 51/100 [05:01<04:50,  5.93s/it, train loss=0.5332, val ΔE00=2.652, best=2.434]Training (xattn/resnet18):  51%|█████     | 51/100 [05:01<04:50,  5.93s/it, train loss=0.5092, val ΔE00=2.702, best=2.434]Training (xattn/resnet18):  52%|█████▏    | 52/100 [05:07<04:44,  5.93s/it, train loss=0.5092, val ΔE00=2.702, best=2.434]Training (xattn/resnet18):  52%|█████▏    | 52/100 [05:07<04:44,  5.93s/it, train loss=0.5906, val ΔE00=2.568, best=2.434]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:12<04:37,  5.91s/it, train loss=0.5906, val ΔE00=2.568, best=2.434]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:12<04:37,  5.91s/it, train loss=0.5241, val ΔE00=2.916, best=2.434]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:18<04:30,  5.89s/it, train loss=0.5241, val ΔE00=2.916, best=2.434]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:18<04:30,  5.89s/it, train loss=0.5651, val ΔE00=2.731, best=2.434]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:24<04:26,  5.93s/it, train loss=0.5651, val ΔE00=2.731, best=2.434]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:24<04:26,  5.93s/it, train loss=0.5351, val ΔE00=2.773, best=2.434]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:30<04:19,  5.91s/it, train loss=0.5351, val ΔE00=2.773, best=2.434]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:30<04:19,  5.91s/it, train loss=0.5739, val ΔE00=2.666, best=2.434]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:36<04:14,  5.91s/it, train loss=0.5739, val ΔE00=2.666, best=2.434]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:36<04:14,  5.91s/it, train loss=0.5838, val ΔE00=2.815, best=2.434]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:42<04:07,  5.89s/it, train loss=0.5838, val ΔE00=2.815, best=2.434]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:42<04:07,  5.89s/it, train loss=0.6340, val ΔE00=2.654, best=2.434]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:48<04:07,  5.89s/it, train loss=0.5733, val ΔE00=2.523, early_stop=yes]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:48<04:12,  6.01s/it, train loss=0.5733, val ΔE00=2.523, early_stop=yes]
[early] stop at epoch 59 (best de00=2.4341 @ 49)
[done] best ΔE00=2.434 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/xattn__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+meta__meta_encoder=flair/final_summary.json (kind=val)
[sweep] === Run 12/12 ===
[sweep] id=012_model=xattn__backbone=resnet18__features=image+mean+meta__meta_encoder=flair
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/flair/full --logdir ./runs/results/flair/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder flair --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone resnet18 --features image+mean+meta --tag_keys model backbone features meta_encoder
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[diag] diag_start: model=xattn, backbone=resnet18, features=image+mean+meta, meta_encoder=flair
[run] model=xattn backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:21,  6.27s/it]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:21,  6.27s/it, train loss=0.0110, val ΔE00=6.603, best=6.603]Training (xattn/resnet18):   2%|▏         | 2/100 [00:12<09:53,  6.06s/it, train loss=0.0110, val ΔE00=6.603, best=6.603]Training (xattn/resnet18):   2%|▏         | 2/100 [00:12<09:53,  6.06s/it, train loss=0.0054, val ΔE00=4.295, best=4.295]Training (xattn/resnet18):   3%|▎         | 3/100 [00:18<09:42,  6.01s/it, train loss=0.0054, val ΔE00=4.295, best=4.295]Training (xattn/resnet18):   3%|▎         | 3/100 [00:18<09:42,  6.01s/it, train loss=0.0091, val ΔE00=4.104, best=4.104]Training (xattn/resnet18):   4%|▍         | 4/100 [00:24<09:33,  5.97s/it, train loss=0.0091, val ΔE00=4.104, best=4.104]Training (xattn/resnet18):   4%|▍         | 4/100 [00:24<09:33,  5.97s/it, train loss=0.0164, val ΔE00=3.875, best=3.875]Training (xattn/resnet18):   5%|▌         | 5/100 [00:30<09:28,  5.98s/it, train loss=0.0164, val ΔE00=3.875, best=3.875]Training (xattn/resnet18):   5%|▌         | 5/100 [00:30<09:28,  5.98s/it, train loss=0.0259, val ΔE00=4.672, best=3.875]Training (xattn/resnet18):   6%|▌         | 6/100 [00:35<09:17,  5.93s/it, train loss=0.0259, val ΔE00=4.672, best=3.875]Training (xattn/resnet18):   6%|▌         | 6/100 [00:35<09:17,  5.93s/it, train loss=0.0334, val ΔE00=4.029, best=3.875]Training (xattn/resnet18):   7%|▋         | 7/100 [00:41<09:10,  5.92s/it, train loss=0.0334, val ΔE00=4.029, best=3.875]Training (xattn/resnet18):   7%|▋         | 7/100 [00:41<09:10,  5.92s/it, train loss=0.0430, val ΔE00=3.334, best=3.334]Training (xattn/resnet18):   8%|▊         | 8/100 [00:47<09:01,  5.89s/it, train loss=0.0430, val ΔE00=3.334, best=3.334]Training (xattn/resnet18):   8%|▊         | 8/100 [00:47<09:01,  5.89s/it, train loss=0.0578, val ΔE00=4.069, best=3.334]Training (xattn/resnet18):   9%|▉         | 9/100 [00:53<08:53,  5.87s/it, train loss=0.0578, val ΔE00=4.069, best=3.334]Training (xattn/resnet18):   9%|▉         | 9/100 [00:53<08:53,  5.87s/it, train loss=0.0698, val ΔE00=3.341, best=3.334]Training (xattn/resnet18):  10%|█         | 10/100 [00:59<08:56,  5.96s/it, train loss=0.0698, val ΔE00=3.341, best=3.334]Training (xattn/resnet18):  10%|█         | 10/100 [00:59<08:56,  5.96s/it, train loss=0.0887, val ΔE00=2.776, best=2.776]Training (xattn/resnet18):  11%|█         | 11/100 [01:05<08:51,  5.97s/it, train loss=0.0887, val ΔE00=2.776, best=2.776]Training (xattn/resnet18):  11%|█         | 11/100 [01:05<08:51,  5.97s/it, train loss=0.0902, val ΔE00=3.167, best=2.776]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:11<08:44,  5.96s/it, train loss=0.0902, val ΔE00=3.167, best=2.776]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:11<08:44,  5.96s/it, train loss=0.1010, val ΔE00=3.558, best=2.776]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:17<08:37,  5.95s/it, train loss=0.1010, val ΔE00=3.558, best=2.776]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:17<08:37,  5.95s/it, train loss=0.1119, val ΔE00=2.910, best=2.776]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:23<08:29,  5.92s/it, train loss=0.1119, val ΔE00=2.910, best=2.776]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:23<08:29,  5.92s/it, train loss=0.1337, val ΔE00=3.220, best=2.776]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:29<08:28,  5.98s/it, train loss=0.1337, val ΔE00=3.220, best=2.776]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:29<08:28,  5.98s/it, train loss=0.1455, val ΔE00=2.833, best=2.776]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:35<08:22,  5.99s/it, train loss=0.1455, val ΔE00=2.833, best=2.776]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:35<08:22,  5.99s/it, train loss=0.1552, val ΔE00=3.095, best=2.776]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:41<08:15,  5.97s/it, train loss=0.1552, val ΔE00=3.095, best=2.776]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:41<08:15,  5.97s/it, train loss=0.1715, val ΔE00=2.814, best=2.776]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:47<08:08,  5.96s/it, train loss=0.1715, val ΔE00=2.814, best=2.776]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:47<08:08,  5.96s/it, train loss=0.1906, val ΔE00=3.245, best=2.776]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:53<08:01,  5.95s/it, train loss=0.1906, val ΔE00=3.245, best=2.776]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:53<08:01,  5.95s/it, train loss=0.2024, val ΔE00=2.885, best=2.776]Training (xattn/resnet18):  20%|██        | 20/100 [01:59<08:01,  6.02s/it, train loss=0.2024, val ΔE00=2.885, best=2.776]Training (xattn/resnet18):  20%|██        | 20/100 [01:59<08:01,  6.02s/it, train loss=0.2190, val ΔE00=2.691, best=2.691]Training (xattn/resnet18):  21%|██        | 21/100 [02:05<07:54,  6.00s/it, train loss=0.2190, val ΔE00=2.691, best=2.691]Training (xattn/resnet18):  21%|██        | 21/100 [02:05<07:54,  6.00s/it, train loss=0.2213, val ΔE00=2.814, best=2.691]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:11<07:45,  5.97s/it, train loss=0.2213, val ΔE00=2.814, best=2.691]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:11<07:45,  5.97s/it, train loss=0.2331, val ΔE00=3.020, best=2.691]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:17<07:37,  5.94s/it, train loss=0.2331, val ΔE00=3.020, best=2.691]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:17<07:37,  5.94s/it, train loss=0.2572, val ΔE00=2.982, best=2.691]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:22<07:28,  5.91s/it, train loss=0.2572, val ΔE00=2.982, best=2.691]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:22<07:28,  5.91s/it, train loss=0.2840, val ΔE00=2.912, best=2.691]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:29<07:27,  5.96s/it, train loss=0.2840, val ΔE00=2.912, best=2.691]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:29<07:27,  5.96s/it, train loss=0.2958, val ΔE00=2.871, best=2.691]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:34<07:19,  5.93s/it, train loss=0.2958, val ΔE00=2.871, best=2.691]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:34<07:19,  5.93s/it, train loss=0.2899, val ΔE00=2.794, best=2.691]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:40<07:12,  5.92s/it, train loss=0.2899, val ΔE00=2.794, best=2.691]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:40<07:12,  5.92s/it, train loss=0.2937, val ΔE00=2.687, best=2.687]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:46<07:04,  5.90s/it, train loss=0.2937, val ΔE00=2.687, best=2.687]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:46<07:04,  5.90s/it, train loss=0.3159, val ΔE00=3.023, best=2.687]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:52<06:57,  5.88s/it, train loss=0.3159, val ΔE00=3.023, best=2.687]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:52<06:57,  5.88s/it, train loss=0.3154, val ΔE00=2.766, best=2.687]Training (xattn/resnet18):  30%|███       | 30/100 [02:58<06:54,  5.92s/it, train loss=0.3154, val ΔE00=2.766, best=2.687]Training (xattn/resnet18):  30%|███       | 30/100 [02:58<06:54,  5.92s/it, train loss=0.3381, val ΔE00=2.969, best=2.687]Training (xattn/resnet18):  31%|███       | 31/100 [03:04<06:49,  5.93s/it, train loss=0.3381, val ΔE00=2.969, best=2.687]Training (xattn/resnet18):  31%|███       | 31/100 [03:04<06:49,  5.93s/it, train loss=0.3760, val ΔE00=2.679, best=2.679]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:10<06:40,  5.90s/it, train loss=0.3760, val ΔE00=2.679, best=2.679]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:10<06:40,  5.90s/it, train loss=0.3653, val ΔE00=2.977, best=2.679]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:16<06:32,  5.86s/it, train loss=0.3653, val ΔE00=2.977, best=2.679]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:16<06:32,  5.86s/it, train loss=0.3725, val ΔE00=2.823, best=2.679]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:21<06:25,  5.83s/it, train loss=0.3725, val ΔE00=2.823, best=2.679]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:21<06:25,  5.83s/it, train loss=0.3951, val ΔE00=2.900, best=2.679]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:27<06:25,  5.92s/it, train loss=0.3951, val ΔE00=2.900, best=2.679]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:27<06:25,  5.92s/it, train loss=0.3802, val ΔE00=2.661, best=2.661]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:33<06:19,  5.93s/it, train loss=0.3802, val ΔE00=2.661, best=2.661]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:33<06:19,  5.93s/it, train loss=0.3999, val ΔE00=2.649, best=2.649]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:39<06:14,  5.94s/it, train loss=0.3999, val ΔE00=2.649, best=2.649]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:39<06:14,  5.94s/it, train loss=0.4571, val ΔE00=2.625, best=2.625]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:45<06:06,  5.91s/it, train loss=0.4571, val ΔE00=2.625, best=2.625]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:45<06:06,  5.91s/it, train loss=0.4261, val ΔE00=2.865, best=2.625]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:51<05:59,  5.89s/it, train loss=0.4261, val ΔE00=2.865, best=2.625]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:51<05:59,  5.89s/it, train loss=0.4658, val ΔE00=2.864, best=2.625]Training (xattn/resnet18):  40%|████      | 40/100 [03:57<05:57,  5.96s/it, train loss=0.4658, val ΔE00=2.864, best=2.625]Training (xattn/resnet18):  40%|████      | 40/100 [03:57<05:57,  5.96s/it, train loss=0.4605, val ΔE00=2.680, best=2.625]Training (xattn/resnet18):  41%|████      | 41/100 [04:03<05:51,  5.96s/it, train loss=0.4605, val ΔE00=2.680, best=2.625]Training (xattn/resnet18):  41%|████      | 41/100 [04:03<05:51,  5.96s/it, train loss=0.4799, val ΔE00=2.784, best=2.625]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:09<05:43,  5.93s/it, train loss=0.4799, val ΔE00=2.784, best=2.625]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:09<05:43,  5.93s/it, train loss=0.4568, val ΔE00=2.673, best=2.625]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:15<05:37,  5.91s/it, train loss=0.4568, val ΔE00=2.673, best=2.625]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:15<05:37,  5.91s/it, train loss=0.5322, val ΔE00=2.805, best=2.625]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:21<05:29,  5.89s/it, train loss=0.5322, val ΔE00=2.805, best=2.625]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:21<05:29,  5.89s/it, train loss=0.4999, val ΔE00=2.739, best=2.625]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:27<05:27,  5.96s/it, train loss=0.4999, val ΔE00=2.739, best=2.625]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:27<05:27,  5.96s/it, train loss=0.5585, val ΔE00=2.596, best=2.596]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:33<05:21,  5.95s/it, train loss=0.5585, val ΔE00=2.596, best=2.596]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:33<05:21,  5.95s/it, train loss=0.5457, val ΔE00=2.828, best=2.596]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:39<05:14,  5.94s/it, train loss=0.5457, val ΔE00=2.828, best=2.596]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:39<05:14,  5.94s/it, train loss=0.5431, val ΔE00=2.662, best=2.596]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:45<05:08,  5.93s/it, train loss=0.5431, val ΔE00=2.662, best=2.596]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:45<05:08,  5.93s/it, train loss=0.5540, val ΔE00=2.774, best=2.596]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:50<05:01,  5.92s/it, train loss=0.5540, val ΔE00=2.774, best=2.596]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:50<05:01,  5.92s/it, train loss=0.4831, val ΔE00=2.434, best=2.434]Training (xattn/resnet18):  50%|█████     | 50/100 [04:56<04:57,  5.94s/it, train loss=0.4831, val ΔE00=2.434, best=2.434]Training (xattn/resnet18):  50%|█████     | 50/100 [04:56<04:57,  5.94s/it, train loss=0.5332, val ΔE00=2.652, best=2.434]Training (xattn/resnet18):  51%|█████     | 51/100 [05:02<04:51,  5.94s/it, train loss=0.5332, val ΔE00=2.652, best=2.434]Training (xattn/resnet18):  51%|█████     | 51/100 [05:02<04:51,  5.94s/it, train loss=0.5092, val ΔE00=2.702, best=2.434]Training (xattn/resnet18):  52%|█████▏    | 52/100 [05:08<04:44,  5.93s/it, train loss=0.5092, val ΔE00=2.702, best=2.434]Training (xattn/resnet18):  52%|█████▏    | 52/100 [05:08<04:44,  5.93s/it, train loss=0.5906, val ΔE00=2.568, best=2.434]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:14<04:37,  5.90s/it, train loss=0.5906, val ΔE00=2.568, best=2.434]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:14<04:37,  5.90s/it, train loss=0.5241, val ΔE00=2.916, best=2.434]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:20<04:30,  5.88s/it, train loss=0.5241, val ΔE00=2.916, best=2.434]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:20<04:30,  5.88s/it, train loss=0.5651, val ΔE00=2.731, best=2.434]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:26<04:27,  5.95s/it, train loss=0.5651, val ΔE00=2.731, best=2.434]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:26<04:27,  5.95s/it, train loss=0.5351, val ΔE00=2.773, best=2.434]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:32<04:21,  5.95s/it, train loss=0.5351, val ΔE00=2.773, best=2.434]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:32<04:21,  5.95s/it, train loss=0.5739, val ΔE00=2.666, best=2.434]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:38<04:15,  5.94s/it, train loss=0.5739, val ΔE00=2.666, best=2.434]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:38<04:15,  5.94s/it, train loss=0.5838, val ΔE00=2.815, best=2.434]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:44<04:09,  5.93s/it, train loss=0.5838, val ΔE00=2.815, best=2.434]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:44<04:09,  5.93s/it, train loss=0.6340, val ΔE00=2.654, best=2.434]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:50<04:09,  5.93s/it, train loss=0.5733, val ΔE00=2.523, early_stop=yes]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:50<04:13,  6.04s/it, train loss=0.5733, val ΔE00=2.523, early_stop=yes]
[early] stop at epoch 59 (best de00=2.4341 @ 49)
[done] best ΔE00=2.434 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/flair/full/xattn__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean+meta__meta_encoder=flair/final_summary.json (kind=val)
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/flair/full --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/flair/flair_full_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/flair/flair_full_summary_groups.csv --md_report /home/dominik/repo/results/results/flair/flair_full_summary_report.md --grid_keys backbone features meta_encoder model --prefer_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 12 checkpoint files and 12 json summaries.
[diag] loaded records by kind: {'val': 24}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/flair/flair_full_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/flair/flair_full_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/flair/flair_full_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/flair/flair_full_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/flair/flair_full_summary_report.md

[ELIMINATION CANDIDATES]
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/flair/full --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/flair/flair_full_pretest_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/flair/flair_full_pretest_summary_groups.csv --md_report /home/dominik/repo/results/results/flair/flair_full_pretest_summary_report.md --grid_keys backbone features meta_encoder model --prefer_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 12 checkpoint files and 12 json summaries.
[diag] loaded records by kind: {'val': 24}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/flair/flair_full_pretest_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/flair/flair_full_pretest_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/flair/flair_full_pretest_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/flair/flair_full_pretest_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/flair/flair_full_pretest_summary_report.md

[ELIMINATION CANDIDATES]
[eval] Selecting up to top_k=20 unique group winner(s) for TEST in FULL-only mode.
[eval][debug] winners (grouped): [{'model': 'film', 'backbone': 'resnet18', 'features': 'image+mean+meta', 'meta_encoder': 'flair'}, {'model': 'film', 'backbone': 'resnet18', 'features': 'image+meta', 'meta_encoder': 'flair'}, {'model': 'late', 'backbone': 'resnet18', 'features': 'image+mean+meta', 'meta_encoder': 'flair'}, {'model': 'late', 'backbone': 'resnet18', 'features': 'image+meta', 'meta_encoder': 'flair'}, {'model': 'xattn', 'backbone': 'smallcnn', 'features': 'image+mean+meta', 'meta_encoder': 'flair'}, {'model': 'xattn', 'backbone': 'smallcnn', 'features': 'image+meta', 'meta_encoder': 'flair'}, {'model': 'film', 'backbone': 'smallcnn', 'features': 'image+mean+meta', 'meta_encoder': 'flair'}, {'model': 'film', 'backbone': 'smallcnn', 'features': 'image+meta', 'meta_encoder': 'flair'}, {'model': 'xattn', 'backbone': 'resnet18', 'features': 'image+mean+meta', 'meta_encoder': 'flair'}, {'model': 'xattn', 'backbone': 'resnet18', 'features': 'image+meta', 'meta_encoder': 'flair'}, {'model': 'late', 'backbone': 'smallcnn', 'features': 'image+mean+meta', 'meta_encoder': 'flair'}, {'model': 'late', 'backbone': 'smallcnn', 'features': 'image+meta', 'meta_encoder': 'flair'}]
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/film__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+mean+meta__meta_encoder=flair/film_resnet18_e055_de002.0866.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/4ea18928ca62/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/film__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+meta__meta_encoder=flair/film_resnet18_e055_de002.0866.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/694c395e66f5/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/late__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean+meta__meta_encoder=flair/late_resnet18_e032_de002.1634.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/fcacf90b26b8/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/late__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+meta__meta_encoder=flair/late_resnet18_e032_de002.1634.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/c429cd01ee31/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/xattn__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+mean+meta__meta_encoder=flair/xattn_smallcnn_e064_de002.2751.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/8cf3a3dc3541/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/xattn__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+meta__meta_encoder=flair/xattn_smallcnn_e064_de002.2751.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/b14ca8d172fa/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/film__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean+meta__meta_encoder=flair/film_smallcnn_e052_de002.3076.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/938986b9947c/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/film__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+meta__meta_encoder=flair/film_smallcnn_e052_de002.3076.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/f849949b3902/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/xattn__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean+meta__meta_encoder=flair/xattn_resnet18_e049_de002.4341.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/311bdd58d501/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/xattn__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+meta__meta_encoder=flair/xattn_resnet18_e049_de002.4341.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/9f63ecad378b/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/late__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean+meta__meta_encoder=flair/late_smallcnn_e054_de002.4694.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/6a1d681c114c/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/flair/full/late__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+meta__meta_encoder=flair/late_smallcnn_e054_de002.4694.pt --images_dir /home/data/Pantone/cropped-merged-256 --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/flair/full/final_test/07d387471daa/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] winners(full-only): ok=0 fail=12
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/flair/full --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/flair/flair_single_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/flair/flair_single_summary_groups.csv --md_report /home/dominik/repo/results/results/flair/flair_single_summary_report.md --grid_keys backbone features meta_encoder model --prefer_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 12 checkpoint files and 12 json summaries.
[diag] loaded records by kind: {'val': 24}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/flair/flair_single_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/flair/flair_single_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/flair/flair_single_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/flair/flair_single_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/flair/flair_single_summary_report.md

[ELIMINATION CANDIDATES]
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/flair/full ./checkpoints/results/flair/full/final_test --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/flair/flair_test_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/flair/flair_test_summary_groups.csv --md_report /home/dominik/repo/results/results/flair/flair_test_summary_report.md --grid_keys backbone features meta_encoder model --prefer_test --only_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 12 checkpoint files and 12 json summaries.
[diag] loaded records by kind: {'val': 24}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/flair/flair_test_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/flair/flair_test_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/flair/flair_test_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/flair/flair_test_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/flair/flair_test_summary_report.md

[ELIMINATION CANDIDATES]
[analysis] runs_csv=/home/dominik/repo/results/results/flair/analysis/analysis_input.csv
[analysis] mode=both test_split_file=./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json outdir=/home/dominik/repo/results/results/flair/analysis
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
/home/dominik/venvs/pantone-cu121/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/eb637a52272c/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/eb637a52272c/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/8f48f112652c/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/8f48f112652c/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/b141d966b043/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/b141d966b043/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/9db6d2bd81ac/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/9db6d2bd81ac/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/7e1c63219fb6/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/7e1c63219fb6/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/269218e71065/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/269218e71065/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/626f9a9d39b8/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/626f9a9d39b8/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/134b36a4f4f1/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/134b36a4f4f1/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/93f507c0dd7f/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/93f507c0dd7f/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/972608a1fc6b/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/972608a1fc6b/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/32097e4f1d2a/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/32097e4f1d2a/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/c37ba9cd41d5/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/flair/analysis/c37ba9cd41d5/test_report.html
[ok] Wrote manifest: /home/dominik/repo/results/results/flair/analysis/analysis_manifest.csv
[sweep] FULL-only mode complete.
[sweep] OK: ./configs/results/flair.yaml

