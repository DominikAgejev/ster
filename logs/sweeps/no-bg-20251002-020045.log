[sweep] === ./configs/results/no-bg.yaml ===
[sweep] cmd: python [sweep] cmd: -u [sweep] cmd: -m [sweep] cmd: src.engine.sweep [sweep] cmd: --config [sweep] cmd: ./configs/results/no-bg.yaml [sweep] cmd: --only_full [sweep] cmd: --auto-summary [sweep] cmd: --analysis [sweep] cmd: --eval-winners [sweep] cmd: --test_split_file [sweep] cmd: AUTO [sweep] cmd: --skip-existing 
[sweep] FULL-only mode: training full stage for all runs.
[sweep] === Run 1/24 ===
[sweep] id=001_model=late__backbone=smallcnn__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone smallcnn --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:04<08:11,  4.97s/it]Training (late/smallcnn):   1%|          | 1/100 [00:04<08:11,  4.97s/it, train loss=0.0074, val ΔE00=7.396, best=7.396]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:37,  4.67s/it, train loss=0.0074, val ΔE00=7.396, best=7.396]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:37,  4.67s/it, train loss=0.0082, val ΔE00=6.167, best=6.167]Training (late/smallcnn):   3%|▎         | 3/100 [00:13<07:24,  4.58s/it, train loss=0.0082, val ΔE00=6.167, best=6.167]Training (late/smallcnn):   3%|▎         | 3/100 [00:13<07:24,  4.58s/it, train loss=0.0154, val ΔE00=5.838, best=5.838]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:15,  4.54s/it, train loss=0.0154, val ΔE00=5.838, best=5.838]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:15,  4.54s/it, train loss=0.0261, val ΔE00=5.283, best=5.283]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:15,  4.59s/it, train loss=0.0261, val ΔE00=5.283, best=5.283]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:15,  4.59s/it, train loss=0.0391, val ΔE00=7.269, best=5.283]Training (late/smallcnn):   6%|▌         | 6/100 [00:27<07:11,  4.59s/it, train loss=0.0391, val ΔE00=7.269, best=5.283]Training (late/smallcnn):   6%|▌         | 6/100 [00:27<07:11,  4.59s/it, train loss=0.0572, val ΔE00=5.329, best=5.283]Training (late/smallcnn):   7%|▋         | 7/100 [00:32<07:03,  4.55s/it, train loss=0.0572, val ΔE00=5.329, best=5.283]Training (late/smallcnn):   7%|▋         | 7/100 [00:32<07:03,  4.55s/it, train loss=0.0765, val ΔE00=4.875, best=4.875]Training (late/smallcnn):   8%|▊         | 8/100 [00:36<06:55,  4.52s/it, train loss=0.0765, val ΔE00=4.875, best=4.875]Training (late/smallcnn):   8%|▊         | 8/100 [00:36<06:55,  4.52s/it, train loss=0.1042, val ΔE00=5.578, best=4.875]Training (late/smallcnn):   9%|▉         | 9/100 [00:41<06:50,  4.51s/it, train loss=0.1042, val ΔE00=5.578, best=4.875]Training (late/smallcnn):   9%|▉         | 9/100 [00:41<06:50,  4.51s/it, train loss=0.1313, val ΔE00=4.679, best=4.679]Training (late/smallcnn):  10%|█         | 10/100 [00:45<06:49,  4.56s/it, train loss=0.1313, val ΔE00=4.679, best=4.679]Training (late/smallcnn):  10%|█         | 10/100 [00:45<06:49,  4.56s/it, train loss=0.1578, val ΔE00=4.500, best=4.500]Training (late/smallcnn):  11%|█         | 11/100 [00:50<06:46,  4.57s/it, train loss=0.1578, val ΔE00=4.500, best=4.500]Training (late/smallcnn):  11%|█         | 11/100 [00:50<06:46,  4.57s/it, train loss=0.1911, val ΔE00=5.740, best=4.500]Training (late/smallcnn):  12%|█▏        | 12/100 [00:54<06:38,  4.53s/it, train loss=0.1911, val ΔE00=5.740, best=4.500]Training (late/smallcnn):  12%|█▏        | 12/100 [00:54<06:38,  4.53s/it, train loss=0.2315, val ΔE00=4.605, best=4.500]Training (late/smallcnn):  13%|█▎        | 13/100 [00:59<06:32,  4.51s/it, train loss=0.2315, val ΔE00=4.605, best=4.500]Training (late/smallcnn):  13%|█▎        | 13/100 [00:59<06:32,  4.51s/it, train loss=0.2571, val ΔE00=5.370, best=4.500]Training (late/smallcnn):  14%|█▍        | 14/100 [01:03<06:26,  4.50s/it, train loss=0.2571, val ΔE00=5.370, best=4.500]Training (late/smallcnn):  14%|█▍        | 14/100 [01:03<06:26,  4.50s/it, train loss=0.3042, val ΔE00=4.695, best=4.500]Training (late/smallcnn):  15%|█▌        | 15/100 [01:08<06:26,  4.55s/it, train loss=0.3042, val ΔE00=4.695, best=4.500]Training (late/smallcnn):  15%|█▌        | 15/100 [01:08<06:26,  4.55s/it, train loss=0.3463, val ΔE00=4.557, best=4.500]Training (late/smallcnn):  16%|█▌        | 16/100 [01:12<06:23,  4.56s/it, train loss=0.3463, val ΔE00=4.557, best=4.500]Training (late/smallcnn):  16%|█▌        | 16/100 [01:12<06:23,  4.56s/it, train loss=0.3824, val ΔE00=4.124, best=4.124]Training (late/smallcnn):  17%|█▋        | 17/100 [01:17<06:16,  4.53s/it, train loss=0.3824, val ΔE00=4.124, best=4.124]Training (late/smallcnn):  17%|█▋        | 17/100 [01:17<06:16,  4.53s/it, train loss=0.4479, val ΔE00=4.654, best=4.124]Training (late/smallcnn):  18%|█▊        | 18/100 [01:21<06:10,  4.51s/it, train loss=0.4479, val ΔE00=4.654, best=4.124]Training (late/smallcnn):  18%|█▊        | 18/100 [01:21<06:10,  4.51s/it, train loss=0.4733, val ΔE00=4.627, best=4.124]Training (late/smallcnn):  19%|█▉        | 19/100 [01:26<06:04,  4.50s/it, train loss=0.4733, val ΔE00=4.627, best=4.124]Training (late/smallcnn):  19%|█▉        | 19/100 [01:26<06:04,  4.50s/it, train loss=0.5329, val ΔE00=3.975, best=3.975]Training (late/smallcnn):  20%|██        | 20/100 [01:31<06:03,  4.55s/it, train loss=0.5329, val ΔE00=3.975, best=3.975]Training (late/smallcnn):  20%|██        | 20/100 [01:31<06:03,  4.55s/it, train loss=0.6130, val ΔE00=5.109, best=3.975]Training (late/smallcnn):  21%|██        | 21/100 [01:35<06:00,  4.56s/it, train loss=0.6130, val ΔE00=5.109, best=3.975]Training (late/smallcnn):  21%|██        | 21/100 [01:35<06:00,  4.56s/it, train loss=0.6503, val ΔE00=4.509, best=3.975]Training (late/smallcnn):  22%|██▏       | 22/100 [01:40<05:53,  4.53s/it, train loss=0.6503, val ΔE00=4.509, best=3.975]Training (late/smallcnn):  22%|██▏       | 22/100 [01:40<05:53,  4.53s/it, train loss=0.7101, val ΔE00=4.171, best=3.975]Training (late/smallcnn):  23%|██▎       | 23/100 [01:44<05:47,  4.51s/it, train loss=0.7101, val ΔE00=4.171, best=3.975]Training (late/smallcnn):  23%|██▎       | 23/100 [01:44<05:47,  4.51s/it, train loss=0.7652, val ΔE00=4.535, best=3.975]Training (late/smallcnn):  24%|██▍       | 24/100 [01:48<05:41,  4.50s/it, train loss=0.7652, val ΔE00=4.535, best=3.975]Training (late/smallcnn):  24%|██▍       | 24/100 [01:48<05:41,  4.50s/it, train loss=0.8352, val ΔE00=4.741, best=3.975]Training (late/smallcnn):  25%|██▌       | 25/100 [01:53<05:41,  4.55s/it, train loss=0.8352, val ΔE00=4.741, best=3.975]Training (late/smallcnn):  25%|██▌       | 25/100 [01:53<05:41,  4.55s/it, train loss=0.8991, val ΔE00=4.061, best=3.975]Training (late/smallcnn):  26%|██▌       | 26/100 [01:58<05:37,  4.56s/it, train loss=0.8991, val ΔE00=4.061, best=3.975]Training (late/smallcnn):  26%|██▌       | 26/100 [01:58<05:37,  4.56s/it, train loss=0.9457, val ΔE00=4.113, best=3.975]Training (late/smallcnn):  27%|██▋       | 27/100 [02:02<05:30,  4.53s/it, train loss=0.9457, val ΔE00=4.113, best=3.975]Training (late/smallcnn):  27%|██▋       | 27/100 [02:02<05:30,  4.53s/it, train loss=1.0202, val ΔE00=4.272, best=3.975]Training (late/smallcnn):  28%|██▊       | 28/100 [02:07<05:24,  4.51s/it, train loss=1.0202, val ΔE00=4.272, best=3.975]Training (late/smallcnn):  28%|██▊       | 28/100 [02:07<05:24,  4.51s/it, train loss=1.0537, val ΔE00=4.386, best=3.975]Training (late/smallcnn):  29%|██▉       | 29/100 [02:11<05:19,  4.49s/it, train loss=1.0537, val ΔE00=4.386, best=3.975]Training (late/smallcnn):  29%|██▉       | 29/100 [02:11<05:19,  4.49s/it, train loss=1.1231, val ΔE00=4.072, best=3.975]Training (late/smallcnn):  30%|███       | 30/100 [02:16<05:19,  4.57s/it, train loss=1.1231, val ΔE00=4.072, best=3.975]Training (late/smallcnn):  30%|███       | 30/100 [02:16<05:19,  4.57s/it, train loss=1.2310, val ΔE00=4.069, best=3.975]Training (late/smallcnn):  31%|███       | 31/100 [02:20<05:14,  4.55s/it, train loss=1.2310, val ΔE00=4.069, best=3.975]Training (late/smallcnn):  31%|███       | 31/100 [02:20<05:14,  4.55s/it, train loss=1.3095, val ΔE00=4.467, best=3.975]Training (late/smallcnn):  32%|███▏      | 32/100 [02:25<05:08,  4.53s/it, train loss=1.3095, val ΔE00=4.467, best=3.975]Training (late/smallcnn):  32%|███▏      | 32/100 [02:25<05:08,  4.53s/it, train loss=1.3073, val ΔE00=3.781, best=3.781]Training (late/smallcnn):  33%|███▎      | 33/100 [02:29<05:02,  4.51s/it, train loss=1.3073, val ΔE00=3.781, best=3.781]Training (late/smallcnn):  33%|███▎      | 33/100 [02:29<05:02,  4.51s/it, train loss=1.3986, val ΔE00=3.936, best=3.781]Training (late/smallcnn):  34%|███▍      | 34/100 [02:34<04:57,  4.50s/it, train loss=1.3986, val ΔE00=3.936, best=3.781]Training (late/smallcnn):  34%|███▍      | 34/100 [02:34<04:57,  4.50s/it, train loss=1.4789, val ΔE00=3.842, best=3.781]Training (late/smallcnn):  35%|███▌      | 35/100 [02:38<04:56,  4.56s/it, train loss=1.4789, val ΔE00=3.842, best=3.781]Training (late/smallcnn):  35%|███▌      | 35/100 [02:38<04:56,  4.56s/it, train loss=1.5796, val ΔE00=4.405, best=3.781]Training (late/smallcnn):  36%|███▌      | 36/100 [02:43<04:51,  4.56s/it, train loss=1.5796, val ΔE00=4.405, best=3.781]Training (late/smallcnn):  36%|███▌      | 36/100 [02:43<04:51,  4.56s/it, train loss=1.6391, val ΔE00=4.640, best=3.781]Training (late/smallcnn):  37%|███▋      | 37/100 [02:48<04:45,  4.53s/it, train loss=1.6391, val ΔE00=4.640, best=3.781]Training (late/smallcnn):  37%|███▋      | 37/100 [02:48<04:45,  4.53s/it, train loss=1.7100, val ΔE00=4.069, best=3.781]Training (late/smallcnn):  38%|███▊      | 38/100 [02:52<04:39,  4.51s/it, train loss=1.7100, val ΔE00=4.069, best=3.781]Training (late/smallcnn):  38%|███▊      | 38/100 [02:52<04:39,  4.51s/it, train loss=1.7396, val ΔE00=4.132, best=3.781]Training (late/smallcnn):  39%|███▉      | 39/100 [02:56<04:34,  4.50s/it, train loss=1.7396, val ΔE00=4.132, best=3.781]Training (late/smallcnn):  39%|███▉      | 39/100 [02:56<04:34,  4.50s/it, train loss=1.8875, val ΔE00=3.907, best=3.781]Training (late/smallcnn):  40%|████      | 40/100 [03:01<04:32,  4.55s/it, train loss=1.8875, val ΔE00=3.907, best=3.781]Training (late/smallcnn):  40%|████      | 40/100 [03:01<04:32,  4.55s/it, train loss=1.9667, val ΔE00=4.632, best=3.781]Training (late/smallcnn):  41%|████      | 41/100 [03:06<04:29,  4.56s/it, train loss=1.9667, val ΔE00=4.632, best=3.781]Training (late/smallcnn):  41%|████      | 41/100 [03:06<04:29,  4.56s/it, train loss=2.0076, val ΔE00=3.822, best=3.781]Training (late/smallcnn):  42%|████▏     | 42/100 [03:10<04:22,  4.53s/it, train loss=2.0076, val ΔE00=3.822, best=3.781]Training (late/smallcnn):  42%|████▏     | 42/100 [03:10<04:22,  4.53s/it, train loss=2.1296, val ΔE00=4.259, best=3.781]Training (late/smallcnn):  43%|████▎     | 43/100 [03:15<04:17,  4.51s/it, train loss=2.1296, val ΔE00=4.259, best=3.781]Training (late/smallcnn):  43%|████▎     | 43/100 [03:15<04:17,  4.51s/it, train loss=2.1263, val ΔE00=3.915, best=3.781]Training (late/smallcnn):  44%|████▍     | 44/100 [03:19<04:11,  4.50s/it, train loss=2.1263, val ΔE00=3.915, best=3.781]Training (late/smallcnn):  44%|████▍     | 44/100 [03:19<04:11,  4.50s/it, train loss=2.1768, val ΔE00=4.362, best=3.781]Training (late/smallcnn):  45%|████▌     | 45/100 [03:24<04:10,  4.55s/it, train loss=2.1768, val ΔE00=4.362, best=3.781]Training (late/smallcnn):  45%|████▌     | 45/100 [03:24<04:10,  4.55s/it, train loss=2.2526, val ΔE00=4.131, best=3.781]Training (late/smallcnn):  46%|████▌     | 46/100 [03:28<04:06,  4.56s/it, train loss=2.2526, val ΔE00=4.131, best=3.781]Training (late/smallcnn):  46%|████▌     | 46/100 [03:28<04:06,  4.56s/it, train loss=2.3403, val ΔE00=3.772, best=3.772]Training (late/smallcnn):  47%|████▋     | 47/100 [03:33<04:00,  4.53s/it, train loss=2.3403, val ΔE00=3.772, best=3.772]Training (late/smallcnn):  47%|████▋     | 47/100 [03:33<04:00,  4.53s/it, train loss=2.4766, val ΔE00=3.990, best=3.772]Training (late/smallcnn):  48%|████▊     | 48/100 [03:37<03:54,  4.51s/it, train loss=2.4766, val ΔE00=3.990, best=3.772]Training (late/smallcnn):  48%|████▊     | 48/100 [03:37<03:54,  4.51s/it, train loss=2.4447, val ΔE00=3.955, best=3.772]Training (late/smallcnn):  49%|████▉     | 49/100 [03:42<03:49,  4.50s/it, train loss=2.4447, val ΔE00=3.955, best=3.772]Training (late/smallcnn):  49%|████▉     | 49/100 [03:42<03:49,  4.50s/it, train loss=2.5079, val ΔE00=4.310, best=3.772]Training (late/smallcnn):  50%|█████     | 50/100 [03:46<03:47,  4.56s/it, train loss=2.5079, val ΔE00=4.310, best=3.772]Training (late/smallcnn):  50%|█████     | 50/100 [03:46<03:47,  4.56s/it, train loss=2.5644, val ΔE00=4.077, best=3.772]Training (late/smallcnn):  51%|█████     | 51/100 [03:51<03:43,  4.57s/it, train loss=2.5644, val ΔE00=4.077, best=3.772]Training (late/smallcnn):  51%|█████     | 51/100 [03:51<03:43,  4.57s/it, train loss=2.6673, val ΔE00=3.629, best=3.629]Training (late/smallcnn):  52%|█████▏    | 52/100 [03:55<03:37,  4.53s/it, train loss=2.6673, val ΔE00=3.629, best=3.629]Training (late/smallcnn):  52%|█████▏    | 52/100 [03:55<03:37,  4.53s/it, train loss=2.6912, val ΔE00=3.653, best=3.629]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:00<03:32,  4.51s/it, train loss=2.6912, val ΔE00=3.653, best=3.629]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:00<03:32,  4.51s/it, train loss=2.6639, val ΔE00=4.018, best=3.629]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:04<03:26,  4.50s/it, train loss=2.6639, val ΔE00=4.018, best=3.629]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:04<03:26,  4.50s/it, train loss=2.8008, val ΔE00=3.851, best=3.629]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:09<03:25,  4.57s/it, train loss=2.8008, val ΔE00=3.851, best=3.629]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:09<03:25,  4.57s/it, train loss=2.8749, val ΔE00=3.943, best=3.629]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:14<03:20,  4.56s/it, train loss=2.8749, val ΔE00=3.943, best=3.629]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:14<03:20,  4.56s/it, train loss=2.9241, val ΔE00=4.190, best=3.629]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:18<03:14,  4.53s/it, train loss=2.9241, val ΔE00=4.190, best=3.629]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:18<03:14,  4.53s/it, train loss=2.9401, val ΔE00=3.719, best=3.629]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:23<03:09,  4.51s/it, train loss=2.9401, val ΔE00=3.719, best=3.629]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:23<03:09,  4.51s/it, train loss=3.0045, val ΔE00=3.927, best=3.629]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:27<03:04,  4.49s/it, train loss=3.0045, val ΔE00=3.927, best=3.629]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:27<03:04,  4.49s/it, train loss=3.1384, val ΔE00=3.947, best=3.629]Training (late/smallcnn):  60%|██████    | 60/100 [04:32<03:01,  4.55s/it, train loss=3.1384, val ΔE00=3.947, best=3.629]Training (late/smallcnn):  60%|██████    | 60/100 [04:32<03:01,  4.55s/it, train loss=3.1881, val ΔE00=4.548, best=3.629]Training (late/smallcnn):  60%|██████    | 60/100 [04:36<03:01,  4.55s/it, train loss=3.2596, val ΔE00=4.031, early_stop=yes]Training (late/smallcnn):  60%|██████    | 60/100 [04:36<03:04,  4.61s/it, train loss=3.2596, val ΔE00=4.031, early_stop=yes]
[early] stop at epoch 61 (best de00=3.6294 @ 51)
[done] best ΔE00=3.629 over 61 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/late__smallcnn__image__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image/final_summary.json (kind=val)
[sweep] === Run 2/24 ===
[sweep] id=002_model=late__backbone=smallcnn__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone smallcnn --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image+mean, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:27,  5.12s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:27,  5.12s/it, train loss=0.0075, val ΔE00=6.218, best=6.218]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:53,  4.83s/it, train loss=0.0075, val ΔE00=6.218, best=6.218]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:53,  4.83s/it, train loss=0.0082, val ΔE00=5.694, best=5.694]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:39,  4.73s/it, train loss=0.0082, val ΔE00=5.694, best=5.694]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:39,  4.73s/it, train loss=0.0151, val ΔE00=4.928, best=4.928]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:30,  4.69s/it, train loss=0.0151, val ΔE00=4.928, best=4.928]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:30,  4.69s/it, train loss=0.0247, val ΔE00=5.000, best=4.928]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:32,  4.76s/it, train loss=0.0247, val ΔE00=5.000, best=4.928]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:32,  4.76s/it, train loss=0.0395, val ΔE00=5.119, best=4.928]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:26,  4.75s/it, train loss=0.0395, val ΔE00=5.119, best=4.928]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:26,  4.75s/it, train loss=0.0573, val ΔE00=5.107, best=4.928]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:17,  4.71s/it, train loss=0.0573, val ΔE00=5.107, best=4.928]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:17,  4.71s/it, train loss=0.0777, val ΔE00=5.068, best=4.928]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:10,  4.68s/it, train loss=0.0777, val ΔE00=5.068, best=4.928]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:10,  4.68s/it, train loss=0.0991, val ΔE00=5.068, best=4.928]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:04,  4.66s/it, train loss=0.0991, val ΔE00=5.068, best=4.928]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:04,  4.66s/it, train loss=0.1284, val ΔE00=5.410, best=4.928]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.72s/it, train loss=0.1284, val ΔE00=5.410, best=4.928]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.72s/it, train loss=0.1633, val ΔE00=4.815, best=4.815]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:01,  4.73s/it, train loss=0.1633, val ΔE00=4.815, best=4.815]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:01,  4.73s/it, train loss=0.1877, val ΔE00=4.735, best=4.735]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:53,  4.70s/it, train loss=0.1877, val ΔE00=4.735, best=4.735]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:53,  4.70s/it, train loss=0.2197, val ΔE00=4.587, best=4.587]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:47,  4.68s/it, train loss=0.2197, val ΔE00=4.587, best=4.587]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:47,  4.68s/it, train loss=0.2567, val ΔE00=4.244, best=4.244]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:40,  4.66s/it, train loss=0.2567, val ΔE00=4.244, best=4.244]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:40,  4.66s/it, train loss=0.2907, val ΔE00=4.093, best=4.093]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:40,  4.72s/it, train loss=0.2907, val ΔE00=4.093, best=4.093]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:40,  4.72s/it, train loss=0.3301, val ΔE00=4.152, best=4.093]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:36,  4.73s/it, train loss=0.3301, val ΔE00=4.152, best=4.093]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:36,  4.73s/it, train loss=0.3809, val ΔE00=3.943, best=3.943]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:29,  4.69s/it, train loss=0.3809, val ΔE00=3.943, best=3.943]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:29,  4.69s/it, train loss=0.4206, val ΔE00=4.431, best=3.943]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:22,  4.67s/it, train loss=0.4206, val ΔE00=4.431, best=3.943]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:22,  4.67s/it, train loss=0.4839, val ΔE00=3.873, best=3.873]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:16,  4.65s/it, train loss=0.4839, val ΔE00=3.873, best=3.873]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:16,  4.65s/it, train loss=0.5292, val ΔE00=4.026, best=3.873]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:16,  4.71s/it, train loss=0.5292, val ΔE00=4.026, best=3.873]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:16,  4.71s/it, train loss=0.5842, val ΔE00=4.014, best=3.873]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:12,  4.72s/it, train loss=0.5842, val ΔE00=4.014, best=3.873]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:12,  4.72s/it, train loss=0.6308, val ΔE00=3.969, best=3.873]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:06,  4.70s/it, train loss=0.6308, val ΔE00=3.969, best=3.873]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:06,  4.70s/it, train loss=0.6900, val ΔE00=4.281, best=3.873]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<06:00,  4.68s/it, train loss=0.6900, val ΔE00=4.281, best=3.873]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<06:00,  4.68s/it, train loss=0.7462, val ΔE00=3.962, best=3.873]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:54,  4.66s/it, train loss=0.7462, val ΔE00=3.962, best=3.873]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:54,  4.66s/it, train loss=0.8144, val ΔE00=4.281, best=3.873]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:53,  4.71s/it, train loss=0.8144, val ΔE00=4.281, best=3.873]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:53,  4.71s/it, train loss=0.8747, val ΔE00=4.951, best=3.873]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:49,  4.72s/it, train loss=0.8747, val ΔE00=4.951, best=3.873]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:49,  4.72s/it, train loss=0.9340, val ΔE00=4.183, best=3.873]Training (late/smallcnn):  27%|██▋       | 27/100 [02:07<05:42,  4.69s/it, train loss=0.9340, val ΔE00=4.183, best=3.873]Training (late/smallcnn):  27%|██▋       | 27/100 [02:07<05:42,  4.69s/it, train loss=1.0069, val ΔE00=4.277, best=3.873]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:36,  4.67s/it, train loss=1.0069, val ΔE00=4.277, best=3.873]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:36,  4.67s/it, train loss=1.0574, val ΔE00=3.857, best=3.857]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:30,  4.66s/it, train loss=1.0574, val ΔE00=3.857, best=3.857]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:30,  4.66s/it, train loss=1.1175, val ΔE00=4.034, best=3.857]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:30,  4.71s/it, train loss=1.1175, val ΔE00=4.034, best=3.857]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:30,  4.71s/it, train loss=1.2218, val ΔE00=4.238, best=3.857]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:25,  4.72s/it, train loss=1.2218, val ΔE00=4.238, best=3.857]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:25,  4.72s/it, train loss=1.2618, val ΔE00=4.241, best=3.857]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:18,  4.69s/it, train loss=1.2618, val ΔE00=4.241, best=3.857]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:18,  4.69s/it, train loss=1.3549, val ΔE00=4.114, best=3.857]Training (late/smallcnn):  33%|███▎      | 33/100 [02:35<05:13,  4.67s/it, train loss=1.3549, val ΔE00=4.114, best=3.857]Training (late/smallcnn):  33%|███▎      | 33/100 [02:35<05:13,  4.67s/it, train loss=1.4069, val ΔE00=4.270, best=3.857]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:07,  4.66s/it, train loss=1.4069, val ΔE00=4.270, best=3.857]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:07,  4.66s/it, train loss=1.4533, val ΔE00=3.848, best=3.848]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:06,  4.72s/it, train loss=1.4533, val ΔE00=3.848, best=3.848]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:06,  4.72s/it, train loss=1.4833, val ΔE00=4.110, best=3.848]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:02,  4.73s/it, train loss=1.4833, val ΔE00=4.110, best=3.848]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:02,  4.73s/it, train loss=1.5784, val ΔE00=4.084, best=3.848]Training (late/smallcnn):  37%|███▋      | 37/100 [02:54<04:56,  4.70s/it, train loss=1.5784, val ΔE00=4.084, best=3.848]Training (late/smallcnn):  37%|███▋      | 37/100 [02:54<04:56,  4.70s/it, train loss=1.7136, val ΔE00=3.872, best=3.848]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:50,  4.68s/it, train loss=1.7136, val ΔE00=3.872, best=3.848]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:50,  4.68s/it, train loss=1.7047, val ΔE00=4.113, best=3.848]Training (late/smallcnn):  39%|███▉      | 39/100 [03:03<04:44,  4.67s/it, train loss=1.7047, val ΔE00=4.113, best=3.848]Training (late/smallcnn):  39%|███▉      | 39/100 [03:03<04:44,  4.67s/it, train loss=1.7927, val ΔE00=5.257, best=3.848]Training (late/smallcnn):  40%|████      | 40/100 [03:08<04:43,  4.72s/it, train loss=1.7927, val ΔE00=5.257, best=3.848]Training (late/smallcnn):  40%|████      | 40/100 [03:08<04:43,  4.72s/it, train loss=1.9044, val ΔE00=4.108, best=3.848]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:39,  4.73s/it, train loss=1.9044, val ΔE00=4.108, best=3.848]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:39,  4.73s/it, train loss=1.8891, val ΔE00=4.159, best=3.848]Training (late/smallcnn):  42%|████▏     | 42/100 [03:17<04:32,  4.70s/it, train loss=1.8891, val ΔE00=4.159, best=3.848]Training (late/smallcnn):  42%|████▏     | 42/100 [03:17<04:32,  4.70s/it, train loss=1.9927, val ΔE00=4.181, best=3.848]Training (late/smallcnn):  43%|████▎     | 43/100 [03:22<04:26,  4.67s/it, train loss=1.9927, val ΔE00=4.181, best=3.848]Training (late/smallcnn):  43%|████▎     | 43/100 [03:22<04:26,  4.67s/it, train loss=2.0504, val ΔE00=3.940, best=3.848]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.66s/it, train loss=2.0504, val ΔE00=3.940, best=3.848]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.66s/it, train loss=2.0902, val ΔE00=3.685, best=3.685]Training (late/smallcnn):  45%|████▌     | 45/100 [03:31<04:19,  4.72s/it, train loss=2.0902, val ΔE00=3.685, best=3.685]Training (late/smallcnn):  45%|████▌     | 45/100 [03:31<04:19,  4.72s/it, train loss=2.1322, val ΔE00=3.961, best=3.685]Training (late/smallcnn):  46%|████▌     | 46/100 [03:36<04:14,  4.72s/it, train loss=2.1322, val ΔE00=3.961, best=3.685]Training (late/smallcnn):  46%|████▌     | 46/100 [03:36<04:14,  4.72s/it, train loss=2.2316, val ΔE00=4.507, best=3.685]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.69s/it, train loss=2.2316, val ΔE00=4.507, best=3.685]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.69s/it, train loss=2.2955, val ΔE00=3.837, best=3.685]Training (late/smallcnn):  48%|████▊     | 48/100 [03:45<04:03,  4.67s/it, train loss=2.2955, val ΔE00=3.837, best=3.685]Training (late/smallcnn):  48%|████▊     | 48/100 [03:45<04:03,  4.67s/it, train loss=2.4716, val ΔE00=4.556, best=3.685]Training (late/smallcnn):  49%|████▉     | 49/100 [03:50<03:57,  4.66s/it, train loss=2.4716, val ΔE00=4.556, best=3.685]Training (late/smallcnn):  49%|████▉     | 49/100 [03:50<03:57,  4.66s/it, train loss=2.4660, val ΔE00=4.262, best=3.685]Training (late/smallcnn):  50%|█████     | 50/100 [03:55<03:55,  4.72s/it, train loss=2.4660, val ΔE00=4.262, best=3.685]Training (late/smallcnn):  50%|█████     | 50/100 [03:55<03:55,  4.72s/it, train loss=2.4891, val ΔE00=4.320, best=3.685]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:51,  4.72s/it, train loss=2.4891, val ΔE00=4.320, best=3.685]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:51,  4.72s/it, train loss=2.5611, val ΔE00=4.088, best=3.685]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:04<03:45,  4.69s/it, train loss=2.5611, val ΔE00=4.088, best=3.685]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:04<03:45,  4.69s/it, train loss=2.5252, val ΔE00=3.827, best=3.685]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:09<03:39,  4.67s/it, train loss=2.5252, val ΔE00=3.827, best=3.685]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:09<03:39,  4.67s/it, train loss=2.7984, val ΔE00=4.782, best=3.685]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:13<03:33,  4.65s/it, train loss=2.7984, val ΔE00=4.782, best=3.685]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:13<03:33,  4.65s/it, train loss=2.7329, val ΔE00=4.103, best=3.685]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:18<03:31,  4.71s/it, train loss=2.7329, val ΔE00=4.103, best=3.685]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:18<03:31,  4.71s/it, train loss=2.7399, val ΔE00=3.780, best=3.685]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:23<03:27,  4.71s/it, train loss=2.7399, val ΔE00=3.780, best=3.685]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:23<03:27,  4.71s/it, train loss=2.8338, val ΔE00=4.451, best=3.685]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:21,  4.69s/it, train loss=2.8338, val ΔE00=4.451, best=3.685]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:21,  4.69s/it, train loss=2.9416, val ΔE00=3.793, best=3.685]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:32<03:15,  4.67s/it, train loss=2.9416, val ΔE00=3.793, best=3.685]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:32<03:15,  4.67s/it, train loss=2.8868, val ΔE00=4.050, best=3.685]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:37<03:15,  4.67s/it, train loss=2.8587, val ΔE00=3.990, early_stop=yes]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:37<03:20,  4.78s/it, train loss=2.8587, val ΔE00=3.990, early_stop=yes]
[early] stop at epoch 59 (best de00=3.6846 @ 44)
[done] best ΔE00=3.685 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/late__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 3/24 ===
[sweep] id=003_model=late__backbone=smallcnn__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone smallcnn --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image+meta, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:27,  5.13s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:27,  5.13s/it, train loss=0.0070, val ΔE00=6.720, best=6.720]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:54,  4.84s/it, train loss=0.0070, val ΔE00=6.720, best=6.720]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:54,  4.84s/it, train loss=0.0075, val ΔE00=5.758, best=5.758]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:39,  4.74s/it, train loss=0.0075, val ΔE00=5.758, best=5.758]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:39,  4.74s/it, train loss=0.0130, val ΔE00=4.910, best=4.910]Training (late/smallcnn):   4%|▍         | 4/100 [00:19<07:30,  4.69s/it, train loss=0.0130, val ΔE00=4.910, best=4.910]Training (late/smallcnn):   4%|▍         | 4/100 [00:19<07:30,  4.69s/it, train loss=0.0214, val ΔE00=5.645, best=4.910]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:31,  4.75s/it, train loss=0.0214, val ΔE00=5.645, best=4.910]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:31,  4.75s/it, train loss=0.0330, val ΔE00=3.794, best=3.794]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:25,  4.74s/it, train loss=0.0330, val ΔE00=3.794, best=3.794]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:25,  4.74s/it, train loss=0.0468, val ΔE00=3.499, best=3.499]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:17,  4.70s/it, train loss=0.0468, val ΔE00=3.499, best=3.499]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:17,  4.70s/it, train loss=0.0628, val ΔE00=4.137, best=3.499]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:10,  4.68s/it, train loss=0.0628, val ΔE00=4.137, best=3.499]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:10,  4.68s/it, train loss=0.0797, val ΔE00=3.611, best=3.499]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:04,  4.66s/it, train loss=0.0797, val ΔE00=3.611, best=3.499]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:04,  4.66s/it, train loss=0.0974, val ΔE00=3.185, best=3.185]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.72s/it, train loss=0.0974, val ΔE00=3.185, best=3.185]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.72s/it, train loss=0.1235, val ΔE00=3.393, best=3.185]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:00,  4.73s/it, train loss=0.1235, val ΔE00=3.393, best=3.185]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:00,  4.73s/it, train loss=0.1402, val ΔE00=3.207, best=3.185]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:52,  4.69s/it, train loss=0.1402, val ΔE00=3.207, best=3.185]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:52,  4.69s/it, train loss=0.1649, val ΔE00=3.490, best=3.185]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:46,  4.67s/it, train loss=0.1649, val ΔE00=3.490, best=3.185]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:46,  4.67s/it, train loss=0.1934, val ΔE00=4.601, best=3.185]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:40,  4.65s/it, train loss=0.1934, val ΔE00=4.601, best=3.185]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:40,  4.65s/it, train loss=0.2215, val ΔE00=2.733, best=2.733]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:40,  4.71s/it, train loss=0.2215, val ΔE00=2.733, best=2.733]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:40,  4.71s/it, train loss=0.2467, val ΔE00=3.011, best=2.733]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:35,  4.71s/it, train loss=0.2467, val ΔE00=3.011, best=2.733]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:35,  4.71s/it, train loss=0.2720, val ΔE00=3.132, best=2.733]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:28,  4.69s/it, train loss=0.2720, val ΔE00=3.132, best=2.733]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:28,  4.69s/it, train loss=0.3269, val ΔE00=2.870, best=2.733]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:22,  4.67s/it, train loss=0.3269, val ΔE00=2.870, best=2.733]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:22,  4.67s/it, train loss=0.3528, val ΔE00=3.376, best=2.733]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:16,  4.65s/it, train loss=0.3528, val ΔE00=3.376, best=2.733]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:16,  4.65s/it, train loss=0.3864, val ΔE00=2.789, best=2.733]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:16,  4.70s/it, train loss=0.3864, val ΔE00=2.789, best=2.733]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:16,  4.70s/it, train loss=0.4320, val ΔE00=2.692, best=2.692]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:12,  4.72s/it, train loss=0.4320, val ΔE00=2.692, best=2.692]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:12,  4.72s/it, train loss=0.4580, val ΔE00=2.648, best=2.648]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:05,  4.69s/it, train loss=0.4580, val ΔE00=2.648, best=2.648]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:05,  4.69s/it, train loss=0.4907, val ΔE00=2.520, best=2.520]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<05:59,  4.67s/it, train loss=0.4907, val ΔE00=2.520, best=2.520]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<05:59,  4.67s/it, train loss=0.5339, val ΔE00=2.770, best=2.520]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:53,  4.65s/it, train loss=0.5339, val ΔE00=2.770, best=2.520]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:53,  4.65s/it, train loss=0.5684, val ΔE00=2.594, best=2.520]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:52,  4.70s/it, train loss=0.5684, val ΔE00=2.594, best=2.520]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:52,  4.70s/it, train loss=0.6176, val ΔE00=2.550, best=2.520]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:48,  4.71s/it, train loss=0.6176, val ΔE00=2.550, best=2.520]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:48,  4.71s/it, train loss=0.6750, val ΔE00=2.437, best=2.437]Training (late/smallcnn):  27%|██▋       | 27/100 [02:06<05:41,  4.68s/it, train loss=0.6750, val ΔE00=2.437, best=2.437]Training (late/smallcnn):  27%|██▋       | 27/100 [02:06<05:41,  4.68s/it, train loss=0.7359, val ΔE00=2.398, best=2.398]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:35,  4.66s/it, train loss=0.7359, val ΔE00=2.398, best=2.398]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:35,  4.66s/it, train loss=0.7891, val ΔE00=3.292, best=2.398]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:30,  4.65s/it, train loss=0.7891, val ΔE00=3.292, best=2.398]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:30,  4.65s/it, train loss=0.8186, val ΔE00=2.555, best=2.398]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:29,  4.70s/it, train loss=0.8186, val ΔE00=2.555, best=2.398]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:29,  4.70s/it, train loss=0.8190, val ΔE00=2.969, best=2.398]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:25,  4.71s/it, train loss=0.8190, val ΔE00=2.969, best=2.398]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:25,  4.71s/it, train loss=0.8924, val ΔE00=2.674, best=2.398]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:18,  4.68s/it, train loss=0.8924, val ΔE00=2.674, best=2.398]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:18,  4.68s/it, train loss=0.9320, val ΔE00=2.895, best=2.398]Training (late/smallcnn):  33%|███▎      | 33/100 [02:34<05:12,  4.66s/it, train loss=0.9320, val ΔE00=2.895, best=2.398]Training (late/smallcnn):  33%|███▎      | 33/100 [02:34<05:12,  4.66s/it, train loss=1.0142, val ΔE00=2.498, best=2.398]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:06,  4.64s/it, train loss=1.0142, val ΔE00=2.498, best=2.398]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:06,  4.64s/it, train loss=1.0431, val ΔE00=2.711, best=2.398]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:05,  4.70s/it, train loss=1.0431, val ΔE00=2.711, best=2.398]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:05,  4.70s/it, train loss=1.0830, val ΔE00=2.500, best=2.398]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:01,  4.71s/it, train loss=1.0830, val ΔE00=2.500, best=2.398]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:01,  4.71s/it, train loss=1.1271, val ΔE00=2.643, best=2.398]Training (late/smallcnn):  37%|███▋      | 37/100 [02:53<04:54,  4.68s/it, train loss=1.1271, val ΔE00=2.643, best=2.398]Training (late/smallcnn):  37%|███▋      | 37/100 [02:53<04:54,  4.68s/it, train loss=1.1966, val ΔE00=2.674, best=2.398]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:49,  4.66s/it, train loss=1.1966, val ΔE00=2.674, best=2.398]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:49,  4.66s/it, train loss=1.2204, val ΔE00=2.496, best=2.398]Training (late/smallcnn):  39%|███▉      | 39/100 [03:02<04:43,  4.65s/it, train loss=1.2204, val ΔE00=2.496, best=2.398]Training (late/smallcnn):  39%|███▉      | 39/100 [03:02<04:43,  4.65s/it, train loss=1.2791, val ΔE00=2.627, best=2.398]Training (late/smallcnn):  40%|████      | 40/100 [03:07<04:42,  4.71s/it, train loss=1.2791, val ΔE00=2.627, best=2.398]Training (late/smallcnn):  40%|████      | 40/100 [03:07<04:42,  4.71s/it, train loss=1.4162, val ΔE00=2.642, best=2.398]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:38,  4.71s/it, train loss=1.4162, val ΔE00=2.642, best=2.398]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:38,  4.71s/it, train loss=1.3572, val ΔE00=2.671, best=2.398]Training (late/smallcnn):  42%|████▏     | 42/100 [03:17<04:31,  4.68s/it, train loss=1.3572, val ΔE00=2.671, best=2.398]Training (late/smallcnn):  42%|████▏     | 42/100 [03:17<04:31,  4.68s/it, train loss=1.4195, val ΔE00=2.479, best=2.398]Training (late/smallcnn):  43%|████▎     | 43/100 [03:21<04:25,  4.66s/it, train loss=1.4195, val ΔE00=2.479, best=2.398]Training (late/smallcnn):  43%|████▎     | 43/100 [03:21<04:25,  4.66s/it, train loss=1.4463, val ΔE00=2.551, best=2.398]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.65s/it, train loss=1.4463, val ΔE00=2.551, best=2.398]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.65s/it, train loss=1.4814, val ΔE00=2.564, best=2.398]Training (late/smallcnn):  45%|████▌     | 45/100 [03:31<04:19,  4.71s/it, train loss=1.4814, val ΔE00=2.564, best=2.398]Training (late/smallcnn):  45%|████▌     | 45/100 [03:31<04:19,  4.71s/it, train loss=1.5757, val ΔE00=2.642, best=2.398]Training (late/smallcnn):  46%|████▌     | 46/100 [03:35<04:14,  4.72s/it, train loss=1.5757, val ΔE00=2.642, best=2.398]Training (late/smallcnn):  46%|████▌     | 46/100 [03:35<04:14,  4.72s/it, train loss=1.6020, val ΔE00=2.368, best=2.368]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.69s/it, train loss=1.6020, val ΔE00=2.368, best=2.368]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.69s/it, train loss=1.6423, val ΔE00=2.833, best=2.368]Training (late/smallcnn):  48%|████▊     | 48/100 [03:45<04:02,  4.67s/it, train loss=1.6423, val ΔE00=2.833, best=2.368]Training (late/smallcnn):  48%|████▊     | 48/100 [03:45<04:02,  4.67s/it, train loss=1.8158, val ΔE00=2.218, best=2.218]Training (late/smallcnn):  49%|████▉     | 49/100 [03:49<03:57,  4.65s/it, train loss=1.8158, val ΔE00=2.218, best=2.218]Training (late/smallcnn):  49%|████▉     | 49/100 [03:49<03:57,  4.65s/it, train loss=1.6736, val ΔE00=2.532, best=2.218]Training (late/smallcnn):  50%|█████     | 50/100 [03:54<03:55,  4.72s/it, train loss=1.6736, val ΔE00=2.532, best=2.218]Training (late/smallcnn):  50%|█████     | 50/100 [03:54<03:55,  4.72s/it, train loss=1.7127, val ΔE00=2.245, best=2.218]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:50,  4.70s/it, train loss=1.7127, val ΔE00=2.245, best=2.218]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:50,  4.70s/it, train loss=1.7775, val ΔE00=2.488, best=2.218]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:03<03:44,  4.67s/it, train loss=1.7775, val ΔE00=2.488, best=2.218]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:03<03:44,  4.67s/it, train loss=1.7722, val ΔE00=2.712, best=2.218]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:08<03:38,  4.65s/it, train loss=1.7722, val ΔE00=2.712, best=2.218]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:08<03:38,  4.65s/it, train loss=1.7809, val ΔE00=2.456, best=2.218]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:13<03:33,  4.64s/it, train loss=1.7809, val ΔE00=2.456, best=2.218]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:13<03:33,  4.64s/it, train loss=1.9668, val ΔE00=2.478, best=2.218]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:18<03:31,  4.70s/it, train loss=1.9668, val ΔE00=2.478, best=2.218]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:18<03:31,  4.70s/it, train loss=1.9318, val ΔE00=2.424, best=2.218]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:22<03:27,  4.71s/it, train loss=1.9318, val ΔE00=2.424, best=2.218]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:22<03:27,  4.71s/it, train loss=1.9367, val ΔE00=2.517, best=2.218]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:21,  4.68s/it, train loss=1.9367, val ΔE00=2.517, best=2.218]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:21,  4.68s/it, train loss=1.9339, val ΔE00=2.578, best=2.218]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:31<03:15,  4.65s/it, train loss=1.9339, val ΔE00=2.578, best=2.218]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:31<03:15,  4.65s/it, train loss=1.9968, val ΔE00=2.286, best=2.218]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:36<03:15,  4.65s/it, train loss=2.0435, val ΔE00=2.340, early_stop=yes]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:36<03:20,  4.77s/it, train loss=2.0435, val ΔE00=2.340, early_stop=yes]
[early] stop at epoch 59 (best de00=2.2183 @ 48)
[done] best ΔE00=2.218 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/late__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 4/24 ===
[sweep] id=004_model=late__backbone=smallcnn__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone smallcnn --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image+mean+meta, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:28,  5.14s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:28,  5.14s/it, train loss=0.0073, val ΔE00=6.845, best=6.845]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:53,  4.83s/it, train loss=0.0073, val ΔE00=6.845, best=6.845]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:53,  4.83s/it, train loss=0.0075, val ΔE00=5.548, best=5.548]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:39,  4.74s/it, train loss=0.0075, val ΔE00=5.548, best=5.548]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:39,  4.74s/it, train loss=0.0141, val ΔE00=5.098, best=5.098]Training (late/smallcnn):   4%|▍         | 4/100 [00:19<07:30,  4.69s/it, train loss=0.0141, val ΔE00=5.098, best=5.098]Training (late/smallcnn):   4%|▍         | 4/100 [00:19<07:30,  4.69s/it, train loss=0.0228, val ΔE00=4.915, best=4.915]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:31,  4.75s/it, train loss=0.0228, val ΔE00=4.915, best=4.915]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:31,  4.75s/it, train loss=0.0346, val ΔE00=4.864, best=4.864]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:26,  4.75s/it, train loss=0.0346, val ΔE00=4.864, best=4.864]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:26,  4.75s/it, train loss=0.0500, val ΔE00=4.129, best=4.129]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:18,  4.71s/it, train loss=0.0500, val ΔE00=4.129, best=4.129]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:18,  4.71s/it, train loss=0.0672, val ΔE00=4.053, best=4.053]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:11,  4.69s/it, train loss=0.0672, val ΔE00=4.053, best=4.053]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:11,  4.69s/it, train loss=0.0839, val ΔE00=3.510, best=3.510]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:04,  4.67s/it, train loss=0.0839, val ΔE00=3.510, best=3.510]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:04,  4.67s/it, train loss=0.1055, val ΔE00=3.637, best=3.510]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.72s/it, train loss=0.1055, val ΔE00=3.637, best=3.510]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.72s/it, train loss=0.1310, val ΔE00=3.580, best=3.510]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:01,  4.73s/it, train loss=0.1310, val ΔE00=3.580, best=3.510]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:01,  4.73s/it, train loss=0.1484, val ΔE00=3.327, best=3.327]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:53,  4.70s/it, train loss=0.1484, val ΔE00=3.327, best=3.327]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:53,  4.70s/it, train loss=0.1706, val ΔE00=3.325, best=3.325]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:46,  4.68s/it, train loss=0.1706, val ΔE00=3.325, best=3.325]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:46,  4.68s/it, train loss=0.1917, val ΔE00=3.016, best=3.016]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:40,  4.66s/it, train loss=0.1917, val ΔE00=3.016, best=3.016]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:40,  4.66s/it, train loss=0.2270, val ΔE00=2.966, best=2.966]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:41,  4.72s/it, train loss=0.2270, val ΔE00=2.966, best=2.966]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:41,  4.72s/it, train loss=0.2634, val ΔE00=2.688, best=2.688]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:37,  4.73s/it, train loss=0.2634, val ΔE00=2.688, best=2.688]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:37,  4.73s/it, train loss=0.2864, val ΔE00=2.791, best=2.688]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:29,  4.70s/it, train loss=0.2864, val ΔE00=2.791, best=2.688]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:29,  4.70s/it, train loss=0.3238, val ΔE00=3.673, best=2.688]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:23,  4.68s/it, train loss=0.3238, val ΔE00=3.673, best=2.688]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:23,  4.68s/it, train loss=0.3760, val ΔE00=2.653, best=2.653]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:17,  4.66s/it, train loss=0.3760, val ΔE00=2.653, best=2.653]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:17,  4.66s/it, train loss=0.3776, val ΔE00=2.681, best=2.653]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:17,  4.72s/it, train loss=0.3776, val ΔE00=2.681, best=2.653]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:17,  4.72s/it, train loss=0.4187, val ΔE00=2.782, best=2.653]Training (late/smallcnn):  21%|██        | 21/100 [01:39<06:13,  4.73s/it, train loss=0.4187, val ΔE00=2.782, best=2.653]Training (late/smallcnn):  21%|██        | 21/100 [01:39<06:13,  4.73s/it, train loss=0.4489, val ΔE00=2.570, best=2.570]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:06,  4.70s/it, train loss=0.4489, val ΔE00=2.570, best=2.570]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:06,  4.70s/it, train loss=0.4902, val ΔE00=2.778, best=2.570]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<06:00,  4.68s/it, train loss=0.4902, val ΔE00=2.778, best=2.570]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<06:00,  4.68s/it, train loss=0.5093, val ΔE00=2.468, best=2.468]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:54,  4.66s/it, train loss=0.5093, val ΔE00=2.468, best=2.468]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:54,  4.66s/it, train loss=0.5954, val ΔE00=2.769, best=2.468]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:53,  4.72s/it, train loss=0.5954, val ΔE00=2.769, best=2.468]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:53,  4.72s/it, train loss=0.6168, val ΔE00=2.524, best=2.468]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:50,  4.73s/it, train loss=0.6168, val ΔE00=2.524, best=2.468]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:50,  4.73s/it, train loss=0.6520, val ΔE00=2.484, best=2.468]Training (late/smallcnn):  27%|██▋       | 27/100 [02:07<05:42,  4.70s/it, train loss=0.6520, val ΔE00=2.484, best=2.468]Training (late/smallcnn):  27%|██▋       | 27/100 [02:07<05:42,  4.70s/it, train loss=0.6854, val ΔE00=2.739, best=2.468]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:36,  4.67s/it, train loss=0.6854, val ΔE00=2.739, best=2.468]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:36,  4.67s/it, train loss=0.7313, val ΔE00=2.699, best=2.468]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:30,  4.66s/it, train loss=0.7313, val ΔE00=2.699, best=2.468]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:30,  4.66s/it, train loss=0.7968, val ΔE00=2.570, best=2.468]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:30,  4.72s/it, train loss=0.7968, val ΔE00=2.570, best=2.468]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:30,  4.72s/it, train loss=0.7861, val ΔE00=2.572, best=2.468]Training (late/smallcnn):  31%|███       | 31/100 [02:26<05:26,  4.73s/it, train loss=0.7861, val ΔE00=2.572, best=2.468]Training (late/smallcnn):  31%|███       | 31/100 [02:26<05:26,  4.73s/it, train loss=0.8476, val ΔE00=2.398, best=2.398]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:19,  4.71s/it, train loss=0.8476, val ΔE00=2.398, best=2.398]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:19,  4.71s/it, train loss=0.9126, val ΔE00=2.600, best=2.398]Training (late/smallcnn):  33%|███▎      | 33/100 [02:35<05:13,  4.68s/it, train loss=0.9126, val ΔE00=2.600, best=2.398]Training (late/smallcnn):  33%|███▎      | 33/100 [02:35<05:13,  4.68s/it, train loss=0.9498, val ΔE00=2.727, best=2.398]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:08,  4.67s/it, train loss=0.9498, val ΔE00=2.727, best=2.398]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:08,  4.67s/it, train loss=1.0156, val ΔE00=2.562, best=2.398]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:07,  4.73s/it, train loss=1.0156, val ΔE00=2.562, best=2.398]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:07,  4.73s/it, train loss=1.0525, val ΔE00=3.270, best=2.398]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:02,  4.73s/it, train loss=1.0525, val ΔE00=3.270, best=2.398]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:02,  4.73s/it, train loss=1.0813, val ΔE00=2.303, best=2.303]Training (late/smallcnn):  37%|███▋      | 37/100 [02:54<04:56,  4.70s/it, train loss=1.0813, val ΔE00=2.303, best=2.303]Training (late/smallcnn):  37%|███▋      | 37/100 [02:54<04:56,  4.70s/it, train loss=1.1807, val ΔE00=2.781, best=2.303]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:50,  4.68s/it, train loss=1.1807, val ΔE00=2.781, best=2.303]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:50,  4.68s/it, train loss=1.1965, val ΔE00=2.383, best=2.303]Training (late/smallcnn):  39%|███▉      | 39/100 [03:03<04:44,  4.67s/it, train loss=1.1965, val ΔE00=2.383, best=2.303]Training (late/smallcnn):  39%|███▉      | 39/100 [03:03<04:44,  4.67s/it, train loss=1.2169, val ΔE00=2.334, best=2.303]Training (late/smallcnn):  40%|████      | 40/100 [03:08<04:43,  4.72s/it, train loss=1.2169, val ΔE00=2.334, best=2.303]Training (late/smallcnn):  40%|████      | 40/100 [03:08<04:43,  4.72s/it, train loss=1.2535, val ΔE00=2.518, best=2.303]Training (late/smallcnn):  41%|████      | 41/100 [03:13<04:39,  4.73s/it, train loss=1.2535, val ΔE00=2.518, best=2.303]Training (late/smallcnn):  41%|████      | 41/100 [03:13<04:39,  4.73s/it, train loss=1.3365, val ΔE00=2.406, best=2.303]Training (late/smallcnn):  42%|████▏     | 42/100 [03:17<04:32,  4.70s/it, train loss=1.3365, val ΔE00=2.406, best=2.303]Training (late/smallcnn):  42%|████▏     | 42/100 [03:17<04:32,  4.70s/it, train loss=1.3302, val ΔE00=2.277, best=2.277]Training (late/smallcnn):  43%|████▎     | 43/100 [03:22<04:26,  4.68s/it, train loss=1.3302, val ΔE00=2.277, best=2.277]Training (late/smallcnn):  43%|████▎     | 43/100 [03:22<04:26,  4.68s/it, train loss=1.4177, val ΔE00=2.522, best=2.277]Training (late/smallcnn):  44%|████▍     | 44/100 [03:27<04:21,  4.67s/it, train loss=1.4177, val ΔE00=2.522, best=2.277]Training (late/smallcnn):  44%|████▍     | 44/100 [03:27<04:21,  4.67s/it, train loss=1.4513, val ΔE00=2.288, best=2.277]Training (late/smallcnn):  45%|████▌     | 45/100 [03:31<04:20,  4.73s/it, train loss=1.4513, val ΔE00=2.288, best=2.277]Training (late/smallcnn):  45%|████▌     | 45/100 [03:31<04:20,  4.73s/it, train loss=1.4583, val ΔE00=2.992, best=2.277]Training (late/smallcnn):  46%|████▌     | 46/100 [03:36<04:15,  4.73s/it, train loss=1.4583, val ΔE00=2.992, best=2.277]Training (late/smallcnn):  46%|████▌     | 46/100 [03:36<04:15,  4.73s/it, train loss=1.4920, val ΔE00=2.382, best=2.277]Training (late/smallcnn):  47%|████▋     | 47/100 [03:41<04:09,  4.70s/it, train loss=1.4920, val ΔE00=2.382, best=2.277]Training (late/smallcnn):  47%|████▋     | 47/100 [03:41<04:09,  4.70s/it, train loss=1.5724, val ΔE00=2.501, best=2.277]Training (late/smallcnn):  48%|████▊     | 48/100 [03:45<04:03,  4.68s/it, train loss=1.5724, val ΔE00=2.501, best=2.277]Training (late/smallcnn):  48%|████▊     | 48/100 [03:45<04:03,  4.68s/it, train loss=1.5990, val ΔE00=2.308, best=2.277]Training (late/smallcnn):  49%|████▉     | 49/100 [03:50<03:57,  4.66s/it, train loss=1.5990, val ΔE00=2.308, best=2.277]Training (late/smallcnn):  49%|████▉     | 49/100 [03:50<03:57,  4.66s/it, train loss=1.6018, val ΔE00=2.571, best=2.277]Training (late/smallcnn):  50%|█████     | 50/100 [03:55<03:55,  4.72s/it, train loss=1.6018, val ΔE00=2.571, best=2.277]Training (late/smallcnn):  50%|█████     | 50/100 [03:55<03:55,  4.72s/it, train loss=1.6331, val ΔE00=2.325, best=2.277]Training (late/smallcnn):  51%|█████     | 51/100 [04:00<03:51,  4.73s/it, train loss=1.6331, val ΔE00=2.325, best=2.277]Training (late/smallcnn):  51%|█████     | 51/100 [04:00<03:51,  4.73s/it, train loss=1.6965, val ΔE00=2.283, best=2.277]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:04<03:45,  4.70s/it, train loss=1.6965, val ΔE00=2.283, best=2.277]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:04<03:45,  4.70s/it, train loss=1.6993, val ΔE00=2.290, best=2.277]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:09<03:40,  4.68s/it, train loss=1.6993, val ΔE00=2.290, best=2.277]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:09<03:40,  4.68s/it, train loss=1.7913, val ΔE00=2.243, best=2.243]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:14<03:34,  4.67s/it, train loss=1.7913, val ΔE00=2.243, best=2.243]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:14<03:34,  4.67s/it, train loss=1.9490, val ΔE00=2.730, best=2.243]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:18<03:32,  4.72s/it, train loss=1.9490, val ΔE00=2.730, best=2.243]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:18<03:32,  4.72s/it, train loss=1.8456, val ΔE00=2.617, best=2.243]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:23<03:28,  4.74s/it, train loss=1.8456, val ΔE00=2.617, best=2.243]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:23<03:28,  4.74s/it, train loss=1.8620, val ΔE00=2.248, best=2.243]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:28<03:22,  4.71s/it, train loss=1.8620, val ΔE00=2.248, best=2.243]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:28<03:22,  4.71s/it, train loss=1.9129, val ΔE00=2.353, best=2.243]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:32<03:16,  4.68s/it, train loss=1.9129, val ΔE00=2.353, best=2.243]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:32<03:16,  4.68s/it, train loss=1.9584, val ΔE00=2.293, best=2.243]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:37<03:11,  4.67s/it, train loss=1.9584, val ΔE00=2.293, best=2.243]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:37<03:11,  4.67s/it, train loss=2.0351, val ΔE00=2.181, best=2.181]Training (late/smallcnn):  60%|██████    | 60/100 [04:42<03:08,  4.72s/it, train loss=2.0351, val ΔE00=2.181, best=2.181]Training (late/smallcnn):  60%|██████    | 60/100 [04:42<03:08,  4.72s/it, train loss=2.0451, val ΔE00=2.068, best=2.068]Training (late/smallcnn):  61%|██████    | 61/100 [04:47<03:04,  4.73s/it, train loss=2.0451, val ΔE00=2.068, best=2.068]Training (late/smallcnn):  61%|██████    | 61/100 [04:47<03:04,  4.73s/it, train loss=1.9829, val ΔE00=2.368, best=2.068]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:51<02:58,  4.70s/it, train loss=1.9829, val ΔE00=2.368, best=2.068]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:51<02:58,  4.70s/it, train loss=2.0631, val ΔE00=2.328, best=2.068]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:56<02:53,  4.68s/it, train loss=2.0631, val ΔE00=2.328, best=2.068]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:56<02:53,  4.68s/it, train loss=2.1260, val ΔE00=2.313, best=2.068]Training (late/smallcnn):  64%|██████▍   | 64/100 [05:01<02:47,  4.66s/it, train loss=2.1260, val ΔE00=2.313, best=2.068]Training (late/smallcnn):  64%|██████▍   | 64/100 [05:01<02:47,  4.66s/it, train loss=2.0241, val ΔE00=3.017, best=2.068]Training (late/smallcnn):  65%|██████▌   | 65/100 [05:05<02:45,  4.72s/it, train loss=2.0241, val ΔE00=3.017, best=2.068]Training (late/smallcnn):  65%|██████▌   | 65/100 [05:05<02:45,  4.72s/it, train loss=2.1244, val ΔE00=3.055, best=2.068]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:10<02:40,  4.72s/it, train loss=2.1244, val ΔE00=3.055, best=2.068]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:10<02:40,  4.72s/it, train loss=2.0980, val ΔE00=2.227, best=2.068]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:15<02:34,  4.69s/it, train loss=2.0980, val ΔE00=2.227, best=2.068]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:15<02:34,  4.69s/it, train loss=2.1060, val ΔE00=2.411, best=2.068]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:19<02:29,  4.67s/it, train loss=2.1060, val ΔE00=2.411, best=2.068]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:19<02:29,  4.67s/it, train loss=2.1030, val ΔE00=2.739, best=2.068]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:24<02:24,  4.66s/it, train loss=2.1030, val ΔE00=2.739, best=2.068]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:24<02:24,  4.66s/it, train loss=2.1664, val ΔE00=2.412, best=2.068]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:29<02:24,  4.66s/it, train loss=2.1126, val ΔE00=2.082, early_stop=yes]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:29<02:27,  4.77s/it, train loss=2.1126, val ΔE00=2.082, early_stop=yes]
[early] stop at epoch 70 (best de00=2.0682 @ 60)
[done] best ΔE00=2.068 over 70 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/late__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 5/24 ===
[sweep] id=005_model=late__backbone=resnet18__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone resnet18 --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:38,  7.05s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:38,  7.05s/it, train loss=0.0105, val ΔE00=7.341, best=7.341]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:02,  6.76s/it, train loss=0.0105, val ΔE00=7.341, best=7.341]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:02,  6.76s/it, train loss=0.0083, val ΔE00=5.740, best=5.740]Training (late/resnet18):   3%|▎         | 3/100 [00:20<10:43,  6.64s/it, train loss=0.0083, val ΔE00=5.740, best=5.740]Training (late/resnet18):   3%|▎         | 3/100 [00:20<10:43,  6.64s/it, train loss=0.0131, val ΔE00=6.411, best=5.740]Training (late/resnet18):   4%|▍         | 4/100 [00:26<10:34,  6.61s/it, train loss=0.0131, val ΔE00=6.411, best=5.740]Training (late/resnet18):   4%|▍         | 4/100 [00:26<10:34,  6.61s/it, train loss=0.0224, val ΔE00=5.468, best=5.468]Training (late/resnet18):   5%|▌         | 5/100 [00:33<10:34,  6.68s/it, train loss=0.0224, val ΔE00=5.468, best=5.468]Training (late/resnet18):   5%|▌         | 5/100 [00:33<10:34,  6.68s/it, train loss=0.0329, val ΔE00=4.867, best=4.867]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:25,  6.65s/it, train loss=0.0329, val ΔE00=4.867, best=4.867]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:25,  6.65s/it, train loss=0.0486, val ΔE00=5.467, best=4.867]Training (late/resnet18):   7%|▋         | 7/100 [00:46<10:15,  6.62s/it, train loss=0.0486, val ΔE00=5.467, best=4.867]Training (late/resnet18):   7%|▋         | 7/100 [00:46<10:15,  6.62s/it, train loss=0.0620, val ΔE00=4.043, best=4.043]Training (late/resnet18):   8%|▊         | 8/100 [00:53<10:04,  6.58s/it, train loss=0.0620, val ΔE00=4.043, best=4.043]Training (late/resnet18):   8%|▊         | 8/100 [00:53<10:04,  6.58s/it, train loss=0.0802, val ΔE00=4.046, best=4.043]Training (late/resnet18):   9%|▉         | 9/100 [00:59<09:56,  6.55s/it, train loss=0.0802, val ΔE00=4.046, best=4.043]Training (late/resnet18):   9%|▉         | 9/100 [00:59<09:56,  6.55s/it, train loss=0.1036, val ΔE00=4.390, best=4.043]Training (late/resnet18):  10%|█         | 10/100 [01:06<09:54,  6.60s/it, train loss=0.1036, val ΔE00=4.390, best=4.043]Training (late/resnet18):  10%|█         | 10/100 [01:06<09:54,  6.60s/it, train loss=0.1203, val ΔE00=5.313, best=4.043]Training (late/resnet18):  11%|█         | 11/100 [01:13<09:49,  6.63s/it, train loss=0.1203, val ΔE00=5.313, best=4.043]Training (late/resnet18):  11%|█         | 11/100 [01:13<09:49,  6.63s/it, train loss=0.1367, val ΔE00=3.953, best=3.953]Training (late/resnet18):  12%|█▏        | 12/100 [01:19<09:41,  6.61s/it, train loss=0.1367, val ΔE00=3.953, best=3.953]Training (late/resnet18):  12%|█▏        | 12/100 [01:19<09:41,  6.61s/it, train loss=0.1555, val ΔE00=3.738, best=3.738]Training (late/resnet18):  13%|█▎        | 13/100 [01:26<09:31,  6.57s/it, train loss=0.1555, val ΔE00=3.738, best=3.738]Training (late/resnet18):  13%|█▎        | 13/100 [01:26<09:31,  6.57s/it, train loss=0.1814, val ΔE00=4.101, best=3.738]Training (late/resnet18):  14%|█▍        | 14/100 [01:32<09:23,  6.55s/it, train loss=0.1814, val ΔE00=4.101, best=3.738]Training (late/resnet18):  14%|█▍        | 14/100 [01:32<09:23,  6.55s/it, train loss=0.1892, val ΔE00=3.784, best=3.738]Training (late/resnet18):  15%|█▌        | 15/100 [01:39<09:22,  6.62s/it, train loss=0.1892, val ΔE00=3.784, best=3.738]Training (late/resnet18):  15%|█▌        | 15/100 [01:39<09:22,  6.62s/it, train loss=0.2286, val ΔE00=3.604, best=3.604]Training (late/resnet18):  16%|█▌        | 16/100 [01:45<09:16,  6.62s/it, train loss=0.2286, val ΔE00=3.604, best=3.604]Training (late/resnet18):  16%|█▌        | 16/100 [01:45<09:16,  6.62s/it, train loss=0.2349, val ΔE00=4.124, best=3.604]Training (late/resnet18):  17%|█▋        | 17/100 [01:52<09:06,  6.58s/it, train loss=0.2349, val ΔE00=4.124, best=3.604]Training (late/resnet18):  17%|█▋        | 17/100 [01:52<09:06,  6.58s/it, train loss=0.2694, val ΔE00=3.655, best=3.604]Training (late/resnet18):  18%|█▊        | 18/100 [01:59<08:59,  6.58s/it, train loss=0.2694, val ΔE00=3.655, best=3.604]Training (late/resnet18):  18%|█▊        | 18/100 [01:59<08:59,  6.58s/it, train loss=0.2992, val ΔE00=3.534, best=3.534]Training (late/resnet18):  19%|█▉        | 19/100 [02:05<08:51,  6.56s/it, train loss=0.2992, val ΔE00=3.534, best=3.534]Training (late/resnet18):  19%|█▉        | 19/100 [02:05<08:51,  6.56s/it, train loss=0.3133, val ΔE00=3.937, best=3.534]Training (late/resnet18):  20%|██        | 20/100 [02:12<08:49,  6.62s/it, train loss=0.3133, val ΔE00=3.937, best=3.534]Training (late/resnet18):  20%|██        | 20/100 [02:12<08:49,  6.62s/it, train loss=0.3310, val ΔE00=3.412, best=3.412]Training (late/resnet18):  21%|██        | 21/100 [02:18<08:43,  6.62s/it, train loss=0.3310, val ΔE00=3.412, best=3.412]Training (late/resnet18):  21%|██        | 21/100 [02:18<08:43,  6.62s/it, train loss=0.3534, val ΔE00=3.550, best=3.412]Training (late/resnet18):  22%|██▏       | 22/100 [02:25<08:33,  6.59s/it, train loss=0.3534, val ΔE00=3.550, best=3.412]Training (late/resnet18):  22%|██▏       | 22/100 [02:25<08:33,  6.59s/it, train loss=0.3820, val ΔE00=3.571, best=3.412]Training (late/resnet18):  23%|██▎       | 23/100 [02:31<08:24,  6.56s/it, train loss=0.3820, val ΔE00=3.571, best=3.412]Training (late/resnet18):  23%|██▎       | 23/100 [02:31<08:24,  6.56s/it, train loss=0.4030, val ΔE00=3.878, best=3.412]Training (late/resnet18):  24%|██▍       | 24/100 [02:38<08:18,  6.56s/it, train loss=0.4030, val ΔE00=3.878, best=3.412]Training (late/resnet18):  24%|██▍       | 24/100 [02:38<08:18,  6.56s/it, train loss=0.4284, val ΔE00=3.352, best=3.352]Training (late/resnet18):  25%|██▌       | 25/100 [02:45<08:15,  6.60s/it, train loss=0.4284, val ΔE00=3.352, best=3.352]Training (late/resnet18):  25%|██▌       | 25/100 [02:45<08:15,  6.60s/it, train loss=0.4552, val ΔE00=3.577, best=3.352]Training (late/resnet18):  26%|██▌       | 26/100 [02:51<08:08,  6.60s/it, train loss=0.4552, val ΔE00=3.577, best=3.352]Training (late/resnet18):  26%|██▌       | 26/100 [02:51<08:08,  6.60s/it, train loss=0.4924, val ΔE00=3.749, best=3.352]Training (late/resnet18):  27%|██▋       | 27/100 [02:58<07:59,  6.57s/it, train loss=0.4924, val ΔE00=3.749, best=3.352]Training (late/resnet18):  27%|██▋       | 27/100 [02:58<07:59,  6.57s/it, train loss=0.4803, val ΔE00=3.407, best=3.352]Training (late/resnet18):  28%|██▊       | 28/100 [03:04<07:51,  6.55s/it, train loss=0.4803, val ΔE00=3.407, best=3.352]Training (late/resnet18):  28%|██▊       | 28/100 [03:04<07:51,  6.55s/it, train loss=0.5222, val ΔE00=3.774, best=3.352]Training (late/resnet18):  29%|██▉       | 29/100 [03:11<07:43,  6.53s/it, train loss=0.5222, val ΔE00=3.774, best=3.352]Training (late/resnet18):  29%|██▉       | 29/100 [03:11<07:43,  6.53s/it, train loss=0.5609, val ΔE00=3.426, best=3.352]Training (late/resnet18):  30%|███       | 30/100 [03:17<07:40,  6.58s/it, train loss=0.5609, val ΔE00=3.426, best=3.352]Training (late/resnet18):  30%|███       | 30/100 [03:17<07:40,  6.58s/it, train loss=0.5827, val ΔE00=3.476, best=3.352]Training (late/resnet18):  31%|███       | 31/100 [03:24<07:35,  6.60s/it, train loss=0.5827, val ΔE00=3.476, best=3.352]Training (late/resnet18):  31%|███       | 31/100 [03:24<07:35,  6.60s/it, train loss=0.6098, val ΔE00=4.243, best=3.352]Training (late/resnet18):  32%|███▏      | 32/100 [03:31<07:26,  6.57s/it, train loss=0.6098, val ΔE00=4.243, best=3.352]Training (late/resnet18):  32%|███▏      | 32/100 [03:31<07:26,  6.57s/it, train loss=0.6165, val ΔE00=3.433, best=3.352]Training (late/resnet18):  33%|███▎      | 33/100 [03:37<07:20,  6.57s/it, train loss=0.6165, val ΔE00=3.433, best=3.352]Training (late/resnet18):  33%|███▎      | 33/100 [03:37<07:20,  6.57s/it, train loss=0.6554, val ΔE00=3.312, best=3.312]Training (late/resnet18):  34%|███▍      | 34/100 [03:44<07:11,  6.55s/it, train loss=0.6554, val ΔE00=3.312, best=3.312]Training (late/resnet18):  34%|███▍      | 34/100 [03:44<07:11,  6.55s/it, train loss=0.6463, val ΔE00=3.523, best=3.312]Training (late/resnet18):  35%|███▌      | 35/100 [03:50<07:08,  6.60s/it, train loss=0.6463, val ΔE00=3.523, best=3.312]Training (late/resnet18):  35%|███▌      | 35/100 [03:50<07:08,  6.60s/it, train loss=0.6813, val ΔE00=3.571, best=3.312]Training (late/resnet18):  36%|███▌      | 36/100 [03:57<07:02,  6.60s/it, train loss=0.6813, val ΔE00=3.571, best=3.312]Training (late/resnet18):  36%|███▌      | 36/100 [03:57<07:02,  6.60s/it, train loss=0.7522, val ΔE00=3.388, best=3.312]Training (late/resnet18):  37%|███▋      | 37/100 [04:03<06:53,  6.57s/it, train loss=0.7522, val ΔE00=3.388, best=3.312]Training (late/resnet18):  37%|███▋      | 37/100 [04:03<06:53,  6.57s/it, train loss=0.7370, val ΔE00=3.535, best=3.312]Training (late/resnet18):  38%|███▊      | 38/100 [04:10<06:45,  6.54s/it, train loss=0.7370, val ΔE00=3.535, best=3.312]Training (late/resnet18):  38%|███▊      | 38/100 [04:10<06:45,  6.54s/it, train loss=0.7342, val ΔE00=3.450, best=3.312]Training (late/resnet18):  39%|███▉      | 39/100 [04:16<06:37,  6.52s/it, train loss=0.7342, val ΔE00=3.450, best=3.312]Training (late/resnet18):  39%|███▉      | 39/100 [04:16<06:37,  6.52s/it, train loss=0.7607, val ΔE00=3.314, best=3.312]Training (late/resnet18):  40%|████      | 40/100 [04:23<06:35,  6.59s/it, train loss=0.7607, val ΔE00=3.314, best=3.312]Training (late/resnet18):  40%|████      | 40/100 [04:23<06:35,  6.59s/it, train loss=0.7802, val ΔE00=3.434, best=3.312]Training (late/resnet18):  41%|████      | 41/100 [04:30<06:28,  6.58s/it, train loss=0.7802, val ΔE00=3.434, best=3.312]Training (late/resnet18):  41%|████      | 41/100 [04:30<06:28,  6.58s/it, train loss=0.8297, val ΔE00=3.398, best=3.312]Training (late/resnet18):  42%|████▏     | 42/100 [04:36<06:20,  6.56s/it, train loss=0.8297, val ΔE00=3.398, best=3.312]Training (late/resnet18):  42%|████▏     | 42/100 [04:36<06:20,  6.56s/it, train loss=0.8186, val ΔE00=3.388, best=3.312]Training (late/resnet18):  43%|████▎     | 43/100 [04:43<06:12,  6.53s/it, train loss=0.8186, val ΔE00=3.388, best=3.312]Training (late/resnet18):  43%|████▎     | 43/100 [04:43<06:12,  6.53s/it, train loss=0.9074, val ΔE00=3.488, best=3.312]Training (late/resnet18):  44%|████▍     | 44/100 [04:49<06:05,  6.52s/it, train loss=0.9074, val ΔE00=3.488, best=3.312]Training (late/resnet18):  44%|████▍     | 44/100 [04:49<06:05,  6.52s/it, train loss=0.8766, val ΔE00=3.625, best=3.312]Training (late/resnet18):  45%|████▌     | 45/100 [04:56<06:01,  6.58s/it, train loss=0.8766, val ΔE00=3.625, best=3.312]Training (late/resnet18):  45%|████▌     | 45/100 [04:56<06:01,  6.58s/it, train loss=0.9135, val ΔE00=3.443, best=3.312]Training (late/resnet18):  46%|████▌     | 46/100 [05:03<05:55,  6.59s/it, train loss=0.9135, val ΔE00=3.443, best=3.312]Training (late/resnet18):  46%|████▌     | 46/100 [05:03<05:55,  6.59s/it, train loss=0.8701, val ΔE00=3.593, best=3.312]Training (late/resnet18):  47%|████▋     | 47/100 [05:09<05:47,  6.56s/it, train loss=0.8701, val ΔE00=3.593, best=3.312]Training (late/resnet18):  47%|████▋     | 47/100 [05:09<05:47,  6.56s/it, train loss=0.9090, val ΔE00=3.426, best=3.312]Training (late/resnet18):  48%|████▊     | 48/100 [05:16<05:40,  6.54s/it, train loss=0.9090, val ΔE00=3.426, best=3.312]Training (late/resnet18):  48%|████▊     | 48/100 [05:16<05:40,  6.54s/it, train loss=0.9778, val ΔE00=3.358, best=3.312]Training (late/resnet18):  49%|████▉     | 49/100 [05:22<05:33,  6.55s/it, train loss=0.9778, val ΔE00=3.358, best=3.312]Training (late/resnet18):  49%|████▉     | 49/100 [05:22<05:33,  6.55s/it, train loss=0.9278, val ΔE00=3.269, best=3.269]Training (late/resnet18):  50%|█████     | 50/100 [05:29<05:30,  6.60s/it, train loss=0.9278, val ΔE00=3.269, best=3.269]Training (late/resnet18):  50%|█████     | 50/100 [05:29<05:30,  6.60s/it, train loss=0.9975, val ΔE00=3.906, best=3.269]Training (late/resnet18):  51%|█████     | 51/100 [05:35<05:23,  6.60s/it, train loss=0.9975, val ΔE00=3.906, best=3.269]Training (late/resnet18):  51%|█████     | 51/100 [05:35<05:23,  6.60s/it, train loss=1.0150, val ΔE00=3.435, best=3.269]Training (late/resnet18):  52%|█████▏    | 52/100 [05:42<05:14,  6.56s/it, train loss=1.0150, val ΔE00=3.435, best=3.269]Training (late/resnet18):  52%|█████▏    | 52/100 [05:42<05:14,  6.56s/it, train loss=1.0087, val ΔE00=3.583, best=3.269]Training (late/resnet18):  53%|█████▎    | 53/100 [05:48<05:07,  6.54s/it, train loss=1.0087, val ΔE00=3.583, best=3.269]Training (late/resnet18):  53%|█████▎    | 53/100 [05:48<05:07,  6.54s/it, train loss=1.0250, val ΔE00=3.565, best=3.269]Training (late/resnet18):  54%|█████▍    | 54/100 [05:55<05:01,  6.54s/it, train loss=1.0250, val ΔE00=3.565, best=3.269]Training (late/resnet18):  54%|█████▍    | 54/100 [05:55<05:01,  6.54s/it, train loss=1.0118, val ΔE00=3.189, best=3.189]Training (late/resnet18):  55%|█████▌    | 55/100 [06:02<04:56,  6.59s/it, train loss=1.0118, val ΔE00=3.189, best=3.189]Training (late/resnet18):  55%|█████▌    | 55/100 [06:02<04:56,  6.59s/it, train loss=0.9894, val ΔE00=3.420, best=3.189]Training (late/resnet18):  56%|█████▌    | 56/100 [06:08<04:50,  6.60s/it, train loss=0.9894, val ΔE00=3.420, best=3.189]Training (late/resnet18):  56%|█████▌    | 56/100 [06:08<04:50,  6.60s/it, train loss=1.0591, val ΔE00=3.423, best=3.189]Training (late/resnet18):  57%|█████▋    | 57/100 [06:15<04:42,  6.57s/it, train loss=1.0591, val ΔE00=3.423, best=3.189]Training (late/resnet18):  57%|█████▋    | 57/100 [06:15<04:42,  6.57s/it, train loss=1.0828, val ΔE00=3.466, best=3.189]Training (late/resnet18):  58%|█████▊    | 58/100 [06:21<04:35,  6.55s/it, train loss=1.0828, val ΔE00=3.466, best=3.189]Training (late/resnet18):  58%|█████▊    | 58/100 [06:21<04:35,  6.55s/it, train loss=1.0679, val ΔE00=3.449, best=3.189]Training (late/resnet18):  59%|█████▉    | 59/100 [06:28<04:28,  6.54s/it, train loss=1.0679, val ΔE00=3.449, best=3.189]Training (late/resnet18):  59%|█████▉    | 59/100 [06:28<04:28,  6.54s/it, train loss=1.0380, val ΔE00=3.640, best=3.189]Training (late/resnet18):  60%|██████    | 60/100 [06:34<04:23,  6.59s/it, train loss=1.0380, val ΔE00=3.640, best=3.189]Training (late/resnet18):  60%|██████    | 60/100 [06:34<04:23,  6.59s/it, train loss=1.0861, val ΔE00=3.321, best=3.189]Training (late/resnet18):  61%|██████    | 61/100 [06:41<04:17,  6.60s/it, train loss=1.0861, val ΔE00=3.321, best=3.189]Training (late/resnet18):  61%|██████    | 61/100 [06:41<04:17,  6.60s/it, train loss=1.1182, val ΔE00=3.739, best=3.189]Training (late/resnet18):  62%|██████▏   | 62/100 [06:48<04:09,  6.57s/it, train loss=1.1182, val ΔE00=3.739, best=3.189]Training (late/resnet18):  62%|██████▏   | 62/100 [06:48<04:09,  6.57s/it, train loss=1.0951, val ΔE00=3.487, best=3.189]Training (late/resnet18):  63%|██████▎   | 63/100 [06:54<04:02,  6.54s/it, train loss=1.0951, val ΔE00=3.487, best=3.189]Training (late/resnet18):  63%|██████▎   | 63/100 [06:54<04:02,  6.54s/it, train loss=1.0390, val ΔE00=3.645, best=3.189]Training (late/resnet18):  63%|██████▎   | 63/100 [07:01<04:02,  6.54s/it, train loss=1.0600, val ΔE00=3.401, early_stop=yes]Training (late/resnet18):  63%|██████▎   | 63/100 [07:01<04:07,  6.68s/it, train loss=1.0600, val ΔE00=3.401, early_stop=yes]
[early] stop at epoch 64 (best de00=3.1894 @ 54)
[done] best ΔE00=3.189 over 64 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/late__resnet18__image__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image/final_summary.json (kind=val)
[sweep] === Run 6/24 ===
[sweep] id=006_model=late__backbone=resnet18__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone resnet18 --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image+mean, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:58,  7.26s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:58,  7.26s/it, train loss=0.0103, val ΔE00=6.979, best=6.979]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:19,  6.94s/it, train loss=0.0103, val ΔE00=6.979, best=6.979]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:19,  6.94s/it, train loss=0.0075, val ΔE00=6.167, best=6.167]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:03,  6.84s/it, train loss=0.0075, val ΔE00=6.167, best=6.167]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:03,  6.84s/it, train loss=0.0132, val ΔE00=4.723, best=4.723]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:48,  6.76s/it, train loss=0.0132, val ΔE00=4.723, best=4.723]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:48,  6.76s/it, train loss=0.0217, val ΔE00=4.931, best=4.723]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:48,  6.83s/it, train loss=0.0217, val ΔE00=4.931, best=4.723]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:48,  6.83s/it, train loss=0.0321, val ΔE00=4.246, best=4.246]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:39,  6.80s/it, train loss=0.0321, val ΔE00=4.246, best=4.246]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:39,  6.80s/it, train loss=0.0472, val ΔE00=4.599, best=4.246]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0472, val ΔE00=4.599, best=4.246]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0620, val ΔE00=4.046, best=4.046]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:20,  6.75s/it, train loss=0.0620, val ΔE00=4.046, best=4.046]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:20,  6.75s/it, train loss=0.0769, val ΔE00=3.900, best=3.900]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:10,  6.71s/it, train loss=0.0769, val ΔE00=3.900, best=3.900]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:10,  6.71s/it, train loss=0.0954, val ΔE00=4.032, best=3.900]Training (late/resnet18):  10%|█         | 10/100 [01:08<10:12,  6.81s/it, train loss=0.0954, val ΔE00=4.032, best=3.900]Training (late/resnet18):  10%|█         | 10/100 [01:08<10:12,  6.81s/it, train loss=0.1124, val ΔE00=3.851, best=3.851]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:05,  6.80s/it, train loss=0.1124, val ΔE00=3.851, best=3.851]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:05,  6.80s/it, train loss=0.1318, val ΔE00=3.531, best=3.531]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:54,  6.75s/it, train loss=0.1318, val ΔE00=3.531, best=3.531]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:54,  6.75s/it, train loss=0.1477, val ΔE00=3.698, best=3.531]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:46,  6.74s/it, train loss=0.1477, val ΔE00=3.698, best=3.531]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:46,  6.74s/it, train loss=0.1667, val ΔE00=3.466, best=3.466]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:36,  6.71s/it, train loss=0.1667, val ΔE00=3.466, best=3.466]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:36,  6.71s/it, train loss=0.1970, val ΔE00=3.660, best=3.466]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:35,  6.77s/it, train loss=0.1970, val ΔE00=3.660, best=3.466]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:35,  6.77s/it, train loss=0.2094, val ΔE00=3.729, best=3.466]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:29,  6.78s/it, train loss=0.2094, val ΔE00=3.729, best=3.466]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:29,  6.78s/it, train loss=0.2331, val ΔE00=3.337, best=3.337]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:18,  6.73s/it, train loss=0.2331, val ΔE00=3.337, best=3.337]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:18,  6.73s/it, train loss=0.2591, val ΔE00=3.768, best=3.337]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:09,  6.71s/it, train loss=0.2591, val ΔE00=3.768, best=3.337]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:09,  6.71s/it, train loss=0.3010, val ΔE00=4.204, best=3.337]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:01,  6.68s/it, train loss=0.3010, val ΔE00=4.204, best=3.337]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:01,  6.68s/it, train loss=0.3112, val ΔE00=3.487, best=3.337]Training (late/resnet18):  20%|██        | 20/100 [02:15<09:00,  6.75s/it, train loss=0.3112, val ΔE00=3.487, best=3.337]Training (late/resnet18):  20%|██        | 20/100 [02:15<09:00,  6.75s/it, train loss=0.3379, val ΔE00=3.477, best=3.337]Training (late/resnet18):  21%|██        | 21/100 [02:22<08:52,  6.74s/it, train loss=0.3379, val ΔE00=3.477, best=3.337]Training (late/resnet18):  21%|██        | 21/100 [02:22<08:52,  6.74s/it, train loss=0.3604, val ΔE00=3.590, best=3.337]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:43,  6.71s/it, train loss=0.3604, val ΔE00=3.590, best=3.337]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:43,  6.71s/it, train loss=0.3761, val ΔE00=3.573, best=3.337]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:34,  6.69s/it, train loss=0.3761, val ΔE00=3.573, best=3.337]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:34,  6.69s/it, train loss=0.3981, val ΔE00=3.605, best=3.337]Training (late/resnet18):  24%|██▍       | 24/100 [02:42<08:27,  6.67s/it, train loss=0.3981, val ΔE00=3.605, best=3.337]Training (late/resnet18):  24%|██▍       | 24/100 [02:42<08:27,  6.67s/it, train loss=0.4145, val ΔE00=3.612, best=3.337]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:25,  6.74s/it, train loss=0.4145, val ΔE00=3.612, best=3.337]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:25,  6.74s/it, train loss=0.4692, val ΔE00=3.384, best=3.337]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:19,  6.75s/it, train loss=0.4692, val ΔE00=3.384, best=3.337]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:19,  6.75s/it, train loss=0.4698, val ΔE00=3.351, best=3.337]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:10,  6.72s/it, train loss=0.4698, val ΔE00=3.351, best=3.337]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:10,  6.72s/it, train loss=0.5192, val ΔE00=3.357, best=3.337]Training (late/resnet18):  28%|██▊       | 28/100 [03:08<08:01,  6.69s/it, train loss=0.5192, val ΔE00=3.357, best=3.337]Training (late/resnet18):  28%|██▊       | 28/100 [03:08<08:01,  6.69s/it, train loss=0.5345, val ΔE00=3.446, best=3.337]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:54,  6.68s/it, train loss=0.5345, val ΔE00=3.446, best=3.337]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:54,  6.68s/it, train loss=0.5512, val ΔE00=3.609, best=3.337]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:51,  6.73s/it, train loss=0.5512, val ΔE00=3.609, best=3.337]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:51,  6.73s/it, train loss=0.6001, val ΔE00=3.616, best=3.337]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:45,  6.74s/it, train loss=0.6001, val ΔE00=3.616, best=3.337]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:45,  6.74s/it, train loss=0.6321, val ΔE00=3.538, best=3.337]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:37,  6.73s/it, train loss=0.6321, val ΔE00=3.538, best=3.337]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:37,  6.73s/it, train loss=0.6032, val ΔE00=3.248, best=3.248]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:30,  6.72s/it, train loss=0.6032, val ΔE00=3.248, best=3.248]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:30,  6.72s/it, train loss=0.6776, val ΔE00=3.188, best=3.188]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:23,  6.72s/it, train loss=0.6776, val ΔE00=3.188, best=3.188]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:23,  6.72s/it, train loss=0.6952, val ΔE00=3.142, best=3.142]Training (late/resnet18):  35%|███▌      | 35/100 [03:56<07:20,  6.77s/it, train loss=0.6952, val ΔE00=3.142, best=3.142]Training (late/resnet18):  35%|███▌      | 35/100 [03:56<07:20,  6.77s/it, train loss=0.6947, val ΔE00=3.297, best=3.142]Training (late/resnet18):  36%|███▌      | 36/100 [04:03<07:13,  6.77s/it, train loss=0.6947, val ΔE00=3.297, best=3.142]Training (late/resnet18):  36%|███▌      | 36/100 [04:03<07:13,  6.77s/it, train loss=0.7127, val ΔE00=3.809, best=3.142]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:04,  6.74s/it, train loss=0.7127, val ΔE00=3.809, best=3.142]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:04,  6.74s/it, train loss=0.7598, val ΔE00=3.427, best=3.142]Training (late/resnet18):  38%|███▊      | 38/100 [04:16<06:55,  6.71s/it, train loss=0.7598, val ΔE00=3.427, best=3.142]Training (late/resnet18):  38%|███▊      | 38/100 [04:16<06:55,  6.71s/it, train loss=0.7526, val ΔE00=3.576, best=3.142]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:48,  6.69s/it, train loss=0.7526, val ΔE00=3.576, best=3.142]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:48,  6.69s/it, train loss=0.8024, val ΔE00=3.314, best=3.142]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:44,  6.75s/it, train loss=0.8024, val ΔE00=3.314, best=3.142]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:44,  6.75s/it, train loss=0.8018, val ΔE00=3.397, best=3.142]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:37,  6.75s/it, train loss=0.8018, val ΔE00=3.397, best=3.142]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:37,  6.75s/it, train loss=0.8285, val ΔE00=3.261, best=3.142]Training (late/resnet18):  42%|████▏     | 42/100 [04:43<06:29,  6.71s/it, train loss=0.8285, val ΔE00=3.261, best=3.142]Training (late/resnet18):  42%|████▏     | 42/100 [04:43<06:29,  6.71s/it, train loss=0.8404, val ΔE00=3.361, best=3.142]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.69s/it, train loss=0.8404, val ΔE00=3.361, best=3.142]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.69s/it, train loss=0.9007, val ΔE00=3.401, best=3.142]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:13,  6.67s/it, train loss=0.9007, val ΔE00=3.401, best=3.142]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:13,  6.67s/it, train loss=0.8639, val ΔE00=3.511, best=3.142]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:10,  6.74s/it, train loss=0.8639, val ΔE00=3.511, best=3.142]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:10,  6.74s/it, train loss=0.9041, val ΔE00=3.485, best=3.142]Training (late/resnet18):  46%|████▌     | 46/100 [05:10<06:04,  6.75s/it, train loss=0.9041, val ΔE00=3.485, best=3.142]Training (late/resnet18):  46%|████▌     | 46/100 [05:10<06:04,  6.75s/it, train loss=0.9521, val ΔE00=3.487, best=3.142]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:56,  6.72s/it, train loss=0.9521, val ΔE00=3.487, best=3.142]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:56,  6.72s/it, train loss=0.9284, val ΔE00=3.403, best=3.142]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:48,  6.70s/it, train loss=0.9284, val ΔE00=3.403, best=3.142]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:48,  6.70s/it, train loss=0.9354, val ΔE00=3.374, best=3.142]Training (late/resnet18):  49%|████▉     | 49/100 [05:30<05:40,  6.68s/it, train loss=0.9354, val ΔE00=3.374, best=3.142]Training (late/resnet18):  49%|████▉     | 49/100 [05:30<05:40,  6.68s/it, train loss=0.9465, val ΔE00=3.212, best=3.142]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:37,  6.75s/it, train loss=0.9465, val ΔE00=3.212, best=3.142]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:37,  6.75s/it, train loss=0.9651, val ΔE00=4.040, best=3.142]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:30,  6.75s/it, train loss=0.9651, val ΔE00=4.040, best=3.142]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:30,  6.75s/it, train loss=0.9360, val ΔE00=3.354, best=3.142]Training (late/resnet18):  52%|█████▏    | 52/100 [05:50<05:22,  6.72s/it, train loss=0.9360, val ΔE00=3.354, best=3.142]Training (late/resnet18):  52%|█████▏    | 52/100 [05:50<05:22,  6.72s/it, train loss=0.9902, val ΔE00=3.264, best=3.142]Training (late/resnet18):  53%|█████▎    | 53/100 [05:57<05:14,  6.70s/it, train loss=0.9902, val ΔE00=3.264, best=3.142]Training (late/resnet18):  53%|█████▎    | 53/100 [05:57<05:14,  6.70s/it, train loss=0.9800, val ΔE00=3.498, best=3.142]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:07,  6.68s/it, train loss=0.9800, val ΔE00=3.498, best=3.142]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:07,  6.68s/it, train loss=1.0120, val ΔE00=3.299, best=3.142]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:03,  6.74s/it, train loss=1.0120, val ΔE00=3.299, best=3.142]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:03,  6.74s/it, train loss=1.0170, val ΔE00=3.188, best=3.142]Training (late/resnet18):  56%|█████▌    | 56/100 [06:17<04:56,  6.75s/it, train loss=1.0170, val ΔE00=3.188, best=3.142]Training (late/resnet18):  56%|█████▌    | 56/100 [06:17<04:56,  6.75s/it, train loss=1.0306, val ΔE00=3.289, best=3.142]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:48,  6.72s/it, train loss=1.0306, val ΔE00=3.289, best=3.142]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:48,  6.72s/it, train loss=1.0533, val ΔE00=3.333, best=3.142]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:41,  6.69s/it, train loss=1.0533, val ΔE00=3.333, best=3.142]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:41,  6.69s/it, train loss=1.0307, val ΔE00=3.367, best=3.142]Training (late/resnet18):  58%|█████▊    | 58/100 [06:37<04:41,  6.69s/it, train loss=1.0622, val ΔE00=3.176, early_stop=yes]Training (late/resnet18):  58%|█████▊    | 58/100 [06:37<04:47,  6.85s/it, train loss=1.0622, val ΔE00=3.176, early_stop=yes]
[early] stop at epoch 59 (best de00=3.1416 @ 34)
[done] best ΔE00=3.142 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/late__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 7/24 ===
[sweep] id=007_model=late__backbone=resnet18__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone resnet18 --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image+meta, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:55,  7.22s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:55,  7.22s/it, train loss=0.0109, val ΔE00=7.566, best=7.566]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:17,  6.91s/it, train loss=0.0109, val ΔE00=7.566, best=7.566]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:17,  6.91s/it, train loss=0.0072, val ΔE00=5.645, best=5.645]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:00,  6.81s/it, train loss=0.0072, val ΔE00=5.645, best=5.645]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:00,  6.81s/it, train loss=0.0126, val ΔE00=5.440, best=5.440]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:49,  6.77s/it, train loss=0.0126, val ΔE00=5.440, best=5.440]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:49,  6.77s/it, train loss=0.0201, val ΔE00=4.507, best=4.507]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:49,  6.83s/it, train loss=0.0201, val ΔE00=4.507, best=4.507]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:49,  6.83s/it, train loss=0.0317, val ΔE00=4.089, best=4.089]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:39,  6.80s/it, train loss=0.0317, val ΔE00=4.089, best=4.089]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:39,  6.80s/it, train loss=0.0412, val ΔE00=4.120, best=4.089]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0412, val ΔE00=4.120, best=4.089]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0574, val ΔE00=3.606, best=3.606]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:20,  6.74s/it, train loss=0.0574, val ΔE00=3.606, best=3.606]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:20,  6.74s/it, train loss=0.0738, val ΔE00=3.604, best=3.604]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:12,  6.73s/it, train loss=0.0738, val ΔE00=3.604, best=3.604]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:12,  6.73s/it, train loss=0.0896, val ΔE00=3.187, best=3.187]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:10,  6.78s/it, train loss=0.0896, val ΔE00=3.187, best=3.187]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:10,  6.78s/it, train loss=0.1086, val ΔE00=3.548, best=3.187]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:04,  6.80s/it, train loss=0.1086, val ΔE00=3.548, best=3.187]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:04,  6.80s/it, train loss=0.1244, val ΔE00=3.053, best=3.053]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:53,  6.75s/it, train loss=0.1244, val ΔE00=3.053, best=3.053]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:53,  6.75s/it, train loss=0.1415, val ΔE00=3.206, best=3.053]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:45,  6.73s/it, train loss=0.1415, val ΔE00=3.206, best=3.053]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:45,  6.73s/it, train loss=0.1622, val ΔE00=2.786, best=2.786]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:36,  6.70s/it, train loss=0.1622, val ΔE00=2.786, best=2.786]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:36,  6.70s/it, train loss=0.1798, val ΔE00=2.840, best=2.786]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:34,  6.75s/it, train loss=0.1798, val ΔE00=2.840, best=2.786]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:34,  6.75s/it, train loss=0.1996, val ΔE00=3.064, best=2.786]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:27,  6.76s/it, train loss=0.1996, val ΔE00=3.064, best=2.786]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:27,  6.76s/it, train loss=0.2243, val ΔE00=3.894, best=2.786]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:18,  6.72s/it, train loss=0.2243, val ΔE00=3.894, best=2.786]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:18,  6.72s/it, train loss=0.2563, val ΔE00=3.103, best=2.786]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:09,  6.70s/it, train loss=0.2563, val ΔE00=3.103, best=2.786]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:09,  6.70s/it, train loss=0.2768, val ΔE00=2.826, best=2.786]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:01,  6.68s/it, train loss=0.2768, val ΔE00=2.826, best=2.786]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:01,  6.68s/it, train loss=0.2914, val ΔE00=2.844, best=2.786]Training (late/resnet18):  20%|██        | 20/100 [02:15<08:58,  6.74s/it, train loss=0.2914, val ΔE00=2.844, best=2.786]Training (late/resnet18):  20%|██        | 20/100 [02:15<08:58,  6.74s/it, train loss=0.3029, val ΔE00=2.791, best=2.786]Training (late/resnet18):  21%|██        | 21/100 [02:21<08:53,  6.75s/it, train loss=0.3029, val ΔE00=2.791, best=2.786]Training (late/resnet18):  21%|██        | 21/100 [02:21<08:53,  6.75s/it, train loss=0.3390, val ΔE00=2.794, best=2.786]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:44,  6.72s/it, train loss=0.3390, val ΔE00=2.794, best=2.786]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:44,  6.72s/it, train loss=0.3773, val ΔE00=2.938, best=2.786]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:37,  6.72s/it, train loss=0.3773, val ΔE00=2.938, best=2.786]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:37,  6.72s/it, train loss=0.4049, val ΔE00=2.766, best=2.766]Training (late/resnet18):  24%|██▍       | 24/100 [02:41<08:28,  6.69s/it, train loss=0.4049, val ΔE00=2.766, best=2.766]Training (late/resnet18):  24%|██▍       | 24/100 [02:41<08:28,  6.69s/it, train loss=0.4108, val ΔE00=2.881, best=2.766]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:26,  6.76s/it, train loss=0.4108, val ΔE00=2.881, best=2.766]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:26,  6.76s/it, train loss=0.4242, val ΔE00=2.962, best=2.766]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:19,  6.75s/it, train loss=0.4242, val ΔE00=2.962, best=2.766]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:19,  6.75s/it, train loss=0.4510, val ΔE00=2.872, best=2.766]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:12,  6.74s/it, train loss=0.4510, val ΔE00=2.872, best=2.766]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:12,  6.74s/it, train loss=0.4870, val ΔE00=2.552, best=2.552]Training (late/resnet18):  28%|██▊       | 28/100 [03:08<08:03,  6.71s/it, train loss=0.4870, val ΔE00=2.552, best=2.552]Training (late/resnet18):  28%|██▊       | 28/100 [03:08<08:03,  6.71s/it, train loss=0.5118, val ΔE00=3.057, best=2.552]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:55,  6.69s/it, train loss=0.5118, val ΔE00=3.057, best=2.552]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:55,  6.69s/it, train loss=0.5236, val ΔE00=3.051, best=2.552]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:52,  6.75s/it, train loss=0.5236, val ΔE00=3.051, best=2.552]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:52,  6.75s/it, train loss=0.5436, val ΔE00=2.971, best=2.552]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:46,  6.76s/it, train loss=0.5436, val ΔE00=2.971, best=2.552]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:46,  6.76s/it, train loss=0.5413, val ΔE00=2.764, best=2.552]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:37,  6.73s/it, train loss=0.5413, val ΔE00=2.764, best=2.552]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:37,  6.73s/it, train loss=0.5861, val ΔE00=2.613, best=2.552]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:28,  6.70s/it, train loss=0.5861, val ΔE00=2.613, best=2.552]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:28,  6.70s/it, train loss=0.6070, val ΔE00=2.907, best=2.552]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:21,  6.69s/it, train loss=0.6070, val ΔE00=2.907, best=2.552]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:21,  6.69s/it, train loss=0.6598, val ΔE00=2.714, best=2.552]Training (late/resnet18):  35%|███▌      | 35/100 [03:56<07:18,  6.74s/it, train loss=0.6598, val ΔE00=2.714, best=2.552]Training (late/resnet18):  35%|███▌      | 35/100 [03:56<07:18,  6.74s/it, train loss=0.6402, val ΔE00=2.768, best=2.552]Training (late/resnet18):  36%|███▌      | 36/100 [04:02<07:11,  6.75s/it, train loss=0.6402, val ΔE00=2.768, best=2.552]Training (late/resnet18):  36%|███▌      | 36/100 [04:02<07:11,  6.75s/it, train loss=0.6682, val ΔE00=2.763, best=2.552]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:03,  6.72s/it, train loss=0.6682, val ΔE00=2.763, best=2.552]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:03,  6.72s/it, train loss=0.6884, val ΔE00=2.819, best=2.552]Training (late/resnet18):  38%|███▊      | 38/100 [04:16<06:55,  6.70s/it, train loss=0.6884, val ΔE00=2.819, best=2.552]Training (late/resnet18):  38%|███▊      | 38/100 [04:16<06:55,  6.70s/it, train loss=0.6982, val ΔE00=2.704, best=2.552]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:47,  6.68s/it, train loss=0.6982, val ΔE00=2.704, best=2.552]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:47,  6.68s/it, train loss=0.7419, val ΔE00=2.608, best=2.552]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:45,  6.76s/it, train loss=0.7419, val ΔE00=2.608, best=2.552]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:45,  6.76s/it, train loss=0.7878, val ΔE00=3.190, best=2.552]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:39,  6.77s/it, train loss=0.7878, val ΔE00=3.190, best=2.552]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:39,  6.77s/it, train loss=0.8454, val ΔE00=2.537, best=2.537]Training (late/resnet18):  42%|████▏     | 42/100 [04:43<06:30,  6.73s/it, train loss=0.8454, val ΔE00=2.537, best=2.537]Training (late/resnet18):  42%|████▏     | 42/100 [04:43<06:30,  6.73s/it, train loss=0.8174, val ΔE00=2.682, best=2.537]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.70s/it, train loss=0.8174, val ΔE00=2.682, best=2.537]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.70s/it, train loss=0.8328, val ΔE00=2.591, best=2.537]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:14,  6.68s/it, train loss=0.8328, val ΔE00=2.591, best=2.537]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:14,  6.68s/it, train loss=0.8475, val ΔE00=3.305, best=2.537]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:10,  6.75s/it, train loss=0.8475, val ΔE00=3.305, best=2.537]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:10,  6.75s/it, train loss=0.8813, val ΔE00=2.562, best=2.537]Training (late/resnet18):  46%|████▌     | 46/100 [05:10<06:03,  6.74s/it, train loss=0.8813, val ΔE00=2.562, best=2.537]Training (late/resnet18):  46%|████▌     | 46/100 [05:10<06:03,  6.74s/it, train loss=0.9073, val ΔE00=2.645, best=2.537]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:55,  6.71s/it, train loss=0.9073, val ΔE00=2.645, best=2.537]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:55,  6.71s/it, train loss=0.8838, val ΔE00=2.684, best=2.537]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:47,  6.69s/it, train loss=0.8838, val ΔE00=2.684, best=2.537]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:47,  6.69s/it, train loss=0.9205, val ΔE00=2.570, best=2.537]Training (late/resnet18):  49%|████▉     | 49/100 [05:29<05:40,  6.67s/it, train loss=0.9205, val ΔE00=2.570, best=2.537]Training (late/resnet18):  49%|████▉     | 49/100 [05:29<05:40,  6.67s/it, train loss=0.9223, val ΔE00=2.728, best=2.537]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:36,  6.73s/it, train loss=0.9223, val ΔE00=2.728, best=2.537]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:36,  6.73s/it, train loss=0.9357, val ΔE00=2.924, best=2.537]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:30,  6.74s/it, train loss=0.9357, val ΔE00=2.924, best=2.537]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:30,  6.74s/it, train loss=0.9041, val ΔE00=2.851, best=2.537]Training (late/resnet18):  52%|█████▏    | 52/100 [05:50<05:23,  6.73s/it, train loss=0.9041, val ΔE00=2.851, best=2.537]Training (late/resnet18):  52%|█████▏    | 52/100 [05:50<05:23,  6.73s/it, train loss=0.9535, val ΔE00=2.525, best=2.525]Training (late/resnet18):  53%|█████▎    | 53/100 [05:56<05:15,  6.71s/it, train loss=0.9535, val ΔE00=2.525, best=2.525]Training (late/resnet18):  53%|█████▎    | 53/100 [05:56<05:15,  6.71s/it, train loss=0.9708, val ΔE00=2.807, best=2.525]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:07,  6.69s/it, train loss=0.9708, val ΔE00=2.807, best=2.525]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:07,  6.69s/it, train loss=0.9661, val ΔE00=2.662, best=2.525]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:04,  6.76s/it, train loss=0.9661, val ΔE00=2.662, best=2.525]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:04,  6.76s/it, train loss=1.0023, val ΔE00=2.511, best=2.511]Training (late/resnet18):  56%|█████▌    | 56/100 [06:17<04:57,  6.76s/it, train loss=1.0023, val ΔE00=2.511, best=2.511]Training (late/resnet18):  56%|█████▌    | 56/100 [06:17<04:57,  6.76s/it, train loss=0.9847, val ΔE00=2.599, best=2.511]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:49,  6.73s/it, train loss=0.9847, val ΔE00=2.599, best=2.511]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:49,  6.73s/it, train loss=1.0425, val ΔE00=2.868, best=2.511]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:41,  6.70s/it, train loss=1.0425, val ΔE00=2.868, best=2.511]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:41,  6.70s/it, train loss=1.0151, val ΔE00=2.751, best=2.511]Training (late/resnet18):  59%|█████▉    | 59/100 [06:37<04:34,  6.69s/it, train loss=1.0151, val ΔE00=2.751, best=2.511]Training (late/resnet18):  59%|█████▉    | 59/100 [06:37<04:34,  6.69s/it, train loss=1.0400, val ΔE00=2.754, best=2.511]Training (late/resnet18):  60%|██████    | 60/100 [06:44<04:30,  6.75s/it, train loss=1.0400, val ΔE00=2.754, best=2.511]Training (late/resnet18):  60%|██████    | 60/100 [06:44<04:30,  6.75s/it, train loss=1.0628, val ΔE00=2.769, best=2.511]Training (late/resnet18):  61%|██████    | 61/100 [06:50<04:23,  6.75s/it, train loss=1.0628, val ΔE00=2.769, best=2.511]Training (late/resnet18):  61%|██████    | 61/100 [06:50<04:23,  6.75s/it, train loss=1.0804, val ΔE00=2.707, best=2.511]Training (late/resnet18):  62%|██████▏   | 62/100 [06:57<04:15,  6.72s/it, train loss=1.0804, val ΔE00=2.707, best=2.511]Training (late/resnet18):  62%|██████▏   | 62/100 [06:57<04:15,  6.72s/it, train loss=1.0104, val ΔE00=2.596, best=2.511]Training (late/resnet18):  63%|██████▎   | 63/100 [07:04<04:07,  6.69s/it, train loss=1.0104, val ΔE00=2.596, best=2.511]Training (late/resnet18):  63%|██████▎   | 63/100 [07:04<04:07,  6.69s/it, train loss=1.0805, val ΔE00=2.594, best=2.511]Training (late/resnet18):  64%|██████▍   | 64/100 [07:10<04:00,  6.67s/it, train loss=1.0805, val ΔE00=2.594, best=2.511]Training (late/resnet18):  64%|██████▍   | 64/100 [07:10<04:00,  6.67s/it, train loss=1.0806, val ΔE00=2.580, best=2.511]Training (late/resnet18):  64%|██████▍   | 64/100 [07:17<04:00,  6.67s/it, train loss=1.0247, val ΔE00=2.723, early_stop=yes]Training (late/resnet18):  64%|██████▍   | 64/100 [07:17<04:06,  6.84s/it, train loss=1.0247, val ΔE00=2.723, early_stop=yes]
[early] stop at epoch 65 (best de00=2.5114 @ 55)
[done] best ΔE00=2.511 over 65 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/late__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 8/24 ===
[sweep] id=008_model=late__backbone=resnet18__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone resnet18 --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image+mean+meta, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:54,  7.22s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:54,  7.22s/it, train loss=0.0098, val ΔE00=6.737, best=6.737]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:16,  6.90s/it, train loss=0.0098, val ΔE00=6.737, best=6.737]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:16,  6.90s/it, train loss=0.0073, val ΔE00=5.622, best=5.622]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:00,  6.81s/it, train loss=0.0073, val ΔE00=5.622, best=5.622]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:00,  6.81s/it, train loss=0.0120, val ΔE00=4.447, best=4.447]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:48,  6.76s/it, train loss=0.0120, val ΔE00=4.447, best=4.447]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:48,  6.76s/it, train loss=0.0203, val ΔE00=3.923, best=3.923]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:47,  6.82s/it, train loss=0.0203, val ΔE00=3.923, best=3.923]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:47,  6.82s/it, train loss=0.0297, val ΔE00=3.958, best=3.923]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:39,  6.80s/it, train loss=0.0297, val ΔE00=3.958, best=3.923]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:39,  6.80s/it, train loss=0.0409, val ΔE00=3.760, best=3.760]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0409, val ΔE00=3.760, best=3.760]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0526, val ΔE00=3.485, best=3.485]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:20,  6.75s/it, train loss=0.0526, val ΔE00=3.485, best=3.485]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:20,  6.75s/it, train loss=0.0676, val ΔE00=3.366, best=3.366]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:12,  6.74s/it, train loss=0.0676, val ΔE00=3.366, best=3.366]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:12,  6.74s/it, train loss=0.0857, val ΔE00=3.343, best=3.343]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:11,  6.79s/it, train loss=0.0857, val ΔE00=3.343, best=3.343]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:11,  6.79s/it, train loss=0.0994, val ΔE00=3.170, best=3.170]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:05,  6.80s/it, train loss=0.0994, val ΔE00=3.170, best=3.170]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:05,  6.80s/it, train loss=0.1210, val ΔE00=3.142, best=3.142]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:55,  6.77s/it, train loss=0.1210, val ΔE00=3.142, best=3.142]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:55,  6.77s/it, train loss=0.1386, val ΔE00=2.971, best=2.971]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:45,  6.73s/it, train loss=0.1386, val ΔE00=2.971, best=2.971]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:45,  6.73s/it, train loss=0.1545, val ΔE00=3.101, best=2.971]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:36,  6.70s/it, train loss=0.1545, val ΔE00=3.101, best=2.971]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:36,  6.70s/it, train loss=0.1766, val ΔE00=3.165, best=2.971]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:37,  6.80s/it, train loss=0.1766, val ΔE00=3.165, best=2.971]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:37,  6.80s/it, train loss=0.1967, val ΔE00=2.839, best=2.839]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:30,  6.79s/it, train loss=0.1967, val ΔE00=2.839, best=2.839]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:30,  6.79s/it, train loss=0.2165, val ΔE00=2.800, best=2.800]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:20,  6.76s/it, train loss=0.2165, val ΔE00=2.800, best=2.800]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:20,  6.76s/it, train loss=0.2409, val ΔE00=2.768, best=2.768]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:11,  6.72s/it, train loss=0.2409, val ΔE00=2.768, best=2.768]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:11,  6.72s/it, train loss=0.2647, val ΔE00=3.029, best=2.768]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:02,  6.69s/it, train loss=0.2647, val ΔE00=3.029, best=2.768]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:02,  6.69s/it, train loss=0.2846, val ΔE00=2.920, best=2.768]Training (late/resnet18):  20%|██        | 20/100 [02:15<08:59,  6.75s/it, train loss=0.2846, val ΔE00=2.920, best=2.768]Training (late/resnet18):  20%|██        | 20/100 [02:15<08:59,  6.75s/it, train loss=0.3045, val ΔE00=2.993, best=2.768]Training (late/resnet18):  21%|██        | 21/100 [02:22<08:53,  6.75s/it, train loss=0.3045, val ΔE00=2.993, best=2.768]Training (late/resnet18):  21%|██        | 21/100 [02:22<08:53,  6.75s/it, train loss=0.3221, val ΔE00=2.834, best=2.768]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:43,  6.71s/it, train loss=0.3221, val ΔE00=2.834, best=2.768]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:43,  6.71s/it, train loss=0.3446, val ΔE00=2.893, best=2.768]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:36,  6.71s/it, train loss=0.3446, val ΔE00=2.893, best=2.768]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:36,  6.71s/it, train loss=0.3621, val ΔE00=2.734, best=2.734]Training (late/resnet18):  24%|██▍       | 24/100 [02:42<08:28,  6.69s/it, train loss=0.3621, val ΔE00=2.734, best=2.734]Training (late/resnet18):  24%|██▍       | 24/100 [02:42<08:28,  6.69s/it, train loss=0.3863, val ΔE00=2.952, best=2.734]Training (late/resnet18):  25%|██▌       | 25/100 [02:49<08:27,  6.77s/it, train loss=0.3863, val ΔE00=2.952, best=2.734]Training (late/resnet18):  25%|██▌       | 25/100 [02:49<08:27,  6.77s/it, train loss=0.4263, val ΔE00=2.706, best=2.706]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:20,  6.76s/it, train loss=0.4263, val ΔE00=2.706, best=2.706]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:20,  6.76s/it, train loss=0.4421, val ΔE00=2.765, best=2.706]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:10,  6.73s/it, train loss=0.4421, val ΔE00=2.765, best=2.706]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:10,  6.73s/it, train loss=0.4770, val ΔE00=2.973, best=2.706]Training (late/resnet18):  28%|██▊       | 28/100 [03:09<08:02,  6.70s/it, train loss=0.4770, val ΔE00=2.973, best=2.706]Training (late/resnet18):  28%|██▊       | 28/100 [03:09<08:02,  6.70s/it, train loss=0.4745, val ΔE00=2.883, best=2.706]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:54,  6.68s/it, train loss=0.4745, val ΔE00=2.883, best=2.706]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:54,  6.68s/it, train loss=0.5423, val ΔE00=2.933, best=2.706]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:51,  6.74s/it, train loss=0.5423, val ΔE00=2.933, best=2.706]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:51,  6.74s/it, train loss=0.5448, val ΔE00=2.929, best=2.706]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:45,  6.74s/it, train loss=0.5448, val ΔE00=2.929, best=2.706]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:45,  6.74s/it, train loss=0.5762, val ΔE00=2.861, best=2.706]Training (late/resnet18):  32%|███▏      | 32/100 [03:36<07:37,  6.73s/it, train loss=0.5762, val ΔE00=2.861, best=2.706]Training (late/resnet18):  32%|███▏      | 32/100 [03:36<07:37,  6.73s/it, train loss=0.5772, val ΔE00=2.640, best=2.640]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:29,  6.71s/it, train loss=0.5772, val ΔE00=2.640, best=2.640]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:29,  6.71s/it, train loss=0.5920, val ΔE00=2.705, best=2.640]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:21,  6.69s/it, train loss=0.5920, val ΔE00=2.705, best=2.640]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:21,  6.69s/it, train loss=0.6345, val ΔE00=3.124, best=2.640]Training (late/resnet18):  35%|███▌      | 35/100 [03:56<07:20,  6.78s/it, train loss=0.6345, val ΔE00=3.124, best=2.640]Training (late/resnet18):  35%|███▌      | 35/100 [03:56<07:20,  6.78s/it, train loss=0.6308, val ΔE00=2.612, best=2.612]Training (late/resnet18):  36%|███▌      | 36/100 [04:03<07:12,  6.76s/it, train loss=0.6308, val ΔE00=2.612, best=2.612]Training (late/resnet18):  36%|███▌      | 36/100 [04:03<07:12,  6.76s/it, train loss=0.6597, val ΔE00=2.969, best=2.612]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:03,  6.73s/it, train loss=0.6597, val ΔE00=2.969, best=2.612]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:03,  6.73s/it, train loss=0.6926, val ΔE00=2.975, best=2.612]Training (late/resnet18):  38%|███▊      | 38/100 [04:16<06:55,  6.70s/it, train loss=0.6926, val ΔE00=2.975, best=2.612]Training (late/resnet18):  38%|███▊      | 38/100 [04:16<06:55,  6.70s/it, train loss=0.7230, val ΔE00=3.028, best=2.612]Training (late/resnet18):  39%|███▉      | 39/100 [04:23<06:47,  6.69s/it, train loss=0.7230, val ΔE00=3.028, best=2.612]Training (late/resnet18):  39%|███▉      | 39/100 [04:23<06:47,  6.69s/it, train loss=0.7409, val ΔE00=2.840, best=2.612]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:44,  6.75s/it, train loss=0.7409, val ΔE00=2.840, best=2.612]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:44,  6.75s/it, train loss=0.7615, val ΔE00=2.777, best=2.612]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:38,  6.75s/it, train loss=0.7615, val ΔE00=2.777, best=2.612]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:38,  6.75s/it, train loss=0.7991, val ΔE00=2.963, best=2.612]Training (late/resnet18):  42%|████▏     | 42/100 [04:43<06:29,  6.72s/it, train loss=0.7991, val ΔE00=2.963, best=2.612]Training (late/resnet18):  42%|████▏     | 42/100 [04:43<06:29,  6.72s/it, train loss=0.8071, val ΔE00=2.875, best=2.612]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.70s/it, train loss=0.8071, val ΔE00=2.875, best=2.612]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.70s/it, train loss=0.8068, val ΔE00=2.770, best=2.612]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:14,  6.68s/it, train loss=0.8068, val ΔE00=2.770, best=2.612]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:14,  6.68s/it, train loss=0.8337, val ΔE00=2.684, best=2.612]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:10,  6.74s/it, train loss=0.8337, val ΔE00=2.684, best=2.612]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:10,  6.74s/it, train loss=0.8352, val ΔE00=3.067, best=2.612]Training (late/resnet18):  46%|████▌     | 46/100 [05:10<06:04,  6.75s/it, train loss=0.8352, val ΔE00=3.067, best=2.612]Training (late/resnet18):  46%|████▌     | 46/100 [05:10<06:04,  6.75s/it, train loss=0.8525, val ΔE00=2.810, best=2.612]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:55,  6.71s/it, train loss=0.8525, val ΔE00=2.810, best=2.612]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:55,  6.71s/it, train loss=0.8632, val ΔE00=2.912, best=2.612]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:47,  6.69s/it, train loss=0.8632, val ΔE00=2.912, best=2.612]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:47,  6.69s/it, train loss=0.8724, val ΔE00=2.997, best=2.612]Training (late/resnet18):  49%|████▉     | 49/100 [05:30<05:40,  6.67s/it, train loss=0.8724, val ΔE00=2.997, best=2.612]Training (late/resnet18):  49%|████▉     | 49/100 [05:30<05:40,  6.67s/it, train loss=0.8753, val ΔE00=3.024, best=2.612]Training (late/resnet18):  50%|█████     | 50/100 [05:37<05:36,  6.73s/it, train loss=0.8753, val ΔE00=3.024, best=2.612]Training (late/resnet18):  50%|█████     | 50/100 [05:37<05:36,  6.73s/it, train loss=0.9425, val ΔE00=2.818, best=2.612]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:30,  6.74s/it, train loss=0.9425, val ΔE00=2.818, best=2.612]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:30,  6.74s/it, train loss=0.9496, val ΔE00=2.740, best=2.612]Training (late/resnet18):  52%|█████▏    | 52/100 [05:50<05:22,  6.71s/it, train loss=0.9496, val ΔE00=2.740, best=2.612]Training (late/resnet18):  52%|█████▏    | 52/100 [05:50<05:22,  6.71s/it, train loss=0.9386, val ΔE00=2.802, best=2.612]Training (late/resnet18):  53%|█████▎    | 53/100 [05:57<05:14,  6.69s/it, train loss=0.9386, val ΔE00=2.802, best=2.612]Training (late/resnet18):  53%|█████▎    | 53/100 [05:57<05:14,  6.69s/it, train loss=0.9649, val ΔE00=2.780, best=2.612]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:07,  6.67s/it, train loss=0.9649, val ΔE00=2.780, best=2.612]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:07,  6.67s/it, train loss=0.9492, val ΔE00=2.708, best=2.612]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:03,  6.74s/it, train loss=0.9492, val ΔE00=2.708, best=2.612]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:03,  6.74s/it, train loss=0.9639, val ΔE00=2.888, best=2.612]Training (late/resnet18):  56%|█████▌    | 56/100 [06:17<04:56,  6.74s/it, train loss=0.9639, val ΔE00=2.888, best=2.612]Training (late/resnet18):  56%|█████▌    | 56/100 [06:17<04:56,  6.74s/it, train loss=1.0838, val ΔE00=2.763, best=2.612]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:48,  6.71s/it, train loss=1.0838, val ΔE00=2.763, best=2.612]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:48,  6.71s/it, train loss=1.0934, val ΔE00=3.197, best=2.612]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:41,  6.69s/it, train loss=1.0934, val ΔE00=3.197, best=2.612]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:41,  6.69s/it, train loss=0.9532, val ΔE00=2.838, best=2.612]Training (late/resnet18):  58%|█████▊    | 58/100 [06:37<04:41,  6.69s/it, train loss=1.0530, val ΔE00=2.661, early_stop=yes]Training (late/resnet18):  58%|█████▊    | 58/100 [06:37<04:47,  6.85s/it, train loss=1.0530, val ΔE00=2.661, early_stop=yes]
[early] stop at epoch 59 (best de00=2.6118 @ 35)
[done] best ΔE00=2.612 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/late__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 9/24 ===
[sweep] id=009_model=film__backbone=smallcnn__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone smallcnn --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:04<08:11,  4.96s/it]Training (film/smallcnn):   1%|          | 1/100 [00:04<08:11,  4.96s/it, train loss=0.0070, val ΔE00=8.845, best=8.845]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:38,  4.68s/it, train loss=0.0070, val ΔE00=8.845, best=8.845]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:38,  4.68s/it, train loss=0.0077, val ΔE00=5.109, best=5.109]Training (film/smallcnn):   3%|▎         | 3/100 [00:13<07:25,  4.59s/it, train loss=0.0077, val ΔE00=5.109, best=5.109]Training (film/smallcnn):   3%|▎         | 3/100 [00:13<07:25,  4.59s/it, train loss=0.0137, val ΔE00=5.531, best=5.109]Training (film/smallcnn):   4%|▍         | 4/100 [00:18<07:16,  4.54s/it, train loss=0.0137, val ΔE00=5.531, best=5.109]Training (film/smallcnn):   4%|▍         | 4/100 [00:18<07:16,  4.54s/it, train loss=0.0243, val ΔE00=5.041, best=5.041]Training (film/smallcnn):   5%|▌         | 5/100 [00:23<07:18,  4.61s/it, train loss=0.0243, val ΔE00=5.041, best=5.041]Training (film/smallcnn):   5%|▌         | 5/100 [00:23<07:18,  4.61s/it, train loss=0.0375, val ΔE00=6.209, best=5.041]Training (film/smallcnn):   6%|▌         | 6/100 [00:27<07:12,  4.60s/it, train loss=0.0375, val ΔE00=6.209, best=5.041]Training (film/smallcnn):   6%|▌         | 6/100 [00:27<07:12,  4.60s/it, train loss=0.0565, val ΔE00=5.953, best=5.041]Training (film/smallcnn):   7%|▋         | 7/100 [00:32<07:03,  4.56s/it, train loss=0.0565, val ΔE00=5.953, best=5.041]Training (film/smallcnn):   7%|▋         | 7/100 [00:32<07:03,  4.56s/it, train loss=0.0768, val ΔE00=5.001, best=5.001]Training (film/smallcnn):   8%|▊         | 8/100 [00:36<06:56,  4.53s/it, train loss=0.0768, val ΔE00=5.001, best=5.001]Training (film/smallcnn):   8%|▊         | 8/100 [00:36<06:56,  4.53s/it, train loss=0.0978, val ΔE00=5.172, best=5.001]Training (film/smallcnn):   9%|▉         | 9/100 [00:41<06:51,  4.52s/it, train loss=0.0978, val ΔE00=5.172, best=5.001]Training (film/smallcnn):   9%|▉         | 9/100 [00:41<06:51,  4.52s/it, train loss=0.1196, val ΔE00=7.652, best=5.001]Training (film/smallcnn):  10%|█         | 10/100 [00:45<06:52,  4.58s/it, train loss=0.1196, val ΔE00=7.652, best=5.001]Training (film/smallcnn):  10%|█         | 10/100 [00:45<06:52,  4.58s/it, train loss=0.1545, val ΔE00=4.573, best=4.573]Training (film/smallcnn):  11%|█         | 11/100 [00:50<06:47,  4.58s/it, train loss=0.1545, val ΔE00=4.573, best=4.573]Training (film/smallcnn):  11%|█         | 11/100 [00:50<06:47,  4.58s/it, train loss=0.1748, val ΔE00=4.774, best=4.573]Training (film/smallcnn):  12%|█▏        | 12/100 [00:54<06:40,  4.55s/it, train loss=0.1748, val ΔE00=4.774, best=4.573]Training (film/smallcnn):  12%|█▏        | 12/100 [00:54<06:40,  4.55s/it, train loss=0.2150, val ΔE00=4.775, best=4.573]Training (film/smallcnn):  13%|█▎        | 13/100 [00:59<06:33,  4.53s/it, train loss=0.2150, val ΔE00=4.775, best=4.573]Training (film/smallcnn):  13%|█▎        | 13/100 [00:59<06:33,  4.53s/it, train loss=0.2489, val ΔE00=4.276, best=4.276]Training (film/smallcnn):  14%|█▍        | 14/100 [01:03<06:27,  4.51s/it, train loss=0.2489, val ΔE00=4.276, best=4.276]Training (film/smallcnn):  14%|█▍        | 14/100 [01:03<06:27,  4.51s/it, train loss=0.2807, val ΔE00=5.282, best=4.276]Training (film/smallcnn):  15%|█▌        | 15/100 [01:08<06:28,  4.57s/it, train loss=0.2807, val ΔE00=5.282, best=4.276]Training (film/smallcnn):  15%|█▌        | 15/100 [01:08<06:28,  4.57s/it, train loss=0.3250, val ΔE00=4.119, best=4.119]Training (film/smallcnn):  16%|█▌        | 16/100 [01:13<06:24,  4.58s/it, train loss=0.3250, val ΔE00=4.119, best=4.119]Training (film/smallcnn):  16%|█▌        | 16/100 [01:13<06:24,  4.58s/it, train loss=0.3669, val ΔE00=4.684, best=4.119]Training (film/smallcnn):  17%|█▋        | 17/100 [01:17<06:17,  4.55s/it, train loss=0.3669, val ΔE00=4.684, best=4.119]Training (film/smallcnn):  17%|█▋        | 17/100 [01:17<06:17,  4.55s/it, train loss=0.4296, val ΔE00=4.833, best=4.119]Training (film/smallcnn):  18%|█▊        | 18/100 [01:22<06:11,  4.53s/it, train loss=0.4296, val ΔE00=4.833, best=4.119]Training (film/smallcnn):  18%|█▊        | 18/100 [01:22<06:11,  4.53s/it, train loss=0.4731, val ΔE00=4.773, best=4.119]Training (film/smallcnn):  19%|█▉        | 19/100 [01:26<06:05,  4.51s/it, train loss=0.4731, val ΔE00=4.773, best=4.119]Training (film/smallcnn):  19%|█▉        | 19/100 [01:26<06:05,  4.51s/it, train loss=0.5249, val ΔE00=4.178, best=4.119]Training (film/smallcnn):  20%|██        | 20/100 [01:31<06:04,  4.56s/it, train loss=0.5249, val ΔE00=4.178, best=4.119]Training (film/smallcnn):  20%|██        | 20/100 [01:31<06:04,  4.56s/it, train loss=0.5753, val ΔE00=4.497, best=4.119]Training (film/smallcnn):  21%|██        | 21/100 [01:35<06:01,  4.58s/it, train loss=0.5753, val ΔE00=4.497, best=4.119]Training (film/smallcnn):  21%|██        | 21/100 [01:35<06:01,  4.58s/it, train loss=0.6105, val ΔE00=4.216, best=4.119]Training (film/smallcnn):  22%|██▏       | 22/100 [01:40<05:54,  4.54s/it, train loss=0.6105, val ΔE00=4.216, best=4.119]Training (film/smallcnn):  22%|██▏       | 22/100 [01:40<05:54,  4.54s/it, train loss=0.6747, val ΔE00=4.376, best=4.119]Training (film/smallcnn):  23%|██▎       | 23/100 [01:44<05:48,  4.52s/it, train loss=0.6747, val ΔE00=4.376, best=4.119]Training (film/smallcnn):  23%|██▎       | 23/100 [01:44<05:48,  4.52s/it, train loss=0.7302, val ΔE00=3.924, best=3.924]Training (film/smallcnn):  24%|██▍       | 24/100 [01:49<05:42,  4.51s/it, train loss=0.7302, val ΔE00=3.924, best=3.924]Training (film/smallcnn):  24%|██▍       | 24/100 [01:49<05:42,  4.51s/it, train loss=0.7830, val ΔE00=4.007, best=3.924]Training (film/smallcnn):  25%|██▌       | 25/100 [01:53<05:42,  4.56s/it, train loss=0.7830, val ΔE00=4.007, best=3.924]Training (film/smallcnn):  25%|██▌       | 25/100 [01:53<05:42,  4.56s/it, train loss=0.8902, val ΔE00=4.615, best=3.924]Training (film/smallcnn):  26%|██▌       | 26/100 [01:58<05:38,  4.58s/it, train loss=0.8902, val ΔE00=4.615, best=3.924]Training (film/smallcnn):  26%|██▌       | 26/100 [01:58<05:38,  4.58s/it, train loss=0.9107, val ΔE00=4.482, best=3.924]Training (film/smallcnn):  27%|██▋       | 27/100 [02:03<05:31,  4.54s/it, train loss=0.9107, val ΔE00=4.482, best=3.924]Training (film/smallcnn):  27%|██▋       | 27/100 [02:03<05:31,  4.54s/it, train loss=0.9833, val ΔE00=4.191, best=3.924]Training (film/smallcnn):  28%|██▊       | 28/100 [02:07<05:25,  4.53s/it, train loss=0.9833, val ΔE00=4.191, best=3.924]Training (film/smallcnn):  28%|██▊       | 28/100 [02:07<05:25,  4.53s/it, train loss=1.0507, val ΔE00=4.304, best=3.924]Training (film/smallcnn):  29%|██▉       | 29/100 [02:12<05:20,  4.51s/it, train loss=1.0507, val ΔE00=4.304, best=3.924]Training (film/smallcnn):  29%|██▉       | 29/100 [02:12<05:20,  4.51s/it, train loss=1.0915, val ΔE00=4.407, best=3.924]Training (film/smallcnn):  30%|███       | 30/100 [02:16<05:19,  4.56s/it, train loss=1.0915, val ΔE00=4.407, best=3.924]Training (film/smallcnn):  30%|███       | 30/100 [02:16<05:19,  4.56s/it, train loss=1.0881, val ΔE00=3.573, best=3.573]Training (film/smallcnn):  31%|███       | 31/100 [02:21<05:15,  4.58s/it, train loss=1.0881, val ΔE00=3.573, best=3.573]Training (film/smallcnn):  31%|███       | 31/100 [02:21<05:15,  4.58s/it, train loss=1.1963, val ΔE00=4.047, best=3.573]Training (film/smallcnn):  32%|███▏      | 32/100 [02:25<05:09,  4.55s/it, train loss=1.1963, val ΔE00=4.047, best=3.573]Training (film/smallcnn):  32%|███▏      | 32/100 [02:25<05:09,  4.55s/it, train loss=1.3007, val ΔE00=3.882, best=3.573]Training (film/smallcnn):  33%|███▎      | 33/100 [02:30<05:03,  4.53s/it, train loss=1.3007, val ΔE00=3.882, best=3.573]Training (film/smallcnn):  33%|███▎      | 33/100 [02:30<05:03,  4.53s/it, train loss=1.3605, val ΔE00=3.839, best=3.573]Training (film/smallcnn):  34%|███▍      | 34/100 [02:34<04:57,  4.51s/it, train loss=1.3605, val ΔE00=3.839, best=3.573]Training (film/smallcnn):  34%|███▍      | 34/100 [02:34<04:57,  4.51s/it, train loss=1.4146, val ΔE00=4.572, best=3.573]Training (film/smallcnn):  35%|███▌      | 35/100 [02:39<04:56,  4.57s/it, train loss=1.4146, val ΔE00=4.572, best=3.573]Training (film/smallcnn):  35%|███▌      | 35/100 [02:39<04:56,  4.57s/it, train loss=1.5001, val ΔE00=4.162, best=3.573]Training (film/smallcnn):  36%|███▌      | 36/100 [02:44<04:53,  4.58s/it, train loss=1.5001, val ΔE00=4.162, best=3.573]Training (film/smallcnn):  36%|███▌      | 36/100 [02:44<04:53,  4.58s/it, train loss=1.5851, val ΔE00=5.211, best=3.573]Training (film/smallcnn):  37%|███▋      | 37/100 [02:48<04:46,  4.55s/it, train loss=1.5851, val ΔE00=5.211, best=3.573]Training (film/smallcnn):  37%|███▋      | 37/100 [02:48<04:46,  4.55s/it, train loss=1.6032, val ΔE00=3.883, best=3.573]Training (film/smallcnn):  38%|███▊      | 38/100 [02:53<04:40,  4.53s/it, train loss=1.6032, val ΔE00=3.883, best=3.573]Training (film/smallcnn):  38%|███▊      | 38/100 [02:53<04:40,  4.53s/it, train loss=1.6776, val ΔE00=3.997, best=3.573]Training (film/smallcnn):  39%|███▉      | 39/100 [02:57<04:35,  4.52s/it, train loss=1.6776, val ΔE00=3.997, best=3.573]Training (film/smallcnn):  39%|███▉      | 39/100 [02:57<04:35,  4.52s/it, train loss=1.7202, val ΔE00=4.267, best=3.573]Training (film/smallcnn):  40%|████      | 40/100 [03:02<04:34,  4.58s/it, train loss=1.7202, val ΔE00=4.267, best=3.573]Training (film/smallcnn):  40%|████      | 40/100 [03:02<04:34,  4.58s/it, train loss=1.8416, val ΔE00=4.107, best=3.573]Training (film/smallcnn):  41%|████      | 41/100 [03:06<04:30,  4.58s/it, train loss=1.8416, val ΔE00=4.107, best=3.573]Training (film/smallcnn):  41%|████      | 41/100 [03:06<04:30,  4.58s/it, train loss=1.8918, val ΔE00=3.736, best=3.573]Training (film/smallcnn):  42%|████▏     | 42/100 [03:11<04:23,  4.55s/it, train loss=1.8918, val ΔE00=3.736, best=3.573]Training (film/smallcnn):  42%|████▏     | 42/100 [03:11<04:23,  4.55s/it, train loss=1.9495, val ΔE00=3.988, best=3.573]Training (film/smallcnn):  43%|████▎     | 43/100 [03:15<04:18,  4.53s/it, train loss=1.9495, val ΔE00=3.988, best=3.573]Training (film/smallcnn):  43%|████▎     | 43/100 [03:15<04:18,  4.53s/it, train loss=1.9893, val ΔE00=4.919, best=3.573]Training (film/smallcnn):  44%|████▍     | 44/100 [03:20<04:12,  4.51s/it, train loss=1.9893, val ΔE00=4.919, best=3.573]Training (film/smallcnn):  44%|████▍     | 44/100 [03:20<04:12,  4.51s/it, train loss=2.1878, val ΔE00=4.269, best=3.573]Training (film/smallcnn):  45%|████▌     | 45/100 [03:24<04:11,  4.57s/it, train loss=2.1878, val ΔE00=4.269, best=3.573]Training (film/smallcnn):  45%|████▌     | 45/100 [03:24<04:11,  4.57s/it, train loss=2.2231, val ΔE00=4.336, best=3.573]Training (film/smallcnn):  46%|████▌     | 46/100 [03:29<04:07,  4.58s/it, train loss=2.2231, val ΔE00=4.336, best=3.573]Training (film/smallcnn):  46%|████▌     | 46/100 [03:29<04:07,  4.58s/it, train loss=2.1716, val ΔE00=4.586, best=3.573]Training (film/smallcnn):  47%|████▋     | 47/100 [03:34<04:01,  4.55s/it, train loss=2.1716, val ΔE00=4.586, best=3.573]Training (film/smallcnn):  47%|████▋     | 47/100 [03:34<04:01,  4.55s/it, train loss=2.3974, val ΔE00=4.524, best=3.573]Training (film/smallcnn):  48%|████▊     | 48/100 [03:38<03:55,  4.53s/it, train loss=2.3974, val ΔE00=4.524, best=3.573]Training (film/smallcnn):  48%|████▊     | 48/100 [03:38<03:55,  4.53s/it, train loss=2.3867, val ΔE00=3.663, best=3.573]Training (film/smallcnn):  49%|████▉     | 49/100 [03:43<03:50,  4.51s/it, train loss=2.3867, val ΔE00=3.663, best=3.573]Training (film/smallcnn):  49%|████▉     | 49/100 [03:43<03:50,  4.51s/it, train loss=2.4329, val ΔE00=4.189, best=3.573]Training (film/smallcnn):  50%|█████     | 50/100 [03:47<03:48,  4.58s/it, train loss=2.4329, val ΔE00=4.189, best=3.573]Training (film/smallcnn):  50%|█████     | 50/100 [03:47<03:48,  4.58s/it, train loss=2.5713, val ΔE00=4.410, best=3.573]Training (film/smallcnn):  51%|█████     | 51/100 [03:52<03:43,  4.57s/it, train loss=2.5713, val ΔE00=4.410, best=3.573]Training (film/smallcnn):  51%|█████     | 51/100 [03:52<03:43,  4.57s/it, train loss=2.4823, val ΔE00=4.857, best=3.573]Training (film/smallcnn):  52%|█████▏    | 52/100 [03:56<03:37,  4.54s/it, train loss=2.4823, val ΔE00=4.857, best=3.573]Training (film/smallcnn):  52%|█████▏    | 52/100 [03:56<03:37,  4.54s/it, train loss=2.5481, val ΔE00=3.651, best=3.573]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:01<03:32,  4.52s/it, train loss=2.5481, val ΔE00=3.651, best=3.573]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:01<03:32,  4.52s/it, train loss=2.6854, val ΔE00=4.156, best=3.573]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:05<03:27,  4.51s/it, train loss=2.6854, val ΔE00=4.156, best=3.573]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:05<03:27,  4.51s/it, train loss=2.6686, val ΔE00=3.912, best=3.573]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:10<03:26,  4.58s/it, train loss=2.6686, val ΔE00=3.912, best=3.573]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:10<03:26,  4.58s/it, train loss=2.6643, val ΔE00=4.200, best=3.573]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:15<03:20,  4.57s/it, train loss=2.6643, val ΔE00=4.200, best=3.573]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:15<03:20,  4.57s/it, train loss=2.8372, val ΔE00=3.969, best=3.573]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:19<03:15,  4.54s/it, train loss=2.8372, val ΔE00=3.969, best=3.573]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:19<03:15,  4.54s/it, train loss=2.7838, val ΔE00=4.286, best=3.573]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:23<03:10,  4.52s/it, train loss=2.7838, val ΔE00=4.286, best=3.573]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:23<03:10,  4.52s/it, train loss=2.8065, val ΔE00=4.324, best=3.573]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:28<03:10,  4.52s/it, train loss=2.7980, val ΔE00=3.930, early_stop=yes]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:28<03:14,  4.63s/it, train loss=2.7980, val ΔE00=3.930, early_stop=yes]
[early] stop at epoch 59 (best de00=3.5733 @ 30)
[done] best ΔE00=3.573 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/film__smallcnn__image__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image/final_summary.json (kind=val)
[sweep] === Run 10/24 ===
[sweep] id=010_model=film__backbone=smallcnn__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone smallcnn --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image+mean, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:33,  5.19s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:33,  5.19s/it, train loss=0.0063, val ΔE00=7.277, best=7.277]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:59,  4.89s/it, train loss=0.0063, val ΔE00=7.277, best=7.277]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:59,  4.89s/it, train loss=0.0072, val ΔE00=5.492, best=5.492]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:44,  4.79s/it, train loss=0.0072, val ΔE00=5.492, best=5.492]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:44,  4.79s/it, train loss=0.0124, val ΔE00=4.864, best=4.864]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:35,  4.75s/it, train loss=0.0124, val ΔE00=4.864, best=4.864]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:35,  4.75s/it, train loss=0.0222, val ΔE00=5.573, best=4.864]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:36,  4.81s/it, train loss=0.0222, val ΔE00=5.573, best=4.864]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:36,  4.81s/it, train loss=0.0353, val ΔE00=5.003, best=4.864]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:31,  4.80s/it, train loss=0.0353, val ΔE00=5.003, best=4.864]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:31,  4.80s/it, train loss=0.0503, val ΔE00=4.630, best=4.630]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:23,  4.76s/it, train loss=0.0503, val ΔE00=4.630, best=4.630]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:23,  4.76s/it, train loss=0.0700, val ΔE00=4.711, best=4.630]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:16,  4.74s/it, train loss=0.0700, val ΔE00=4.711, best=4.630]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:16,  4.74s/it, train loss=0.0875, val ΔE00=5.290, best=4.630]Training (film/smallcnn):   9%|▉         | 9/100 [00:42<07:09,  4.72s/it, train loss=0.0875, val ΔE00=5.290, best=4.630]Training (film/smallcnn):   9%|▉         | 9/100 [00:42<07:09,  4.72s/it, train loss=0.1102, val ΔE00=4.580, best=4.580]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:09,  4.78s/it, train loss=0.1102, val ΔE00=4.580, best=4.580]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:09,  4.78s/it, train loss=0.1332, val ΔE00=4.827, best=4.580]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:06,  4.79s/it, train loss=0.1332, val ΔE00=4.827, best=4.580]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:06,  4.79s/it, train loss=0.1645, val ΔE00=4.284, best=4.284]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:58,  4.75s/it, train loss=0.1645, val ΔE00=4.284, best=4.284]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:58,  4.75s/it, train loss=0.1945, val ΔE00=4.502, best=4.284]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:51,  4.73s/it, train loss=0.1945, val ΔE00=4.502, best=4.284]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:51,  4.73s/it, train loss=0.2296, val ΔE00=3.857, best=3.857]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:45,  4.71s/it, train loss=0.2296, val ΔE00=3.857, best=3.857]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:45,  4.71s/it, train loss=0.2601, val ΔE00=3.568, best=3.568]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:45,  4.76s/it, train loss=0.2601, val ΔE00=3.568, best=3.568]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:45,  4.76s/it, train loss=0.2947, val ΔE00=4.055, best=3.568]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:41,  4.78s/it, train loss=0.2947, val ΔE00=4.055, best=3.568]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:41,  4.78s/it, train loss=0.3304, val ΔE00=3.864, best=3.568]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:33,  4.75s/it, train loss=0.3304, val ΔE00=3.864, best=3.568]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:33,  4.75s/it, train loss=0.3570, val ΔE00=4.181, best=3.568]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:27,  4.73s/it, train loss=0.3570, val ΔE00=4.181, best=3.568]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:27,  4.73s/it, train loss=0.4170, val ΔE00=3.679, best=3.568]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:21,  4.71s/it, train loss=0.4170, val ΔE00=3.679, best=3.568]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:21,  4.71s/it, train loss=0.4635, val ΔE00=4.530, best=3.568]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:21,  4.76s/it, train loss=0.4635, val ΔE00=4.530, best=3.568]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:21,  4.76s/it, train loss=0.5096, val ΔE00=4.106, best=3.568]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:16,  4.77s/it, train loss=0.5096, val ΔE00=4.106, best=3.568]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:16,  4.77s/it, train loss=0.5237, val ΔE00=3.667, best=3.568]Training (film/smallcnn):  22%|██▏       | 22/100 [01:44<06:09,  4.74s/it, train loss=0.5237, val ΔE00=3.667, best=3.568]Training (film/smallcnn):  22%|██▏       | 22/100 [01:44<06:09,  4.74s/it, train loss=0.6036, val ΔE00=4.118, best=3.568]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:03,  4.72s/it, train loss=0.6036, val ΔE00=4.118, best=3.568]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:03,  4.72s/it, train loss=0.6417, val ΔE00=3.684, best=3.568]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:57,  4.71s/it, train loss=0.6417, val ΔE00=3.684, best=3.568]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:57,  4.71s/it, train loss=0.7186, val ΔE00=3.887, best=3.568]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:57,  4.76s/it, train loss=0.7186, val ΔE00=3.887, best=3.568]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:57,  4.76s/it, train loss=0.7366, val ΔE00=3.847, best=3.568]Training (film/smallcnn):  26%|██▌       | 26/100 [02:03<05:53,  4.78s/it, train loss=0.7366, val ΔE00=3.847, best=3.568]Training (film/smallcnn):  26%|██▌       | 26/100 [02:03<05:53,  4.78s/it, train loss=0.7920, val ΔE00=3.733, best=3.568]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:46,  4.75s/it, train loss=0.7920, val ΔE00=3.733, best=3.568]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:46,  4.75s/it, train loss=0.8674, val ΔE00=3.791, best=3.568]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:40,  4.72s/it, train loss=0.8674, val ΔE00=3.791, best=3.568]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:40,  4.72s/it, train loss=0.9412, val ΔE00=4.291, best=3.568]Training (film/smallcnn):  29%|██▉       | 29/100 [02:17<05:34,  4.71s/it, train loss=0.9412, val ΔE00=4.291, best=3.568]Training (film/smallcnn):  29%|██▉       | 29/100 [02:17<05:34,  4.71s/it, train loss=0.9557, val ΔE00=4.054, best=3.568]Training (film/smallcnn):  30%|███       | 30/100 [02:22<05:33,  4.76s/it, train loss=0.9557, val ΔE00=4.054, best=3.568]Training (film/smallcnn):  30%|███       | 30/100 [02:22<05:33,  4.76s/it, train loss=1.0355, val ΔE00=3.753, best=3.568]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:28,  4.77s/it, train loss=1.0355, val ΔE00=3.753, best=3.568]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:28,  4.77s/it, train loss=1.1379, val ΔE00=4.314, best=3.568]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:22,  4.74s/it, train loss=1.1379, val ΔE00=4.314, best=3.568]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:22,  4.74s/it, train loss=1.2077, val ΔE00=4.251, best=3.568]Training (film/smallcnn):  33%|███▎      | 33/100 [02:36<05:15,  4.72s/it, train loss=1.2077, val ΔE00=4.251, best=3.568]Training (film/smallcnn):  33%|███▎      | 33/100 [02:36<05:15,  4.72s/it, train loss=1.2289, val ΔE00=4.337, best=3.568]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:10,  4.71s/it, train loss=1.2289, val ΔE00=4.337, best=3.568]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:10,  4.71s/it, train loss=1.2790, val ΔE00=4.192, best=3.568]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:09,  4.76s/it, train loss=1.2790, val ΔE00=4.192, best=3.568]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:09,  4.76s/it, train loss=1.3492, val ΔE00=3.852, best=3.568]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:05,  4.77s/it, train loss=1.3492, val ΔE00=3.852, best=3.568]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:05,  4.77s/it, train loss=1.4116, val ΔE00=4.410, best=3.568]Training (film/smallcnn):  37%|███▋      | 37/100 [02:55<04:58,  4.74s/it, train loss=1.4116, val ΔE00=4.410, best=3.568]Training (film/smallcnn):  37%|███▋      | 37/100 [02:55<04:58,  4.74s/it, train loss=1.4543, val ΔE00=4.097, best=3.568]Training (film/smallcnn):  38%|███▊      | 38/100 [03:00<04:52,  4.72s/it, train loss=1.4543, val ΔE00=4.097, best=3.568]Training (film/smallcnn):  38%|███▊      | 38/100 [03:00<04:52,  4.72s/it, train loss=1.5505, val ΔE00=4.060, best=3.568]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:46,  4.70s/it, train loss=1.5505, val ΔE00=4.060, best=3.568]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:46,  4.70s/it, train loss=1.5644, val ΔE00=3.954, best=3.568]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:45,  4.76s/it, train loss=1.5644, val ΔE00=3.954, best=3.568]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:45,  4.76s/it, train loss=1.6400, val ΔE00=3.841, best=3.568]Training (film/smallcnn):  41%|████      | 41/100 [03:14<04:41,  4.77s/it, train loss=1.6400, val ΔE00=3.841, best=3.568]Training (film/smallcnn):  41%|████      | 41/100 [03:14<04:41,  4.77s/it, train loss=1.6695, val ΔE00=3.678, best=3.568]Training (film/smallcnn):  42%|████▏     | 42/100 [03:19<04:34,  4.74s/it, train loss=1.6695, val ΔE00=3.678, best=3.568]Training (film/smallcnn):  42%|████▏     | 42/100 [03:19<04:34,  4.74s/it, train loss=1.7972, val ΔE00=3.996, best=3.568]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:28,  4.72s/it, train loss=1.7972, val ΔE00=3.996, best=3.568]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:28,  4.72s/it, train loss=1.7022, val ΔE00=3.879, best=3.568]Training (film/smallcnn):  44%|████▍     | 44/100 [03:28<04:23,  4.70s/it, train loss=1.7022, val ΔE00=3.879, best=3.568]Training (film/smallcnn):  44%|████▍     | 44/100 [03:28<04:23,  4.70s/it, train loss=2.0050, val ΔE00=3.689, best=3.568]Training (film/smallcnn):  45%|████▌     | 45/100 [03:33<04:21,  4.76s/it, train loss=2.0050, val ΔE00=3.689, best=3.568]Training (film/smallcnn):  45%|████▌     | 45/100 [03:33<04:21,  4.76s/it, train loss=1.8644, val ΔE00=3.537, best=3.537]Training (film/smallcnn):  46%|████▌     | 46/100 [03:38<04:17,  4.77s/it, train loss=1.8644, val ΔE00=3.537, best=3.537]Training (film/smallcnn):  46%|████▌     | 46/100 [03:38<04:17,  4.77s/it, train loss=2.0166, val ΔE00=4.721, best=3.537]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:11,  4.74s/it, train loss=2.0166, val ΔE00=4.721, best=3.537]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:11,  4.74s/it, train loss=2.0098, val ΔE00=3.739, best=3.537]Training (film/smallcnn):  48%|████▊     | 48/100 [03:47<04:05,  4.72s/it, train loss=2.0098, val ΔE00=3.739, best=3.537]Training (film/smallcnn):  48%|████▊     | 48/100 [03:47<04:05,  4.72s/it, train loss=2.0854, val ΔE00=3.580, best=3.537]Training (film/smallcnn):  49%|████▉     | 49/100 [03:52<03:59,  4.70s/it, train loss=2.0854, val ΔE00=3.580, best=3.537]Training (film/smallcnn):  49%|████▉     | 49/100 [03:52<03:59,  4.70s/it, train loss=2.2080, val ΔE00=3.837, best=3.537]Training (film/smallcnn):  50%|█████     | 50/100 [03:57<03:57,  4.75s/it, train loss=2.2080, val ΔE00=3.837, best=3.537]Training (film/smallcnn):  50%|█████     | 50/100 [03:57<03:57,  4.75s/it, train loss=2.1069, val ΔE00=4.257, best=3.537]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:53,  4.77s/it, train loss=2.1069, val ΔE00=4.257, best=3.537]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:53,  4.77s/it, train loss=2.1947, val ΔE00=3.547, best=3.537]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:06<03:47,  4.74s/it, train loss=2.1947, val ΔE00=3.547, best=3.537]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:06<03:47,  4.74s/it, train loss=2.2943, val ΔE00=4.028, best=3.537]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:11<03:41,  4.72s/it, train loss=2.2943, val ΔE00=4.028, best=3.537]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:11<03:41,  4.72s/it, train loss=2.3370, val ΔE00=3.743, best=3.537]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:16<03:36,  4.71s/it, train loss=2.3370, val ΔE00=3.743, best=3.537]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:16<03:36,  4.71s/it, train loss=2.3261, val ΔE00=3.834, best=3.537]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:34,  4.76s/it, train loss=2.3261, val ΔE00=3.834, best=3.537]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:34,  4.76s/it, train loss=2.3239, val ΔE00=3.645, best=3.537]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:25<03:29,  4.77s/it, train loss=2.3239, val ΔE00=3.645, best=3.537]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:25<03:29,  4.77s/it, train loss=2.4471, val ΔE00=3.492, best=3.492]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:30<03:23,  4.74s/it, train loss=2.4471, val ΔE00=3.492, best=3.492]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:30<03:23,  4.74s/it, train loss=2.4249, val ΔE00=4.139, best=3.492]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:35<03:18,  4.72s/it, train loss=2.4249, val ΔE00=4.139, best=3.492]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:35<03:18,  4.72s/it, train loss=2.5126, val ΔE00=3.688, best=3.492]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:39<03:12,  4.71s/it, train loss=2.5126, val ΔE00=3.688, best=3.492]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:39<03:12,  4.71s/it, train loss=2.5070, val ΔE00=3.963, best=3.492]Training (film/smallcnn):  60%|██████    | 60/100 [04:44<03:10,  4.76s/it, train loss=2.5070, val ΔE00=3.963, best=3.492]Training (film/smallcnn):  60%|██████    | 60/100 [04:44<03:10,  4.76s/it, train loss=2.5633, val ΔE00=3.772, best=3.492]Training (film/smallcnn):  61%|██████    | 61/100 [04:49<03:06,  4.77s/it, train loss=2.5633, val ΔE00=3.772, best=3.492]Training (film/smallcnn):  61%|██████    | 61/100 [04:49<03:06,  4.77s/it, train loss=2.6332, val ΔE00=4.271, best=3.492]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:54<03:00,  4.74s/it, train loss=2.6332, val ΔE00=4.271, best=3.492]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:54<03:00,  4.74s/it, train loss=2.5940, val ΔE00=3.531, best=3.492]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:59<02:54,  4.72s/it, train loss=2.5940, val ΔE00=3.531, best=3.492]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:59<02:54,  4.72s/it, train loss=2.7964, val ΔE00=3.647, best=3.492]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:03<02:49,  4.70s/it, train loss=2.7964, val ΔE00=3.647, best=3.492]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:03<02:49,  4.70s/it, train loss=2.6164, val ΔE00=3.902, best=3.492]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:08<02:46,  4.76s/it, train loss=2.6164, val ΔE00=3.902, best=3.492]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:08<02:46,  4.76s/it, train loss=2.7571, val ΔE00=3.909, best=3.492]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:13<02:46,  4.76s/it, train loss=2.7798, val ΔE00=3.625, early_stop=yes]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:13<02:48,  4.82s/it, train loss=2.7798, val ΔE00=3.625, early_stop=yes]
[early] stop at epoch 66 (best de00=3.4920 @ 56)
[done] best ΔE00=3.492 over 66 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/film__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 11/24 ===
[sweep] id=011_model=film__backbone=smallcnn__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone smallcnn --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image+meta, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:32,  5.18s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:32,  5.18s/it, train loss=0.0070, val ΔE00=6.450, best=6.450]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:58,  4.88s/it, train loss=0.0070, val ΔE00=6.450, best=6.450]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:58,  4.88s/it, train loss=0.0060, val ΔE00=4.820, best=4.820]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:44,  4.79s/it, train loss=0.0060, val ΔE00=4.820, best=4.820]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:44,  4.79s/it, train loss=0.0113, val ΔE00=4.512, best=4.512]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:35,  4.74s/it, train loss=0.0113, val ΔE00=4.512, best=4.512]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:35,  4.74s/it, train loss=0.0200, val ΔE00=5.752, best=4.512]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:36,  4.80s/it, train loss=0.0200, val ΔE00=5.752, best=4.512]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:36,  4.80s/it, train loss=0.0302, val ΔE00=4.341, best=4.341]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:32,  4.81s/it, train loss=0.0302, val ΔE00=4.341, best=4.341]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:32,  4.81s/it, train loss=0.0459, val ΔE00=4.133, best=4.133]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:24,  4.78s/it, train loss=0.0459, val ΔE00=4.133, best=4.133]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:24,  4.78s/it, train loss=0.0597, val ΔE00=3.312, best=3.312]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:17,  4.75s/it, train loss=0.0597, val ΔE00=3.312, best=3.312]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:17,  4.75s/it, train loss=0.0709, val ΔE00=3.373, best=3.312]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:11,  4.74s/it, train loss=0.0709, val ΔE00=3.373, best=3.312]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:11,  4.74s/it, train loss=0.0945, val ΔE00=3.141, best=3.141]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:12,  4.80s/it, train loss=0.0945, val ΔE00=3.141, best=3.141]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:12,  4.80s/it, train loss=0.1109, val ΔE00=3.140, best=3.140]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:08,  4.81s/it, train loss=0.1109, val ΔE00=3.140, best=3.140]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:08,  4.81s/it, train loss=0.1386, val ΔE00=2.944, best=2.944]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<07:00,  4.78s/it, train loss=0.1386, val ΔE00=2.944, best=2.944]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<07:00,  4.78s/it, train loss=0.1589, val ΔE00=2.812, best=2.812]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:53,  4.75s/it, train loss=0.1589, val ΔE00=2.812, best=2.812]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:53,  4.75s/it, train loss=0.1816, val ΔE00=3.787, best=2.812]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:46,  4.72s/it, train loss=0.1816, val ΔE00=3.787, best=2.812]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:46,  4.72s/it, train loss=0.2075, val ΔE00=2.994, best=2.812]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:45,  4.78s/it, train loss=0.2075, val ΔE00=2.994, best=2.812]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:45,  4.78s/it, train loss=0.2546, val ΔE00=3.608, best=2.812]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:41,  4.78s/it, train loss=0.2546, val ΔE00=3.608, best=2.812]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:41,  4.78s/it, train loss=0.2846, val ΔE00=4.211, best=2.812]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:34,  4.75s/it, train loss=0.2846, val ΔE00=4.211, best=2.812]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:34,  4.75s/it, train loss=0.3065, val ΔE00=2.844, best=2.812]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:28,  4.73s/it, train loss=0.3065, val ΔE00=2.844, best=2.812]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:28,  4.73s/it, train loss=0.3319, val ΔE00=2.935, best=2.812]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:21,  4.71s/it, train loss=0.3319, val ΔE00=2.935, best=2.812]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:21,  4.71s/it, train loss=0.3709, val ΔE00=2.982, best=2.812]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:22,  4.78s/it, train loss=0.3709, val ΔE00=2.982, best=2.812]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:22,  4.78s/it, train loss=0.3882, val ΔE00=3.024, best=2.812]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:17,  4.78s/it, train loss=0.3882, val ΔE00=3.024, best=2.812]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:17,  4.78s/it, train loss=0.4407, val ΔE00=3.356, best=2.812]Training (film/smallcnn):  22%|██▏       | 22/100 [01:45<06:11,  4.76s/it, train loss=0.4407, val ΔE00=3.356, best=2.812]Training (film/smallcnn):  22%|██▏       | 22/100 [01:45<06:11,  4.76s/it, train loss=0.4741, val ΔE00=3.374, best=2.812]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:04,  4.73s/it, train loss=0.4741, val ΔE00=3.374, best=2.812]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:04,  4.73s/it, train loss=0.4982, val ΔE00=3.088, best=2.812]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:58,  4.72s/it, train loss=0.4982, val ΔE00=3.088, best=2.812]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:58,  4.72s/it, train loss=0.5455, val ΔE00=3.627, best=2.812]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:57,  4.77s/it, train loss=0.5455, val ΔE00=3.627, best=2.812]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:57,  4.77s/it, train loss=0.6242, val ΔE00=3.231, best=2.812]Training (film/smallcnn):  26%|██▌       | 26/100 [02:04<05:54,  4.79s/it, train loss=0.6242, val ΔE00=3.231, best=2.812]Training (film/smallcnn):  26%|██▌       | 26/100 [02:04<05:54,  4.79s/it, train loss=0.6511, val ΔE00=3.025, best=2.812]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:47,  4.76s/it, train loss=0.6511, val ΔE00=3.025, best=2.812]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:47,  4.76s/it, train loss=0.6758, val ΔE00=2.707, best=2.707]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:41,  4.74s/it, train loss=0.6758, val ΔE00=2.707, best=2.707]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:41,  4.74s/it, train loss=0.7241, val ΔE00=2.552, best=2.552]Training (film/smallcnn):  29%|██▉       | 29/100 [02:18<05:35,  4.72s/it, train loss=0.7241, val ΔE00=2.552, best=2.552]Training (film/smallcnn):  29%|██▉       | 29/100 [02:18<05:35,  4.72s/it, train loss=0.7581, val ΔE00=2.726, best=2.552]Training (film/smallcnn):  30%|███       | 30/100 [02:23<05:34,  4.78s/it, train loss=0.7581, val ΔE00=2.726, best=2.552]Training (film/smallcnn):  30%|███       | 30/100 [02:23<05:34,  4.78s/it, train loss=0.8644, val ΔE00=3.020, best=2.552]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:30,  4.79s/it, train loss=0.8644, val ΔE00=3.020, best=2.552]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:30,  4.79s/it, train loss=0.8673, val ΔE00=3.006, best=2.552]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:23,  4.76s/it, train loss=0.8673, val ΔE00=3.006, best=2.552]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:23,  4.76s/it, train loss=0.8673, val ΔE00=3.818, best=2.552]Training (film/smallcnn):  33%|███▎      | 33/100 [02:37<05:17,  4.74s/it, train loss=0.8673, val ΔE00=3.818, best=2.552]Training (film/smallcnn):  33%|███▎      | 33/100 [02:37<05:17,  4.74s/it, train loss=0.8816, val ΔE00=2.865, best=2.552]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:11,  4.72s/it, train loss=0.8816, val ΔE00=2.865, best=2.552]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:11,  4.72s/it, train loss=0.9451, val ΔE00=2.754, best=2.552]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:10,  4.78s/it, train loss=0.9451, val ΔE00=2.754, best=2.552]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:10,  4.78s/it, train loss=0.9892, val ΔE00=2.693, best=2.552]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:06,  4.80s/it, train loss=0.9892, val ΔE00=2.693, best=2.552]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:06,  4.80s/it, train loss=1.0674, val ΔE00=2.812, best=2.552]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<05:00,  4.77s/it, train loss=1.0674, val ΔE00=2.812, best=2.552]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<05:00,  4.77s/it, train loss=1.1008, val ΔE00=3.079, best=2.552]Training (film/smallcnn):  38%|███▊      | 38/100 [03:01<04:54,  4.75s/it, train loss=1.1008, val ΔE00=3.079, best=2.552]Training (film/smallcnn):  38%|███▊      | 38/100 [03:01<04:54,  4.75s/it, train loss=1.1392, val ΔE00=2.889, best=2.552]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:48,  4.72s/it, train loss=1.1392, val ΔE00=2.889, best=2.552]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:48,  4.72s/it, train loss=1.1434, val ΔE00=2.857, best=2.552]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:46,  4.78s/it, train loss=1.1434, val ΔE00=2.857, best=2.552]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:46,  4.78s/it, train loss=1.1744, val ΔE00=2.620, best=2.552]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:42,  4.79s/it, train loss=1.1744, val ΔE00=2.620, best=2.552]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:42,  4.79s/it, train loss=1.2618, val ΔE00=2.551, best=2.551]Training (film/smallcnn):  42%|████▏     | 42/100 [03:20<04:36,  4.76s/it, train loss=1.2618, val ΔE00=2.551, best=2.551]Training (film/smallcnn):  42%|████▏     | 42/100 [03:20<04:36,  4.76s/it, train loss=1.2553, val ΔE00=2.344, best=2.344]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:30,  4.74s/it, train loss=1.2553, val ΔE00=2.344, best=2.344]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:30,  4.74s/it, train loss=1.3310, val ΔE00=3.235, best=2.344]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:24,  4.72s/it, train loss=1.3310, val ΔE00=3.235, best=2.344]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:24,  4.72s/it, train loss=1.3178, val ΔE00=2.835, best=2.344]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:22,  4.77s/it, train loss=1.3178, val ΔE00=2.835, best=2.344]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:22,  4.77s/it, train loss=1.3891, val ΔE00=2.688, best=2.344]Training (film/smallcnn):  46%|████▌     | 46/100 [03:39<04:18,  4.78s/it, train loss=1.3891, val ΔE00=2.688, best=2.344]Training (film/smallcnn):  46%|████▌     | 46/100 [03:39<04:18,  4.78s/it, train loss=1.4340, val ΔE00=2.877, best=2.344]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:11,  4.75s/it, train loss=1.4340, val ΔE00=2.877, best=2.344]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:11,  4.75s/it, train loss=1.4626, val ΔE00=2.720, best=2.344]Training (film/smallcnn):  48%|████▊     | 48/100 [03:48<04:05,  4.73s/it, train loss=1.4626, val ΔE00=2.720, best=2.344]Training (film/smallcnn):  48%|████▊     | 48/100 [03:48<04:05,  4.73s/it, train loss=1.5817, val ΔE00=2.457, best=2.344]Training (film/smallcnn):  49%|████▉     | 49/100 [03:53<04:00,  4.71s/it, train loss=1.5817, val ΔE00=2.457, best=2.344]Training (film/smallcnn):  49%|████▉     | 49/100 [03:53<04:00,  4.71s/it, train loss=1.5494, val ΔE00=2.529, best=2.344]Training (film/smallcnn):  50%|█████     | 50/100 [03:58<03:58,  4.76s/it, train loss=1.5494, val ΔE00=2.529, best=2.344]Training (film/smallcnn):  50%|█████     | 50/100 [03:58<03:58,  4.76s/it, train loss=1.6575, val ΔE00=2.963, best=2.344]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:54,  4.78s/it, train loss=1.6575, val ΔE00=2.963, best=2.344]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:54,  4.78s/it, train loss=1.7519, val ΔE00=2.292, best=2.292]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:07<03:47,  4.75s/it, train loss=1.7519, val ΔE00=2.292, best=2.292]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:07<03:47,  4.75s/it, train loss=1.6280, val ΔE00=2.451, best=2.292]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:12<03:42,  4.73s/it, train loss=1.6280, val ΔE00=2.451, best=2.292]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:12<03:42,  4.73s/it, train loss=1.7381, val ΔE00=2.560, best=2.292]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:17<03:37,  4.72s/it, train loss=1.7381, val ΔE00=2.560, best=2.292]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:17<03:37,  4.72s/it, train loss=1.8818, val ΔE00=2.803, best=2.292]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:35,  4.79s/it, train loss=1.8818, val ΔE00=2.803, best=2.292]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:35,  4.79s/it, train loss=1.7672, val ΔE00=2.581, best=2.292]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:26<03:30,  4.78s/it, train loss=1.7672, val ΔE00=2.581, best=2.292]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:26<03:30,  4.78s/it, train loss=1.7977, val ΔE00=2.595, best=2.292]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:31<03:24,  4.75s/it, train loss=1.7977, val ΔE00=2.595, best=2.292]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:31<03:24,  4.75s/it, train loss=1.8389, val ΔE00=2.422, best=2.292]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:36<03:18,  4.73s/it, train loss=1.8389, val ΔE00=2.422, best=2.292]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:36<03:18,  4.73s/it, train loss=1.7937, val ΔE00=2.441, best=2.292]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:40<03:13,  4.71s/it, train loss=1.7937, val ΔE00=2.441, best=2.292]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:40<03:13,  4.71s/it, train loss=1.7934, val ΔE00=2.191, best=2.191]Training (film/smallcnn):  60%|██████    | 60/100 [04:45<03:10,  4.77s/it, train loss=1.7934, val ΔE00=2.191, best=2.191]Training (film/smallcnn):  60%|██████    | 60/100 [04:45<03:10,  4.77s/it, train loss=1.8719, val ΔE00=2.656, best=2.191]Training (film/smallcnn):  61%|██████    | 61/100 [04:50<03:06,  4.78s/it, train loss=1.8719, val ΔE00=2.656, best=2.191]Training (film/smallcnn):  61%|██████    | 61/100 [04:50<03:06,  4.78s/it, train loss=1.9086, val ΔE00=2.357, best=2.191]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:55<03:00,  4.74s/it, train loss=1.9086, val ΔE00=2.357, best=2.191]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:55<03:00,  4.74s/it, train loss=1.8633, val ΔE00=2.304, best=2.191]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:59<02:54,  4.72s/it, train loss=1.8633, val ΔE00=2.304, best=2.191]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:59<02:54,  4.72s/it, train loss=1.9485, val ΔE00=2.717, best=2.191]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:04<02:49,  4.71s/it, train loss=1.9485, val ΔE00=2.717, best=2.191]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:04<02:49,  4.71s/it, train loss=1.9318, val ΔE00=2.552, best=2.191]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:09<02:46,  4.76s/it, train loss=1.9318, val ΔE00=2.552, best=2.191]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:09<02:46,  4.76s/it, train loss=2.1431, val ΔE00=2.209, best=2.191]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:14<02:42,  4.78s/it, train loss=2.1431, val ΔE00=2.209, best=2.191]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:14<02:42,  4.78s/it, train loss=2.0435, val ΔE00=2.491, best=2.191]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:18<02:36,  4.75s/it, train loss=2.0435, val ΔE00=2.491, best=2.191]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:18<02:36,  4.75s/it, train loss=2.0486, val ΔE00=2.984, best=2.191]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:23<02:31,  4.73s/it, train loss=2.0486, val ΔE00=2.984, best=2.191]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:23<02:31,  4.73s/it, train loss=1.8650, val ΔE00=2.613, best=2.191]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:28<02:31,  4.73s/it, train loss=2.0257, val ΔE00=2.950, early_stop=yes]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:28<02:34,  4.83s/it, train loss=2.0257, val ΔE00=2.950, early_stop=yes]
[early] stop at epoch 69 (best de00=2.1911 @ 59)
[done] best ΔE00=2.191 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/film__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 12/24 ===
[sweep] id=012_model=film__backbone=smallcnn__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone smallcnn --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image+mean+meta, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:39,  5.24s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:39,  5.24s/it, train loss=0.0060, val ΔE00=6.939, best=6.939]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<08:05,  4.95s/it, train loss=0.0060, val ΔE00=6.939, best=6.939]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<08:05,  4.95s/it, train loss=0.0067, val ΔE00=5.133, best=5.133]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:51,  4.86s/it, train loss=0.0067, val ΔE00=5.133, best=5.133]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:51,  4.86s/it, train loss=0.0116, val ΔE00=4.839, best=4.839]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:43,  4.83s/it, train loss=0.0116, val ΔE00=4.839, best=4.839]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:43,  4.83s/it, train loss=0.0196, val ΔE00=4.899, best=4.839]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:43,  4.88s/it, train loss=0.0196, val ΔE00=4.899, best=4.839]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:43,  4.88s/it, train loss=0.0292, val ΔE00=4.497, best=4.497]Training (film/smallcnn):   6%|▌         | 6/100 [00:29<07:38,  4.88s/it, train loss=0.0292, val ΔE00=4.497, best=4.497]Training (film/smallcnn):   6%|▌         | 6/100 [00:29<07:38,  4.88s/it, train loss=0.0416, val ΔE00=3.689, best=3.689]Training (film/smallcnn):   7%|▋         | 7/100 [00:34<07:29,  4.83s/it, train loss=0.0416, val ΔE00=3.689, best=3.689]Training (film/smallcnn):   7%|▋         | 7/100 [00:34<07:29,  4.83s/it, train loss=0.0535, val ΔE00=3.867, best=3.689]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:21,  4.80s/it, train loss=0.0535, val ΔE00=3.867, best=3.689]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:21,  4.80s/it, train loss=0.0682, val ΔE00=4.129, best=3.689]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:14,  4.78s/it, train loss=0.0682, val ΔE00=4.129, best=3.689]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:14,  4.78s/it, train loss=0.0842, val ΔE00=3.694, best=3.689]Training (film/smallcnn):  10%|█         | 10/100 [00:48<07:15,  4.84s/it, train loss=0.0842, val ΔE00=3.694, best=3.689]Training (film/smallcnn):  10%|█         | 10/100 [00:48<07:15,  4.84s/it, train loss=0.0993, val ΔE00=3.101, best=3.101]Training (film/smallcnn):  11%|█         | 11/100 [00:53<07:10,  4.84s/it, train loss=0.0993, val ΔE00=3.101, best=3.101]Training (film/smallcnn):  11%|█         | 11/100 [00:53<07:10,  4.84s/it, train loss=0.1185, val ΔE00=3.176, best=3.101]Training (film/smallcnn):  12%|█▏        | 12/100 [00:58<07:03,  4.82s/it, train loss=0.1185, val ΔE00=3.176, best=3.101]Training (film/smallcnn):  12%|█▏        | 12/100 [00:58<07:03,  4.82s/it, train loss=0.1365, val ΔE00=2.912, best=2.912]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:57,  4.80s/it, train loss=0.1365, val ΔE00=2.912, best=2.912]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:57,  4.80s/it, train loss=0.1577, val ΔE00=3.002, best=2.912]Training (film/smallcnn):  14%|█▍        | 14/100 [01:07<06:51,  4.78s/it, train loss=0.1577, val ΔE00=3.002, best=2.912]Training (film/smallcnn):  14%|█▍        | 14/100 [01:07<06:51,  4.78s/it, train loss=0.1841, val ΔE00=3.151, best=2.912]Training (film/smallcnn):  15%|█▌        | 15/100 [01:12<06:51,  4.84s/it, train loss=0.1841, val ΔE00=3.151, best=2.912]Training (film/smallcnn):  15%|█▌        | 15/100 [01:12<06:51,  4.84s/it, train loss=0.2046, val ΔE00=3.059, best=2.912]Training (film/smallcnn):  16%|█▌        | 16/100 [01:17<06:46,  4.84s/it, train loss=0.2046, val ΔE00=3.059, best=2.912]Training (film/smallcnn):  16%|█▌        | 16/100 [01:17<06:46,  4.84s/it, train loss=0.2376, val ΔE00=2.914, best=2.912]Training (film/smallcnn):  17%|█▋        | 17/100 [01:22<06:40,  4.82s/it, train loss=0.2376, val ΔE00=2.914, best=2.912]Training (film/smallcnn):  17%|█▋        | 17/100 [01:22<06:40,  4.82s/it, train loss=0.2642, val ΔE00=2.695, best=2.695]Training (film/smallcnn):  18%|█▊        | 18/100 [01:27<06:33,  4.80s/it, train loss=0.2642, val ΔE00=2.695, best=2.695]Training (film/smallcnn):  18%|█▊        | 18/100 [01:27<06:33,  4.80s/it, train loss=0.2810, val ΔE00=2.842, best=2.695]Training (film/smallcnn):  19%|█▉        | 19/100 [01:31<06:27,  4.78s/it, train loss=0.2810, val ΔE00=2.842, best=2.695]Training (film/smallcnn):  19%|█▉        | 19/100 [01:31<06:27,  4.78s/it, train loss=0.3089, val ΔE00=3.008, best=2.695]Training (film/smallcnn):  20%|██        | 20/100 [01:36<06:26,  4.83s/it, train loss=0.3089, val ΔE00=3.008, best=2.695]Training (film/smallcnn):  20%|██        | 20/100 [01:36<06:26,  4.83s/it, train loss=0.3353, val ΔE00=3.074, best=2.695]Training (film/smallcnn):  21%|██        | 21/100 [01:41<06:22,  4.84s/it, train loss=0.3353, val ΔE00=3.074, best=2.695]Training (film/smallcnn):  21%|██        | 21/100 [01:41<06:22,  4.84s/it, train loss=0.3712, val ΔE00=2.684, best=2.684]Training (film/smallcnn):  22%|██▏       | 22/100 [01:46<06:15,  4.81s/it, train loss=0.3712, val ΔE00=2.684, best=2.684]Training (film/smallcnn):  22%|██▏       | 22/100 [01:46<06:15,  4.81s/it, train loss=0.3938, val ΔE00=3.990, best=2.684]Training (film/smallcnn):  23%|██▎       | 23/100 [01:51<06:09,  4.79s/it, train loss=0.3938, val ΔE00=3.990, best=2.684]Training (film/smallcnn):  23%|██▎       | 23/100 [01:51<06:09,  4.79s/it, train loss=0.4449, val ΔE00=2.458, best=2.458]Training (film/smallcnn):  24%|██▍       | 24/100 [01:55<06:02,  4.77s/it, train loss=0.4449, val ΔE00=2.458, best=2.458]Training (film/smallcnn):  24%|██▍       | 24/100 [01:55<06:02,  4.77s/it, train loss=0.4631, val ΔE00=3.419, best=2.458]Training (film/smallcnn):  25%|██▌       | 25/100 [02:00<06:03,  4.84s/it, train loss=0.4631, val ΔE00=3.419, best=2.458]Training (film/smallcnn):  25%|██▌       | 25/100 [02:00<06:03,  4.84s/it, train loss=0.4952, val ΔE00=2.447, best=2.447]Training (film/smallcnn):  26%|██▌       | 26/100 [02:05<05:58,  4.85s/it, train loss=0.4952, val ΔE00=2.447, best=2.447]Training (film/smallcnn):  26%|██▌       | 26/100 [02:05<05:58,  4.85s/it, train loss=0.5134, val ΔE00=2.685, best=2.447]Training (film/smallcnn):  27%|██▋       | 27/100 [02:10<05:52,  4.82s/it, train loss=0.5134, val ΔE00=2.685, best=2.447]Training (film/smallcnn):  27%|██▋       | 27/100 [02:10<05:52,  4.82s/it, train loss=0.5516, val ΔE00=2.491, best=2.447]Training (film/smallcnn):  28%|██▊       | 28/100 [02:15<05:45,  4.80s/it, train loss=0.5516, val ΔE00=2.491, best=2.447]Training (film/smallcnn):  28%|██▊       | 28/100 [02:15<05:45,  4.80s/it, train loss=0.5952, val ΔE00=2.540, best=2.447]Training (film/smallcnn):  29%|██▉       | 29/100 [02:19<05:39,  4.78s/it, train loss=0.5952, val ΔE00=2.540, best=2.447]Training (film/smallcnn):  29%|██▉       | 29/100 [02:19<05:39,  4.78s/it, train loss=0.6179, val ΔE00=2.490, best=2.447]Training (film/smallcnn):  30%|███       | 30/100 [02:24<05:38,  4.83s/it, train loss=0.6179, val ΔE00=2.490, best=2.447]Training (film/smallcnn):  30%|███       | 30/100 [02:24<05:38,  4.83s/it, train loss=0.6708, val ΔE00=2.576, best=2.447]Training (film/smallcnn):  31%|███       | 31/100 [02:29<05:34,  4.85s/it, train loss=0.6708, val ΔE00=2.576, best=2.447]Training (film/smallcnn):  31%|███       | 31/100 [02:29<05:34,  4.85s/it, train loss=0.6798, val ΔE00=2.517, best=2.447]Training (film/smallcnn):  32%|███▏      | 32/100 [02:34<05:27,  4.82s/it, train loss=0.6798, val ΔE00=2.517, best=2.447]Training (film/smallcnn):  32%|███▏      | 32/100 [02:34<05:27,  4.82s/it, train loss=0.7472, val ΔE00=2.580, best=2.447]Training (film/smallcnn):  33%|███▎      | 33/100 [02:39<05:21,  4.80s/it, train loss=0.7472, val ΔE00=2.580, best=2.447]Training (film/smallcnn):  33%|███▎      | 33/100 [02:39<05:21,  4.80s/it, train loss=0.7688, val ΔE00=2.533, best=2.447]Training (film/smallcnn):  34%|███▍      | 34/100 [02:43<05:15,  4.78s/it, train loss=0.7688, val ΔE00=2.533, best=2.447]Training (film/smallcnn):  34%|███▍      | 34/100 [02:43<05:15,  4.78s/it, train loss=0.7813, val ΔE00=2.591, best=2.447]Training (film/smallcnn):  35%|███▌      | 35/100 [02:48<05:14,  4.84s/it, train loss=0.7813, val ΔE00=2.591, best=2.447]Training (film/smallcnn):  35%|███▌      | 35/100 [02:48<05:14,  4.84s/it, train loss=0.8324, val ΔE00=2.613, best=2.447]Training (film/smallcnn):  36%|███▌      | 36/100 [02:53<05:10,  4.85s/it, train loss=0.8324, val ΔE00=2.613, best=2.447]Training (film/smallcnn):  36%|███▌      | 36/100 [02:53<05:10,  4.85s/it, train loss=0.8526, val ΔE00=2.658, best=2.447]Training (film/smallcnn):  37%|███▋      | 37/100 [02:58<05:03,  4.82s/it, train loss=0.8526, val ΔE00=2.658, best=2.447]Training (film/smallcnn):  37%|███▋      | 37/100 [02:58<05:03,  4.82s/it, train loss=0.8940, val ΔE00=2.733, best=2.447]Training (film/smallcnn):  38%|███▊      | 38/100 [03:03<04:57,  4.80s/it, train loss=0.8940, val ΔE00=2.733, best=2.447]Training (film/smallcnn):  38%|███▊      | 38/100 [03:03<04:57,  4.80s/it, train loss=0.9557, val ΔE00=2.853, best=2.447]Training (film/smallcnn):  39%|███▉      | 39/100 [03:08<04:51,  4.79s/it, train loss=0.9557, val ΔE00=2.853, best=2.447]Training (film/smallcnn):  39%|███▉      | 39/100 [03:08<04:51,  4.79s/it, train loss=0.9498, val ΔE00=2.445, best=2.445]Training (film/smallcnn):  40%|████      | 40/100 [03:13<04:50,  4.84s/it, train loss=0.9498, val ΔE00=2.445, best=2.445]Training (film/smallcnn):  40%|████      | 40/100 [03:13<04:50,  4.84s/it, train loss=1.0049, val ΔE00=2.707, best=2.445]Training (film/smallcnn):  41%|████      | 41/100 [03:17<04:46,  4.85s/it, train loss=1.0049, val ΔE00=2.707, best=2.445]Training (film/smallcnn):  41%|████      | 41/100 [03:17<04:46,  4.85s/it, train loss=0.9985, val ΔE00=2.505, best=2.445]Training (film/smallcnn):  42%|████▏     | 42/100 [03:22<04:39,  4.82s/it, train loss=0.9985, val ΔE00=2.505, best=2.445]Training (film/smallcnn):  42%|████▏     | 42/100 [03:22<04:39,  4.82s/it, train loss=1.0636, val ΔE00=2.523, best=2.445]Training (film/smallcnn):  43%|████▎     | 43/100 [03:27<04:33,  4.80s/it, train loss=1.0636, val ΔE00=2.523, best=2.445]Training (film/smallcnn):  43%|████▎     | 43/100 [03:27<04:33,  4.80s/it, train loss=1.0590, val ΔE00=2.731, best=2.445]Training (film/smallcnn):  44%|████▍     | 44/100 [03:32<04:28,  4.79s/it, train loss=1.0590, val ΔE00=2.731, best=2.445]Training (film/smallcnn):  44%|████▍     | 44/100 [03:32<04:28,  4.79s/it, train loss=1.1195, val ΔE00=2.595, best=2.445]Training (film/smallcnn):  45%|████▌     | 45/100 [03:37<04:26,  4.85s/it, train loss=1.1195, val ΔE00=2.595, best=2.445]Training (film/smallcnn):  45%|████▌     | 45/100 [03:37<04:26,  4.85s/it, train loss=1.1494, val ΔE00=2.697, best=2.445]Training (film/smallcnn):  46%|████▌     | 46/100 [03:42<04:21,  4.85s/it, train loss=1.1494, val ΔE00=2.697, best=2.445]Training (film/smallcnn):  46%|████▌     | 46/100 [03:42<04:21,  4.85s/it, train loss=1.1715, val ΔE00=2.141, best=2.141]Training (film/smallcnn):  47%|████▋     | 47/100 [03:46<04:15,  4.82s/it, train loss=1.1715, val ΔE00=2.141, best=2.141]Training (film/smallcnn):  47%|████▋     | 47/100 [03:46<04:15,  4.82s/it, train loss=1.2314, val ΔE00=2.857, best=2.141]Training (film/smallcnn):  48%|████▊     | 48/100 [03:51<04:09,  4.80s/it, train loss=1.2314, val ΔE00=2.857, best=2.141]Training (film/smallcnn):  48%|████▊     | 48/100 [03:51<04:09,  4.80s/it, train loss=1.2107, val ΔE00=2.380, best=2.141]Training (film/smallcnn):  49%|████▉     | 49/100 [03:56<04:04,  4.79s/it, train loss=1.2107, val ΔE00=2.380, best=2.141]Training (film/smallcnn):  49%|████▉     | 49/100 [03:56<04:04,  4.79s/it, train loss=1.2340, val ΔE00=2.207, best=2.141]Training (film/smallcnn):  50%|█████     | 50/100 [04:01<04:02,  4.85s/it, train loss=1.2340, val ΔE00=2.207, best=2.141]Training (film/smallcnn):  50%|█████     | 50/100 [04:01<04:02,  4.85s/it, train loss=1.3007, val ΔE00=2.320, best=2.141]Training (film/smallcnn):  51%|█████     | 51/100 [04:06<03:58,  4.86s/it, train loss=1.3007, val ΔE00=2.320, best=2.141]Training (film/smallcnn):  51%|█████     | 51/100 [04:06<03:58,  4.86s/it, train loss=1.3304, val ΔE00=3.520, best=2.141]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:10<03:51,  4.83s/it, train loss=1.3304, val ΔE00=3.520, best=2.141]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:10<03:51,  4.83s/it, train loss=1.3644, val ΔE00=3.014, best=2.141]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:15<03:45,  4.80s/it, train loss=1.3644, val ΔE00=3.014, best=2.141]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:15<03:45,  4.80s/it, train loss=1.3765, val ΔE00=2.650, best=2.141]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:20<03:40,  4.79s/it, train loss=1.3765, val ΔE00=2.650, best=2.141]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:20<03:40,  4.79s/it, train loss=1.3726, val ΔE00=2.562, best=2.141]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:25<03:38,  4.85s/it, train loss=1.3726, val ΔE00=2.562, best=2.141]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:25<03:38,  4.85s/it, train loss=1.4913, val ΔE00=2.678, best=2.141]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:30<03:33,  4.85s/it, train loss=1.4913, val ΔE00=2.678, best=2.141]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:30<03:33,  4.85s/it, train loss=1.4412, val ΔE00=2.233, best=2.141]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:35<03:27,  4.82s/it, train loss=1.4412, val ΔE00=2.233, best=2.141]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:35<03:27,  4.82s/it, train loss=1.4916, val ΔE00=2.432, best=2.141]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:39<03:21,  4.80s/it, train loss=1.4916, val ΔE00=2.432, best=2.141]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:39<03:21,  4.80s/it, train loss=1.4887, val ΔE00=2.826, best=2.141]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:44<03:21,  4.80s/it, train loss=1.4543, val ΔE00=2.528, early_stop=yes]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:44<03:26,  4.91s/it, train loss=1.4543, val ΔE00=2.528, early_stop=yes]
[early] stop at epoch 59 (best de00=2.1413 @ 46)
[done] best ΔE00=2.141 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/film__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 13/24 ===
[sweep] id=013_model=film__backbone=resnet18__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone resnet18 --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=resnet18, features=image, meta_encoder=none
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:05<09:48,  5.94s/it]Training (film/resnet18):   1%|          | 1/100 [00:05<09:48,  5.94s/it, train loss=0.0095, val ΔE00=6.703, best=6.703]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:12,  5.64s/it, train loss=0.0095, val ΔE00=6.703, best=6.703]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:12,  5.64s/it, train loss=0.0068, val ΔE00=5.388, best=5.388]Training (film/resnet18):   3%|▎         | 3/100 [00:16<08:57,  5.54s/it, train loss=0.0068, val ΔE00=5.388, best=5.388]Training (film/resnet18):   3%|▎         | 3/100 [00:16<08:57,  5.54s/it, train loss=0.0131, val ΔE00=5.016, best=5.016]Training (film/resnet18):   4%|▍         | 4/100 [00:22<08:47,  5.49s/it, train loss=0.0131, val ΔE00=5.016, best=5.016]Training (film/resnet18):   4%|▍         | 4/100 [00:22<08:47,  5.49s/it, train loss=0.0210, val ΔE00=4.789, best=4.789]Training (film/resnet18):   5%|▌         | 5/100 [00:27<08:47,  5.55s/it, train loss=0.0210, val ΔE00=4.789, best=4.789]Training (film/resnet18):   5%|▌         | 5/100 [00:27<08:47,  5.55s/it, train loss=0.0326, val ΔE00=4.415, best=4.415]Training (film/resnet18):   6%|▌         | 6/100 [00:33<08:41,  5.55s/it, train loss=0.0326, val ΔE00=4.415, best=4.415]Training (film/resnet18):   6%|▌         | 6/100 [00:33<08:41,  5.55s/it, train loss=0.0452, val ΔE00=4.177, best=4.177]Training (film/resnet18):   7%|▋         | 7/100 [00:38<08:29,  5.48s/it, train loss=0.0452, val ΔE00=4.177, best=4.177]Training (film/resnet18):   7%|▋         | 7/100 [00:38<08:29,  5.48s/it, train loss=0.0604, val ΔE00=4.350, best=4.177]Training (film/resnet18):   8%|▊         | 8/100 [00:44<08:21,  5.45s/it, train loss=0.0604, val ΔE00=4.350, best=4.177]Training (film/resnet18):   8%|▊         | 8/100 [00:44<08:21,  5.45s/it, train loss=0.0786, val ΔE00=5.404, best=4.177]Training (film/resnet18):   9%|▉         | 9/100 [00:49<08:15,  5.44s/it, train loss=0.0786, val ΔE00=5.404, best=4.177]Training (film/resnet18):   9%|▉         | 9/100 [00:49<08:15,  5.44s/it, train loss=0.0970, val ΔE00=3.801, best=3.801]Training (film/resnet18):  10%|█         | 10/100 [00:55<08:15,  5.51s/it, train loss=0.0970, val ΔE00=3.801, best=3.801]Training (film/resnet18):  10%|█         | 10/100 [00:55<08:15,  5.51s/it, train loss=0.1178, val ΔE00=3.716, best=3.716]Training (film/resnet18):  11%|█         | 11/100 [01:00<08:08,  5.49s/it, train loss=0.1178, val ΔE00=3.716, best=3.716]Training (film/resnet18):  11%|█         | 11/100 [01:00<08:08,  5.49s/it, train loss=0.1442, val ΔE00=3.872, best=3.716]Training (film/resnet18):  12%|█▏        | 12/100 [01:06<07:59,  5.45s/it, train loss=0.1442, val ΔE00=3.872, best=3.716]Training (film/resnet18):  12%|█▏        | 12/100 [01:06<07:59,  5.45s/it, train loss=0.1663, val ΔE00=4.130, best=3.716]Training (film/resnet18):  13%|█▎        | 13/100 [01:11<07:53,  5.44s/it, train loss=0.1663, val ΔE00=4.130, best=3.716]Training (film/resnet18):  13%|█▎        | 13/100 [01:11<07:53,  5.44s/it, train loss=0.1868, val ΔE00=3.211, best=3.211]Training (film/resnet18):  14%|█▍        | 14/100 [01:16<07:45,  5.42s/it, train loss=0.1868, val ΔE00=3.211, best=3.211]Training (film/resnet18):  14%|█▍        | 14/100 [01:16<07:45,  5.42s/it, train loss=0.2066, val ΔE00=3.326, best=3.211]Training (film/resnet18):  15%|█▌        | 15/100 [01:22<07:44,  5.47s/it, train loss=0.2066, val ΔE00=3.326, best=3.211]Training (film/resnet18):  15%|█▌        | 15/100 [01:22<07:44,  5.47s/it, train loss=0.2415, val ΔE00=3.692, best=3.211]Training (film/resnet18):  16%|█▌        | 16/100 [01:27<07:39,  5.48s/it, train loss=0.2415, val ΔE00=3.692, best=3.211]Training (film/resnet18):  16%|█▌        | 16/100 [01:27<07:39,  5.48s/it, train loss=0.2565, val ΔE00=3.784, best=3.211]Training (film/resnet18):  17%|█▋        | 17/100 [01:33<07:31,  5.44s/it, train loss=0.2565, val ΔE00=3.784, best=3.211]Training (film/resnet18):  17%|█▋        | 17/100 [01:33<07:31,  5.44s/it, train loss=0.3029, val ΔE00=3.894, best=3.211]Training (film/resnet18):  18%|█▊        | 18/100 [01:38<07:24,  5.42s/it, train loss=0.3029, val ΔE00=3.894, best=3.211]Training (film/resnet18):  18%|█▊        | 18/100 [01:38<07:24,  5.42s/it, train loss=0.3423, val ΔE00=3.250, best=3.211]Training (film/resnet18):  19%|█▉        | 19/100 [01:43<07:17,  5.40s/it, train loss=0.3423, val ΔE00=3.250, best=3.211]Training (film/resnet18):  19%|█▉        | 19/100 [01:43<07:17,  5.40s/it, train loss=0.3455, val ΔE00=3.391, best=3.211]Training (film/resnet18):  20%|██        | 20/100 [01:49<07:16,  5.46s/it, train loss=0.3455, val ΔE00=3.391, best=3.211]Training (film/resnet18):  20%|██        | 20/100 [01:49<07:16,  5.46s/it, train loss=0.4055, val ΔE00=3.772, best=3.211]Training (film/resnet18):  21%|██        | 21/100 [01:55<07:11,  5.46s/it, train loss=0.4055, val ΔE00=3.772, best=3.211]Training (film/resnet18):  21%|██        | 21/100 [01:55<07:11,  5.46s/it, train loss=0.4180, val ΔE00=3.317, best=3.211]Training (film/resnet18):  22%|██▏       | 22/100 [02:00<07:03,  5.43s/it, train loss=0.4180, val ΔE00=3.317, best=3.211]Training (film/resnet18):  22%|██▏       | 22/100 [02:00<07:03,  5.43s/it, train loss=0.4577, val ΔE00=3.434, best=3.211]Training (film/resnet18):  23%|██▎       | 23/100 [02:05<06:56,  5.41s/it, train loss=0.4577, val ΔE00=3.434, best=3.211]Training (film/resnet18):  23%|██▎       | 23/100 [02:05<06:56,  5.41s/it, train loss=0.4732, val ΔE00=3.219, best=3.211]Training (film/resnet18):  24%|██▍       | 24/100 [02:11<06:49,  5.39s/it, train loss=0.4732, val ΔE00=3.219, best=3.211]Training (film/resnet18):  24%|██▍       | 24/100 [02:11<06:49,  5.39s/it, train loss=0.5176, val ΔE00=3.402, best=3.211]Training (film/resnet18):  25%|██▌       | 25/100 [02:16<06:48,  5.45s/it, train loss=0.5176, val ΔE00=3.402, best=3.211]Training (film/resnet18):  25%|██▌       | 25/100 [02:16<06:48,  5.45s/it, train loss=0.5485, val ΔE00=3.260, best=3.211]Training (film/resnet18):  26%|██▌       | 26/100 [02:22<06:43,  5.45s/it, train loss=0.5485, val ΔE00=3.260, best=3.211]Training (film/resnet18):  26%|██▌       | 26/100 [02:22<06:43,  5.45s/it, train loss=0.6474, val ΔE00=3.382, best=3.211]Training (film/resnet18):  27%|██▋       | 27/100 [02:27<06:35,  5.42s/it, train loss=0.6474, val ΔE00=3.382, best=3.211]Training (film/resnet18):  27%|██▋       | 27/100 [02:27<06:35,  5.42s/it, train loss=0.5978, val ΔE00=3.641, best=3.211]Training (film/resnet18):  28%|██▊       | 28/100 [02:32<06:30,  5.42s/it, train loss=0.5978, val ΔE00=3.641, best=3.211]Training (film/resnet18):  28%|██▊       | 28/100 [02:32<06:30,  5.42s/it, train loss=0.6209, val ΔE00=3.133, best=3.133]Training (film/resnet18):  29%|██▉       | 29/100 [02:38<06:23,  5.41s/it, train loss=0.6209, val ΔE00=3.133, best=3.133]Training (film/resnet18):  29%|██▉       | 29/100 [02:38<06:23,  5.41s/it, train loss=0.6552, val ΔE00=3.253, best=3.133]Training (film/resnet18):  30%|███       | 30/100 [02:43<06:22,  5.46s/it, train loss=0.6552, val ΔE00=3.253, best=3.133]Training (film/resnet18):  30%|███       | 30/100 [02:43<06:22,  5.46s/it, train loss=0.7118, val ΔE00=3.647, best=3.133]Training (film/resnet18):  31%|███       | 31/100 [02:49<06:17,  5.46s/it, train loss=0.7118, val ΔE00=3.647, best=3.133]Training (film/resnet18):  31%|███       | 31/100 [02:49<06:17,  5.46s/it, train loss=0.7355, val ΔE00=3.405, best=3.133]Training (film/resnet18):  32%|███▏      | 32/100 [02:54<06:10,  5.45s/it, train loss=0.7355, val ΔE00=3.405, best=3.133]Training (film/resnet18):  32%|███▏      | 32/100 [02:54<06:10,  5.45s/it, train loss=0.7840, val ΔE00=2.912, best=2.912]Training (film/resnet18):  33%|███▎      | 33/100 [03:00<06:03,  5.42s/it, train loss=0.7840, val ΔE00=2.912, best=2.912]Training (film/resnet18):  33%|███▎      | 33/100 [03:00<06:03,  5.42s/it, train loss=0.8389, val ΔE00=3.385, best=2.912]Training (film/resnet18):  34%|███▍      | 34/100 [03:05<05:56,  5.40s/it, train loss=0.8389, val ΔE00=3.385, best=2.912]Training (film/resnet18):  34%|███▍      | 34/100 [03:05<05:56,  5.40s/it, train loss=0.8566, val ΔE00=3.995, best=2.912]Training (film/resnet18):  35%|███▌      | 35/100 [03:11<05:54,  5.46s/it, train loss=0.8566, val ΔE00=3.995, best=2.912]Training (film/resnet18):  35%|███▌      | 35/100 [03:11<05:54,  5.46s/it, train loss=0.8541, val ΔE00=3.232, best=2.912]Training (film/resnet18):  36%|███▌      | 36/100 [03:16<05:50,  5.47s/it, train loss=0.8541, val ΔE00=3.232, best=2.912]Training (film/resnet18):  36%|███▌      | 36/100 [03:16<05:50,  5.47s/it, train loss=0.8807, val ΔE00=2.961, best=2.912]Training (film/resnet18):  37%|███▋      | 37/100 [03:21<05:42,  5.44s/it, train loss=0.8807, val ΔE00=2.961, best=2.912]Training (film/resnet18):  37%|███▋      | 37/100 [03:21<05:42,  5.44s/it, train loss=0.9417, val ΔE00=3.205, best=2.912]Training (film/resnet18):  38%|███▊      | 38/100 [03:27<05:35,  5.42s/it, train loss=0.9417, val ΔE00=3.205, best=2.912]Training (film/resnet18):  38%|███▊      | 38/100 [03:27<05:35,  5.42s/it, train loss=0.9238, val ΔE00=3.527, best=2.912]Training (film/resnet18):  39%|███▉      | 39/100 [03:32<05:29,  5.40s/it, train loss=0.9238, val ΔE00=3.527, best=2.912]Training (film/resnet18):  39%|███▉      | 39/100 [03:32<05:29,  5.40s/it, train loss=0.9496, val ΔE00=2.988, best=2.912]Training (film/resnet18):  40%|████      | 40/100 [03:38<05:27,  5.45s/it, train loss=0.9496, val ΔE00=2.988, best=2.912]Training (film/resnet18):  40%|████      | 40/100 [03:38<05:27,  5.45s/it, train loss=1.0009, val ΔE00=3.149, best=2.912]Training (film/resnet18):  41%|████      | 41/100 [03:43<05:22,  5.46s/it, train loss=1.0009, val ΔE00=3.149, best=2.912]Training (film/resnet18):  41%|████      | 41/100 [03:43<05:22,  5.46s/it, train loss=1.0381, val ΔE00=2.983, best=2.912]Training (film/resnet18):  42%|████▏     | 42/100 [03:49<05:16,  5.45s/it, train loss=1.0381, val ΔE00=2.983, best=2.912]Training (film/resnet18):  42%|████▏     | 42/100 [03:49<05:16,  5.45s/it, train loss=0.9833, val ΔE00=2.857, best=2.857]Training (film/resnet18):  43%|████▎     | 43/100 [03:54<05:09,  5.43s/it, train loss=0.9833, val ΔE00=2.857, best=2.857]Training (film/resnet18):  43%|████▎     | 43/100 [03:54<05:09,  5.43s/it, train loss=1.0763, val ΔE00=3.970, best=2.857]Training (film/resnet18):  44%|████▍     | 44/100 [03:59<05:02,  5.40s/it, train loss=1.0763, val ΔE00=3.970, best=2.857]Training (film/resnet18):  44%|████▍     | 44/100 [03:59<05:02,  5.40s/it, train loss=1.0793, val ΔE00=3.239, best=2.857]Training (film/resnet18):  45%|████▌     | 45/100 [04:05<05:00,  5.47s/it, train loss=1.0793, val ΔE00=3.239, best=2.857]Training (film/resnet18):  45%|████▌     | 45/100 [04:05<05:00,  5.47s/it, train loss=1.1284, val ΔE00=3.379, best=2.857]Training (film/resnet18):  46%|████▌     | 46/100 [04:11<04:55,  5.48s/it, train loss=1.1284, val ΔE00=3.379, best=2.857]Training (film/resnet18):  46%|████▌     | 46/100 [04:11<04:55,  5.48s/it, train loss=1.1480, val ΔE00=2.760, best=2.760]Training (film/resnet18):  47%|████▋     | 47/100 [04:16<04:48,  5.44s/it, train loss=1.1480, val ΔE00=2.760, best=2.760]Training (film/resnet18):  47%|████▋     | 47/100 [04:16<04:48,  5.44s/it, train loss=1.2126, val ΔE00=3.158, best=2.760]Training (film/resnet18):  48%|████▊     | 48/100 [04:21<04:41,  5.42s/it, train loss=1.2126, val ΔE00=3.158, best=2.760]Training (film/resnet18):  48%|████▊     | 48/100 [04:21<04:41,  5.42s/it, train loss=1.1800, val ΔE00=3.193, best=2.760]Training (film/resnet18):  49%|████▉     | 49/100 [04:27<04:35,  5.41s/it, train loss=1.1800, val ΔE00=3.193, best=2.760]Training (film/resnet18):  49%|████▉     | 49/100 [04:27<04:35,  5.41s/it, train loss=1.1613, val ΔE00=3.259, best=2.760]Training (film/resnet18):  50%|█████     | 50/100 [04:32<04:33,  5.47s/it, train loss=1.1613, val ΔE00=3.259, best=2.760]Training (film/resnet18):  50%|█████     | 50/100 [04:32<04:33,  5.47s/it, train loss=1.1620, val ΔE00=2.909, best=2.760]Training (film/resnet18):  51%|█████     | 51/100 [04:38<04:27,  5.46s/it, train loss=1.1620, val ΔE00=2.909, best=2.760]Training (film/resnet18):  51%|█████     | 51/100 [04:38<04:27,  5.46s/it, train loss=1.1640, val ΔE00=3.249, best=2.760]Training (film/resnet18):  52%|█████▏    | 52/100 [04:43<04:20,  5.44s/it, train loss=1.1640, val ΔE00=3.249, best=2.760]Training (film/resnet18):  52%|█████▏    | 52/100 [04:43<04:20,  5.44s/it, train loss=1.1229, val ΔE00=3.195, best=2.760]Training (film/resnet18):  53%|█████▎    | 53/100 [04:48<04:14,  5.42s/it, train loss=1.1229, val ΔE00=3.195, best=2.760]Training (film/resnet18):  53%|█████▎    | 53/100 [04:48<04:14,  5.42s/it, train loss=1.1912, val ΔE00=3.371, best=2.760]Training (film/resnet18):  54%|█████▍    | 54/100 [04:54<04:08,  5.40s/it, train loss=1.1912, val ΔE00=3.371, best=2.760]Training (film/resnet18):  54%|█████▍    | 54/100 [04:54<04:08,  5.40s/it, train loss=1.2270, val ΔE00=2.842, best=2.760]Training (film/resnet18):  55%|█████▌    | 55/100 [04:59<04:05,  5.46s/it, train loss=1.2270, val ΔE00=2.842, best=2.760]Training (film/resnet18):  55%|█████▌    | 55/100 [04:59<04:05,  5.46s/it, train loss=1.3532, val ΔE00=3.344, best=2.760]Training (film/resnet18):  56%|█████▌    | 56/100 [05:05<04:00,  5.47s/it, train loss=1.3532, val ΔE00=3.344, best=2.760]Training (film/resnet18):  56%|█████▌    | 56/100 [05:05<04:00,  5.47s/it, train loss=1.2974, val ΔE00=3.342, best=2.760]Training (film/resnet18):  57%|█████▋    | 57/100 [05:10<03:53,  5.44s/it, train loss=1.2974, val ΔE00=3.342, best=2.760]Training (film/resnet18):  57%|█████▋    | 57/100 [05:10<03:53,  5.44s/it, train loss=1.2926, val ΔE00=3.025, best=2.760]Training (film/resnet18):  58%|█████▊    | 58/100 [05:16<03:47,  5.42s/it, train loss=1.2926, val ΔE00=3.025, best=2.760]Training (film/resnet18):  58%|█████▊    | 58/100 [05:16<03:47,  5.42s/it, train loss=1.2537, val ΔE00=3.621, best=2.760]Training (film/resnet18):  59%|█████▉    | 59/100 [05:21<03:42,  5.42s/it, train loss=1.2537, val ΔE00=3.621, best=2.760]Training (film/resnet18):  59%|█████▉    | 59/100 [05:21<03:42,  5.42s/it, train loss=1.2352, val ΔE00=2.557, best=2.557]Training (film/resnet18):  60%|██████    | 60/100 [05:27<03:38,  5.47s/it, train loss=1.2352, val ΔE00=2.557, best=2.557]Training (film/resnet18):  60%|██████    | 60/100 [05:27<03:38,  5.47s/it, train loss=1.1772, val ΔE00=2.817, best=2.557]Training (film/resnet18):  61%|██████    | 61/100 [05:32<03:33,  5.47s/it, train loss=1.1772, val ΔE00=2.817, best=2.557]Training (film/resnet18):  61%|██████    | 61/100 [05:32<03:33,  5.47s/it, train loss=1.2538, val ΔE00=2.881, best=2.557]Training (film/resnet18):  62%|██████▏   | 62/100 [05:37<03:26,  5.44s/it, train loss=1.2538, val ΔE00=2.881, best=2.557]Training (film/resnet18):  62%|██████▏   | 62/100 [05:37<03:26,  5.44s/it, train loss=1.2905, val ΔE00=3.065, best=2.557]Training (film/resnet18):  63%|██████▎   | 63/100 [05:43<03:20,  5.41s/it, train loss=1.2905, val ΔE00=3.065, best=2.557]Training (film/resnet18):  63%|██████▎   | 63/100 [05:43<03:20,  5.41s/it, train loss=1.3105, val ΔE00=2.906, best=2.557]Training (film/resnet18):  64%|██████▍   | 64/100 [05:48<03:14,  5.40s/it, train loss=1.3105, val ΔE00=2.906, best=2.557]Training (film/resnet18):  64%|██████▍   | 64/100 [05:48<03:14,  5.40s/it, train loss=1.3359, val ΔE00=3.201, best=2.557]Training (film/resnet18):  65%|██████▌   | 65/100 [05:54<03:11,  5.47s/it, train loss=1.3359, val ΔE00=3.201, best=2.557]Training (film/resnet18):  65%|██████▌   | 65/100 [05:54<03:11,  5.47s/it, train loss=1.3447, val ΔE00=2.902, best=2.557]Training (film/resnet18):  66%|██████▌   | 66/100 [05:59<03:05,  5.46s/it, train loss=1.3447, val ΔE00=2.902, best=2.557]Training (film/resnet18):  66%|██████▌   | 66/100 [05:59<03:05,  5.46s/it, train loss=1.1938, val ΔE00=3.020, best=2.557]Training (film/resnet18):  67%|██████▋   | 67/100 [06:05<02:58,  5.42s/it, train loss=1.1938, val ΔE00=3.020, best=2.557]Training (film/resnet18):  67%|██████▋   | 67/100 [06:05<02:58,  5.42s/it, train loss=1.3279, val ΔE00=2.974, best=2.557]Training (film/resnet18):  68%|██████▊   | 68/100 [06:10<02:52,  5.41s/it, train loss=1.3279, val ΔE00=2.974, best=2.557]Training (film/resnet18):  68%|██████▊   | 68/100 [06:10<02:52,  5.41s/it, train loss=1.3166, val ΔE00=2.975, best=2.557]Training (film/resnet18):  68%|██████▊   | 68/100 [06:15<02:52,  5.41s/it, train loss=1.2361, val ΔE00=3.082, early_stop=yes]Training (film/resnet18):  68%|██████▊   | 68/100 [06:15<02:56,  5.53s/it, train loss=1.2361, val ΔE00=3.082, early_stop=yes]
[early] stop at epoch 69 (best de00=2.5570 @ 59)
[done] best ΔE00=2.557 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/film__resnet18__image__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image/final_summary.json (kind=val)
[sweep] === Run 14/24 ===
[sweep] id=014_model=film__backbone=resnet18__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone resnet18 --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=resnet18, features=image+mean, meta_encoder=none
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:06<10:05,  6.12s/it]Training (film/resnet18):   1%|          | 1/100 [00:06<10:05,  6.12s/it, train loss=0.0072, val ΔE00=5.818, best=5.818]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:29,  5.82s/it, train loss=0.0072, val ΔE00=5.818, best=5.818]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:29,  5.82s/it, train loss=0.0057, val ΔE00=4.617, best=4.617]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:11,  5.68s/it, train loss=0.0057, val ΔE00=4.617, best=4.617]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:11,  5.68s/it, train loss=0.0105, val ΔE00=4.831, best=4.617]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:01,  5.64s/it, train loss=0.0105, val ΔE00=4.831, best=4.617]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:01,  5.64s/it, train loss=0.0186, val ΔE00=4.251, best=4.251]Training (film/resnet18):   5%|▌         | 5/100 [00:28<08:59,  5.68s/it, train loss=0.0186, val ΔE00=4.251, best=4.251]Training (film/resnet18):   5%|▌         | 5/100 [00:28<08:59,  5.68s/it, train loss=0.0268, val ΔE00=4.702, best=4.251]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:54,  5.69s/it, train loss=0.0268, val ΔE00=4.702, best=4.251]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:54,  5.69s/it, train loss=0.0382, val ΔE00=3.415, best=3.415]Training (film/resnet18):   7%|▋         | 7/100 [00:39<08:43,  5.63s/it, train loss=0.0382, val ΔE00=3.415, best=3.415]Training (film/resnet18):   7%|▋         | 7/100 [00:39<08:43,  5.63s/it, train loss=0.0508, val ΔE00=4.817, best=3.415]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:34,  5.59s/it, train loss=0.0508, val ΔE00=4.817, best=3.415]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:34,  5.59s/it, train loss=0.0649, val ΔE00=3.829, best=3.415]Training (film/resnet18):   9%|▉         | 9/100 [00:50<08:26,  5.57s/it, train loss=0.0649, val ΔE00=3.829, best=3.415]Training (film/resnet18):   9%|▉         | 9/100 [00:50<08:26,  5.57s/it, train loss=0.0802, val ΔE00=4.217, best=3.415]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:25,  5.62s/it, train loss=0.0802, val ΔE00=4.217, best=3.415]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:25,  5.62s/it, train loss=0.1049, val ΔE00=3.574, best=3.415]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:20,  5.62s/it, train loss=0.1049, val ΔE00=3.574, best=3.415]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:20,  5.62s/it, train loss=0.1143, val ΔE00=4.429, best=3.415]Training (film/resnet18):  12%|█▏        | 12/100 [01:07<08:13,  5.61s/it, train loss=0.1143, val ΔE00=4.429, best=3.415]Training (film/resnet18):  12%|█▏        | 12/100 [01:07<08:13,  5.61s/it, train loss=0.1487, val ΔE00=3.336, best=3.336]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:05,  5.58s/it, train loss=0.1487, val ΔE00=3.336, best=3.336]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:05,  5.58s/it, train loss=0.1663, val ΔE00=3.492, best=3.336]Training (film/resnet18):  14%|█▍        | 14/100 [01:18<07:59,  5.58s/it, train loss=0.1663, val ΔE00=3.492, best=3.336]Training (film/resnet18):  14%|█▍        | 14/100 [01:18<07:59,  5.58s/it, train loss=0.1810, val ΔE00=3.240, best=3.240]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<08:00,  5.65s/it, train loss=0.1810, val ΔE00=3.240, best=3.240]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<08:00,  5.65s/it, train loss=0.2121, val ΔE00=3.169, best=3.169]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:54,  5.65s/it, train loss=0.2121, val ΔE00=3.169, best=3.169]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:54,  5.65s/it, train loss=0.2285, val ΔE00=3.260, best=3.169]Training (film/resnet18):  17%|█▋        | 17/100 [01:35<07:45,  5.61s/it, train loss=0.2285, val ΔE00=3.260, best=3.169]Training (film/resnet18):  17%|█▋        | 17/100 [01:35<07:45,  5.61s/it, train loss=0.2484, val ΔE00=4.046, best=3.169]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:37,  5.58s/it, train loss=0.2484, val ΔE00=4.046, best=3.169]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:37,  5.58s/it, train loss=0.2863, val ΔE00=3.300, best=3.169]Training (film/resnet18):  19%|█▉        | 19/100 [01:46<07:30,  5.56s/it, train loss=0.2863, val ΔE00=3.300, best=3.169]Training (film/resnet18):  19%|█▉        | 19/100 [01:46<07:30,  5.56s/it, train loss=0.2836, val ΔE00=3.477, best=3.169]Training (film/resnet18):  20%|██        | 20/100 [01:52<07:29,  5.62s/it, train loss=0.2836, val ΔE00=3.477, best=3.169]Training (film/resnet18):  20%|██        | 20/100 [01:52<07:29,  5.62s/it, train loss=0.3077, val ΔE00=3.761, best=3.169]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:24,  5.63s/it, train loss=0.3077, val ΔE00=3.761, best=3.169]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:24,  5.63s/it, train loss=0.3328, val ΔE00=3.180, best=3.169]Training (film/resnet18):  22%|██▏       | 22/100 [02:03<07:16,  5.60s/it, train loss=0.3328, val ΔE00=3.180, best=3.169]Training (film/resnet18):  22%|██▏       | 22/100 [02:03<07:16,  5.60s/it, train loss=0.3672, val ΔE00=3.251, best=3.169]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:09,  5.58s/it, train loss=0.3672, val ΔE00=3.251, best=3.169]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:09,  5.58s/it, train loss=0.3913, val ΔE00=3.392, best=3.169]Training (film/resnet18):  24%|██▍       | 24/100 [02:14<07:02,  5.56s/it, train loss=0.3913, val ΔE00=3.392, best=3.169]Training (film/resnet18):  24%|██▍       | 24/100 [02:14<07:02,  5.56s/it, train loss=0.3961, val ΔE00=3.263, best=3.169]Training (film/resnet18):  25%|██▌       | 25/100 [02:20<07:02,  5.63s/it, train loss=0.3961, val ΔE00=3.263, best=3.169]Training (film/resnet18):  25%|██▌       | 25/100 [02:20<07:02,  5.63s/it, train loss=0.4326, val ΔE00=3.663, best=3.169]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:57,  5.65s/it, train loss=0.4326, val ΔE00=3.663, best=3.169]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:57,  5.65s/it, train loss=0.4594, val ΔE00=3.074, best=3.074]Training (film/resnet18):  27%|██▋       | 27/100 [02:31<06:49,  5.61s/it, train loss=0.4594, val ΔE00=3.074, best=3.074]Training (film/resnet18):  27%|██▋       | 27/100 [02:31<06:49,  5.61s/it, train loss=0.4790, val ΔE00=3.316, best=3.074]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:41,  5.58s/it, train loss=0.4790, val ΔE00=3.316, best=3.074]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:41,  5.58s/it, train loss=0.4865, val ΔE00=3.175, best=3.074]Training (film/resnet18):  29%|██▉       | 29/100 [02:42<06:34,  5.56s/it, train loss=0.4865, val ΔE00=3.175, best=3.074]Training (film/resnet18):  29%|██▉       | 29/100 [02:42<06:34,  5.56s/it, train loss=0.5250, val ΔE00=3.202, best=3.074]Training (film/resnet18):  30%|███       | 30/100 [02:48<06:34,  5.63s/it, train loss=0.5250, val ΔE00=3.202, best=3.074]Training (film/resnet18):  30%|███       | 30/100 [02:48<06:34,  5.63s/it, train loss=0.5438, val ΔE00=3.229, best=3.074]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:28,  5.63s/it, train loss=0.5438, val ΔE00=3.229, best=3.074]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:28,  5.63s/it, train loss=0.5369, val ΔE00=3.288, best=3.074]Training (film/resnet18):  32%|███▏      | 32/100 [02:59<06:20,  5.59s/it, train loss=0.5369, val ΔE00=3.288, best=3.074]Training (film/resnet18):  32%|███▏      | 32/100 [02:59<06:20,  5.59s/it, train loss=0.5807, val ΔE00=3.088, best=3.074]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:13,  5.57s/it, train loss=0.5807, val ΔE00=3.088, best=3.074]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:13,  5.57s/it, train loss=0.5813, val ΔE00=3.154, best=3.074]Training (film/resnet18):  34%|███▍      | 34/100 [03:10<06:06,  5.55s/it, train loss=0.5813, val ΔE00=3.154, best=3.074]Training (film/resnet18):  34%|███▍      | 34/100 [03:10<06:06,  5.55s/it, train loss=0.6122, val ΔE00=3.111, best=3.074]Training (film/resnet18):  35%|███▌      | 35/100 [03:16<06:06,  5.63s/it, train loss=0.6122, val ΔE00=3.111, best=3.074]Training (film/resnet18):  35%|███▌      | 35/100 [03:16<06:06,  5.63s/it, train loss=0.6551, val ΔE00=3.031, best=3.031]Training (film/resnet18):  36%|███▌      | 36/100 [03:22<06:01,  5.65s/it, train loss=0.6551, val ΔE00=3.031, best=3.031]Training (film/resnet18):  36%|███▌      | 36/100 [03:22<06:01,  5.65s/it, train loss=0.6496, val ΔE00=3.020, best=3.020]Training (film/resnet18):  37%|███▋      | 37/100 [03:27<05:54,  5.63s/it, train loss=0.6496, val ΔE00=3.020, best=3.020]Training (film/resnet18):  37%|███▋      | 37/100 [03:27<05:54,  5.63s/it, train loss=0.7669, val ΔE00=2.829, best=2.829]Training (film/resnet18):  38%|███▊      | 38/100 [03:33<05:46,  5.59s/it, train loss=0.7669, val ΔE00=2.829, best=2.829]Training (film/resnet18):  38%|███▊      | 38/100 [03:33<05:46,  5.59s/it, train loss=0.7077, val ΔE00=3.143, best=2.829]Training (film/resnet18):  39%|███▉      | 39/100 [03:38<05:39,  5.57s/it, train loss=0.7077, val ΔE00=3.143, best=2.829]Training (film/resnet18):  39%|███▉      | 39/100 [03:38<05:39,  5.57s/it, train loss=0.6960, val ΔE00=3.162, best=2.829]Training (film/resnet18):  40%|████      | 40/100 [03:44<05:37,  5.62s/it, train loss=0.6960, val ΔE00=3.162, best=2.829]Training (film/resnet18):  40%|████      | 40/100 [03:44<05:37,  5.62s/it, train loss=0.7630, val ΔE00=3.140, best=2.829]Training (film/resnet18):  41%|████      | 41/100 [03:50<05:31,  5.62s/it, train loss=0.7630, val ΔE00=3.140, best=2.829]Training (film/resnet18):  41%|████      | 41/100 [03:50<05:31,  5.62s/it, train loss=0.7302, val ΔE00=3.321, best=2.829]Training (film/resnet18):  42%|████▏     | 42/100 [03:55<05:24,  5.59s/it, train loss=0.7302, val ΔE00=3.321, best=2.829]Training (film/resnet18):  42%|████▏     | 42/100 [03:55<05:24,  5.59s/it, train loss=0.7648, val ΔE00=2.872, best=2.829]Training (film/resnet18):  43%|████▎     | 43/100 [04:01<05:17,  5.56s/it, train loss=0.7648, val ΔE00=2.872, best=2.829]Training (film/resnet18):  43%|████▎     | 43/100 [04:01<05:17,  5.56s/it, train loss=0.7748, val ΔE00=3.233, best=2.829]Training (film/resnet18):  44%|████▍     | 44/100 [04:06<05:10,  5.55s/it, train loss=0.7748, val ΔE00=3.233, best=2.829]Training (film/resnet18):  44%|████▍     | 44/100 [04:06<05:10,  5.55s/it, train loss=0.7911, val ΔE00=3.208, best=2.829]Training (film/resnet18):  45%|████▌     | 45/100 [04:12<05:09,  5.62s/it, train loss=0.7911, val ΔE00=3.208, best=2.829]Training (film/resnet18):  45%|████▌     | 45/100 [04:12<05:09,  5.62s/it, train loss=0.8080, val ΔE00=3.086, best=2.829]Training (film/resnet18):  46%|████▌     | 46/100 [04:18<05:03,  5.61s/it, train loss=0.8080, val ΔE00=3.086, best=2.829]Training (film/resnet18):  46%|████▌     | 46/100 [04:18<05:03,  5.61s/it, train loss=0.8645, val ΔE00=3.557, best=2.829]Training (film/resnet18):  47%|████▋     | 47/100 [04:23<04:55,  5.58s/it, train loss=0.8645, val ΔE00=3.557, best=2.829]Training (film/resnet18):  47%|████▋     | 47/100 [04:23<04:55,  5.58s/it, train loss=0.7705, val ΔE00=3.062, best=2.829]Training (film/resnet18):  48%|████▊     | 48/100 [04:29<04:49,  5.57s/it, train loss=0.7705, val ΔE00=3.062, best=2.829]Training (film/resnet18):  48%|████▊     | 48/100 [04:29<04:49,  5.57s/it, train loss=0.9391, val ΔE00=3.066, best=2.829]Training (film/resnet18):  49%|████▉     | 49/100 [04:34<04:42,  5.55s/it, train loss=0.9391, val ΔE00=3.066, best=2.829]Training (film/resnet18):  49%|████▉     | 49/100 [04:34<04:42,  5.55s/it, train loss=0.8345, val ΔE00=3.444, best=2.829]Training (film/resnet18):  50%|█████     | 50/100 [04:40<04:41,  5.62s/it, train loss=0.8345, val ΔE00=3.444, best=2.829]Training (film/resnet18):  50%|█████     | 50/100 [04:40<04:41,  5.62s/it, train loss=0.8467, val ΔE00=3.432, best=2.829]Training (film/resnet18):  51%|█████     | 51/100 [04:46<04:35,  5.62s/it, train loss=0.8467, val ΔE00=3.432, best=2.829]Training (film/resnet18):  51%|█████     | 51/100 [04:46<04:35,  5.62s/it, train loss=0.8632, val ΔE00=3.254, best=2.829]Training (film/resnet18):  52%|█████▏    | 52/100 [04:51<04:28,  5.59s/it, train loss=0.8632, val ΔE00=3.254, best=2.829]Training (film/resnet18):  52%|█████▏    | 52/100 [04:51<04:28,  5.59s/it, train loss=0.9199, val ΔE00=3.075, best=2.829]Training (film/resnet18):  53%|█████▎    | 53/100 [04:57<04:21,  5.57s/it, train loss=0.9199, val ΔE00=3.075, best=2.829]Training (film/resnet18):  53%|█████▎    | 53/100 [04:57<04:21,  5.57s/it, train loss=0.9673, val ΔE00=3.858, best=2.829]Training (film/resnet18):  54%|█████▍    | 54/100 [05:02<04:15,  5.55s/it, train loss=0.9673, val ΔE00=3.858, best=2.829]Training (film/resnet18):  54%|█████▍    | 54/100 [05:02<04:15,  5.55s/it, train loss=0.9711, val ΔE00=3.191, best=2.829]Training (film/resnet18):  55%|█████▌    | 55/100 [05:08<04:12,  5.62s/it, train loss=0.9711, val ΔE00=3.191, best=2.829]Training (film/resnet18):  55%|█████▌    | 55/100 [05:08<04:12,  5.62s/it, train loss=0.9103, val ΔE00=3.145, best=2.829]Training (film/resnet18):  56%|█████▌    | 56/100 [05:14<04:07,  5.62s/it, train loss=0.9103, val ΔE00=3.145, best=2.829]Training (film/resnet18):  56%|█████▌    | 56/100 [05:14<04:07,  5.62s/it, train loss=0.8340, val ΔE00=3.118, best=2.829]Training (film/resnet18):  57%|█████▋    | 57/100 [05:19<04:00,  5.58s/it, train loss=0.8340, val ΔE00=3.118, best=2.829]Training (film/resnet18):  57%|█████▋    | 57/100 [05:19<04:00,  5.58s/it, train loss=0.9726, val ΔE00=2.868, best=2.829]Training (film/resnet18):  58%|█████▊    | 58/100 [05:25<03:53,  5.56s/it, train loss=0.9726, val ΔE00=2.868, best=2.829]Training (film/resnet18):  58%|█████▊    | 58/100 [05:25<03:53,  5.56s/it, train loss=0.9531, val ΔE00=3.327, best=2.829]Training (film/resnet18):  58%|█████▊    | 58/100 [05:30<03:53,  5.56s/it, train loss=0.9142, val ΔE00=3.402, early_stop=yes]Training (film/resnet18):  58%|█████▊    | 58/100 [05:30<03:59,  5.70s/it, train loss=0.9142, val ΔE00=3.402, early_stop=yes]
[early] stop at epoch 59 (best de00=2.8288 @ 37)
[done] best ΔE00=2.829 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/film__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 15/24 ===
[sweep] id=015_model=film__backbone=resnet18__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone resnet18 --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=resnet18, features=image+meta, meta_encoder=none
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:06<10:03,  6.10s/it]Training (film/resnet18):   1%|          | 1/100 [00:06<10:03,  6.10s/it, train loss=0.0078, val ΔE00=6.309, best=6.309]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:28,  5.80s/it, train loss=0.0078, val ΔE00=6.309, best=6.309]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:28,  5.80s/it, train loss=0.0064, val ΔE00=4.935, best=4.935]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:09,  5.66s/it, train loss=0.0064, val ΔE00=4.935, best=4.935]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:09,  5.66s/it, train loss=0.0103, val ΔE00=5.200, best=4.935]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:01,  5.64s/it, train loss=0.0103, val ΔE00=5.200, best=4.935]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:01,  5.64s/it, train loss=0.0182, val ΔE00=4.264, best=4.264]Training (film/resnet18):   5%|▌         | 5/100 [00:28<09:00,  5.69s/it, train loss=0.0182, val ΔE00=4.264, best=4.264]Training (film/resnet18):   5%|▌         | 5/100 [00:28<09:00,  5.69s/it, train loss=0.0289, val ΔE00=4.992, best=4.264]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:55,  5.70s/it, train loss=0.0289, val ΔE00=4.992, best=4.264]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:55,  5.70s/it, train loss=0.0384, val ΔE00=4.049, best=4.049]Training (film/resnet18):   7%|▋         | 7/100 [00:39<08:46,  5.66s/it, train loss=0.0384, val ΔE00=4.049, best=4.049]Training (film/resnet18):   7%|▋         | 7/100 [00:39<08:46,  5.66s/it, train loss=0.0545, val ΔE00=3.313, best=3.313]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:37,  5.63s/it, train loss=0.0545, val ΔE00=3.313, best=3.313]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:37,  5.63s/it, train loss=0.0697, val ΔE00=3.247, best=3.247]Training (film/resnet18):   9%|▉         | 9/100 [00:50<08:29,  5.60s/it, train loss=0.0697, val ΔE00=3.247, best=3.247]Training (film/resnet18):   9%|▉         | 9/100 [00:50<08:29,  5.60s/it, train loss=0.0837, val ΔE00=4.100, best=3.247]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:29,  5.66s/it, train loss=0.0837, val ΔE00=4.100, best=3.247]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:29,  5.66s/it, train loss=0.1017, val ΔE00=3.798, best=3.247]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:23,  5.66s/it, train loss=0.1017, val ΔE00=3.798, best=3.247]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:23,  5.66s/it, train loss=0.1218, val ΔE00=3.043, best=3.043]Training (film/resnet18):  12%|█▏        | 12/100 [01:07<08:14,  5.62s/it, train loss=0.1218, val ΔE00=3.043, best=3.043]Training (film/resnet18):  12%|█▏        | 12/100 [01:07<08:14,  5.62s/it, train loss=0.1427, val ΔE00=3.743, best=3.043]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:07,  5.60s/it, train loss=0.1427, val ΔE00=3.743, best=3.043]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:07,  5.60s/it, train loss=0.1683, val ΔE00=2.996, best=2.996]Training (film/resnet18):  14%|█▍        | 14/100 [01:19<08:01,  5.60s/it, train loss=0.1683, val ΔE00=2.996, best=2.996]Training (film/resnet18):  14%|█▍        | 14/100 [01:19<08:01,  5.60s/it, train loss=0.1924, val ΔE00=2.942, best=2.942]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<08:00,  5.65s/it, train loss=0.1924, val ΔE00=2.942, best=2.942]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<08:00,  5.65s/it, train loss=0.2018, val ΔE00=3.234, best=2.942]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:53,  5.64s/it, train loss=0.2018, val ΔE00=3.234, best=2.942]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:53,  5.64s/it, train loss=0.2238, val ΔE00=3.042, best=2.942]Training (film/resnet18):  17%|█▋        | 17/100 [01:35<07:44,  5.60s/it, train loss=0.2238, val ΔE00=3.042, best=2.942]Training (film/resnet18):  17%|█▋        | 17/100 [01:35<07:44,  5.60s/it, train loss=0.2446, val ΔE00=2.982, best=2.942]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:38,  5.60s/it, train loss=0.2446, val ΔE00=2.982, best=2.942]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:38,  5.60s/it, train loss=0.2797, val ΔE00=2.727, best=2.727]Training (film/resnet18):  19%|█▉        | 19/100 [01:47<07:31,  5.57s/it, train loss=0.2797, val ΔE00=2.727, best=2.727]Training (film/resnet18):  19%|█▉        | 19/100 [01:47<07:31,  5.57s/it, train loss=0.2907, val ΔE00=2.903, best=2.727]Training (film/resnet18):  20%|██        | 20/100 [01:52<07:30,  5.63s/it, train loss=0.2907, val ΔE00=2.903, best=2.727]Training (film/resnet18):  20%|██        | 20/100 [01:52<07:30,  5.63s/it, train loss=0.3210, val ΔE00=3.191, best=2.727]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:24,  5.63s/it, train loss=0.3210, val ΔE00=3.191, best=2.727]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:24,  5.63s/it, train loss=0.3519, val ΔE00=2.985, best=2.727]Training (film/resnet18):  22%|██▏       | 22/100 [02:04<07:18,  5.62s/it, train loss=0.3519, val ΔE00=2.985, best=2.727]Training (film/resnet18):  22%|██▏       | 22/100 [02:04<07:18,  5.62s/it, train loss=0.3767, val ΔE00=2.699, best=2.699]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:10,  5.59s/it, train loss=0.3767, val ΔE00=2.699, best=2.699]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:10,  5.59s/it, train loss=0.4221, val ΔE00=2.718, best=2.699]Training (film/resnet18):  24%|██▍       | 24/100 [02:15<07:03,  5.57s/it, train loss=0.4221, val ΔE00=2.718, best=2.699]Training (film/resnet18):  24%|██▍       | 24/100 [02:15<07:03,  5.57s/it, train loss=0.4421, val ΔE00=3.333, best=2.699]Training (film/resnet18):  25%|██▌       | 25/100 [02:20<07:02,  5.63s/it, train loss=0.4421, val ΔE00=3.333, best=2.699]Training (film/resnet18):  25%|██▌       | 25/100 [02:20<07:02,  5.63s/it, train loss=0.4614, val ΔE00=2.831, best=2.699]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:56,  5.63s/it, train loss=0.4614, val ΔE00=2.831, best=2.699]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:56,  5.63s/it, train loss=0.5297, val ΔE00=2.886, best=2.699]Training (film/resnet18):  27%|██▋       | 27/100 [02:32<06:48,  5.60s/it, train loss=0.5297, val ΔE00=2.886, best=2.699]Training (film/resnet18):  27%|██▋       | 27/100 [02:32<06:48,  5.60s/it, train loss=0.5488, val ΔE00=2.909, best=2.699]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:42,  5.59s/it, train loss=0.5488, val ΔE00=2.909, best=2.699]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:42,  5.59s/it, train loss=0.5106, val ΔE00=2.465, best=2.465]Training (film/resnet18):  29%|██▉       | 29/100 [02:43<06:35,  5.57s/it, train loss=0.5106, val ΔE00=2.465, best=2.465]Training (film/resnet18):  29%|██▉       | 29/100 [02:43<06:35,  5.57s/it, train loss=0.5959, val ΔE00=2.493, best=2.465]Training (film/resnet18):  30%|███       | 30/100 [02:48<06:35,  5.66s/it, train loss=0.5959, val ΔE00=2.493, best=2.465]Training (film/resnet18):  30%|███       | 30/100 [02:49<06:35,  5.66s/it, train loss=0.5855, val ΔE00=2.371, best=2.371]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:29,  5.65s/it, train loss=0.5855, val ΔE00=2.371, best=2.371]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:29,  5.65s/it, train loss=0.5967, val ΔE00=2.692, best=2.371]Training (film/resnet18):  32%|███▏      | 32/100 [03:00<06:21,  5.61s/it, train loss=0.5967, val ΔE00=2.692, best=2.371]Training (film/resnet18):  32%|███▏      | 32/100 [03:00<06:21,  5.61s/it, train loss=0.6493, val ΔE00=2.965, best=2.371]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:14,  5.58s/it, train loss=0.6493, val ΔE00=2.965, best=2.371]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:14,  5.58s/it, train loss=0.6627, val ΔE00=2.406, best=2.371]Training (film/resnet18):  34%|███▍      | 34/100 [03:11<06:07,  5.57s/it, train loss=0.6627, val ΔE00=2.406, best=2.371]Training (film/resnet18):  34%|███▍      | 34/100 [03:11<06:07,  5.57s/it, train loss=0.7750, val ΔE00=2.532, best=2.371]Training (film/resnet18):  35%|███▌      | 35/100 [03:16<06:06,  5.63s/it, train loss=0.7750, val ΔE00=2.532, best=2.371]Training (film/resnet18):  35%|███▌      | 35/100 [03:16<06:06,  5.63s/it, train loss=0.7201, val ΔE00=2.750, best=2.371]Training (film/resnet18):  36%|███▌      | 36/100 [03:22<06:00,  5.63s/it, train loss=0.7201, val ΔE00=2.750, best=2.371]Training (film/resnet18):  36%|███▌      | 36/100 [03:22<06:00,  5.63s/it, train loss=0.7864, val ΔE00=3.112, best=2.371]Training (film/resnet18):  37%|███▋      | 37/100 [03:28<05:52,  5.60s/it, train loss=0.7864, val ΔE00=3.112, best=2.371]Training (film/resnet18):  37%|███▋      | 37/100 [03:28<05:52,  5.60s/it, train loss=0.7702, val ΔE00=2.489, best=2.371]Training (film/resnet18):  38%|███▊      | 38/100 [03:33<05:47,  5.60s/it, train loss=0.7702, val ΔE00=2.489, best=2.371]Training (film/resnet18):  38%|███▊      | 38/100 [03:33<05:47,  5.60s/it, train loss=0.7494, val ΔE00=2.268, best=2.268]Training (film/resnet18):  39%|███▉      | 39/100 [03:39<05:40,  5.57s/it, train loss=0.7494, val ΔE00=2.268, best=2.268]Training (film/resnet18):  39%|███▉      | 39/100 [03:39<05:40,  5.57s/it, train loss=0.8360, val ΔE00=2.692, best=2.268]Training (film/resnet18):  40%|████      | 40/100 [03:45<05:38,  5.64s/it, train loss=0.8360, val ΔE00=2.692, best=2.268]Training (film/resnet18):  40%|████      | 40/100 [03:45<05:38,  5.64s/it, train loss=0.9025, val ΔE00=2.651, best=2.268]Training (film/resnet18):  41%|████      | 41/100 [03:50<05:31,  5.63s/it, train loss=0.9025, val ΔE00=2.651, best=2.268]Training (film/resnet18):  41%|████      | 41/100 [03:50<05:31,  5.63s/it, train loss=0.8613, val ΔE00=2.928, best=2.268]Training (film/resnet18):  42%|████▏     | 42/100 [03:56<05:24,  5.59s/it, train loss=0.8613, val ΔE00=2.928, best=2.268]Training (film/resnet18):  42%|████▏     | 42/100 [03:56<05:24,  5.59s/it, train loss=0.9033, val ΔE00=2.361, best=2.268]Training (film/resnet18):  43%|████▎     | 43/100 [04:01<05:17,  5.57s/it, train loss=0.9033, val ΔE00=2.361, best=2.268]Training (film/resnet18):  43%|████▎     | 43/100 [04:01<05:17,  5.57s/it, train loss=0.8853, val ΔE00=2.460, best=2.268]Training (film/resnet18):  44%|████▍     | 44/100 [04:07<05:11,  5.57s/it, train loss=0.8853, val ΔE00=2.460, best=2.268]Training (film/resnet18):  44%|████▍     | 44/100 [04:07<05:11,  5.57s/it, train loss=0.8728, val ΔE00=2.264, best=2.264]Training (film/resnet18):  45%|████▌     | 45/100 [04:12<05:08,  5.62s/it, train loss=0.8728, val ΔE00=2.264, best=2.264]Training (film/resnet18):  45%|████▌     | 45/100 [04:12<05:08,  5.62s/it, train loss=0.9666, val ΔE00=2.503, best=2.264]Training (film/resnet18):  46%|████▌     | 46/100 [04:18<05:03,  5.63s/it, train loss=0.9666, val ΔE00=2.503, best=2.264]Training (film/resnet18):  46%|████▌     | 46/100 [04:18<05:03,  5.63s/it, train loss=1.0111, val ΔE00=2.534, best=2.264]Training (film/resnet18):  47%|████▋     | 47/100 [04:24<04:56,  5.60s/it, train loss=1.0111, val ΔE00=2.534, best=2.264]Training (film/resnet18):  47%|████▋     | 47/100 [04:24<04:56,  5.60s/it, train loss=1.0422, val ΔE00=2.831, best=2.264]Training (film/resnet18):  48%|████▊     | 48/100 [04:29<04:49,  5.58s/it, train loss=1.0422, val ΔE00=2.831, best=2.264]Training (film/resnet18):  48%|████▊     | 48/100 [04:29<04:49,  5.58s/it, train loss=1.1062, val ΔE00=2.550, best=2.264]Training (film/resnet18):  49%|████▉     | 49/100 [04:35<04:43,  5.56s/it, train loss=1.1062, val ΔE00=2.550, best=2.264]Training (film/resnet18):  49%|████▉     | 49/100 [04:35<04:43,  5.56s/it, train loss=0.9543, val ΔE00=2.618, best=2.264]Training (film/resnet18):  50%|█████     | 50/100 [04:40<04:41,  5.62s/it, train loss=0.9543, val ΔE00=2.618, best=2.264]Training (film/resnet18):  50%|█████     | 50/100 [04:40<04:41,  5.62s/it, train loss=0.9382, val ΔE00=2.376, best=2.264]Training (film/resnet18):  51%|█████     | 51/100 [04:46<04:35,  5.63s/it, train loss=0.9382, val ΔE00=2.376, best=2.264]Training (film/resnet18):  51%|█████     | 51/100 [04:46<04:35,  5.63s/it, train loss=1.0686, val ΔE00=2.420, best=2.264]Training (film/resnet18):  52%|█████▏    | 52/100 [04:52<04:28,  5.59s/it, train loss=1.0686, val ΔE00=2.420, best=2.264]Training (film/resnet18):  52%|█████▏    | 52/100 [04:52<04:28,  5.59s/it, train loss=1.0051, val ΔE00=2.713, best=2.264]Training (film/resnet18):  53%|█████▎    | 53/100 [04:57<04:21,  5.57s/it, train loss=1.0051, val ΔE00=2.713, best=2.264]Training (film/resnet18):  53%|█████▎    | 53/100 [04:57<04:21,  5.57s/it, train loss=1.0906, val ΔE00=2.470, best=2.264]Training (film/resnet18):  54%|█████▍    | 54/100 [05:03<04:15,  5.56s/it, train loss=1.0906, val ΔE00=2.470, best=2.264]Training (film/resnet18):  54%|█████▍    | 54/100 [05:03<04:15,  5.56s/it, train loss=0.9784, val ΔE00=2.522, best=2.264]Training (film/resnet18):  55%|█████▌    | 55/100 [05:08<04:12,  5.62s/it, train loss=0.9784, val ΔE00=2.522, best=2.264]Training (film/resnet18):  55%|█████▌    | 55/100 [05:08<04:12,  5.62s/it, train loss=1.0436, val ΔE00=2.377, best=2.264]Training (film/resnet18):  56%|█████▌    | 56/100 [05:14<04:07,  5.62s/it, train loss=1.0436, val ΔE00=2.377, best=2.264]Training (film/resnet18):  56%|█████▌    | 56/100 [05:14<04:07,  5.62s/it, train loss=1.1369, val ΔE00=3.518, best=2.264]Training (film/resnet18):  57%|█████▋    | 57/100 [05:20<04:01,  5.61s/it, train loss=1.1369, val ΔE00=3.518, best=2.264]Training (film/resnet18):  57%|█████▋    | 57/100 [05:20<04:01,  5.61s/it, train loss=1.0780, val ΔE00=2.260, best=2.260]Training (film/resnet18):  58%|█████▊    | 58/100 [05:25<03:54,  5.58s/it, train loss=1.0780, val ΔE00=2.260, best=2.260]Training (film/resnet18):  58%|█████▊    | 58/100 [05:25<03:54,  5.58s/it, train loss=1.1495, val ΔE00=2.303, best=2.260]Training (film/resnet18):  58%|█████▊    | 58/100 [05:31<03:54,  5.58s/it, train loss=1.1921, val ΔE00=2.551, early_stop=yes]Training (film/resnet18):  58%|█████▊    | 58/100 [05:31<03:59,  5.71s/it, train loss=1.1921, val ΔE00=2.551, early_stop=yes]
[early] stop at epoch 59 (best de00=2.2676 @ 38)
[done] best ΔE00=2.260 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/film__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 16/24 ===
[sweep] id=016_model=film__backbone=resnet18__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone resnet18 --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=resnet18, features=image+mean+meta, meta_encoder=none
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:06<10:09,  6.16s/it]Training (film/resnet18):   1%|          | 1/100 [00:06<10:09,  6.16s/it, train loss=0.0079, val ΔE00=6.495, best=6.495]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:31,  5.84s/it, train loss=0.0079, val ΔE00=6.495, best=6.495]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:31,  5.84s/it, train loss=0.0061, val ΔE00=5.523, best=5.523]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:15,  5.72s/it, train loss=0.0061, val ΔE00=5.523, best=5.523]Training (film/resnet18):   3%|▎         | 3/100 [00:17<09:15,  5.72s/it, train loss=0.0116, val ΔE00=4.346, best=4.346]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:01,  5.64s/it, train loss=0.0116, val ΔE00=4.346, best=4.346]Training (film/resnet18):   4%|▍         | 4/100 [00:22<09:01,  5.64s/it, train loss=0.0175, val ΔE00=4.945, best=4.346]Training (film/resnet18):   5%|▌         | 5/100 [00:28<08:59,  5.68s/it, train loss=0.0175, val ΔE00=4.945, best=4.346]Training (film/resnet18):   5%|▌         | 5/100 [00:28<08:59,  5.68s/it, train loss=0.0266, val ΔE00=5.191, best=4.346]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:52,  5.67s/it, train loss=0.0266, val ΔE00=5.191, best=4.346]Training (film/resnet18):   6%|▌         | 6/100 [00:34<08:52,  5.67s/it, train loss=0.0380, val ΔE00=4.552, best=4.346]Training (film/resnet18):   7%|▋         | 7/100 [00:39<08:44,  5.64s/it, train loss=0.0380, val ΔE00=4.552, best=4.346]Training (film/resnet18):   7%|▋         | 7/100 [00:39<08:44,  5.64s/it, train loss=0.0515, val ΔE00=3.655, best=3.655]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:35,  5.60s/it, train loss=0.0515, val ΔE00=3.655, best=3.655]Training (film/resnet18):   8%|▊         | 8/100 [00:45<08:35,  5.60s/it, train loss=0.0622, val ΔE00=3.839, best=3.655]Training (film/resnet18):   9%|▉         | 9/100 [00:50<08:29,  5.60s/it, train loss=0.0622, val ΔE00=3.839, best=3.655]Training (film/resnet18):   9%|▉         | 9/100 [00:50<08:29,  5.60s/it, train loss=0.0829, val ΔE00=3.455, best=3.455]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:28,  5.65s/it, train loss=0.0829, val ΔE00=3.455, best=3.455]Training (film/resnet18):  10%|█         | 10/100 [00:56<08:28,  5.65s/it, train loss=0.0919, val ΔE00=3.470, best=3.455]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:24,  5.67s/it, train loss=0.0919, val ΔE00=3.470, best=3.455]Training (film/resnet18):  11%|█         | 11/100 [01:02<08:24,  5.67s/it, train loss=0.1145, val ΔE00=3.251, best=3.251]Training (film/resnet18):  12%|█▏        | 12/100 [01:07<08:15,  5.63s/it, train loss=0.1145, val ΔE00=3.251, best=3.251]Training (film/resnet18):  12%|█▏        | 12/100 [01:07<08:15,  5.63s/it, train loss=0.1399, val ΔE00=3.495, best=3.251]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:09,  5.62s/it, train loss=0.1399, val ΔE00=3.495, best=3.251]Training (film/resnet18):  13%|█▎        | 13/100 [01:13<08:09,  5.62s/it, train loss=0.1507, val ΔE00=3.191, best=3.191]Training (film/resnet18):  14%|█▍        | 14/100 [01:19<08:00,  5.59s/it, train loss=0.1507, val ΔE00=3.191, best=3.191]Training (film/resnet18):  14%|█▍        | 14/100 [01:19<08:00,  5.59s/it, train loss=0.1672, val ΔE00=3.357, best=3.191]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<07:59,  5.64s/it, train loss=0.1672, val ΔE00=3.357, best=3.191]Training (film/resnet18):  15%|█▌        | 15/100 [01:24<07:59,  5.64s/it, train loss=0.1883, val ΔE00=3.488, best=3.191]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:54,  5.65s/it, train loss=0.1883, val ΔE00=3.488, best=3.191]Training (film/resnet18):  16%|█▌        | 16/100 [01:30<07:54,  5.65s/it, train loss=0.2295, val ΔE00=3.878, best=3.191]Training (film/resnet18):  17%|█▋        | 17/100 [01:36<07:47,  5.63s/it, train loss=0.2295, val ΔE00=3.878, best=3.191]Training (film/resnet18):  17%|█▋        | 17/100 [01:36<07:47,  5.63s/it, train loss=0.2459, val ΔE00=3.008, best=3.008]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:40,  5.62s/it, train loss=0.2459, val ΔE00=3.008, best=3.008]Training (film/resnet18):  18%|█▊        | 18/100 [01:41<07:40,  5.62s/it, train loss=0.2491, val ΔE00=2.844, best=2.844]Training (film/resnet18):  19%|█▉        | 19/100 [01:47<07:32,  5.59s/it, train loss=0.2491, val ΔE00=2.844, best=2.844]Training (film/resnet18):  19%|█▉        | 19/100 [01:47<07:32,  5.59s/it, train loss=0.2775, val ΔE00=3.560, best=2.844]Training (film/resnet18):  20%|██        | 20/100 [01:52<07:30,  5.64s/it, train loss=0.2775, val ΔE00=3.560, best=2.844]Training (film/resnet18):  20%|██        | 20/100 [01:52<07:30,  5.64s/it, train loss=0.3025, val ΔE00=3.094, best=2.844]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:25,  5.64s/it, train loss=0.3025, val ΔE00=3.094, best=2.844]Training (film/resnet18):  21%|██        | 21/100 [01:58<07:25,  5.64s/it, train loss=0.3049, val ΔE00=3.085, best=2.844]Training (film/resnet18):  22%|██▏       | 22/100 [02:04<07:16,  5.60s/it, train loss=0.3049, val ΔE00=3.085, best=2.844]Training (film/resnet18):  22%|██▏       | 22/100 [02:04<07:16,  5.60s/it, train loss=0.3478, val ΔE00=3.212, best=2.844]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:10,  5.60s/it, train loss=0.3478, val ΔE00=3.212, best=2.844]Training (film/resnet18):  23%|██▎       | 23/100 [02:09<07:10,  5.60s/it, train loss=0.3885, val ΔE00=2.754, best=2.754]Training (film/resnet18):  24%|██▍       | 24/100 [02:15<07:05,  5.59s/it, train loss=0.3885, val ΔE00=2.754, best=2.754]Training (film/resnet18):  24%|██▍       | 24/100 [02:15<07:05,  5.59s/it, train loss=0.3921, val ΔE00=2.595, best=2.595]Training (film/resnet18):  25%|██▌       | 25/100 [02:21<07:02,  5.64s/it, train loss=0.3921, val ΔE00=2.595, best=2.595]Training (film/resnet18):  25%|██▌       | 25/100 [02:21<07:02,  5.64s/it, train loss=0.4082, val ΔE00=2.951, best=2.595]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:57,  5.64s/it, train loss=0.4082, val ΔE00=2.951, best=2.595]Training (film/resnet18):  26%|██▌       | 26/100 [02:26<06:57,  5.64s/it, train loss=0.4197, val ΔE00=3.205, best=2.595]Training (film/resnet18):  27%|██▋       | 27/100 [02:32<06:49,  5.60s/it, train loss=0.4197, val ΔE00=3.205, best=2.595]Training (film/resnet18):  27%|██▋       | 27/100 [02:32<06:49,  5.60s/it, train loss=0.4564, val ΔE00=2.799, best=2.595]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:41,  5.58s/it, train loss=0.4564, val ΔE00=2.799, best=2.595]Training (film/resnet18):  28%|██▊       | 28/100 [02:37<06:41,  5.58s/it, train loss=0.4763, val ΔE00=2.638, best=2.595]Training (film/resnet18):  29%|██▉       | 29/100 [02:43<06:34,  5.56s/it, train loss=0.4763, val ΔE00=2.638, best=2.595]Training (film/resnet18):  29%|██▉       | 29/100 [02:43<06:34,  5.56s/it, train loss=0.5048, val ΔE00=3.367, best=2.595]Training (film/resnet18):  30%|███       | 30/100 [02:49<06:33,  5.62s/it, train loss=0.5048, val ΔE00=3.367, best=2.595]Training (film/resnet18):  30%|███       | 30/100 [02:49<06:33,  5.62s/it, train loss=0.5331, val ΔE00=2.769, best=2.595]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:28,  5.63s/it, train loss=0.5331, val ΔE00=2.769, best=2.595]Training (film/resnet18):  31%|███       | 31/100 [02:54<06:28,  5.63s/it, train loss=0.5354, val ΔE00=3.332, best=2.595]Training (film/resnet18):  32%|███▏      | 32/100 [03:00<06:20,  5.60s/it, train loss=0.5354, val ΔE00=3.332, best=2.595]Training (film/resnet18):  32%|███▏      | 32/100 [03:00<06:20,  5.60s/it, train loss=0.5876, val ΔE00=3.125, best=2.595]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:13,  5.58s/it, train loss=0.5876, val ΔE00=3.125, best=2.595]Training (film/resnet18):  33%|███▎      | 33/100 [03:05<06:13,  5.58s/it, train loss=0.5914, val ΔE00=2.836, best=2.595]Training (film/resnet18):  34%|███▍      | 34/100 [03:11<06:06,  5.56s/it, train loss=0.5914, val ΔE00=2.836, best=2.595]Training (film/resnet18):  34%|███▍      | 34/100 [03:11<06:06,  5.56s/it, train loss=0.5986, val ΔE00=2.711, best=2.595]Training (film/resnet18):  35%|███▌      | 35/100 [03:17<06:06,  5.64s/it, train loss=0.5986, val ΔE00=2.711, best=2.595]Training (film/resnet18):  35%|███▌      | 35/100 [03:17<06:06,  5.64s/it, train loss=0.6159, val ΔE00=2.582, best=2.582]Training (film/resnet18):  36%|███▌      | 36/100 [03:22<06:01,  5.65s/it, train loss=0.6159, val ΔE00=2.582, best=2.582]Training (film/resnet18):  36%|███▌      | 36/100 [03:22<06:01,  5.65s/it, train loss=0.6533, val ΔE00=2.635, best=2.582]Training (film/resnet18):  37%|███▋      | 37/100 [03:28<05:53,  5.61s/it, train loss=0.6533, val ΔE00=2.635, best=2.582]Training (film/resnet18):  37%|███▋      | 37/100 [03:28<05:53,  5.61s/it, train loss=0.6229, val ΔE00=2.661, best=2.582]Training (film/resnet18):  38%|███▊      | 38/100 [03:33<05:46,  5.59s/it, train loss=0.6229, val ΔE00=2.661, best=2.582]Training (film/resnet18):  38%|███▊      | 38/100 [03:33<05:46,  5.59s/it, train loss=0.6542, val ΔE00=3.254, best=2.582]Training (film/resnet18):  39%|███▉      | 39/100 [03:39<05:40,  5.57s/it, train loss=0.6542, val ΔE00=3.254, best=2.582]Training (film/resnet18):  39%|███▉      | 39/100 [03:39<05:40,  5.57s/it, train loss=0.6982, val ΔE00=2.657, best=2.582]Training (film/resnet18):  40%|████      | 40/100 [03:45<05:37,  5.63s/it, train loss=0.6982, val ΔE00=2.657, best=2.582]Training (film/resnet18):  40%|████      | 40/100 [03:45<05:37,  5.63s/it, train loss=0.6714, val ΔE00=2.851, best=2.582]Training (film/resnet18):  41%|████      | 41/100 [03:50<05:32,  5.64s/it, train loss=0.6714, val ΔE00=2.851, best=2.582]Training (film/resnet18):  41%|████      | 41/100 [03:50<05:32,  5.64s/it, train loss=0.6861, val ΔE00=2.775, best=2.582]Training (film/resnet18):  42%|████▏     | 42/100 [03:56<05:25,  5.61s/it, train loss=0.6861, val ΔE00=2.775, best=2.582]Training (film/resnet18):  42%|████▏     | 42/100 [03:56<05:25,  5.61s/it, train loss=0.6972, val ΔE00=3.048, best=2.582]Training (film/resnet18):  43%|████▎     | 43/100 [04:01<05:18,  5.58s/it, train loss=0.6972, val ΔE00=3.048, best=2.582]Training (film/resnet18):  43%|████▎     | 43/100 [04:01<05:18,  5.58s/it, train loss=0.7591, val ΔE00=3.019, best=2.582]Training (film/resnet18):  44%|████▍     | 44/100 [04:07<05:11,  5.57s/it, train loss=0.7591, val ΔE00=3.019, best=2.582]Training (film/resnet18):  44%|████▍     | 44/100 [04:07<05:11,  5.57s/it, train loss=0.8297, val ΔE00=2.599, best=2.582]Training (film/resnet18):  45%|████▌     | 45/100 [04:13<05:09,  5.63s/it, train loss=0.8297, val ΔE00=2.599, best=2.582]Training (film/resnet18):  45%|████▌     | 45/100 [04:13<05:09,  5.63s/it, train loss=0.7559, val ΔE00=2.766, best=2.582]Training (film/resnet18):  46%|████▌     | 46/100 [04:18<05:04,  5.63s/it, train loss=0.7559, val ΔE00=2.766, best=2.582]Training (film/resnet18):  46%|████▌     | 46/100 [04:18<05:04,  5.63s/it, train loss=0.8230, val ΔE00=3.264, best=2.582]Training (film/resnet18):  47%|████▋     | 47/100 [04:24<04:56,  5.60s/it, train loss=0.8230, val ΔE00=3.264, best=2.582]Training (film/resnet18):  47%|████▋     | 47/100 [04:24<04:56,  5.60s/it, train loss=0.7536, val ΔE00=2.632, best=2.582]Training (film/resnet18):  48%|████▊     | 48/100 [04:29<04:50,  5.59s/it, train loss=0.7536, val ΔE00=2.632, best=2.582]Training (film/resnet18):  48%|████▊     | 48/100 [04:29<04:50,  5.59s/it, train loss=0.7800, val ΔE00=2.581, best=2.581]Training (film/resnet18):  49%|████▉     | 49/100 [04:35<04:44,  5.57s/it, train loss=0.7800, val ΔE00=2.581, best=2.581]Training (film/resnet18):  49%|████▉     | 49/100 [04:35<04:44,  5.57s/it, train loss=0.7423, val ΔE00=2.627, best=2.581]Training (film/resnet18):  50%|█████     | 50/100 [04:41<04:40,  5.62s/it, train loss=0.7423, val ΔE00=2.627, best=2.581]Training (film/resnet18):  50%|█████     | 50/100 [04:41<04:40,  5.62s/it, train loss=0.8508, val ΔE00=2.954, best=2.581]Training (film/resnet18):  51%|█████     | 51/100 [04:46<04:35,  5.63s/it, train loss=0.8508, val ΔE00=2.954, best=2.581]Training (film/resnet18):  51%|█████     | 51/100 [04:46<04:35,  5.63s/it, train loss=0.8404, val ΔE00=2.798, best=2.581]Training (film/resnet18):  52%|█████▏    | 52/100 [04:52<04:28,  5.60s/it, train loss=0.8404, val ΔE00=2.798, best=2.581]Training (film/resnet18):  52%|█████▏    | 52/100 [04:52<04:28,  5.60s/it, train loss=0.8563, val ΔE00=2.691, best=2.581]Training (film/resnet18):  53%|█████▎    | 53/100 [04:57<04:21,  5.57s/it, train loss=0.8563, val ΔE00=2.691, best=2.581]Training (film/resnet18):  53%|█████▎    | 53/100 [04:57<04:21,  5.57s/it, train loss=0.8790, val ΔE00=2.702, best=2.581]Training (film/resnet18):  54%|█████▍    | 54/100 [05:03<04:15,  5.56s/it, train loss=0.8790, val ΔE00=2.702, best=2.581]Training (film/resnet18):  54%|█████▍    | 54/100 [05:03<04:15,  5.56s/it, train loss=0.8498, val ΔE00=2.836, best=2.581]Training (film/resnet18):  55%|█████▌    | 55/100 [05:09<04:13,  5.62s/it, train loss=0.8498, val ΔE00=2.836, best=2.581]Training (film/resnet18):  55%|█████▌    | 55/100 [05:09<04:13,  5.62s/it, train loss=0.8458, val ΔE00=2.658, best=2.581]Training (film/resnet18):  56%|█████▌    | 56/100 [05:14<04:07,  5.63s/it, train loss=0.8458, val ΔE00=2.658, best=2.581]Training (film/resnet18):  56%|█████▌    | 56/100 [05:14<04:07,  5.63s/it, train loss=0.8011, val ΔE00=3.008, best=2.581]Training (film/resnet18):  57%|█████▋    | 57/100 [05:20<04:01,  5.62s/it, train loss=0.8011, val ΔE00=3.008, best=2.581]Training (film/resnet18):  57%|█████▋    | 57/100 [05:20<04:01,  5.62s/it, train loss=0.8689, val ΔE00=2.431, best=2.431]Training (film/resnet18):  58%|█████▊    | 58/100 [05:25<03:54,  5.59s/it, train loss=0.8689, val ΔE00=2.431, best=2.431]Training (film/resnet18):  58%|█████▊    | 58/100 [05:25<03:54,  5.59s/it, train loss=0.8524, val ΔE00=2.868, best=2.431]Training (film/resnet18):  59%|█████▉    | 59/100 [05:31<03:48,  5.58s/it, train loss=0.8524, val ΔE00=2.868, best=2.431]Training (film/resnet18):  59%|█████▉    | 59/100 [05:31<03:48,  5.58s/it, train loss=0.8419, val ΔE00=2.823, best=2.431]Training (film/resnet18):  60%|██████    | 60/100 [05:37<03:45,  5.63s/it, train loss=0.8419, val ΔE00=2.823, best=2.431]Training (film/resnet18):  60%|██████    | 60/100 [05:37<03:45,  5.63s/it, train loss=0.9077, val ΔE00=2.953, best=2.431]Training (film/resnet18):  61%|██████    | 61/100 [05:42<03:40,  5.64s/it, train loss=0.9077, val ΔE00=2.953, best=2.431]Training (film/resnet18):  61%|██████    | 61/100 [05:42<03:40,  5.64s/it, train loss=0.8655, val ΔE00=3.028, best=2.431]Training (film/resnet18):  62%|██████▏   | 62/100 [05:48<03:33,  5.61s/it, train loss=0.8655, val ΔE00=3.028, best=2.431]Training (film/resnet18):  62%|██████▏   | 62/100 [05:48<03:33,  5.61s/it, train loss=0.9149, val ΔE00=2.693, best=2.431]Training (film/resnet18):  63%|██████▎   | 63/100 [05:53<03:26,  5.59s/it, train loss=0.9149, val ΔE00=2.693, best=2.431]Training (film/resnet18):  63%|██████▎   | 63/100 [05:53<03:26,  5.59s/it, train loss=0.8735, val ΔE00=2.792, best=2.431]Training (film/resnet18):  64%|██████▍   | 64/100 [05:59<03:20,  5.57s/it, train loss=0.8735, val ΔE00=2.792, best=2.431]Training (film/resnet18):  64%|██████▍   | 64/100 [05:59<03:20,  5.57s/it, train loss=0.9190, val ΔE00=2.947, best=2.431]Training (film/resnet18):  65%|██████▌   | 65/100 [06:05<03:17,  5.63s/it, train loss=0.9190, val ΔE00=2.947, best=2.431]Training (film/resnet18):  65%|██████▌   | 65/100 [06:05<03:17,  5.63s/it, train loss=0.8559, val ΔE00=2.647, best=2.431]Training (film/resnet18):  66%|██████▌   | 66/100 [06:10<03:11,  5.64s/it, train loss=0.8559, val ΔE00=2.647, best=2.431]Training (film/resnet18):  66%|██████▌   | 66/100 [06:10<03:11,  5.64s/it, train loss=0.9407, val ΔE00=2.754, best=2.431]Training (film/resnet18):  66%|██████▌   | 66/100 [06:16<03:11,  5.64s/it, train loss=0.8940, val ΔE00=2.701, early_stop=yes]Training (film/resnet18):  66%|██████▌   | 66/100 [06:16<03:13,  5.70s/it, train loss=0.8940, val ΔE00=2.701, early_stop=yes]
[early] stop at epoch 67 (best de00=2.4308 @ 57)
[done] best ΔE00=2.431 over 67 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/film__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 17/24 ===
[sweep] id=017_model=xattn__backbone=smallcnn__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone smallcnn --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=smallcnn, features=image, meta_encoder=none
[run] model=xattn backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<08:54,  5.40s/it]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<08:54,  5.40s/it, train loss=0.0072, val ΔE00=6.740, best=6.740]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:20,  5.11s/it, train loss=0.0072, val ΔE00=6.740, best=6.740]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:20,  5.11s/it, train loss=0.0081, val ΔE00=5.822, best=5.822]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:06,  5.02s/it, train loss=0.0081, val ΔE00=5.822, best=5.822]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:06,  5.02s/it, train loss=0.0138, val ΔE00=5.776, best=5.776]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<07:57,  4.97s/it, train loss=0.0138, val ΔE00=5.776, best=5.776]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<07:57,  4.97s/it, train loss=0.0234, val ΔE00=5.451, best=5.451]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<07:57,  5.03s/it, train loss=0.0234, val ΔE00=5.451, best=5.451]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<07:57,  5.03s/it, train loss=0.0390, val ΔE00=5.433, best=5.433]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:30<07:52,  5.03s/it, train loss=0.0390, val ΔE00=5.433, best=5.433]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:30<07:52,  5.03s/it, train loss=0.0548, val ΔE00=5.124, best=5.124]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:35<07:43,  4.98s/it, train loss=0.0548, val ΔE00=5.124, best=5.124]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:35<07:43,  4.98s/it, train loss=0.0751, val ΔE00=4.598, best=4.598]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:40<07:36,  4.96s/it, train loss=0.0751, val ΔE00=4.598, best=4.598]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:40<07:36,  4.96s/it, train loss=0.1023, val ΔE00=5.126, best=4.598]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:44<07:29,  4.94s/it, train loss=0.1023, val ΔE00=5.126, best=4.598]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:44<07:29,  4.94s/it, train loss=0.1244, val ΔE00=5.280, best=4.598]Training (xattn/smallcnn):  10%|█         | 10/100 [00:50<07:28,  4.99s/it, train loss=0.1244, val ΔE00=5.280, best=4.598]Training (xattn/smallcnn):  10%|█         | 10/100 [00:50<07:28,  4.99s/it, train loss=0.1568, val ΔE00=4.766, best=4.598]Training (xattn/smallcnn):  11%|█         | 11/100 [00:55<07:24,  5.00s/it, train loss=0.1568, val ΔE00=4.766, best=4.598]Training (xattn/smallcnn):  11%|█         | 11/100 [00:55<07:24,  5.00s/it, train loss=0.1864, val ΔE00=4.151, best=4.151]Training (xattn/smallcnn):  12%|█▏        | 12/100 [00:59<07:16,  4.97s/it, train loss=0.1864, val ΔE00=4.151, best=4.151]Training (xattn/smallcnn):  12%|█▏        | 12/100 [00:59<07:16,  4.97s/it, train loss=0.2071, val ΔE00=5.102, best=4.151]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:04<07:10,  4.95s/it, train loss=0.2071, val ΔE00=5.102, best=4.151]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:04<07:10,  4.95s/it, train loss=0.2452, val ΔE00=4.228, best=4.151]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:09<07:03,  4.93s/it, train loss=0.2452, val ΔE00=4.228, best=4.151]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:09<07:03,  4.93s/it, train loss=0.2916, val ΔE00=4.541, best=4.151]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:14<07:03,  4.98s/it, train loss=0.2916, val ΔE00=4.541, best=4.151]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:14<07:03,  4.98s/it, train loss=0.3271, val ΔE00=4.384, best=4.151]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:19<06:59,  4.99s/it, train loss=0.3271, val ΔE00=4.384, best=4.151]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:19<06:59,  4.99s/it, train loss=0.3685, val ΔE00=4.798, best=4.151]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:24<06:52,  4.97s/it, train loss=0.3685, val ΔE00=4.798, best=4.151]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:24<06:52,  4.97s/it, train loss=0.4295, val ΔE00=4.811, best=4.151]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:29<06:45,  4.95s/it, train loss=0.4295, val ΔE00=4.811, best=4.151]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:29<06:45,  4.95s/it, train loss=0.4369, val ΔE00=4.787, best=4.151]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:34<06:39,  4.93s/it, train loss=0.4369, val ΔE00=4.787, best=4.151]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:34<06:39,  4.93s/it, train loss=0.5040, val ΔE00=4.529, best=4.151]Training (xattn/smallcnn):  20%|██        | 20/100 [01:39<06:38,  4.98s/it, train loss=0.5040, val ΔE00=4.529, best=4.151]Training (xattn/smallcnn):  20%|██        | 20/100 [01:39<06:38,  4.98s/it, train loss=0.5708, val ΔE00=4.556, best=4.151]Training (xattn/smallcnn):  21%|██        | 21/100 [01:44<06:34,  4.99s/it, train loss=0.5708, val ΔE00=4.556, best=4.151]Training (xattn/smallcnn):  21%|██        | 21/100 [01:44<06:34,  4.99s/it, train loss=0.5859, val ΔE00=4.449, best=4.151]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:49<06:27,  4.96s/it, train loss=0.5859, val ΔE00=4.449, best=4.151]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:49<06:27,  4.96s/it, train loss=0.6194, val ΔE00=4.448, best=4.151]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:54<06:20,  4.95s/it, train loss=0.6194, val ΔE00=4.448, best=4.151]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:54<06:20,  4.95s/it, train loss=0.6926, val ΔE00=3.989, best=3.989]Training (xattn/smallcnn):  24%|██▍       | 24/100 [01:59<06:14,  4.93s/it, train loss=0.6926, val ΔE00=3.989, best=3.989]Training (xattn/smallcnn):  24%|██▍       | 24/100 [01:59<06:14,  4.93s/it, train loss=0.7505, val ΔE00=3.976, best=3.976]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:04<06:13,  4.98s/it, train loss=0.7505, val ΔE00=3.976, best=3.976]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:04<06:13,  4.98s/it, train loss=0.7818, val ΔE00=4.041, best=3.976]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:09<06:09,  5.00s/it, train loss=0.7818, val ΔE00=4.041, best=3.976]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:09<06:09,  5.00s/it, train loss=0.8340, val ΔE00=3.925, best=3.925]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:14<06:02,  4.97s/it, train loss=0.8340, val ΔE00=3.925, best=3.925]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:14<06:02,  4.97s/it, train loss=0.8873, val ΔE00=4.019, best=3.925]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:19<05:56,  4.95s/it, train loss=0.8873, val ΔE00=4.019, best=3.925]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:19<05:56,  4.95s/it, train loss=0.9755, val ΔE00=4.278, best=3.925]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:24<05:50,  4.93s/it, train loss=0.9755, val ΔE00=4.278, best=3.925]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:24<05:50,  4.93s/it, train loss=1.0593, val ΔE00=4.031, best=3.925]Training (xattn/smallcnn):  30%|███       | 30/100 [02:29<05:48,  4.98s/it, train loss=1.0593, val ΔE00=4.031, best=3.925]Training (xattn/smallcnn):  30%|███       | 30/100 [02:29<05:48,  4.98s/it, train loss=1.0622, val ΔE00=3.638, best=3.638]Training (xattn/smallcnn):  31%|███       | 31/100 [02:34<05:44,  4.99s/it, train loss=1.0622, val ΔE00=3.638, best=3.638]Training (xattn/smallcnn):  31%|███       | 31/100 [02:34<05:44,  4.99s/it, train loss=1.1430, val ΔE00=3.870, best=3.638]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:39<05:37,  4.96s/it, train loss=1.1430, val ΔE00=3.870, best=3.638]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:39<05:37,  4.96s/it, train loss=1.2367, val ΔE00=4.077, best=3.638]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:44<05:31,  4.94s/it, train loss=1.2367, val ΔE00=4.077, best=3.638]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:44<05:31,  4.94s/it, train loss=1.2367, val ΔE00=4.419, best=3.638]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:49<05:25,  4.93s/it, train loss=1.2367, val ΔE00=4.419, best=3.638]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:49<05:25,  4.93s/it, train loss=1.2597, val ΔE00=3.687, best=3.638]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:54<05:23,  4.98s/it, train loss=1.2597, val ΔE00=3.687, best=3.638]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:54<05:23,  4.98s/it, train loss=1.3611, val ΔE00=4.535, best=3.638]Training (xattn/smallcnn):  36%|███▌      | 36/100 [02:59<05:19,  4.99s/it, train loss=1.3611, val ΔE00=4.535, best=3.638]Training (xattn/smallcnn):  36%|███▌      | 36/100 [02:59<05:19,  4.99s/it, train loss=1.4325, val ΔE00=3.685, best=3.638]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:04<05:12,  4.97s/it, train loss=1.4325, val ΔE00=3.685, best=3.638]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:04<05:12,  4.97s/it, train loss=1.4156, val ΔE00=3.970, best=3.638]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:08<05:06,  4.95s/it, train loss=1.4156, val ΔE00=3.970, best=3.638]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:08<05:06,  4.95s/it, train loss=1.5134, val ΔE00=5.015, best=3.638]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:13<05:01,  4.94s/it, train loss=1.5134, val ΔE00=5.015, best=3.638]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:13<05:01,  4.94s/it, train loss=1.5708, val ΔE00=3.797, best=3.638]Training (xattn/smallcnn):  40%|████      | 40/100 [03:19<04:59,  4.99s/it, train loss=1.5708, val ΔE00=3.797, best=3.638]Training (xattn/smallcnn):  40%|████      | 40/100 [03:19<04:59,  4.99s/it, train loss=1.6183, val ΔE00=4.174, best=3.638]Training (xattn/smallcnn):  41%|████      | 41/100 [03:24<04:54,  5.00s/it, train loss=1.6183, val ΔE00=4.174, best=3.638]Training (xattn/smallcnn):  41%|████      | 41/100 [03:24<04:54,  5.00s/it, train loss=1.6630, val ΔE00=3.789, best=3.638]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:28<04:48,  4.97s/it, train loss=1.6630, val ΔE00=3.789, best=3.638]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:28<04:48,  4.97s/it, train loss=1.7349, val ΔE00=3.866, best=3.638]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:33<04:41,  4.95s/it, train loss=1.7349, val ΔE00=3.866, best=3.638]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:33<04:41,  4.95s/it, train loss=1.7730, val ΔE00=4.065, best=3.638]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:38<04:36,  4.93s/it, train loss=1.7730, val ΔE00=4.065, best=3.638]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:38<04:36,  4.93s/it, train loss=1.8879, val ΔE00=4.490, best=3.638]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:43<04:34,  4.98s/it, train loss=1.8879, val ΔE00=4.490, best=3.638]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:43<04:34,  4.98s/it, train loss=1.9411, val ΔE00=3.810, best=3.638]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:48<04:29,  5.00s/it, train loss=1.9411, val ΔE00=3.810, best=3.638]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:48<04:29,  5.00s/it, train loss=1.8647, val ΔE00=3.683, best=3.638]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:53<04:23,  4.98s/it, train loss=1.8647, val ΔE00=3.683, best=3.638]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:53<04:23,  4.98s/it, train loss=1.9526, val ΔE00=3.920, best=3.638]Training (xattn/smallcnn):  48%|████▊     | 48/100 [03:58<04:17,  4.96s/it, train loss=1.9526, val ΔE00=3.920, best=3.638]Training (xattn/smallcnn):  48%|████▊     | 48/100 [03:58<04:17,  4.96s/it, train loss=1.9728, val ΔE00=4.019, best=3.638]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:03<04:11,  4.94s/it, train loss=1.9728, val ΔE00=4.019, best=3.638]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:03<04:11,  4.94s/it, train loss=2.0023, val ΔE00=4.709, best=3.638]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:08<04:09,  4.99s/it, train loss=2.0023, val ΔE00=4.709, best=3.638]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:08<04:09,  4.99s/it, train loss=2.1113, val ΔE00=4.146, best=3.638]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:13<04:05,  5.00s/it, train loss=2.1113, val ΔE00=4.146, best=3.638]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:13<04:05,  5.00s/it, train loss=2.0648, val ΔE00=3.753, best=3.638]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:18<03:58,  4.97s/it, train loss=2.0648, val ΔE00=3.753, best=3.638]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:18<03:58,  4.97s/it, train loss=2.2203, val ΔE00=3.902, best=3.638]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:23<03:52,  4.95s/it, train loss=2.2203, val ΔE00=3.902, best=3.638]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:23<03:52,  4.95s/it, train loss=2.2039, val ΔE00=3.900, best=3.638]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:28<03:46,  4.93s/it, train loss=2.2039, val ΔE00=3.900, best=3.638]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:28<03:46,  4.93s/it, train loss=2.3107, val ΔE00=4.891, best=3.638]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:33<03:44,  4.98s/it, train loss=2.3107, val ΔE00=4.891, best=3.638]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:33<03:44,  4.98s/it, train loss=2.2292, val ΔE00=3.850, best=3.638]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:38<03:39,  4.99s/it, train loss=2.2292, val ΔE00=3.850, best=3.638]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:38<03:39,  4.99s/it, train loss=2.3615, val ΔE00=4.203, best=3.638]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:43<03:33,  4.96s/it, train loss=2.3615, val ΔE00=4.203, best=3.638]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:43<03:33,  4.96s/it, train loss=2.3994, val ΔE00=4.173, best=3.638]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:48<03:27,  4.94s/it, train loss=2.3994, val ΔE00=4.173, best=3.638]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:48<03:27,  4.94s/it, train loss=2.3993, val ΔE00=4.258, best=3.638]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:53<03:27,  4.94s/it, train loss=2.5088, val ΔE00=4.262, early_stop=yes]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:53<03:32,  5.06s/it, train loss=2.5088, val ΔE00=4.262, early_stop=yes]
[early] stop at epoch 59 (best de00=3.6376 @ 30)
[done] best ΔE00=3.638 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/xattn__smallcnn__image__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image/final_summary.json (kind=val)
[sweep] === Run 18/24 ===
[sweep] id=018_model=xattn__backbone=smallcnn__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone smallcnn --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=smallcnn, features=image+mean, meta_encoder=none
[run] model=xattn backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:08,  5.54s/it]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:08,  5.54s/it, train loss=0.0069, val ΔE00=6.677, best=6.677]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:32,  5.23s/it, train loss=0.0069, val ΔE00=6.677, best=6.677]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:32,  5.23s/it, train loss=0.0071, val ΔE00=4.889, best=4.889]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:17,  5.13s/it, train loss=0.0071, val ΔE00=4.889, best=4.889]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:17,  5.13s/it, train loss=0.0118, val ΔE00=5.273, best=4.889]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:07,  5.08s/it, train loss=0.0118, val ΔE00=5.273, best=4.889]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:07,  5.08s/it, train loss=0.0194, val ΔE00=5.299, best=4.889]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<08:07,  5.14s/it, train loss=0.0194, val ΔE00=5.299, best=4.889]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<08:07,  5.14s/it, train loss=0.0323, val ΔE00=4.599, best=4.599]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:30<08:02,  5.13s/it, train loss=0.0323, val ΔE00=4.599, best=4.599]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:30<08:02,  5.13s/it, train loss=0.0501, val ΔE00=4.902, best=4.599]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:35<07:53,  5.09s/it, train loss=0.0501, val ΔE00=4.902, best=4.599]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:35<07:53,  5.09s/it, train loss=0.0628, val ΔE00=4.753, best=4.599]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:40<07:46,  5.07s/it, train loss=0.0628, val ΔE00=4.753, best=4.599]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:40<07:46,  5.07s/it, train loss=0.0839, val ΔE00=4.282, best=4.282]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:45<07:39,  5.05s/it, train loss=0.0839, val ΔE00=4.282, best=4.282]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:45<07:39,  5.05s/it, train loss=0.1034, val ΔE00=4.629, best=4.282]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:39,  5.11s/it, train loss=0.1034, val ΔE00=4.629, best=4.282]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:39,  5.11s/it, train loss=0.1289, val ΔE00=4.370, best=4.282]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:35,  5.12s/it, train loss=0.1289, val ΔE00=4.370, best=4.282]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:35,  5.12s/it, train loss=0.1488, val ΔE00=4.259, best=4.259]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:01<07:27,  5.08s/it, train loss=0.1488, val ΔE00=4.259, best=4.259]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:01<07:27,  5.08s/it, train loss=0.1742, val ΔE00=4.344, best=4.259]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:06<07:21,  5.07s/it, train loss=0.1742, val ΔE00=4.344, best=4.259]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:06<07:21,  5.07s/it, train loss=0.1990, val ΔE00=3.855, best=3.855]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:11<07:14,  5.05s/it, train loss=0.1990, val ΔE00=3.855, best=3.855]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:11<07:14,  5.05s/it, train loss=0.2370, val ΔE00=4.283, best=3.855]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:16<07:14,  5.11s/it, train loss=0.2370, val ΔE00=4.283, best=3.855]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:16<07:14,  5.11s/it, train loss=0.2673, val ΔE00=3.890, best=3.855]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:21<07:09,  5.11s/it, train loss=0.2673, val ΔE00=3.890, best=3.855]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:21<07:09,  5.11s/it, train loss=0.3060, val ΔE00=4.181, best=3.855]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:26<07:02,  5.09s/it, train loss=0.3060, val ΔE00=4.181, best=3.855]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:26<07:02,  5.09s/it, train loss=0.3365, val ΔE00=3.986, best=3.855]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:31<06:55,  5.06s/it, train loss=0.3365, val ΔE00=3.986, best=3.855]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:31<06:55,  5.06s/it, train loss=0.3697, val ΔE00=3.880, best=3.855]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:36<06:48,  5.05s/it, train loss=0.3697, val ΔE00=3.880, best=3.855]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:36<06:48,  5.05s/it, train loss=0.4116, val ΔE00=3.991, best=3.855]Training (xattn/smallcnn):  20%|██        | 20/100 [01:42<06:48,  5.10s/it, train loss=0.4116, val ΔE00=3.991, best=3.855]Training (xattn/smallcnn):  20%|██        | 20/100 [01:42<06:48,  5.10s/it, train loss=0.4508, val ΔE00=4.288, best=3.855]Training (xattn/smallcnn):  21%|██        | 21/100 [01:47<06:44,  5.12s/it, train loss=0.4508, val ΔE00=4.288, best=3.855]Training (xattn/smallcnn):  21%|██        | 21/100 [01:47<06:44,  5.12s/it, train loss=0.4823, val ΔE00=3.647, best=3.647]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:52<06:36,  5.09s/it, train loss=0.4823, val ΔE00=3.647, best=3.647]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:52<06:36,  5.09s/it, train loss=0.5132, val ΔE00=3.910, best=3.647]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:57<06:30,  5.07s/it, train loss=0.5132, val ΔE00=3.910, best=3.647]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:57<06:30,  5.07s/it, train loss=0.5782, val ΔE00=3.838, best=3.647]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:02<06:23,  5.05s/it, train loss=0.5782, val ΔE00=3.838, best=3.647]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:02<06:23,  5.05s/it, train loss=0.5953, val ΔE00=4.339, best=3.647]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:07<06:23,  5.11s/it, train loss=0.5953, val ΔE00=4.339, best=3.647]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:07<06:23,  5.11s/it, train loss=0.6548, val ΔE00=3.611, best=3.611]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:12<06:18,  5.12s/it, train loss=0.6548, val ΔE00=3.611, best=3.611]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:12<06:18,  5.12s/it, train loss=0.6926, val ΔE00=4.047, best=3.611]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:17<06:11,  5.09s/it, train loss=0.6926, val ΔE00=4.047, best=3.611]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:17<06:11,  5.09s/it, train loss=0.7402, val ΔE00=3.416, best=3.416]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:22<06:04,  5.07s/it, train loss=0.7402, val ΔE00=3.416, best=3.416]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:22<06:04,  5.07s/it, train loss=0.8020, val ΔE00=4.051, best=3.416]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:27<05:59,  5.06s/it, train loss=0.8020, val ΔE00=4.051, best=3.416]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:27<05:59,  5.06s/it, train loss=0.8065, val ΔE00=3.385, best=3.385]Training (xattn/smallcnn):  30%|███       | 30/100 [02:32<05:57,  5.11s/it, train loss=0.8065, val ΔE00=3.385, best=3.385]Training (xattn/smallcnn):  30%|███       | 30/100 [02:32<05:57,  5.11s/it, train loss=0.8339, val ΔE00=3.613, best=3.385]Training (xattn/smallcnn):  31%|███       | 31/100 [02:38<05:53,  5.12s/it, train loss=0.8339, val ΔE00=3.613, best=3.385]Training (xattn/smallcnn):  31%|███       | 31/100 [02:38<05:53,  5.12s/it, train loss=0.9039, val ΔE00=3.873, best=3.385]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:43<05:46,  5.09s/it, train loss=0.9039, val ΔE00=3.873, best=3.385]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:43<05:46,  5.09s/it, train loss=0.9780, val ΔE00=3.444, best=3.385]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:48<05:39,  5.07s/it, train loss=0.9780, val ΔE00=3.444, best=3.385]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:48<05:39,  5.07s/it, train loss=0.9498, val ΔE00=3.541, best=3.385]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:53<05:33,  5.06s/it, train loss=0.9498, val ΔE00=3.541, best=3.385]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:53<05:33,  5.06s/it, train loss=0.9931, val ΔE00=3.665, best=3.385]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:58<05:32,  5.12s/it, train loss=0.9931, val ΔE00=3.665, best=3.385]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:58<05:32,  5.12s/it, train loss=1.0615, val ΔE00=3.814, best=3.385]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:03<05:27,  5.12s/it, train loss=1.0615, val ΔE00=3.814, best=3.385]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:03<05:27,  5.12s/it, train loss=1.0973, val ΔE00=3.584, best=3.385]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:08<05:20,  5.10s/it, train loss=1.0973, val ΔE00=3.584, best=3.385]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:08<05:20,  5.10s/it, train loss=1.1661, val ΔE00=3.375, best=3.375]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:13<05:14,  5.07s/it, train loss=1.1661, val ΔE00=3.375, best=3.375]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:13<05:14,  5.07s/it, train loss=1.1742, val ΔE00=3.407, best=3.375]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:18<05:08,  5.05s/it, train loss=1.1742, val ΔE00=3.407, best=3.375]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:18<05:08,  5.05s/it, train loss=1.2044, val ΔE00=3.840, best=3.375]Training (xattn/smallcnn):  40%|████      | 40/100 [03:23<05:06,  5.10s/it, train loss=1.2044, val ΔE00=3.840, best=3.375]Training (xattn/smallcnn):  40%|████      | 40/100 [03:23<05:06,  5.10s/it, train loss=1.2837, val ΔE00=3.558, best=3.375]Training (xattn/smallcnn):  41%|████      | 41/100 [03:28<05:01,  5.12s/it, train loss=1.2837, val ΔE00=3.558, best=3.375]Training (xattn/smallcnn):  41%|████      | 41/100 [03:28<05:01,  5.12s/it, train loss=1.2621, val ΔE00=3.636, best=3.375]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:33<04:54,  5.08s/it, train loss=1.2621, val ΔE00=3.636, best=3.375]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:33<04:54,  5.08s/it, train loss=1.2609, val ΔE00=3.881, best=3.375]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:38<04:48,  5.06s/it, train loss=1.2609, val ΔE00=3.881, best=3.375]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:38<04:48,  5.06s/it, train loss=1.3411, val ΔE00=3.748, best=3.375]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:44<04:42,  5.05s/it, train loss=1.3411, val ΔE00=3.748, best=3.375]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:44<04:42,  5.05s/it, train loss=1.3777, val ΔE00=3.244, best=3.244]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:49<04:41,  5.12s/it, train loss=1.3777, val ΔE00=3.244, best=3.244]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:49<04:41,  5.12s/it, train loss=1.3842, val ΔE00=3.364, best=3.244]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:54<04:36,  5.12s/it, train loss=1.3842, val ΔE00=3.364, best=3.244]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:54<04:36,  5.12s/it, train loss=1.4122, val ΔE00=3.459, best=3.244]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:59<04:29,  5.09s/it, train loss=1.4122, val ΔE00=3.459, best=3.244]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:59<04:29,  5.09s/it, train loss=1.4684, val ΔE00=3.706, best=3.244]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:04<04:23,  5.07s/it, train loss=1.4684, val ΔE00=3.706, best=3.244]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:04<04:23,  5.07s/it, train loss=1.5108, val ΔE00=3.680, best=3.244]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:09<04:17,  5.05s/it, train loss=1.5108, val ΔE00=3.680, best=3.244]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:09<04:17,  5.05s/it, train loss=1.5108, val ΔE00=3.737, best=3.244]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:14<04:15,  5.11s/it, train loss=1.5108, val ΔE00=3.737, best=3.244]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:14<04:15,  5.11s/it, train loss=1.5781, val ΔE00=3.619, best=3.244]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:19<04:10,  5.12s/it, train loss=1.5781, val ΔE00=3.619, best=3.244]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:19<04:10,  5.12s/it, train loss=1.5330, val ΔE00=3.742, best=3.244]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:24<04:04,  5.09s/it, train loss=1.5330, val ΔE00=3.742, best=3.244]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:24<04:04,  5.09s/it, train loss=1.6366, val ΔE00=3.276, best=3.244]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:29<03:58,  5.07s/it, train loss=1.6366, val ΔE00=3.276, best=3.244]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:29<03:58,  5.07s/it, train loss=1.6128, val ΔE00=3.622, best=3.244]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:34<03:52,  5.05s/it, train loss=1.6128, val ΔE00=3.622, best=3.244]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:34<03:52,  5.05s/it, train loss=1.6501, val ΔE00=3.552, best=3.244]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:40<03:49,  5.11s/it, train loss=1.6501, val ΔE00=3.552, best=3.244]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:40<03:49,  5.11s/it, train loss=1.6370, val ΔE00=3.506, best=3.244]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:45<03:44,  5.11s/it, train loss=1.6370, val ΔE00=3.506, best=3.244]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:45<03:44,  5.11s/it, train loss=1.7494, val ΔE00=4.035, best=3.244]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:50<03:38,  5.08s/it, train loss=1.7494, val ΔE00=4.035, best=3.244]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:50<03:38,  5.08s/it, train loss=1.7504, val ΔE00=3.453, best=3.244]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:55<03:32,  5.06s/it, train loss=1.7504, val ΔE00=3.453, best=3.244]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:55<03:32,  5.06s/it, train loss=1.6865, val ΔE00=3.458, best=3.244]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [05:00<03:32,  5.06s/it, train loss=1.7003, val ΔE00=3.685, early_stop=yes]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [05:00<03:37,  5.18s/it, train loss=1.7003, val ΔE00=3.685, early_stop=yes]
[early] stop at epoch 59 (best de00=3.2440 @ 44)
[done] best ΔE00=3.244 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/xattn__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 19/24 ===
[sweep] id=019_model=xattn__backbone=smallcnn__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone smallcnn --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=smallcnn, features=image+meta, meta_encoder=none
[run] model=xattn backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:08,  5.54s/it]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:08,  5.54s/it, train loss=0.0075, val ΔE00=7.514, best=7.514]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:32,  5.23s/it, train loss=0.0075, val ΔE00=7.514, best=7.514]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:32,  5.23s/it, train loss=0.0074, val ΔE00=6.155, best=6.155]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:17,  5.13s/it, train loss=0.0074, val ΔE00=6.155, best=6.155]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:17,  5.13s/it, train loss=0.0125, val ΔE00=4.710, best=4.710]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:08,  5.09s/it, train loss=0.0125, val ΔE00=4.710, best=4.710]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:08,  5.09s/it, train loss=0.0210, val ΔE00=4.356, best=4.356]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<08:09,  5.15s/it, train loss=0.0210, val ΔE00=4.356, best=4.356]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:25<08:09,  5.15s/it, train loss=0.0318, val ΔE00=5.085, best=4.356]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:30<08:03,  5.14s/it, train loss=0.0318, val ΔE00=5.085, best=4.356]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:30<08:03,  5.14s/it, train loss=0.0462, val ΔE00=4.304, best=4.304]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:35<07:54,  5.10s/it, train loss=0.0462, val ΔE00=4.304, best=4.304]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:35<07:54,  5.10s/it, train loss=0.0659, val ΔE00=4.668, best=4.304]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:41<07:46,  5.07s/it, train loss=0.0659, val ΔE00=4.668, best=4.304]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:41<07:46,  5.07s/it, train loss=0.0756, val ΔE00=3.909, best=3.909]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:46<07:39,  5.05s/it, train loss=0.0756, val ΔE00=3.909, best=3.909]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:46<07:39,  5.05s/it, train loss=0.0968, val ΔE00=4.083, best=3.909]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:41,  5.13s/it, train loss=0.0968, val ΔE00=4.083, best=3.909]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:41,  5.13s/it, train loss=0.1146, val ΔE00=3.875, best=3.875]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:35,  5.12s/it, train loss=0.1146, val ΔE00=3.875, best=3.875]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:35,  5.12s/it, train loss=0.1356, val ΔE00=3.172, best=3.172]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:01<07:27,  5.09s/it, train loss=0.1356, val ΔE00=3.172, best=3.172]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:01<07:27,  5.09s/it, train loss=0.1481, val ΔE00=3.724, best=3.172]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:06<07:20,  5.07s/it, train loss=0.1481, val ΔE00=3.724, best=3.172]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:06<07:20,  5.07s/it, train loss=0.1736, val ΔE00=2.985, best=2.985]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:11<07:14,  5.05s/it, train loss=0.1736, val ΔE00=2.985, best=2.985]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:11<07:14,  5.05s/it, train loss=0.1958, val ΔE00=3.518, best=2.985]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:16<07:14,  5.11s/it, train loss=0.1958, val ΔE00=3.518, best=2.985]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:16<07:14,  5.11s/it, train loss=0.2200, val ΔE00=2.720, best=2.720]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:21<07:09,  5.11s/it, train loss=0.2200, val ΔE00=2.720, best=2.720]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:21<07:09,  5.11s/it, train loss=0.2334, val ΔE00=2.888, best=2.720]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:26<07:01,  5.08s/it, train loss=0.2334, val ΔE00=2.888, best=2.720]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:26<07:01,  5.08s/it, train loss=0.2630, val ΔE00=3.211, best=2.720]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:31<06:54,  5.06s/it, train loss=0.2630, val ΔE00=3.211, best=2.720]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:31<06:54,  5.06s/it, train loss=0.3179, val ΔE00=2.831, best=2.720]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:36<06:48,  5.04s/it, train loss=0.3179, val ΔE00=2.831, best=2.720]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:36<06:48,  5.04s/it, train loss=0.3338, val ΔE00=3.233, best=2.720]Training (xattn/smallcnn):  20%|██        | 20/100 [01:42<06:48,  5.10s/it, train loss=0.3338, val ΔE00=3.233, best=2.720]Training (xattn/smallcnn):  20%|██        | 20/100 [01:42<06:48,  5.10s/it, train loss=0.3723, val ΔE00=2.742, best=2.720]Training (xattn/smallcnn):  21%|██        | 21/100 [01:47<06:43,  5.11s/it, train loss=0.3723, val ΔE00=2.742, best=2.720]Training (xattn/smallcnn):  21%|██        | 21/100 [01:47<06:43,  5.11s/it, train loss=0.3849, val ΔE00=2.719, best=2.719]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:52<06:36,  5.08s/it, train loss=0.3849, val ΔE00=2.719, best=2.719]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:52<06:36,  5.08s/it, train loss=0.4076, val ΔE00=2.836, best=2.719]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:57<06:30,  5.06s/it, train loss=0.4076, val ΔE00=2.836, best=2.719]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:57<06:30,  5.06s/it, train loss=0.4317, val ΔE00=3.139, best=2.719]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:02<06:23,  5.05s/it, train loss=0.4317, val ΔE00=3.139, best=2.719]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:02<06:23,  5.05s/it, train loss=0.4868, val ΔE00=2.775, best=2.719]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:07<06:23,  5.11s/it, train loss=0.4868, val ΔE00=2.775, best=2.719]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:07<06:23,  5.11s/it, train loss=0.5323, val ΔE00=2.664, best=2.664]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:12<06:19,  5.13s/it, train loss=0.5323, val ΔE00=2.664, best=2.664]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:12<06:19,  5.13s/it, train loss=0.5301, val ΔE00=2.597, best=2.597]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:17<06:12,  5.10s/it, train loss=0.5301, val ΔE00=2.597, best=2.597]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:17<06:12,  5.10s/it, train loss=0.5636, val ΔE00=3.107, best=2.597]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:22<06:05,  5.08s/it, train loss=0.5636, val ΔE00=3.107, best=2.597]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:22<06:05,  5.08s/it, train loss=0.6183, val ΔE00=2.509, best=2.509]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:27<05:58,  5.06s/it, train loss=0.6183, val ΔE00=2.509, best=2.509]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:27<05:58,  5.06s/it, train loss=0.6410, val ΔE00=2.636, best=2.509]Training (xattn/smallcnn):  30%|███       | 30/100 [02:32<05:57,  5.11s/it, train loss=0.6410, val ΔE00=2.636, best=2.509]Training (xattn/smallcnn):  30%|███       | 30/100 [02:32<05:57,  5.11s/it, train loss=0.6974, val ΔE00=3.173, best=2.509]Training (xattn/smallcnn):  31%|███       | 31/100 [02:38<05:52,  5.11s/it, train loss=0.6974, val ΔE00=3.173, best=2.509]Training (xattn/smallcnn):  31%|███       | 31/100 [02:38<05:52,  5.11s/it, train loss=0.7673, val ΔE00=2.575, best=2.509]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:43<05:45,  5.08s/it, train loss=0.7673, val ΔE00=2.575, best=2.509]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:43<05:45,  5.08s/it, train loss=0.7801, val ΔE00=2.691, best=2.509]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:48<05:38,  5.06s/it, train loss=0.7801, val ΔE00=2.691, best=2.509]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:48<05:38,  5.06s/it, train loss=0.7764, val ΔE00=2.646, best=2.509]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:53<05:32,  5.04s/it, train loss=0.7764, val ΔE00=2.646, best=2.509]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:53<05:32,  5.04s/it, train loss=0.7953, val ΔE00=2.671, best=2.509]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:58<05:31,  5.10s/it, train loss=0.7953, val ΔE00=2.671, best=2.509]Training (xattn/smallcnn):  35%|███▌      | 35/100 [02:58<05:31,  5.10s/it, train loss=0.8626, val ΔE00=2.782, best=2.509]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:03<05:27,  5.11s/it, train loss=0.8626, val ΔE00=2.782, best=2.509]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:03<05:27,  5.11s/it, train loss=0.8843, val ΔE00=2.484, best=2.484]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:08<05:19,  5.08s/it, train loss=0.8843, val ΔE00=2.484, best=2.484]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:08<05:19,  5.08s/it, train loss=0.9567, val ΔE00=2.669, best=2.484]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:13<05:13,  5.06s/it, train loss=0.9567, val ΔE00=2.669, best=2.484]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:13<05:13,  5.06s/it, train loss=0.9546, val ΔE00=3.111, best=2.484]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:18<05:07,  5.05s/it, train loss=0.9546, val ΔE00=3.111, best=2.484]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:18<05:07,  5.05s/it, train loss=0.9781, val ΔE00=2.416, best=2.416]Training (xattn/smallcnn):  40%|████      | 40/100 [03:23<05:06,  5.11s/it, train loss=0.9781, val ΔE00=2.416, best=2.416]Training (xattn/smallcnn):  40%|████      | 40/100 [03:23<05:06,  5.11s/it, train loss=0.9693, val ΔE00=2.503, best=2.416]Training (xattn/smallcnn):  41%|████      | 41/100 [03:28<05:01,  5.11s/it, train loss=0.9693, val ΔE00=2.503, best=2.416]Training (xattn/smallcnn):  41%|████      | 41/100 [03:28<05:01,  5.11s/it, train loss=0.9922, val ΔE00=2.689, best=2.416]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:33<04:54,  5.08s/it, train loss=0.9922, val ΔE00=2.689, best=2.416]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:33<04:54,  5.08s/it, train loss=1.0956, val ΔE00=2.984, best=2.416]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:38<04:48,  5.06s/it, train loss=1.0956, val ΔE00=2.984, best=2.416]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:38<04:48,  5.06s/it, train loss=1.1740, val ΔE00=2.867, best=2.416]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:43<04:42,  5.04s/it, train loss=1.1740, val ΔE00=2.867, best=2.416]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:43<04:42,  5.04s/it, train loss=1.1183, val ΔE00=2.577, best=2.416]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:49<04:40,  5.10s/it, train loss=1.1183, val ΔE00=2.577, best=2.416]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:49<04:40,  5.10s/it, train loss=1.1871, val ΔE00=2.663, best=2.416]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:54<04:35,  5.11s/it, train loss=1.1871, val ΔE00=2.663, best=2.416]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:54<04:35,  5.11s/it, train loss=1.1687, val ΔE00=2.436, best=2.416]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:59<04:28,  5.07s/it, train loss=1.1687, val ΔE00=2.436, best=2.416]Training (xattn/smallcnn):  47%|████▋     | 47/100 [03:59<04:28,  5.07s/it, train loss=1.2747, val ΔE00=2.781, best=2.416]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:04<04:23,  5.06s/it, train loss=1.2747, val ΔE00=2.781, best=2.416]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:04<04:23,  5.06s/it, train loss=1.2881, val ΔE00=2.835, best=2.416]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:09<04:17,  5.04s/it, train loss=1.2881, val ΔE00=2.835, best=2.416]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:09<04:17,  5.04s/it, train loss=1.2797, val ΔE00=2.511, best=2.416]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:14<04:15,  5.10s/it, train loss=1.2797, val ΔE00=2.511, best=2.416]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:14<04:15,  5.10s/it, train loss=1.3182, val ΔE00=2.354, best=2.354]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:19<04:10,  5.11s/it, train loss=1.3182, val ΔE00=2.354, best=2.354]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:19<04:10,  5.11s/it, train loss=1.2682, val ΔE00=2.718, best=2.354]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:24<04:03,  5.08s/it, train loss=1.2682, val ΔE00=2.718, best=2.354]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:24<04:03,  5.08s/it, train loss=1.4013, val ΔE00=2.854, best=2.354]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:29<03:57,  5.06s/it, train loss=1.4013, val ΔE00=2.854, best=2.354]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:29<03:57,  5.06s/it, train loss=1.4027, val ΔE00=2.888, best=2.354]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:34<03:52,  5.05s/it, train loss=1.4027, val ΔE00=2.888, best=2.354]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:34<03:52,  5.05s/it, train loss=1.3982, val ΔE00=2.372, best=2.354]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:39<03:49,  5.10s/it, train loss=1.3982, val ΔE00=2.372, best=2.354]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:39<03:49,  5.10s/it, train loss=1.4264, val ΔE00=2.452, best=2.354]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:45<03:44,  5.11s/it, train loss=1.4264, val ΔE00=2.452, best=2.354]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:45<03:44,  5.11s/it, train loss=1.5332, val ΔE00=2.875, best=2.354]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:50<03:38,  5.08s/it, train loss=1.5332, val ΔE00=2.875, best=2.354]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:50<03:38,  5.08s/it, train loss=1.4924, val ΔE00=2.499, best=2.354]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:55<03:32,  5.06s/it, train loss=1.4924, val ΔE00=2.499, best=2.354]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:55<03:32,  5.06s/it, train loss=1.4956, val ΔE00=2.361, best=2.354]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:00<03:27,  5.05s/it, train loss=1.4956, val ΔE00=2.361, best=2.354]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:00<03:27,  5.05s/it, train loss=1.5569, val ΔE00=2.413, best=2.354]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:05<03:27,  5.05s/it, train loss=1.5000, val ΔE00=2.778, early_stop=yes]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:05<03:32,  5.18s/it, train loss=1.5000, val ΔE00=2.778, early_stop=yes]
[early] stop at epoch 60 (best de00=2.3538 @ 50)
[done] best ΔE00=2.354 over 60 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/xattn__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 20/24 ===
[sweep] id=020_model=xattn__backbone=smallcnn__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone smallcnn --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=smallcnn, features=image+mean+meta, meta_encoder=none
[run] model=xattn backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:12,  5.58s/it]Training (xattn/smallcnn):   1%|          | 1/100 [00:05<09:12,  5.58s/it, train loss=0.0071, val ΔE00=6.806, best=6.806]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:37,  5.28s/it, train loss=0.0071, val ΔE00=6.806, best=6.806]Training (xattn/smallcnn):   2%|▏         | 2/100 [00:10<08:37,  5.28s/it, train loss=0.0066, val ΔE00=4.944, best=4.944]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:22,  5.18s/it, train loss=0.0066, val ΔE00=4.944, best=4.944]Training (xattn/smallcnn):   3%|▎         | 3/100 [00:15<08:22,  5.18s/it, train loss=0.0117, val ΔE00=6.298, best=4.944]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:13,  5.14s/it, train loss=0.0117, val ΔE00=6.298, best=4.944]Training (xattn/smallcnn):   4%|▍         | 4/100 [00:20<08:13,  5.14s/it, train loss=0.0188, val ΔE00=4.090, best=4.090]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:26<08:14,  5.20s/it, train loss=0.0188, val ΔE00=4.090, best=4.090]Training (xattn/smallcnn):   5%|▌         | 5/100 [00:26<08:14,  5.20s/it, train loss=0.0276, val ΔE00=3.962, best=3.962]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:31<08:08,  5.19s/it, train loss=0.0276, val ΔE00=3.962, best=3.962]Training (xattn/smallcnn):   6%|▌         | 6/100 [00:31<08:08,  5.19s/it, train loss=0.0389, val ΔE00=4.282, best=3.962]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:36<07:59,  5.15s/it, train loss=0.0389, val ΔE00=4.282, best=3.962]Training (xattn/smallcnn):   7%|▋         | 7/100 [00:36<07:59,  5.15s/it, train loss=0.0522, val ΔE00=3.910, best=3.910]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:41<07:51,  5.13s/it, train loss=0.0522, val ΔE00=3.910, best=3.910]Training (xattn/smallcnn):   8%|▊         | 8/100 [00:41<07:51,  5.13s/it, train loss=0.0664, val ΔE00=3.254, best=3.254]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:46<07:44,  5.11s/it, train loss=0.0664, val ΔE00=3.254, best=3.254]Training (xattn/smallcnn):   9%|▉         | 9/100 [00:46<07:44,  5.11s/it, train loss=0.0820, val ΔE00=3.511, best=3.254]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:45,  5.17s/it, train loss=0.0820, val ΔE00=3.511, best=3.254]Training (xattn/smallcnn):  10%|█         | 10/100 [00:51<07:45,  5.17s/it, train loss=0.0983, val ΔE00=3.776, best=3.254]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:39,  5.17s/it, train loss=0.0983, val ΔE00=3.776, best=3.254]Training (xattn/smallcnn):  11%|█         | 11/100 [00:56<07:39,  5.17s/it, train loss=0.1073, val ΔE00=4.433, best=3.254]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:02<07:32,  5.14s/it, train loss=0.1073, val ΔE00=4.433, best=3.254]Training (xattn/smallcnn):  12%|█▏        | 12/100 [01:02<07:32,  5.14s/it, train loss=0.1291, val ΔE00=3.488, best=3.254]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:07<07:25,  5.12s/it, train loss=0.1291, val ΔE00=3.488, best=3.254]Training (xattn/smallcnn):  13%|█▎        | 13/100 [01:07<07:25,  5.12s/it, train loss=0.1440, val ΔE00=3.047, best=3.047]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:12<07:18,  5.10s/it, train loss=0.1440, val ΔE00=3.047, best=3.047]Training (xattn/smallcnn):  14%|█▍        | 14/100 [01:12<07:18,  5.10s/it, train loss=0.1684, val ΔE00=2.977, best=2.977]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:17<07:19,  5.17s/it, train loss=0.1684, val ΔE00=2.977, best=2.977]Training (xattn/smallcnn):  15%|█▌        | 15/100 [01:17<07:19,  5.17s/it, train loss=0.1828, val ΔE00=2.770, best=2.770]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:22<07:14,  5.18s/it, train loss=0.1828, val ΔE00=2.770, best=2.770]Training (xattn/smallcnn):  16%|█▌        | 16/100 [01:22<07:14,  5.18s/it, train loss=0.2024, val ΔE00=3.129, best=2.770]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:27<07:07,  5.15s/it, train loss=0.2024, val ΔE00=3.129, best=2.770]Training (xattn/smallcnn):  17%|█▋        | 17/100 [01:27<07:07,  5.15s/it, train loss=0.2295, val ΔE00=2.644, best=2.644]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:32<07:00,  5.13s/it, train loss=0.2295, val ΔE00=2.644, best=2.644]Training (xattn/smallcnn):  18%|█▊        | 18/100 [01:32<07:00,  5.13s/it, train loss=0.2488, val ΔE00=2.766, best=2.644]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:37<06:53,  5.11s/it, train loss=0.2488, val ΔE00=2.766, best=2.644]Training (xattn/smallcnn):  19%|█▉        | 19/100 [01:37<06:53,  5.11s/it, train loss=0.2710, val ΔE00=2.714, best=2.644]Training (xattn/smallcnn):  20%|██        | 20/100 [01:43<06:54,  5.18s/it, train loss=0.2710, val ΔE00=2.714, best=2.644]Training (xattn/smallcnn):  20%|██        | 20/100 [01:43<06:54,  5.18s/it, train loss=0.2947, val ΔE00=2.532, best=2.532]Training (xattn/smallcnn):  21%|██        | 21/100 [01:48<06:48,  5.17s/it, train loss=0.2947, val ΔE00=2.532, best=2.532]Training (xattn/smallcnn):  21%|██        | 21/100 [01:48<06:48,  5.17s/it, train loss=0.3213, val ΔE00=2.760, best=2.532]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:53<06:41,  5.14s/it, train loss=0.3213, val ΔE00=2.760, best=2.532]Training (xattn/smallcnn):  22%|██▏       | 22/100 [01:53<06:41,  5.14s/it, train loss=0.3435, val ΔE00=2.819, best=2.532]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:58<06:34,  5.12s/it, train loss=0.3435, val ΔE00=2.819, best=2.532]Training (xattn/smallcnn):  23%|██▎       | 23/100 [01:58<06:34,  5.12s/it, train loss=0.3657, val ΔE00=2.603, best=2.532]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:03<06:27,  5.10s/it, train loss=0.3657, val ΔE00=2.603, best=2.532]Training (xattn/smallcnn):  24%|██▍       | 24/100 [02:03<06:27,  5.10s/it, train loss=0.3974, val ΔE00=2.541, best=2.532]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:08<06:28,  5.17s/it, train loss=0.3974, val ΔE00=2.541, best=2.532]Training (xattn/smallcnn):  25%|██▌       | 25/100 [02:08<06:28,  5.17s/it, train loss=0.4269, val ΔE00=2.984, best=2.532]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:14<06:21,  5.16s/it, train loss=0.4269, val ΔE00=2.984, best=2.532]Training (xattn/smallcnn):  26%|██▌       | 26/100 [02:14<06:21,  5.16s/it, train loss=0.4446, val ΔE00=2.683, best=2.532]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:19<06:14,  5.13s/it, train loss=0.4446, val ΔE00=2.683, best=2.532]Training (xattn/smallcnn):  27%|██▋       | 27/100 [02:19<06:14,  5.13s/it, train loss=0.4867, val ΔE00=2.716, best=2.532]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:24<06:07,  5.11s/it, train loss=0.4867, val ΔE00=2.716, best=2.532]Training (xattn/smallcnn):  28%|██▊       | 28/100 [02:24<06:07,  5.11s/it, train loss=0.4988, val ΔE00=2.786, best=2.532]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:29<06:01,  5.10s/it, train loss=0.4988, val ΔE00=2.786, best=2.532]Training (xattn/smallcnn):  29%|██▉       | 29/100 [02:29<06:01,  5.10s/it, train loss=0.5339, val ΔE00=2.719, best=2.532]Training (xattn/smallcnn):  30%|███       | 30/100 [02:34<06:01,  5.17s/it, train loss=0.5339, val ΔE00=2.719, best=2.532]Training (xattn/smallcnn):  30%|███       | 30/100 [02:34<06:01,  5.17s/it, train loss=0.5708, val ΔE00=3.477, best=2.532]Training (xattn/smallcnn):  31%|███       | 31/100 [02:39<05:56,  5.16s/it, train loss=0.5708, val ΔE00=3.477, best=2.532]Training (xattn/smallcnn):  31%|███       | 31/100 [02:39<05:56,  5.16s/it, train loss=0.5961, val ΔE00=2.309, best=2.309]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:44<05:49,  5.14s/it, train loss=0.5961, val ΔE00=2.309, best=2.309]Training (xattn/smallcnn):  32%|███▏      | 32/100 [02:44<05:49,  5.14s/it, train loss=0.6026, val ΔE00=2.644, best=2.309]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:49<05:42,  5.11s/it, train loss=0.6026, val ΔE00=2.644, best=2.309]Training (xattn/smallcnn):  33%|███▎      | 33/100 [02:49<05:42,  5.11s/it, train loss=0.6456, val ΔE00=2.573, best=2.309]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:54<05:36,  5.10s/it, train loss=0.6456, val ΔE00=2.573, best=2.309]Training (xattn/smallcnn):  34%|███▍      | 34/100 [02:54<05:36,  5.10s/it, train loss=0.6905, val ΔE00=2.337, best=2.309]Training (xattn/smallcnn):  35%|███▌      | 35/100 [03:00<05:36,  5.17s/it, train loss=0.6905, val ΔE00=2.337, best=2.309]Training (xattn/smallcnn):  35%|███▌      | 35/100 [03:00<05:36,  5.17s/it, train loss=0.6816, val ΔE00=2.474, best=2.309]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:05<05:30,  5.16s/it, train loss=0.6816, val ΔE00=2.474, best=2.309]Training (xattn/smallcnn):  36%|███▌      | 36/100 [03:05<05:30,  5.16s/it, train loss=0.7189, val ΔE00=2.534, best=2.309]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:10<05:23,  5.13s/it, train loss=0.7189, val ΔE00=2.534, best=2.309]Training (xattn/smallcnn):  37%|███▋      | 37/100 [03:10<05:23,  5.13s/it, train loss=0.7408, val ΔE00=2.652, best=2.309]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:15<05:16,  5.11s/it, train loss=0.7408, val ΔE00=2.652, best=2.309]Training (xattn/smallcnn):  38%|███▊      | 38/100 [03:15<05:16,  5.11s/it, train loss=0.7794, val ΔE00=2.444, best=2.309]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:20<05:11,  5.10s/it, train loss=0.7794, val ΔE00=2.444, best=2.309]Training (xattn/smallcnn):  39%|███▉      | 39/100 [03:20<05:11,  5.10s/it, train loss=0.8102, val ΔE00=2.304, best=2.304]Training (xattn/smallcnn):  40%|████      | 40/100 [03:25<05:09,  5.17s/it, train loss=0.8102, val ΔE00=2.304, best=2.304]Training (xattn/smallcnn):  40%|████      | 40/100 [03:25<05:09,  5.17s/it, train loss=0.8064, val ΔE00=2.382, best=2.304]Training (xattn/smallcnn):  41%|████      | 41/100 [03:31<05:05,  5.17s/it, train loss=0.8064, val ΔE00=2.382, best=2.304]Training (xattn/smallcnn):  41%|████      | 41/100 [03:31<05:05,  5.17s/it, train loss=0.8451, val ΔE00=2.551, best=2.304]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:36<04:58,  5.14s/it, train loss=0.8451, val ΔE00=2.551, best=2.304]Training (xattn/smallcnn):  42%|████▏     | 42/100 [03:36<04:58,  5.14s/it, train loss=0.8504, val ΔE00=2.574, best=2.304]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:41<04:51,  5.12s/it, train loss=0.8504, val ΔE00=2.574, best=2.304]Training (xattn/smallcnn):  43%|████▎     | 43/100 [03:41<04:51,  5.12s/it, train loss=0.9014, val ΔE00=2.607, best=2.304]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:46<04:45,  5.10s/it, train loss=0.9014, val ΔE00=2.607, best=2.304]Training (xattn/smallcnn):  44%|████▍     | 44/100 [03:46<04:45,  5.10s/it, train loss=0.8989, val ΔE00=2.553, best=2.304]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:51<04:43,  5.16s/it, train loss=0.8989, val ΔE00=2.553, best=2.304]Training (xattn/smallcnn):  45%|████▌     | 45/100 [03:51<04:43,  5.16s/it, train loss=0.9229, val ΔE00=2.490, best=2.304]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:56<04:39,  5.17s/it, train loss=0.9229, val ΔE00=2.490, best=2.304]Training (xattn/smallcnn):  46%|████▌     | 46/100 [03:56<04:39,  5.17s/it, train loss=0.9756, val ΔE00=2.243, best=2.243]Training (xattn/smallcnn):  47%|████▋     | 47/100 [04:01<04:32,  5.14s/it, train loss=0.9756, val ΔE00=2.243, best=2.243]Training (xattn/smallcnn):  47%|████▋     | 47/100 [04:01<04:32,  5.14s/it, train loss=1.0050, val ΔE00=2.911, best=2.243]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:06<04:26,  5.12s/it, train loss=1.0050, val ΔE00=2.911, best=2.243]Training (xattn/smallcnn):  48%|████▊     | 48/100 [04:06<04:26,  5.12s/it, train loss=1.0014, val ΔE00=2.436, best=2.243]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:12<04:20,  5.10s/it, train loss=1.0014, val ΔE00=2.436, best=2.243]Training (xattn/smallcnn):  49%|████▉     | 49/100 [04:12<04:20,  5.10s/it, train loss=1.0183, val ΔE00=2.454, best=2.243]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:17<04:18,  5.16s/it, train loss=1.0183, val ΔE00=2.454, best=2.243]Training (xattn/smallcnn):  50%|█████     | 50/100 [04:17<04:18,  5.16s/it, train loss=1.0508, val ΔE00=2.201, best=2.201]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:22<04:13,  5.17s/it, train loss=1.0508, val ΔE00=2.201, best=2.201]Training (xattn/smallcnn):  51%|█████     | 51/100 [04:22<04:13,  5.17s/it, train loss=1.0583, val ΔE00=2.407, best=2.201]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:27<04:06,  5.14s/it, train loss=1.0583, val ΔE00=2.407, best=2.201]Training (xattn/smallcnn):  52%|█████▏    | 52/100 [04:27<04:06,  5.14s/it, train loss=1.0894, val ΔE00=2.360, best=2.201]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:32<04:00,  5.12s/it, train loss=1.0894, val ΔE00=2.360, best=2.201]Training (xattn/smallcnn):  53%|█████▎    | 53/100 [04:32<04:00,  5.12s/it, train loss=1.0723, val ΔE00=2.627, best=2.201]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:37<03:54,  5.10s/it, train loss=1.0723, val ΔE00=2.627, best=2.201]Training (xattn/smallcnn):  54%|█████▍    | 54/100 [04:37<03:54,  5.10s/it, train loss=1.1748, val ΔE00=2.465, best=2.201]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:43<03:52,  5.17s/it, train loss=1.1748, val ΔE00=2.465, best=2.201]Training (xattn/smallcnn):  55%|█████▌    | 55/100 [04:43<03:52,  5.17s/it, train loss=1.0936, val ΔE00=2.289, best=2.201]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:48<03:46,  5.16s/it, train loss=1.0936, val ΔE00=2.289, best=2.201]Training (xattn/smallcnn):  56%|█████▌    | 56/100 [04:48<03:46,  5.16s/it, train loss=1.1696, val ΔE00=2.476, best=2.201]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:53<03:40,  5.13s/it, train loss=1.1696, val ΔE00=2.476, best=2.201]Training (xattn/smallcnn):  57%|█████▋    | 57/100 [04:53<03:40,  5.13s/it, train loss=1.1391, val ΔE00=2.386, best=2.201]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:58<03:34,  5.11s/it, train loss=1.1391, val ΔE00=2.386, best=2.201]Training (xattn/smallcnn):  58%|█████▊    | 58/100 [04:58<03:34,  5.11s/it, train loss=1.1533, val ΔE00=2.397, best=2.201]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:03<03:28,  5.09s/it, train loss=1.1533, val ΔE00=2.397, best=2.201]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:03<03:28,  5.09s/it, train loss=1.2364, val ΔE00=2.389, best=2.201]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:08<03:28,  5.09s/it, train loss=1.1991, val ΔE00=2.373, early_stop=yes]Training (xattn/smallcnn):  59%|█████▉    | 59/100 [05:08<03:34,  5.23s/it, train loss=1.1991, val ΔE00=2.373, early_stop=yes]
[early] stop at epoch 60 (best de00=2.2010 @ 50)
[done] best ΔE00=2.201 over 60 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/xattn__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 21/24 ===
[sweep] id=021_model=xattn__backbone=resnet18__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone resnet18 --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=resnet18, features=image, meta_encoder=none
[run] model=xattn backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:00,  6.06s/it]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:00,  6.06s/it, train loss=0.0074, val ΔE00=6.430, best=6.430]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:24,  5.76s/it, train loss=0.0074, val ΔE00=6.430, best=6.430]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:24,  5.76s/it, train loss=0.0068, val ΔE00=5.314, best=5.314]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:08,  5.65s/it, train loss=0.0068, val ΔE00=5.314, best=5.314]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:08,  5.65s/it, train loss=0.0118, val ΔE00=4.982, best=4.982]Training (xattn/resnet18):   4%|▍         | 4/100 [00:22<08:57,  5.60s/it, train loss=0.0118, val ΔE00=4.982, best=4.982]Training (xattn/resnet18):   4%|▍         | 4/100 [00:22<08:57,  5.60s/it, train loss=0.0211, val ΔE00=4.522, best=4.522]Training (xattn/resnet18):   5%|▌         | 5/100 [00:28<08:57,  5.66s/it, train loss=0.0211, val ΔE00=4.522, best=4.522]Training (xattn/resnet18):   5%|▌         | 5/100 [00:28<08:57,  5.66s/it, train loss=0.0302, val ΔE00=3.789, best=3.789]Training (xattn/resnet18):   6%|▌         | 6/100 [00:34<08:49,  5.64s/it, train loss=0.0302, val ΔE00=3.789, best=3.789]Training (xattn/resnet18):   6%|▌         | 6/100 [00:34<08:49,  5.64s/it, train loss=0.0471, val ΔE00=4.399, best=3.789]Training (xattn/resnet18):   7%|▋         | 7/100 [00:39<08:39,  5.58s/it, train loss=0.0471, val ΔE00=4.399, best=3.789]Training (xattn/resnet18):   7%|▋         | 7/100 [00:39<08:39,  5.58s/it, train loss=0.0616, val ΔE00=4.608, best=3.789]Training (xattn/resnet18):   8%|▊         | 8/100 [00:45<08:32,  5.57s/it, train loss=0.0616, val ΔE00=4.608, best=3.789]Training (xattn/resnet18):   8%|▊         | 8/100 [00:45<08:32,  5.57s/it, train loss=0.0712, val ΔE00=3.729, best=3.729]Training (xattn/resnet18):   9%|▉         | 9/100 [00:50<08:23,  5.53s/it, train loss=0.0712, val ΔE00=3.729, best=3.729]Training (xattn/resnet18):   9%|▉         | 9/100 [00:50<08:23,  5.53s/it, train loss=0.0930, val ΔE00=3.854, best=3.729]Training (xattn/resnet18):  10%|█         | 10/100 [00:56<08:22,  5.59s/it, train loss=0.0930, val ΔE00=3.854, best=3.729]Training (xattn/resnet18):  10%|█         | 10/100 [00:56<08:22,  5.59s/it, train loss=0.1134, val ΔE00=3.975, best=3.729]Training (xattn/resnet18):  11%|█         | 11/100 [01:01<08:16,  5.58s/it, train loss=0.1134, val ΔE00=3.975, best=3.729]Training (xattn/resnet18):  11%|█         | 11/100 [01:01<08:16,  5.58s/it, train loss=0.1336, val ΔE00=4.436, best=3.729]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:07<08:08,  5.55s/it, train loss=0.1336, val ΔE00=4.436, best=3.729]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:07<08:08,  5.55s/it, train loss=0.1576, val ΔE00=4.186, best=3.729]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:12<08:00,  5.52s/it, train loss=0.1576, val ΔE00=4.186, best=3.729]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:12<08:00,  5.52s/it, train loss=0.1741, val ΔE00=3.753, best=3.729]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:18<07:55,  5.53s/it, train loss=0.1741, val ΔE00=3.753, best=3.729]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:18<07:55,  5.53s/it, train loss=0.1965, val ΔE00=3.438, best=3.438]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:23<07:54,  5.58s/it, train loss=0.1965, val ΔE00=3.438, best=3.438]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:23<07:54,  5.58s/it, train loss=0.2169, val ΔE00=3.724, best=3.438]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:29<07:49,  5.59s/it, train loss=0.2169, val ΔE00=3.724, best=3.438]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:29<07:49,  5.59s/it, train loss=0.2321, val ΔE00=3.958, best=3.438]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:35<07:42,  5.57s/it, train loss=0.2321, val ΔE00=3.958, best=3.438]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:35<07:42,  5.57s/it, train loss=0.2544, val ΔE00=3.325, best=3.325]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:40<07:34,  5.54s/it, train loss=0.2544, val ΔE00=3.325, best=3.325]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:40<07:34,  5.54s/it, train loss=0.2794, val ΔE00=3.636, best=3.325]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:46<07:28,  5.54s/it, train loss=0.2794, val ΔE00=3.636, best=3.325]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:46<07:28,  5.54s/it, train loss=0.2921, val ΔE00=3.195, best=3.195]Training (xattn/resnet18):  20%|██        | 20/100 [01:51<07:26,  5.58s/it, train loss=0.2921, val ΔE00=3.195, best=3.195]Training (xattn/resnet18):  20%|██        | 20/100 [01:51<07:26,  5.58s/it, train loss=0.3411, val ΔE00=3.936, best=3.195]Training (xattn/resnet18):  21%|██        | 21/100 [01:57<07:21,  5.59s/it, train loss=0.3411, val ΔE00=3.936, best=3.195]Training (xattn/resnet18):  21%|██        | 21/100 [01:57<07:21,  5.59s/it, train loss=0.3714, val ΔE00=3.251, best=3.195]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:02<07:12,  5.55s/it, train loss=0.3714, val ΔE00=3.251, best=3.195]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:02<07:12,  5.55s/it, train loss=0.3850, val ΔE00=3.536, best=3.195]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:08<07:05,  5.53s/it, train loss=0.3850, val ΔE00=3.536, best=3.195]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:08<07:05,  5.53s/it, train loss=0.4095, val ΔE00=3.801, best=3.195]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:13<06:58,  5.51s/it, train loss=0.4095, val ΔE00=3.801, best=3.195]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:13<06:58,  5.51s/it, train loss=0.4183, val ΔE00=3.353, best=3.195]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:19<06:58,  5.58s/it, train loss=0.4183, val ΔE00=3.353, best=3.195]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:19<06:58,  5.58s/it, train loss=0.4557, val ΔE00=3.165, best=3.165]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:25<06:53,  5.59s/it, train loss=0.4557, val ΔE00=3.165, best=3.165]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:25<06:53,  5.59s/it, train loss=0.4997, val ΔE00=3.197, best=3.165]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:30<06:45,  5.55s/it, train loss=0.4997, val ΔE00=3.197, best=3.165]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:30<06:45,  5.55s/it, train loss=0.5095, val ΔE00=3.812, best=3.165]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:36<06:37,  5.52s/it, train loss=0.5095, val ΔE00=3.812, best=3.165]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:36<06:37,  5.52s/it, train loss=0.5238, val ΔE00=3.353, best=3.165]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:41<06:30,  5.50s/it, train loss=0.5238, val ΔE00=3.353, best=3.165]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:41<06:30,  5.50s/it, train loss=0.5431, val ΔE00=3.180, best=3.165]Training (xattn/resnet18):  30%|███       | 30/100 [02:47<06:28,  5.55s/it, train loss=0.5431, val ΔE00=3.180, best=3.165]Training (xattn/resnet18):  30%|███       | 30/100 [02:47<06:28,  5.55s/it, train loss=0.6041, val ΔE00=3.560, best=3.165]Training (xattn/resnet18):  31%|███       | 31/100 [02:52<06:24,  5.57s/it, train loss=0.6041, val ΔE00=3.560, best=3.165]Training (xattn/resnet18):  31%|███       | 31/100 [02:52<06:24,  5.57s/it, train loss=0.5959, val ΔE00=3.381, best=3.165]Training (xattn/resnet18):  32%|███▏      | 32/100 [02:58<06:16,  5.54s/it, train loss=0.5959, val ΔE00=3.381, best=3.165]Training (xattn/resnet18):  32%|███▏      | 32/100 [02:58<06:16,  5.54s/it, train loss=0.6166, val ΔE00=3.430, best=3.165]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:03<06:09,  5.52s/it, train loss=0.6166, val ΔE00=3.430, best=3.165]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:03<06:09,  5.52s/it, train loss=0.6265, val ΔE00=3.589, best=3.165]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:09<06:02,  5.50s/it, train loss=0.6265, val ΔE00=3.589, best=3.165]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:09<06:02,  5.50s/it, train loss=0.6201, val ΔE00=3.579, best=3.165]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:14<06:01,  5.57s/it, train loss=0.6201, val ΔE00=3.579, best=3.165]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:14<06:01,  5.57s/it, train loss=0.6919, val ΔE00=3.095, best=3.095]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:20<05:56,  5.58s/it, train loss=0.6919, val ΔE00=3.095, best=3.095]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:20<05:56,  5.58s/it, train loss=0.6866, val ΔE00=3.911, best=3.095]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:25<05:49,  5.55s/it, train loss=0.6866, val ΔE00=3.911, best=3.095]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:25<05:49,  5.55s/it, train loss=0.6620, val ΔE00=3.499, best=3.095]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:31<05:42,  5.52s/it, train loss=0.6620, val ΔE00=3.499, best=3.095]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:31<05:42,  5.52s/it, train loss=0.7760, val ΔE00=3.508, best=3.095]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:36<05:35,  5.51s/it, train loss=0.7760, val ΔE00=3.508, best=3.095]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:36<05:35,  5.51s/it, train loss=0.7452, val ΔE00=3.934, best=3.095]Training (xattn/resnet18):  40%|████      | 40/100 [03:42<05:33,  5.56s/it, train loss=0.7452, val ΔE00=3.934, best=3.095]Training (xattn/resnet18):  40%|████      | 40/100 [03:42<05:33,  5.56s/it, train loss=0.7566, val ΔE00=3.459, best=3.095]Training (xattn/resnet18):  41%|████      | 41/100 [03:48<05:28,  5.57s/it, train loss=0.7566, val ΔE00=3.459, best=3.095]Training (xattn/resnet18):  41%|████      | 41/100 [03:48<05:28,  5.57s/it, train loss=0.7931, val ΔE00=3.695, best=3.095]Training (xattn/resnet18):  42%|████▏     | 42/100 [03:53<05:21,  5.54s/it, train loss=0.7931, val ΔE00=3.695, best=3.095]Training (xattn/resnet18):  42%|████▏     | 42/100 [03:53<05:21,  5.54s/it, train loss=0.7933, val ΔE00=3.609, best=3.095]Training (xattn/resnet18):  43%|████▎     | 43/100 [03:59<05:14,  5.52s/it, train loss=0.7933, val ΔE00=3.609, best=3.095]Training (xattn/resnet18):  43%|████▎     | 43/100 [03:59<05:14,  5.52s/it, train loss=0.8312, val ΔE00=3.928, best=3.095]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:04<05:08,  5.51s/it, train loss=0.8312, val ΔE00=3.928, best=3.095]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:04<05:08,  5.51s/it, train loss=0.7581, val ΔE00=3.610, best=3.095]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:10<05:05,  5.56s/it, train loss=0.7581, val ΔE00=3.610, best=3.095]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:10<05:05,  5.56s/it, train loss=0.8444, val ΔE00=3.556, best=3.095]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:15<05:00,  5.57s/it, train loss=0.8444, val ΔE00=3.556, best=3.095]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:15<05:00,  5.57s/it, train loss=0.8427, val ΔE00=3.587, best=3.095]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:21<04:53,  5.54s/it, train loss=0.8427, val ΔE00=3.587, best=3.095]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:21<04:53,  5.54s/it, train loss=0.8078, val ΔE00=3.372, best=3.095]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:26<04:46,  5.51s/it, train loss=0.8078, val ΔE00=3.372, best=3.095]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:26<04:46,  5.51s/it, train loss=0.7778, val ΔE00=3.651, best=3.095]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:32<04:40,  5.50s/it, train loss=0.7778, val ΔE00=3.651, best=3.095]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:32<04:40,  5.50s/it, train loss=0.8171, val ΔE00=3.522, best=3.095]Training (xattn/resnet18):  50%|█████     | 50/100 [04:37<04:38,  5.56s/it, train loss=0.8171, val ΔE00=3.522, best=3.095]Training (xattn/resnet18):  50%|█████     | 50/100 [04:37<04:38,  5.56s/it, train loss=0.7945, val ΔE00=3.426, best=3.095]Training (xattn/resnet18):  51%|█████     | 51/100 [04:43<04:32,  5.57s/it, train loss=0.7945, val ΔE00=3.426, best=3.095]Training (xattn/resnet18):  51%|█████     | 51/100 [04:43<04:32,  5.57s/it, train loss=0.8414, val ΔE00=3.756, best=3.095]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:49<04:25,  5.54s/it, train loss=0.8414, val ΔE00=3.756, best=3.095]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:49<04:25,  5.54s/it, train loss=0.9123, val ΔE00=3.563, best=3.095]Training (xattn/resnet18):  53%|█████▎    | 53/100 [04:54<04:19,  5.52s/it, train loss=0.9123, val ΔE00=3.563, best=3.095]Training (xattn/resnet18):  53%|█████▎    | 53/100 [04:54<04:19,  5.52s/it, train loss=0.8947, val ΔE00=3.467, best=3.095]Training (xattn/resnet18):  54%|█████▍    | 54/100 [04:59<04:13,  5.50s/it, train loss=0.8947, val ΔE00=3.467, best=3.095]Training (xattn/resnet18):  54%|█████▍    | 54/100 [04:59<04:13,  5.50s/it, train loss=0.9156, val ΔE00=3.713, best=3.095]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:05<04:10,  5.56s/it, train loss=0.9156, val ΔE00=3.713, best=3.095]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:05<04:10,  5.56s/it, train loss=0.9623, val ΔE00=3.412, best=3.095]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:11<04:05,  5.57s/it, train loss=0.9623, val ΔE00=3.412, best=3.095]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:11<04:05,  5.57s/it, train loss=0.9048, val ΔE00=3.431, best=3.095]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:16<03:58,  5.54s/it, train loss=0.9048, val ΔE00=3.431, best=3.095]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:16<03:58,  5.54s/it, train loss=0.8437, val ΔE00=3.512, best=3.095]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:22<03:51,  5.52s/it, train loss=0.8437, val ΔE00=3.512, best=3.095]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:22<03:51,  5.52s/it, train loss=0.8496, val ΔE00=3.520, best=3.095]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:27<03:51,  5.52s/it, train loss=0.8283, val ΔE00=3.535, early_stop=yes]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:27<03:57,  5.65s/it, train loss=0.8283, val ΔE00=3.535, early_stop=yes]
[early] stop at epoch 59 (best de00=3.0947 @ 35)
[done] best ΔE00=3.095 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/xattn__resnet18__image__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image/final_summary.json (kind=val)
[sweep] === Run 22/24 ===
[sweep] id=022_model=xattn__backbone=resnet18__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone resnet18 --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=resnet18, features=image+mean, meta_encoder=none
[run] model=xattn backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:16,  6.23s/it]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:16,  6.23s/it, train loss=0.0077, val ΔE00=5.781, best=5.781]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:38,  5.90s/it, train loss=0.0077, val ΔE00=5.781, best=5.781]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:38,  5.90s/it, train loss=0.0061, val ΔE00=5.491, best=5.491]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:19,  5.77s/it, train loss=0.0061, val ΔE00=5.491, best=5.491]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:19,  5.77s/it, train loss=0.0108, val ΔE00=5.774, best=5.491]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:10,  5.73s/it, train loss=0.0108, val ΔE00=5.774, best=5.491]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:10,  5.73s/it, train loss=0.0178, val ΔE00=4.412, best=4.412]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:08,  5.77s/it, train loss=0.0178, val ΔE00=4.412, best=4.412]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:08,  5.77s/it, train loss=0.0257, val ΔE00=4.690, best=4.412]Training (xattn/resnet18):   6%|▌         | 6/100 [00:34<09:01,  5.76s/it, train loss=0.0257, val ΔE00=4.690, best=4.412]Training (xattn/resnet18):   6%|▌         | 6/100 [00:34<09:01,  5.76s/it, train loss=0.0387, val ΔE00=5.600, best=4.412]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:53,  5.73s/it, train loss=0.0387, val ΔE00=5.600, best=4.412]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:53,  5.73s/it, train loss=0.0507, val ΔE00=4.158, best=4.158]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:44,  5.70s/it, train loss=0.0507, val ΔE00=4.158, best=4.158]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:44,  5.70s/it, train loss=0.0674, val ΔE00=4.181, best=4.158]Training (xattn/resnet18):   9%|▉         | 9/100 [00:51<08:38,  5.70s/it, train loss=0.0674, val ΔE00=4.181, best=4.158]Training (xattn/resnet18):   9%|▉         | 9/100 [00:51<08:38,  5.70s/it, train loss=0.0782, val ΔE00=3.733, best=3.733]Training (xattn/resnet18):  10%|█         | 10/100 [00:57<08:36,  5.74s/it, train loss=0.0782, val ΔE00=3.733, best=3.733]Training (xattn/resnet18):  10%|█         | 10/100 [00:57<08:36,  5.74s/it, train loss=0.0950, val ΔE00=4.388, best=3.733]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:30,  5.74s/it, train loss=0.0950, val ΔE00=4.388, best=3.733]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:30,  5.74s/it, train loss=0.1149, val ΔE00=4.093, best=3.733]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:08<08:21,  5.70s/it, train loss=0.1149, val ΔE00=4.093, best=3.733]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:08<08:21,  5.70s/it, train loss=0.1264, val ΔE00=3.778, best=3.733]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:14<08:13,  5.68s/it, train loss=0.1264, val ΔE00=3.778, best=3.733]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:14<08:13,  5.68s/it, train loss=0.1454, val ΔE00=3.782, best=3.733]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:20<08:08,  5.68s/it, train loss=0.1454, val ΔE00=3.782, best=3.733]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:20<08:08,  5.68s/it, train loss=0.1560, val ΔE00=3.378, best=3.378]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:07,  5.73s/it, train loss=0.1560, val ΔE00=3.378, best=3.378]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:07,  5.73s/it, train loss=0.1810, val ΔE00=3.714, best=3.378]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:31<08:01,  5.74s/it, train loss=0.1810, val ΔE00=3.714, best=3.378]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:31<08:01,  5.74s/it, train loss=0.2054, val ΔE00=3.686, best=3.378]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:37<07:53,  5.71s/it, train loss=0.2054, val ΔE00=3.686, best=3.378]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:37<07:53,  5.71s/it, train loss=0.2258, val ΔE00=3.742, best=3.378]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:43<07:46,  5.69s/it, train loss=0.2258, val ΔE00=3.742, best=3.378]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:43<07:46,  5.69s/it, train loss=0.2347, val ΔE00=3.559, best=3.378]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:48<07:39,  5.67s/it, train loss=0.2347, val ΔE00=3.559, best=3.378]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:48<07:39,  5.67s/it, train loss=0.2419, val ΔE00=3.506, best=3.378]Training (xattn/resnet18):  20%|██        | 20/100 [01:54<07:37,  5.72s/it, train loss=0.2419, val ΔE00=3.506, best=3.378]Training (xattn/resnet18):  20%|██        | 20/100 [01:54<07:37,  5.72s/it, train loss=0.2706, val ΔE00=3.599, best=3.378]Training (xattn/resnet18):  21%|██        | 21/100 [02:00<07:32,  5.73s/it, train loss=0.2706, val ΔE00=3.599, best=3.378]Training (xattn/resnet18):  21%|██        | 21/100 [02:00<07:32,  5.73s/it, train loss=0.2853, val ΔE00=3.430, best=3.378]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:05<07:24,  5.69s/it, train loss=0.2853, val ΔE00=3.430, best=3.378]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:05<07:24,  5.69s/it, train loss=0.3066, val ΔE00=3.444, best=3.378]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:11<07:16,  5.67s/it, train loss=0.3066, val ΔE00=3.444, best=3.378]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:11<07:16,  5.67s/it, train loss=0.3342, val ΔE00=3.668, best=3.378]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:17<07:10,  5.66s/it, train loss=0.3342, val ΔE00=3.668, best=3.378]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:17<07:10,  5.66s/it, train loss=0.3389, val ΔE00=3.699, best=3.378]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:23<07:08,  5.72s/it, train loss=0.3389, val ΔE00=3.699, best=3.378]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:23<07:08,  5.72s/it, train loss=0.3589, val ΔE00=3.753, best=3.378]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:28<07:04,  5.73s/it, train loss=0.3589, val ΔE00=3.753, best=3.378]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:28<07:04,  5.73s/it, train loss=0.3704, val ΔE00=3.683, best=3.378]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:34<06:55,  5.70s/it, train loss=0.3704, val ΔE00=3.683, best=3.378]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:34<06:55,  5.70s/it, train loss=0.3909, val ΔE00=3.444, best=3.378]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:40<06:48,  5.68s/it, train loss=0.3909, val ΔE00=3.444, best=3.378]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:40<06:48,  5.68s/it, train loss=0.4029, val ΔE00=3.458, best=3.378]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:45<06:42,  5.66s/it, train loss=0.4029, val ΔE00=3.458, best=3.378]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:45<06:42,  5.66s/it, train loss=0.3921, val ΔE00=3.799, best=3.378]Training (xattn/resnet18):  30%|███       | 30/100 [02:51<06:40,  5.72s/it, train loss=0.3921, val ΔE00=3.799, best=3.378]Training (xattn/resnet18):  30%|███       | 30/100 [02:51<06:40,  5.72s/it, train loss=0.4186, val ΔE00=3.563, best=3.378]Training (xattn/resnet18):  31%|███       | 31/100 [02:57<06:35,  5.73s/it, train loss=0.4186, val ΔE00=3.563, best=3.378]Training (xattn/resnet18):  31%|███       | 31/100 [02:57<06:35,  5.73s/it, train loss=0.4564, val ΔE00=3.400, best=3.378]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:02<06:27,  5.70s/it, train loss=0.4564, val ΔE00=3.400, best=3.378]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:02<06:27,  5.70s/it, train loss=0.4682, val ΔE00=3.469, best=3.378]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:08<06:20,  5.68s/it, train loss=0.4682, val ΔE00=3.469, best=3.378]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:08<06:20,  5.68s/it, train loss=0.4954, val ΔE00=3.520, best=3.378]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:14<06:13,  5.66s/it, train loss=0.4954, val ΔE00=3.520, best=3.378]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:14<06:13,  5.66s/it, train loss=0.4838, val ΔE00=3.880, best=3.378]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:20<06:12,  5.72s/it, train loss=0.4838, val ΔE00=3.880, best=3.378]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:20<06:12,  5.72s/it, train loss=0.4913, val ΔE00=3.627, best=3.378]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:25<06:06,  5.73s/it, train loss=0.4913, val ΔE00=3.627, best=3.378]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:25<06:06,  5.73s/it, train loss=0.5099, val ΔE00=3.495, best=3.378]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:31<05:58,  5.69s/it, train loss=0.5099, val ΔE00=3.495, best=3.378]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:31<05:58,  5.69s/it, train loss=0.5342, val ΔE00=3.757, best=3.378]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:37<05:51,  5.67s/it, train loss=0.5342, val ΔE00=3.757, best=3.378]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:37<05:51,  5.67s/it, train loss=0.5099, val ΔE00=3.578, best=3.378]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:42<05:45,  5.67s/it, train loss=0.5099, val ΔE00=3.578, best=3.378]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:42<05:45,  5.67s/it, train loss=0.4815, val ΔE00=3.259, best=3.259]Training (xattn/resnet18):  40%|████      | 40/100 [03:48<05:43,  5.73s/it, train loss=0.4815, val ΔE00=3.259, best=3.259]Training (xattn/resnet18):  40%|████      | 40/100 [03:48<05:43,  5.73s/it, train loss=0.5496, val ΔE00=3.374, best=3.259]Training (xattn/resnet18):  41%|████      | 41/100 [03:54<05:37,  5.73s/it, train loss=0.5496, val ΔE00=3.374, best=3.259]Training (xattn/resnet18):  41%|████      | 41/100 [03:54<05:37,  5.73s/it, train loss=0.5625, val ΔE00=3.728, best=3.259]Training (xattn/resnet18):  42%|████▏     | 42/100 [03:59<05:30,  5.69s/it, train loss=0.5625, val ΔE00=3.728, best=3.259]Training (xattn/resnet18):  42%|████▏     | 42/100 [03:59<05:30,  5.69s/it, train loss=0.5406, val ΔE00=4.216, best=3.259]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:05<05:22,  5.66s/it, train loss=0.5406, val ΔE00=4.216, best=3.259]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:05<05:22,  5.66s/it, train loss=0.5882, val ΔE00=3.612, best=3.259]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:11<05:16,  5.65s/it, train loss=0.5882, val ΔE00=3.612, best=3.259]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:11<05:16,  5.65s/it, train loss=0.6095, val ΔE00=3.502, best=3.259]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:16<05:14,  5.71s/it, train loss=0.6095, val ΔE00=3.502, best=3.259]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:16<05:14,  5.71s/it, train loss=0.5809, val ΔE00=3.648, best=3.259]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:22<05:08,  5.71s/it, train loss=0.5809, val ΔE00=3.648, best=3.259]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:22<05:08,  5.71s/it, train loss=0.5907, val ΔE00=3.532, best=3.259]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:28<05:01,  5.68s/it, train loss=0.5907, val ΔE00=3.532, best=3.259]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:28<05:01,  5.68s/it, train loss=0.6345, val ΔE00=3.423, best=3.259]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:33<04:54,  5.66s/it, train loss=0.6345, val ΔE00=3.423, best=3.259]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:33<04:54,  5.66s/it, train loss=0.5962, val ΔE00=3.266, best=3.259]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:39<04:48,  5.65s/it, train loss=0.5962, val ΔE00=3.266, best=3.259]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:39<04:48,  5.65s/it, train loss=0.5440, val ΔE00=3.877, best=3.259]Training (xattn/resnet18):  50%|█████     | 50/100 [04:45<04:45,  5.71s/it, train loss=0.5440, val ΔE00=3.877, best=3.259]Training (xattn/resnet18):  50%|█████     | 50/100 [04:45<04:45,  5.71s/it, train loss=0.6103, val ΔE00=3.494, best=3.259]Training (xattn/resnet18):  51%|█████     | 51/100 [04:51<04:40,  5.73s/it, train loss=0.6103, val ΔE00=3.494, best=3.259]Training (xattn/resnet18):  51%|█████     | 51/100 [04:51<04:40,  5.73s/it, train loss=0.6257, val ΔE00=3.556, best=3.259]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:56<04:33,  5.69s/it, train loss=0.6257, val ΔE00=3.556, best=3.259]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:56<04:33,  5.69s/it, train loss=0.6044, val ΔE00=3.542, best=3.259]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:02<04:26,  5.67s/it, train loss=0.6044, val ΔE00=3.542, best=3.259]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:02<04:26,  5.67s/it, train loss=0.6175, val ΔE00=3.275, best=3.259]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:08<04:20,  5.66s/it, train loss=0.6175, val ΔE00=3.275, best=3.259]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:08<04:20,  5.66s/it, train loss=0.5862, val ΔE00=3.787, best=3.259]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:13<04:17,  5.73s/it, train loss=0.5862, val ΔE00=3.787, best=3.259]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:13<04:17,  5.73s/it, train loss=0.6180, val ΔE00=3.677, best=3.259]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:19<04:11,  5.72s/it, train loss=0.6180, val ΔE00=3.677, best=3.259]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:19<04:11,  5.72s/it, train loss=0.6378, val ΔE00=3.652, best=3.259]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:25<04:04,  5.69s/it, train loss=0.6378, val ΔE00=3.652, best=3.259]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:25<04:04,  5.69s/it, train loss=0.6612, val ΔE00=3.523, best=3.259]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:30<03:58,  5.67s/it, train loss=0.6612, val ΔE00=3.523, best=3.259]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:30<03:58,  5.67s/it, train loss=0.6390, val ΔE00=3.555, best=3.259]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:36<03:58,  5.67s/it, train loss=0.6700, val ΔE00=3.667, early_stop=yes]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:36<04:03,  5.80s/it, train loss=0.6700, val ΔE00=3.667, early_stop=yes]
[early] stop at epoch 59 (best de00=3.2588 @ 39)
[done] best ΔE00=3.259 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/xattn__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 23/24 ===
[sweep] id=023_model=xattn__backbone=resnet18__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone resnet18 --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=resnet18, features=image+meta, meta_encoder=none
[run] model=xattn backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:18,  6.25s/it]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:18,  6.25s/it, train loss=0.0087, val ΔE00=5.917, best=5.917]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:39,  5.92s/it, train loss=0.0087, val ΔE00=5.917, best=5.917]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:39,  5.92s/it, train loss=0.0065, val ΔE00=5.202, best=5.202]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:24,  5.82s/it, train loss=0.0065, val ΔE00=5.202, best=5.202]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:24,  5.82s/it, train loss=0.0114, val ΔE00=4.095, best=4.095]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:11,  5.75s/it, train loss=0.0114, val ΔE00=4.095, best=4.095]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:11,  5.75s/it, train loss=0.0169, val ΔE00=4.447, best=4.095]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:12,  5.82s/it, train loss=0.0169, val ΔE00=4.447, best=4.095]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:12,  5.82s/it, train loss=0.0273, val ΔE00=3.946, best=3.946]Training (xattn/resnet18):   6%|▌         | 6/100 [00:35<09:06,  5.82s/it, train loss=0.0273, val ΔE00=3.946, best=3.946]Training (xattn/resnet18):   6%|▌         | 6/100 [00:35<09:06,  5.82s/it, train loss=0.0400, val ΔE00=3.892, best=3.892]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:57,  5.78s/it, train loss=0.0400, val ΔE00=3.892, best=3.892]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:57,  5.78s/it, train loss=0.0500, val ΔE00=3.150, best=3.150]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:47,  5.73s/it, train loss=0.0500, val ΔE00=3.150, best=3.150]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:47,  5.73s/it, train loss=0.0631, val ΔE00=3.560, best=3.150]Training (xattn/resnet18):   9%|▉         | 9/100 [00:51<08:38,  5.70s/it, train loss=0.0631, val ΔE00=3.560, best=3.150]Training (xattn/resnet18):   9%|▉         | 9/100 [00:51<08:38,  5.70s/it, train loss=0.0745, val ΔE00=3.571, best=3.150]Training (xattn/resnet18):  10%|█         | 10/100 [00:57<08:39,  5.77s/it, train loss=0.0745, val ΔE00=3.571, best=3.150]Training (xattn/resnet18):  10%|█         | 10/100 [00:57<08:39,  5.77s/it, train loss=0.0882, val ΔE00=2.972, best=2.972]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:33,  5.76s/it, train loss=0.0882, val ΔE00=2.972, best=2.972]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:33,  5.76s/it, train loss=0.0983, val ΔE00=3.239, best=2.972]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:09<08:25,  5.75s/it, train loss=0.0983, val ΔE00=3.239, best=2.972]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:09<08:25,  5.75s/it, train loss=0.1224, val ΔE00=2.888, best=2.888]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:15<08:16,  5.71s/it, train loss=0.1224, val ΔE00=2.888, best=2.888]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:15<08:16,  5.71s/it, train loss=0.1375, val ΔE00=3.218, best=2.888]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:20<08:10,  5.70s/it, train loss=0.1375, val ΔE00=3.218, best=2.888]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:20<08:10,  5.70s/it, train loss=0.1521, val ΔE00=2.662, best=2.662]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:08,  5.75s/it, train loss=0.1521, val ΔE00=2.662, best=2.662]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:08,  5.75s/it, train loss=0.1831, val ΔE00=3.429, best=2.662]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:32<08:03,  5.75s/it, train loss=0.1831, val ΔE00=3.429, best=2.662]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:32<08:03,  5.75s/it, train loss=0.1848, val ΔE00=3.001, best=2.662]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:37<07:54,  5.71s/it, train loss=0.1848, val ΔE00=3.001, best=2.662]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:37<07:54,  5.71s/it, train loss=0.2188, val ΔE00=2.892, best=2.662]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:43<07:46,  5.68s/it, train loss=0.2188, val ΔE00=2.892, best=2.662]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:43<07:46,  5.68s/it, train loss=0.2172, val ΔE00=3.265, best=2.662]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:49<07:42,  5.71s/it, train loss=0.2172, val ΔE00=3.265, best=2.662]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:49<07:42,  5.71s/it, train loss=0.2544, val ΔE00=2.938, best=2.662]Training (xattn/resnet18):  20%|██        | 20/100 [01:55<07:47,  5.85s/it, train loss=0.2544, val ΔE00=2.938, best=2.662]Training (xattn/resnet18):  20%|██        | 20/100 [01:55<07:47,  5.85s/it, train loss=0.2477, val ΔE00=2.601, best=2.601]Training (xattn/resnet18):  21%|██        | 21/100 [02:01<07:42,  5.86s/it, train loss=0.2477, val ΔE00=2.601, best=2.601]Training (xattn/resnet18):  21%|██        | 21/100 [02:01<07:42,  5.86s/it, train loss=0.2729, val ΔE00=2.751, best=2.601]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:07<07:34,  5.82s/it, train loss=0.2729, val ΔE00=2.751, best=2.601]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:07<07:34,  5.82s/it, train loss=0.2837, val ΔE00=2.795, best=2.601]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:12<07:23,  5.76s/it, train loss=0.2837, val ΔE00=2.795, best=2.601]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:12<07:23,  5.76s/it, train loss=0.3060, val ΔE00=2.627, best=2.601]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:18<07:16,  5.74s/it, train loss=0.3060, val ΔE00=2.627, best=2.601]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:18<07:16,  5.74s/it, train loss=0.3517, val ΔE00=2.597, best=2.597]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:24<07:13,  5.78s/it, train loss=0.3517, val ΔE00=2.597, best=2.597]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:24<07:13,  5.78s/it, train loss=0.3867, val ΔE00=2.641, best=2.597]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:30<07:07,  5.77s/it, train loss=0.3867, val ΔE00=2.641, best=2.597]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:30<07:07,  5.77s/it, train loss=0.3815, val ΔE00=2.833, best=2.597]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:35<06:58,  5.73s/it, train loss=0.3815, val ΔE00=2.833, best=2.597]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:35<06:58,  5.73s/it, train loss=0.3869, val ΔE00=2.747, best=2.597]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:41<06:51,  5.72s/it, train loss=0.3869, val ΔE00=2.747, best=2.597]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:41<06:51,  5.72s/it, train loss=0.4197, val ΔE00=2.394, best=2.394]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:47<06:44,  5.69s/it, train loss=0.4197, val ΔE00=2.394, best=2.394]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:47<06:44,  5.69s/it, train loss=0.4143, val ΔE00=2.705, best=2.394]Training (xattn/resnet18):  30%|███       | 30/100 [02:52<06:41,  5.74s/it, train loss=0.4143, val ΔE00=2.705, best=2.394]Training (xattn/resnet18):  30%|███       | 30/100 [02:52<06:41,  5.74s/it, train loss=0.4471, val ΔE00=2.649, best=2.394]Training (xattn/resnet18):  31%|███       | 31/100 [02:58<06:36,  5.74s/it, train loss=0.4471, val ΔE00=2.649, best=2.394]Training (xattn/resnet18):  31%|███       | 31/100 [02:58<06:36,  5.74s/it, train loss=0.4741, val ΔE00=2.617, best=2.394]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:04<06:28,  5.71s/it, train loss=0.4741, val ΔE00=2.617, best=2.394]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:04<06:28,  5.71s/it, train loss=0.4821, val ΔE00=2.743, best=2.394]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:09<06:20,  5.69s/it, train loss=0.4821, val ΔE00=2.743, best=2.394]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:09<06:20,  5.69s/it, train loss=0.4888, val ΔE00=2.626, best=2.394]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:15<06:14,  5.67s/it, train loss=0.4888, val ΔE00=2.626, best=2.394]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:15<06:14,  5.67s/it, train loss=0.5635, val ΔE00=2.500, best=2.394]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:21<06:12,  5.73s/it, train loss=0.5635, val ΔE00=2.500, best=2.394]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:21<06:12,  5.73s/it, train loss=0.5197, val ΔE00=2.679, best=2.394]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:27<06:06,  5.73s/it, train loss=0.5197, val ΔE00=2.679, best=2.394]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:27<06:06,  5.73s/it, train loss=0.5778, val ΔE00=2.870, best=2.394]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:32<05:59,  5.70s/it, train loss=0.5778, val ΔE00=2.870, best=2.394]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:32<05:59,  5.70s/it, train loss=0.5553, val ΔE00=2.460, best=2.394]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:38<05:51,  5.67s/it, train loss=0.5553, val ΔE00=2.460, best=2.394]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:38<05:51,  5.67s/it, train loss=0.5342, val ΔE00=2.552, best=2.394]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:43<05:45,  5.66s/it, train loss=0.5342, val ΔE00=2.552, best=2.394]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:43<05:45,  5.66s/it, train loss=0.5786, val ΔE00=2.515, best=2.394]Training (xattn/resnet18):  40%|████      | 40/100 [03:49<05:43,  5.72s/it, train loss=0.5786, val ΔE00=2.515, best=2.394]Training (xattn/resnet18):  40%|████      | 40/100 [03:49<05:43,  5.72s/it, train loss=0.5970, val ΔE00=2.636, best=2.394]Training (xattn/resnet18):  41%|████      | 41/100 [03:55<05:37,  5.73s/it, train loss=0.5970, val ΔE00=2.636, best=2.394]Training (xattn/resnet18):  41%|████      | 41/100 [03:55<05:37,  5.73s/it, train loss=0.5495, val ΔE00=2.588, best=2.394]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:01<05:30,  5.70s/it, train loss=0.5495, val ΔE00=2.588, best=2.394]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:01<05:30,  5.70s/it, train loss=0.6382, val ΔE00=2.561, best=2.394]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:06<05:23,  5.68s/it, train loss=0.6382, val ΔE00=2.561, best=2.394]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:06<05:23,  5.68s/it, train loss=0.6055, val ΔE00=2.628, best=2.394]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:12<05:17,  5.66s/it, train loss=0.6055, val ΔE00=2.628, best=2.394]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:12<05:17,  5.66s/it, train loss=0.6463, val ΔE00=2.877, best=2.394]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:18<05:14,  5.73s/it, train loss=0.6463, val ΔE00=2.877, best=2.394]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:18<05:14,  5.73s/it, train loss=0.6829, val ΔE00=2.569, best=2.394]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:24<05:09,  5.73s/it, train loss=0.6829, val ΔE00=2.569, best=2.394]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:24<05:09,  5.73s/it, train loss=0.6710, val ΔE00=2.427, best=2.394]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:29<05:01,  5.69s/it, train loss=0.6710, val ΔE00=2.427, best=2.394]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:29<05:01,  5.69s/it, train loss=0.7005, val ΔE00=2.551, best=2.394]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:35<04:55,  5.68s/it, train loss=0.7005, val ΔE00=2.551, best=2.394]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:35<04:55,  5.68s/it, train loss=0.6631, val ΔE00=2.680, best=2.394]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:40<04:48,  5.66s/it, train loss=0.6631, val ΔE00=2.680, best=2.394]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:40<04:48,  5.66s/it, train loss=0.7010, val ΔE00=2.525, best=2.394]Training (xattn/resnet18):  50%|█████     | 50/100 [04:46<04:45,  5.71s/it, train loss=0.7010, val ΔE00=2.525, best=2.394]Training (xattn/resnet18):  50%|█████     | 50/100 [04:46<04:45,  5.71s/it, train loss=0.6902, val ΔE00=2.651, best=2.394]Training (xattn/resnet18):  51%|█████     | 51/100 [04:52<04:40,  5.72s/it, train loss=0.6902, val ΔE00=2.651, best=2.394]Training (xattn/resnet18):  51%|█████     | 51/100 [04:52<04:40,  5.72s/it, train loss=0.7619, val ΔE00=2.570, best=2.394]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:58<04:33,  5.69s/it, train loss=0.7619, val ΔE00=2.570, best=2.394]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:58<04:33,  5.69s/it, train loss=0.7518, val ΔE00=2.589, best=2.394]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:03<04:26,  5.67s/it, train loss=0.7518, val ΔE00=2.589, best=2.394]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:03<04:26,  5.67s/it, train loss=0.7518, val ΔE00=2.550, best=2.394]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:09<04:20,  5.66s/it, train loss=0.7518, val ΔE00=2.550, best=2.394]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:09<04:20,  5.66s/it, train loss=0.8110, val ΔE00=2.544, best=2.394]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:15<04:17,  5.73s/it, train loss=0.8110, val ΔE00=2.544, best=2.394]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:15<04:17,  5.73s/it, train loss=0.7315, val ΔE00=2.461, best=2.394]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:21<04:12,  5.73s/it, train loss=0.7315, val ΔE00=2.461, best=2.394]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:21<04:12,  5.73s/it, train loss=0.7103, val ΔE00=2.726, best=2.394]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:26<04:04,  5.69s/it, train loss=0.7103, val ΔE00=2.726, best=2.394]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:26<04:04,  5.69s/it, train loss=0.7690, val ΔE00=2.623, best=2.394]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:32<03:58,  5.67s/it, train loss=0.7690, val ΔE00=2.623, best=2.394]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:32<03:58,  5.67s/it, train loss=0.7610, val ΔE00=2.423, best=2.394]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:37<03:58,  5.67s/it, train loss=0.7588, val ΔE00=2.506, early_stop=yes]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:37<04:04,  5.83s/it, train loss=0.7588, val ΔE00=2.506, early_stop=yes]
[early] stop at epoch 59 (best de00=2.3936 @ 28)
[done] best ΔE00=2.394 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/xattn__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 24/24 ===
[sweep] id=024_model=xattn__backbone=resnet18__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg/full --logdir ./runs/results/no-bg/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model xattn --backbone resnet18 --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=xattn, backbone=resnet18, features=image+mean+meta, meta_encoder=none
[run] model=xattn backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (xattn/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:18,  6.25s/it]Training (xattn/resnet18):   1%|          | 1/100 [00:06<10:18,  6.25s/it, train loss=0.0074, val ΔE00=5.665, best=5.665]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:40,  5.92s/it, train loss=0.0074, val ΔE00=5.665, best=5.665]Training (xattn/resnet18):   2%|▏         | 2/100 [00:11<09:40,  5.92s/it, train loss=0.0062, val ΔE00=5.194, best=5.194]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:23,  5.81s/it, train loss=0.0062, val ΔE00=5.194, best=5.194]Training (xattn/resnet18):   3%|▎         | 3/100 [00:17<09:23,  5.81s/it, train loss=0.0098, val ΔE00=3.783, best=3.783]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:10,  5.73s/it, train loss=0.0098, val ΔE00=3.783, best=3.783]Training (xattn/resnet18):   4%|▍         | 4/100 [00:23<09:10,  5.73s/it, train loss=0.0161, val ΔE00=4.023, best=3.783]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:09,  5.78s/it, train loss=0.0161, val ΔE00=4.023, best=3.783]Training (xattn/resnet18):   5%|▌         | 5/100 [00:29<09:09,  5.78s/it, train loss=0.0240, val ΔE00=3.804, best=3.783]Training (xattn/resnet18):   6%|▌         | 6/100 [00:34<09:05,  5.80s/it, train loss=0.0240, val ΔE00=3.804, best=3.783]Training (xattn/resnet18):   6%|▌         | 6/100 [00:34<09:05,  5.80s/it, train loss=0.0345, val ΔE00=3.742, best=3.742]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:55,  5.76s/it, train loss=0.0345, val ΔE00=3.742, best=3.742]Training (xattn/resnet18):   7%|▋         | 7/100 [00:40<08:55,  5.76s/it, train loss=0.0444, val ΔE00=3.210, best=3.210]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:47,  5.74s/it, train loss=0.0444, val ΔE00=3.210, best=3.210]Training (xattn/resnet18):   8%|▊         | 8/100 [00:46<08:47,  5.74s/it, train loss=0.0578, val ΔE00=2.966, best=2.966]Training (xattn/resnet18):   9%|▉         | 9/100 [00:51<08:40,  5.71s/it, train loss=0.0578, val ΔE00=2.966, best=2.966]Training (xattn/resnet18):   9%|▉         | 9/100 [00:51<08:40,  5.71s/it, train loss=0.0682, val ΔE00=2.890, best=2.890]Training (xattn/resnet18):  10%|█         | 10/100 [00:57<08:38,  5.76s/it, train loss=0.0682, val ΔE00=2.890, best=2.890]Training (xattn/resnet18):  10%|█         | 10/100 [00:57<08:38,  5.76s/it, train loss=0.0837, val ΔE00=3.039, best=2.890]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:31,  5.75s/it, train loss=0.0837, val ΔE00=3.039, best=2.890]Training (xattn/resnet18):  11%|█         | 11/100 [01:03<08:31,  5.75s/it, train loss=0.0911, val ΔE00=3.214, best=2.890]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:09<08:22,  5.71s/it, train loss=0.0911, val ΔE00=3.214, best=2.890]Training (xattn/resnet18):  12%|█▏        | 12/100 [01:09<08:22,  5.71s/it, train loss=0.1109, val ΔE00=2.929, best=2.890]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:14<08:15,  5.69s/it, train loss=0.1109, val ΔE00=2.929, best=2.890]Training (xattn/resnet18):  13%|█▎        | 13/100 [01:14<08:15,  5.69s/it, train loss=0.1164, val ΔE00=2.710, best=2.710]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:20<08:07,  5.67s/it, train loss=0.1164, val ΔE00=2.710, best=2.710]Training (xattn/resnet18):  14%|█▍        | 14/100 [01:20<08:07,  5.67s/it, train loss=0.1401, val ΔE00=3.035, best=2.710]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:08,  5.75s/it, train loss=0.1401, val ΔE00=3.035, best=2.710]Training (xattn/resnet18):  15%|█▌        | 15/100 [01:26<08:08,  5.75s/it, train loss=0.1503, val ΔE00=2.644, best=2.644]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:32<08:04,  5.77s/it, train loss=0.1503, val ΔE00=2.644, best=2.644]Training (xattn/resnet18):  16%|█▌        | 16/100 [01:32<08:04,  5.77s/it, train loss=0.1629, val ΔE00=2.607, best=2.607]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:37<07:54,  5.72s/it, train loss=0.1629, val ΔE00=2.607, best=2.607]Training (xattn/resnet18):  17%|█▋        | 17/100 [01:37<07:54,  5.72s/it, train loss=0.1834, val ΔE00=2.737, best=2.607]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:43<07:46,  5.69s/it, train loss=0.1834, val ΔE00=2.737, best=2.607]Training (xattn/resnet18):  18%|█▊        | 18/100 [01:43<07:46,  5.69s/it, train loss=0.1933, val ΔE00=2.611, best=2.607]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:49<07:40,  5.69s/it, train loss=0.1933, val ΔE00=2.611, best=2.607]Training (xattn/resnet18):  19%|█▉        | 19/100 [01:49<07:40,  5.69s/it, train loss=0.1955, val ΔE00=2.426, best=2.426]Training (xattn/resnet18):  20%|██        | 20/100 [01:54<07:39,  5.74s/it, train loss=0.1955, val ΔE00=2.426, best=2.426]Training (xattn/resnet18):  20%|██        | 20/100 [01:54<07:39,  5.74s/it, train loss=0.2290, val ΔE00=2.651, best=2.426]Training (xattn/resnet18):  21%|██        | 21/100 [02:00<07:33,  5.74s/it, train loss=0.2290, val ΔE00=2.651, best=2.426]Training (xattn/resnet18):  21%|██        | 21/100 [02:00<07:33,  5.74s/it, train loss=0.2450, val ΔE00=2.586, best=2.426]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:06<07:25,  5.71s/it, train loss=0.2450, val ΔE00=2.586, best=2.426]Training (xattn/resnet18):  22%|██▏       | 22/100 [02:06<07:25,  5.71s/it, train loss=0.2650, val ΔE00=2.539, best=2.426]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:12<07:19,  5.71s/it, train loss=0.2650, val ΔE00=2.539, best=2.426]Training (xattn/resnet18):  23%|██▎       | 23/100 [02:12<07:19,  5.71s/it, train loss=0.2729, val ΔE00=2.377, best=2.377]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:17<07:11,  5.68s/it, train loss=0.2729, val ΔE00=2.377, best=2.377]Training (xattn/resnet18):  24%|██▍       | 24/100 [02:17<07:11,  5.68s/it, train loss=0.3003, val ΔE00=2.410, best=2.377]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:23<07:09,  5.73s/it, train loss=0.3003, val ΔE00=2.410, best=2.377]Training (xattn/resnet18):  25%|██▌       | 25/100 [02:23<07:09,  5.73s/it, train loss=0.3088, val ΔE00=2.600, best=2.377]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:29<07:04,  5.73s/it, train loss=0.3088, val ΔE00=2.600, best=2.377]Training (xattn/resnet18):  26%|██▌       | 26/100 [02:29<07:04,  5.73s/it, train loss=0.3306, val ΔE00=2.429, best=2.377]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:34<06:56,  5.70s/it, train loss=0.3306, val ΔE00=2.429, best=2.377]Training (xattn/resnet18):  27%|██▋       | 27/100 [02:34<06:56,  5.70s/it, train loss=0.3082, val ΔE00=2.451, best=2.377]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:40<06:48,  5.67s/it, train loss=0.3082, val ΔE00=2.451, best=2.377]Training (xattn/resnet18):  28%|██▊       | 28/100 [02:40<06:48,  5.67s/it, train loss=0.3629, val ΔE00=2.738, best=2.377]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:46<06:41,  5.66s/it, train loss=0.3629, val ΔE00=2.738, best=2.377]Training (xattn/resnet18):  29%|██▉       | 29/100 [02:46<06:41,  5.66s/it, train loss=0.3677, val ΔE00=2.677, best=2.377]Training (xattn/resnet18):  30%|███       | 30/100 [02:51<06:40,  5.72s/it, train loss=0.3677, val ΔE00=2.677, best=2.377]Training (xattn/resnet18):  30%|███       | 30/100 [02:51<06:40,  5.72s/it, train loss=0.4056, val ΔE00=2.799, best=2.377]Training (xattn/resnet18):  31%|███       | 31/100 [02:57<06:34,  5.72s/it, train loss=0.4056, val ΔE00=2.799, best=2.377]Training (xattn/resnet18):  31%|███       | 31/100 [02:57<06:34,  5.72s/it, train loss=0.3692, val ΔE00=2.517, best=2.377]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:03<06:27,  5.69s/it, train loss=0.3692, val ΔE00=2.517, best=2.377]Training (xattn/resnet18):  32%|███▏      | 32/100 [03:03<06:27,  5.69s/it, train loss=0.4111, val ΔE00=2.518, best=2.377]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:08<06:19,  5.67s/it, train loss=0.4111, val ΔE00=2.518, best=2.377]Training (xattn/resnet18):  33%|███▎      | 33/100 [03:08<06:19,  5.67s/it, train loss=0.4056, val ΔE00=2.869, best=2.377]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:14<06:12,  5.65s/it, train loss=0.4056, val ΔE00=2.869, best=2.377]Training (xattn/resnet18):  34%|███▍      | 34/100 [03:14<06:12,  5.65s/it, train loss=0.3998, val ΔE00=2.469, best=2.377]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:20<06:11,  5.72s/it, train loss=0.3998, val ΔE00=2.469, best=2.377]Training (xattn/resnet18):  35%|███▌      | 35/100 [03:20<06:11,  5.72s/it, train loss=0.4266, val ΔE00=2.429, best=2.377]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:26<06:06,  5.72s/it, train loss=0.4266, val ΔE00=2.429, best=2.377]Training (xattn/resnet18):  36%|███▌      | 36/100 [03:26<06:06,  5.72s/it, train loss=0.4604, val ΔE00=2.721, best=2.377]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:31<05:58,  5.69s/it, train loss=0.4604, val ΔE00=2.721, best=2.377]Training (xattn/resnet18):  37%|███▋      | 37/100 [03:31<05:58,  5.69s/it, train loss=0.4715, val ΔE00=2.427, best=2.377]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:37<05:51,  5.66s/it, train loss=0.4715, val ΔE00=2.427, best=2.377]Training (xattn/resnet18):  38%|███▊      | 38/100 [03:37<05:51,  5.66s/it, train loss=0.4340, val ΔE00=2.520, best=2.377]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:42<05:44,  5.65s/it, train loss=0.4340, val ΔE00=2.520, best=2.377]Training (xattn/resnet18):  39%|███▉      | 39/100 [03:42<05:44,  5.65s/it, train loss=0.4409, val ΔE00=2.539, best=2.377]Training (xattn/resnet18):  40%|████      | 40/100 [03:48<05:42,  5.71s/it, train loss=0.4409, val ΔE00=2.539, best=2.377]Training (xattn/resnet18):  40%|████      | 40/100 [03:48<05:42,  5.71s/it, train loss=0.5011, val ΔE00=2.389, best=2.377]Training (xattn/resnet18):  41%|████      | 41/100 [03:54<05:36,  5.71s/it, train loss=0.5011, val ΔE00=2.389, best=2.377]Training (xattn/resnet18):  41%|████      | 41/100 [03:54<05:36,  5.71s/it, train loss=0.5047, val ΔE00=2.485, best=2.377]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:00<05:29,  5.68s/it, train loss=0.5047, val ΔE00=2.485, best=2.377]Training (xattn/resnet18):  42%|████▏     | 42/100 [04:00<05:29,  5.68s/it, train loss=0.4953, val ΔE00=2.609, best=2.377]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:05<05:22,  5.66s/it, train loss=0.4953, val ΔE00=2.609, best=2.377]Training (xattn/resnet18):  43%|████▎     | 43/100 [04:05<05:22,  5.66s/it, train loss=0.5174, val ΔE00=2.576, best=2.377]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:11<05:16,  5.64s/it, train loss=0.5174, val ΔE00=2.576, best=2.377]Training (xattn/resnet18):  44%|████▍     | 44/100 [04:11<05:16,  5.64s/it, train loss=0.4835, val ΔE00=2.839, best=2.377]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:17<05:14,  5.71s/it, train loss=0.4835, val ΔE00=2.839, best=2.377]Training (xattn/resnet18):  45%|████▌     | 45/100 [04:17<05:14,  5.71s/it, train loss=0.5153, val ΔE00=2.405, best=2.377]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:22<05:08,  5.71s/it, train loss=0.5153, val ΔE00=2.405, best=2.377]Training (xattn/resnet18):  46%|████▌     | 46/100 [04:22<05:08,  5.71s/it, train loss=0.5183, val ΔE00=2.415, best=2.377]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:28<05:01,  5.68s/it, train loss=0.5183, val ΔE00=2.415, best=2.377]Training (xattn/resnet18):  47%|████▋     | 47/100 [04:28<05:01,  5.68s/it, train loss=0.4899, val ΔE00=2.436, best=2.377]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:34<04:54,  5.66s/it, train loss=0.4899, val ΔE00=2.436, best=2.377]Training (xattn/resnet18):  48%|████▊     | 48/100 [04:34<04:54,  5.66s/it, train loss=0.5739, val ΔE00=2.476, best=2.377]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:39<04:47,  5.64s/it, train loss=0.5739, val ΔE00=2.476, best=2.377]Training (xattn/resnet18):  49%|████▉     | 49/100 [04:39<04:47,  5.64s/it, train loss=0.5409, val ΔE00=2.511, best=2.377]Training (xattn/resnet18):  50%|█████     | 50/100 [04:45<04:45,  5.72s/it, train loss=0.5409, val ΔE00=2.511, best=2.377]Training (xattn/resnet18):  50%|█████     | 50/100 [04:45<04:45,  5.72s/it, train loss=0.5307, val ΔE00=2.417, best=2.377]Training (xattn/resnet18):  51%|█████     | 51/100 [04:51<04:39,  5.71s/it, train loss=0.5307, val ΔE00=2.417, best=2.377]Training (xattn/resnet18):  51%|█████     | 51/100 [04:51<04:39,  5.71s/it, train loss=0.4853, val ΔE00=2.594, best=2.377]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:56<04:32,  5.68s/it, train loss=0.4853, val ΔE00=2.594, best=2.377]Training (xattn/resnet18):  52%|█████▏    | 52/100 [04:56<04:32,  5.68s/it, train loss=0.5396, val ΔE00=2.633, best=2.377]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:02<04:26,  5.66s/it, train loss=0.5396, val ΔE00=2.633, best=2.377]Training (xattn/resnet18):  53%|█████▎    | 53/100 [05:02<04:26,  5.66s/it, train loss=0.5348, val ΔE00=2.481, best=2.377]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:08<04:19,  5.64s/it, train loss=0.5348, val ΔE00=2.481, best=2.377]Training (xattn/resnet18):  54%|█████▍    | 54/100 [05:08<04:19,  5.64s/it, train loss=0.5568, val ΔE00=2.483, best=2.377]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:14<04:16,  5.71s/it, train loss=0.5568, val ΔE00=2.483, best=2.377]Training (xattn/resnet18):  55%|█████▌    | 55/100 [05:14<04:16,  5.71s/it, train loss=0.5396, val ΔE00=2.396, best=2.377]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:19<04:11,  5.72s/it, train loss=0.5396, val ΔE00=2.396, best=2.377]Training (xattn/resnet18):  56%|█████▌    | 56/100 [05:19<04:11,  5.72s/it, train loss=0.5185, val ΔE00=2.428, best=2.377]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:25<04:04,  5.69s/it, train loss=0.5185, val ΔE00=2.428, best=2.377]Training (xattn/resnet18):  57%|█████▋    | 57/100 [05:25<04:04,  5.69s/it, train loss=0.5350, val ΔE00=2.567, best=2.377]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:31<03:57,  5.67s/it, train loss=0.5350, val ΔE00=2.567, best=2.377]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:31<03:57,  5.67s/it, train loss=0.5695, val ΔE00=2.491, best=2.377]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:36<03:57,  5.67s/it, train loss=0.5653, val ΔE00=2.504, early_stop=yes]Training (xattn/resnet18):  58%|█████▊    | 58/100 [05:36<04:03,  5.80s/it, train loss=0.5653, val ΔE00=2.504, early_stop=yes]
[early] stop at epoch 59 (best de00=2.3769 @ 23)
[done] best ΔE00=2.377 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg/full/xattn__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean+meta/final_summary.json (kind=val)
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/no-bg/full --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/no-bg/no-bg_full_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/no-bg/no-bg_full_summary_groups.csv --md_report /home/dominik/repo/results/results/no-bg/no-bg_full_summary_report.md --grid_keys backbone features model --prefer_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 48 checkpoint files and 24 json summaries.
[diag] loaded records by kind: {'val': 72}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/no-bg/no-bg_full_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/no-bg/no-bg_full_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/no-bg/no-bg_full_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/no-bg/no-bg_full_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/no-bg/no-bg_full_summary_report.md

[ELIMINATION CANDIDATES]
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/no-bg/full --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/no-bg/no-bg_full_pretest_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/no-bg/no-bg_full_pretest_summary_groups.csv --md_report /home/dominik/repo/results/results/no-bg/no-bg_full_pretest_summary_report.md --grid_keys backbone features model --prefer_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 48 checkpoint files and 24 json summaries.
[diag] loaded records by kind: {'val': 72}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/no-bg/no-bg_full_pretest_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/no-bg/no-bg_full_pretest_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/no-bg/no-bg_full_pretest_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/no-bg/no-bg_full_pretest_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/no-bg/no-bg_full_pretest_summary_report.md

[ELIMINATION CANDIDATES]
[eval] Selecting up to top_k=20 unique group winner(s) for TEST in FULL-only mode.
[eval][debug] winners (grouped): [{'model': 'xattn', 'backbone': 'smallcnn', 'features': 'image+mean+meta'}, {'model': 'xattn', 'backbone': 'smallcnn', 'features': 'image+mean'}, {'model': 'film', 'backbone': 'resnet18', 'features': 'image+mean+meta'}, {'model': 'film', 'backbone': 'smallcnn', 'features': 'image+mean+meta'}, {'model': 'film', 'backbone': 'resnet18', 'features': 'image'}, {'model': 'xattn', 'backbone': 'resnet18', 'features': 'image+mean'}, {'model': 'film', 'backbone': 'resnet18', 'features': 'image+mean'}, {'model': 'xattn', 'backbone': 'smallcnn', 'features': 'image+meta'}, {'model': 'film', 'backbone': 'smallcnn', 'features': 'image+mean'}, {'model': 'film', 'backbone': 'resnet18', 'features': 'image+meta'}, {'model': 'xattn', 'backbone': 'resnet18', 'features': 'image+meta'}, {'model': 'xattn', 'backbone': 'resnet18', 'features': 'image+mean+meta'}, {'model': 'late', 'backbone': 'smallcnn', 'features': 'image+mean+meta'}, {'model': 'late', 'backbone': 'resnet18', 'features': 'image+mean'}, {'model': 'late', 'backbone': 'resnet18', 'features': 'image+mean+meta'}, {'model': 'late', 'backbone': 'resnet18', 'features': 'image'}, {'model': 'late', 'backbone': 'resnet18', 'features': 'image+meta'}, {'model': 'xattn', 'backbone': 'resnet18', 'features': 'image'}, {'model': 'film', 'backbone': 'smallcnn', 'features': 'image+meta'}, {'model': 'late', 'backbone': 'smallcnn', 'features': 'image+mean'}]
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/xattn__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+mean+meta/xattn_smallcnn_e063_de001.7373.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/6e87c305e854/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/xattn__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+mean/xattn_smallcnn_e067_de001.7966.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/14159ef67ff2/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/film__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+mean+meta/film_resnet18_e067_de001.8758.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/359cb7704fca/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/film__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean+meta/film_smallcnn_e042_de001.8847.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/caf256c9b8a9/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/film__resnet18__image__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image/film_resnet18_e044_de001.8992.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/21a0190ee6f1/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/xattn__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean/xattn_resnet18_e061_de001.9077.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/b2b2bd1d4bf3/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/film__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+mean/film_resnet18_e058_de001.9341.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/d44325f74475/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/xattn__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=smallcnn__features=image+meta/xattn_smallcnn_e064_de001.9614.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/4a5fd0d3a900/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/film__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean/film_smallcnn_e057_de001.9742.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/45720b8dd8be/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/film__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=resnet18__features=image+meta/film_resnet18_e055_de001.9745.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/493fa80601ab/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/xattn__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+meta/xattn_resnet18_e069_de002.0307.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/657b7d8e311f/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/xattn__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image+mean+meta/xattn_resnet18_e070_de002.0523.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/e21aba1e4b1a/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/late__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean+meta/late_smallcnn_e060_de002.0682.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/89c22698f5c6/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/late__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean/late_resnet18_e061_de002.0746.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/09e5536fc9a0/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/late__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean+meta/late_resnet18_e069_de002.0799.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/55fac85d0c33/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/late__resnet18__image__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image/late_resnet18_e055_de002.1335.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/0f27f23429e2/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/late__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+meta/late_resnet18_e056_de002.1443.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/ee46c590a383/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/xattn__resnet18__image__-focus-__layersnone__ts-2__s101__model=xattn__backbone=resnet18__features=image/xattn_resnet18_e024_de002.1505.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/849274beff50/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/film__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+meta/film_smallcnn_e059_de002.1911.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/adb9c1555e68/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.engine.eval_ckpt --ckpt ./checkpoints/results/no-bg/full/late__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean/late_smallcnn_e080_de002.1979.pt --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --test_split_file ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json --monitor de00 --out_json ./checkpoints/results/no-bg/full/final_test/04855dd162f4/final_summary.json --token_stage -2.0
usage: eval_ckpt.py [-h] --ckpt CKPT --images_dir IMAGES_DIR --json_dir
                    JSON_DIR --labels_csv LABELS_CSV --test_split_file
                    TEST_SPLIT_FILE --monitor MONITOR [--device DEVICE]
                    [--outdir OUTDIR] [--out_json OUT_JSON]
eval_ckpt.py: error: unrecognized arguments: --token_stage -2.0
[eval] winners(full-only): ok=0 fail=20
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/no-bg/full --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/no-bg/no-bg_single_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/no-bg/no-bg_single_summary_groups.csv --md_report /home/dominik/repo/results/results/no-bg/no-bg_single_summary_report.md --grid_keys backbone features model --prefer_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 48 checkpoint files and 24 json summaries.
[diag] loaded records by kind: {'val': 72}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/no-bg/no-bg_single_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/no-bg/no-bg_single_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/no-bg/no-bg_single_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/no-bg/no-bg_single_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/no-bg/no-bg_single_summary_report.md

[ELIMINATION CANDIDATES]
[summary] RUN: /home/dominik/venvs/pantone-cu121/bin/python -m src.analysis.summarize_sweep --ckpt_dir ./checkpoints/results/no-bg/full ./checkpoints/results/no-bg/full/final_test --monitor de00 --mode min --skip_bad --auto_group --report_keep images_dir included_folders epochs mse_weight_epochs optim lr_auto lr_schedule weight_decay --extra_group_keys model --include_json --out_csv /home/dominik/repo/results/results/no-bg/no-bg_test_summary_runs.csv --out_groups_csv /home/dominik/repo/results/results/no-bg/no-bg_test_summary_groups.csv --md_report /home/dominik/repo/results/results/no-bg/no-bg_test_summary_report.md --grid_keys backbone features model --prefer_test --only_test
/home/dominik/repo/src/analysis/summarize_sweep.py:568: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  runs_df[col] = runs_df[col].fillna(vals[0])
[info] Found 48 checkpoint files and 24 json summaries.
[diag] loaded records by kind: {'val': 72}
[ok] Wrote per-run summary: /home/dominik/repo/results/results/no-bg/no-bg_test_summary_runs.csv
[ok] Wrote best-by-grid: /home/dominik/repo/results/results/no-bg/no-bg_test_summary_runs_best_by_grid.csv
[ok] Wrote columns meta: /home/dominik/repo/results/results/no-bg/no-bg_test_summary_runs_columns_meta.json
[ok] Wrote grouped summary: /home/dominik/repo/results/results/no-bg/no-bg_test_summary_groups.csv
[ok] Wrote markdown report: /home/dominik/repo/results/results/no-bg/no-bg_test_summary_report.md

[ELIMINATION CANDIDATES]
[analysis] runs_csv=/home/dominik/repo/results/results/no-bg/analysis/analysis_input.csv
[analysis] mode=both test_split_file=./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json outdir=/home/dominik/repo/results/results/no-bg/analysis
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/217021d3d0a9/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/217021d3d0a9/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/2087425f8cd4/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/2087425f8cd4/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/212bdf2b6e71/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/212bdf2b6e71/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/712fb3604eae/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/712fb3604eae/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/41a62ec7ec80/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/41a62ec7ec80/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/b1c5369cde43/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/b1c5369cde43/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/70f6bb681e64/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/70f6bb681e64/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/590915ceb157/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/590915ceb157/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/fae892177eee/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/fae892177eee/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/5d334d895b08/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/5d334d895b08/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/367246e9d25c/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/367246e9d25c/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/0654a58f64b4/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/0654a58f64b4/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/286cb3e3ee11/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/286cb3e3ee11/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/615299a2596e/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/615299a2596e/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/14a793874137/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/14a793874137/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/227058fa5f99/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/227058fa5f99/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/3dcd3ae4334e/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/3dcd3ae4334e/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/279595b9fed2/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/279595b9fed2/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/0d2f4f535cbb/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/0d2f4f535cbb/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/56cfe7d9bf07/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/56cfe7d9bf07/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/87039354abfa/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/87039354abfa/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/935b052f29ae/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/935b052f29ae/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/387375c050e7/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[analysis] inferred attn_dim=256 from checkpoint.
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/387375c050e7/test_report.html
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/16235f199369/val_report.html
[split] loaded <- ./splits/sweep/IF=focus__EF=NONE__HC=0__SEED=101/test.json
[info] Saved copy of 414 test samples to /home/data/Pantone/test-dominik/test.csv
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1656 val=0 test=414
[ok] Wrote HTML report → /home/dominik/repo/results/results/no-bg/analysis/16235f199369/test_report.html
[ok] Wrote manifest: /home/dominik/repo/results/results/no-bg/analysis/analysis_manifest.csv
[sweep] FULL-only mode complete.
[sweep] OK: ./configs/results/no-bg.yaml

