[sweep] === ./configs/results/no-bg2.yaml ===
[sweep] cmd: python [sweep] cmd: -u [sweep] cmd: -m [sweep] cmd: src.engine.sweep [sweep] cmd: --config [sweep] cmd: ./configs/results/no-bg2.yaml [sweep] cmd: --only_full [sweep] cmd: --auto-summary [sweep] cmd: --analysis [sweep] cmd: --eval-winners [sweep] cmd: --test_split_file [sweep] cmd: AUTO [sweep] cmd: --skip-existing 
[sweep] FULL-only mode: training full stage for all runs.
[sweep] === Run 1/24 ===
[sweep] id=001_model=late__backbone=smallcnn__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone smallcnn --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:04<08:09,  4.95s/it]Training (late/smallcnn):   1%|          | 1/100 [00:04<08:09,  4.95s/it, train loss=0.0074, val ΔE00=7.396, best=7.396]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:37,  4.67s/it, train loss=0.0074, val ΔE00=7.396, best=7.396]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:37,  4.67s/it, train loss=0.0082, val ΔE00=6.167, best=6.167]Training (late/smallcnn):   3%|▎         | 3/100 [00:13<07:24,  4.58s/it, train loss=0.0082, val ΔE00=6.167, best=6.167]Training (late/smallcnn):   3%|▎         | 3/100 [00:13<07:24,  4.58s/it, train loss=0.0154, val ΔE00=5.838, best=5.838]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:15,  4.54s/it, train loss=0.0154, val ΔE00=5.838, best=5.838]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:15,  4.54s/it, train loss=0.0261, val ΔE00=5.283, best=5.283]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:16,  4.59s/it, train loss=0.0261, val ΔE00=5.283, best=5.283]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:16,  4.59s/it, train loss=0.0391, val ΔE00=7.269, best=5.283]Training (late/smallcnn):   6%|▌         | 6/100 [00:27<07:11,  4.59s/it, train loss=0.0391, val ΔE00=7.269, best=5.283]Training (late/smallcnn):   6%|▌         | 6/100 [00:27<07:11,  4.59s/it, train loss=0.0572, val ΔE00=5.329, best=5.283]Training (late/smallcnn):   7%|▋         | 7/100 [00:32<07:03,  4.55s/it, train loss=0.0572, val ΔE00=5.329, best=5.283]Training (late/smallcnn):   7%|▋         | 7/100 [00:32<07:03,  4.55s/it, train loss=0.0765, val ΔE00=4.875, best=4.875]Training (late/smallcnn):   8%|▊         | 8/100 [00:36<06:56,  4.52s/it, train loss=0.0765, val ΔE00=4.875, best=4.875]Training (late/smallcnn):   8%|▊         | 8/100 [00:36<06:56,  4.52s/it, train loss=0.1042, val ΔE00=5.578, best=4.875]Training (late/smallcnn):   9%|▉         | 9/100 [00:41<06:49,  4.51s/it, train loss=0.1042, val ΔE00=5.578, best=4.875]Training (late/smallcnn):   9%|▉         | 9/100 [00:41<06:49,  4.51s/it, train loss=0.1313, val ΔE00=4.679, best=4.679]Training (late/smallcnn):  10%|█         | 10/100 [00:45<06:50,  4.56s/it, train loss=0.1313, val ΔE00=4.679, best=4.679]Training (late/smallcnn):  10%|█         | 10/100 [00:45<06:50,  4.56s/it, train loss=0.1578, val ΔE00=4.500, best=4.500]Training (late/smallcnn):  11%|█         | 11/100 [00:50<06:47,  4.58s/it, train loss=0.1578, val ΔE00=4.500, best=4.500]Training (late/smallcnn):  11%|█         | 11/100 [00:50<06:47,  4.58s/it, train loss=0.1911, val ΔE00=5.740, best=4.500]Training (late/smallcnn):  12%|█▏        | 12/100 [00:54<06:41,  4.56s/it, train loss=0.1911, val ΔE00=5.740, best=4.500]Training (late/smallcnn):  12%|█▏        | 12/100 [00:54<06:41,  4.56s/it, train loss=0.2315, val ΔE00=4.605, best=4.500]Training (late/smallcnn):  13%|█▎        | 13/100 [00:59<06:36,  4.56s/it, train loss=0.2315, val ΔE00=4.605, best=4.500]Training (late/smallcnn):  13%|█▎        | 13/100 [00:59<06:36,  4.56s/it, train loss=0.2571, val ΔE00=5.370, best=4.500]Training (late/smallcnn):  14%|█▍        | 14/100 [01:03<06:32,  4.56s/it, train loss=0.2571, val ΔE00=5.370, best=4.500]Training (late/smallcnn):  14%|█▍        | 14/100 [01:03<06:32,  4.56s/it, train loss=0.3042, val ΔE00=4.695, best=4.500]Training (late/smallcnn):  15%|█▌        | 15/100 [01:08<06:34,  4.65s/it, train loss=0.3042, val ΔE00=4.695, best=4.500]Training (late/smallcnn):  15%|█▌        | 15/100 [01:08<06:34,  4.65s/it, train loss=0.3463, val ΔE00=4.557, best=4.500]Training (late/smallcnn):  16%|█▌        | 16/100 [01:13<06:29,  4.64s/it, train loss=0.3463, val ΔE00=4.557, best=4.500]Training (late/smallcnn):  16%|█▌        | 16/100 [01:13<06:29,  4.64s/it, train loss=0.3824, val ΔE00=4.124, best=4.124]Training (late/smallcnn):  17%|█▋        | 17/100 [01:18<06:22,  4.61s/it, train loss=0.3824, val ΔE00=4.124, best=4.124]Training (late/smallcnn):  17%|█▋        | 17/100 [01:18<06:22,  4.61s/it, train loss=0.4479, val ΔE00=4.654, best=4.124]Training (late/smallcnn):  18%|█▊        | 18/100 [01:22<06:15,  4.58s/it, train loss=0.4479, val ΔE00=4.654, best=4.124]Training (late/smallcnn):  18%|█▊        | 18/100 [01:22<06:15,  4.58s/it, train loss=0.4733, val ΔE00=4.627, best=4.124]Training (late/smallcnn):  19%|█▉        | 19/100 [01:26<06:08,  4.55s/it, train loss=0.4733, val ΔE00=4.627, best=4.124]Training (late/smallcnn):  19%|█▉        | 19/100 [01:26<06:08,  4.55s/it, train loss=0.5329, val ΔE00=3.975, best=3.975]Training (late/smallcnn):  20%|██        | 20/100 [01:31<06:06,  4.59s/it, train loss=0.5329, val ΔE00=3.975, best=3.975]Training (late/smallcnn):  20%|██        | 20/100 [01:31<06:06,  4.59s/it, train loss=0.6130, val ΔE00=5.109, best=3.975]Training (late/smallcnn):  21%|██        | 21/100 [01:36<06:02,  4.59s/it, train loss=0.6130, val ΔE00=5.109, best=3.975]Training (late/smallcnn):  21%|██        | 21/100 [01:36<06:02,  4.59s/it, train loss=0.6503, val ΔE00=4.509, best=3.975]Training (late/smallcnn):  22%|██▏       | 22/100 [01:40<05:54,  4.55s/it, train loss=0.6503, val ΔE00=4.509, best=3.975]Training (late/smallcnn):  22%|██▏       | 22/100 [01:40<05:54,  4.55s/it, train loss=0.7101, val ΔE00=4.171, best=3.975]Training (late/smallcnn):  23%|██▎       | 23/100 [01:45<05:48,  4.53s/it, train loss=0.7101, val ΔE00=4.171, best=3.975]Training (late/smallcnn):  23%|██▎       | 23/100 [01:45<05:48,  4.53s/it, train loss=0.7652, val ΔE00=4.535, best=3.975]Training (late/smallcnn):  24%|██▍       | 24/100 [01:49<05:42,  4.51s/it, train loss=0.7652, val ΔE00=4.535, best=3.975]Training (late/smallcnn):  24%|██▍       | 24/100 [01:49<05:42,  4.51s/it, train loss=0.8352, val ΔE00=4.741, best=3.975]Training (late/smallcnn):  25%|██▌       | 25/100 [01:54<05:42,  4.56s/it, train loss=0.8352, val ΔE00=4.741, best=3.975]Training (late/smallcnn):  25%|██▌       | 25/100 [01:54<05:42,  4.56s/it, train loss=0.8991, val ΔE00=4.061, best=3.975]Training (late/smallcnn):  26%|██▌       | 26/100 [01:58<05:37,  4.56s/it, train loss=0.8991, val ΔE00=4.061, best=3.975]Training (late/smallcnn):  26%|██▌       | 26/100 [01:58<05:37,  4.56s/it, train loss=0.9457, val ΔE00=4.113, best=3.975]Training (late/smallcnn):  27%|██▋       | 27/100 [02:03<05:30,  4.53s/it, train loss=0.9457, val ΔE00=4.113, best=3.975]Training (late/smallcnn):  27%|██▋       | 27/100 [02:03<05:30,  4.53s/it, train loss=1.0202, val ΔE00=4.272, best=3.975]Training (late/smallcnn):  28%|██▊       | 28/100 [02:07<05:24,  4.51s/it, train loss=1.0202, val ΔE00=4.272, best=3.975]Training (late/smallcnn):  28%|██▊       | 28/100 [02:07<05:24,  4.51s/it, train loss=1.0537, val ΔE00=4.386, best=3.975]Training (late/smallcnn):  29%|██▉       | 29/100 [02:12<05:19,  4.50s/it, train loss=1.0537, val ΔE00=4.386, best=3.975]Training (late/smallcnn):  29%|██▉       | 29/100 [02:12<05:19,  4.50s/it, train loss=1.1231, val ΔE00=4.072, best=3.975]Training (late/smallcnn):  30%|███       | 30/100 [02:16<05:18,  4.55s/it, train loss=1.1231, val ΔE00=4.072, best=3.975]Training (late/smallcnn):  30%|███       | 30/100 [02:16<05:18,  4.55s/it, train loss=1.2310, val ΔE00=4.069, best=3.975]Training (late/smallcnn):  31%|███       | 31/100 [02:21<05:15,  4.57s/it, train loss=1.2310, val ΔE00=4.069, best=3.975]Training (late/smallcnn):  31%|███       | 31/100 [02:21<05:15,  4.57s/it, train loss=1.3095, val ΔE00=4.467, best=3.975]Training (late/smallcnn):  32%|███▏      | 32/100 [02:26<05:08,  4.53s/it, train loss=1.3095, val ΔE00=4.467, best=3.975]Training (late/smallcnn):  32%|███▏      | 32/100 [02:26<05:08,  4.53s/it, train loss=1.3073, val ΔE00=3.781, best=3.781]Training (late/smallcnn):  33%|███▎      | 33/100 [02:30<05:02,  4.51s/it, train loss=1.3073, val ΔE00=3.781, best=3.781]Training (late/smallcnn):  33%|███▎      | 33/100 [02:30<05:02,  4.51s/it, train loss=1.3986, val ΔE00=3.936, best=3.781]Training (late/smallcnn):  34%|███▍      | 34/100 [02:34<04:57,  4.50s/it, train loss=1.3986, val ΔE00=3.936, best=3.781]Training (late/smallcnn):  34%|███▍      | 34/100 [02:34<04:57,  4.50s/it, train loss=1.4789, val ΔE00=3.842, best=3.781]Training (late/smallcnn):  35%|███▌      | 35/100 [02:39<04:55,  4.55s/it, train loss=1.4789, val ΔE00=3.842, best=3.781]Training (late/smallcnn):  35%|███▌      | 35/100 [02:39<04:55,  4.55s/it, train loss=1.5796, val ΔE00=4.405, best=3.781]Training (late/smallcnn):  36%|███▌      | 36/100 [02:44<04:51,  4.56s/it, train loss=1.5796, val ΔE00=4.405, best=3.781]Training (late/smallcnn):  36%|███▌      | 36/100 [02:44<04:51,  4.56s/it, train loss=1.6391, val ΔE00=4.640, best=3.781]Training (late/smallcnn):  37%|███▋      | 37/100 [02:48<04:45,  4.53s/it, train loss=1.6391, val ΔE00=4.640, best=3.781]Training (late/smallcnn):  37%|███▋      | 37/100 [02:48<04:45,  4.53s/it, train loss=1.7100, val ΔE00=4.069, best=3.781]Training (late/smallcnn):  38%|███▊      | 38/100 [02:53<04:39,  4.51s/it, train loss=1.7100, val ΔE00=4.069, best=3.781]Training (late/smallcnn):  38%|███▊      | 38/100 [02:53<04:39,  4.51s/it, train loss=1.7396, val ΔE00=4.132, best=3.781]Training (late/smallcnn):  39%|███▉      | 39/100 [02:57<04:34,  4.50s/it, train loss=1.7396, val ΔE00=4.132, best=3.781]Training (late/smallcnn):  39%|███▉      | 39/100 [02:57<04:34,  4.50s/it, train loss=1.8875, val ΔE00=3.907, best=3.781]Training (late/smallcnn):  40%|████      | 40/100 [03:02<04:33,  4.56s/it, train loss=1.8875, val ΔE00=3.907, best=3.781]Training (late/smallcnn):  40%|████      | 40/100 [03:02<04:33,  4.56s/it, train loss=1.9667, val ΔE00=4.632, best=3.781]Training (late/smallcnn):  41%|████      | 41/100 [03:06<04:28,  4.56s/it, train loss=1.9667, val ΔE00=4.632, best=3.781]Training (late/smallcnn):  41%|████      | 41/100 [03:06<04:28,  4.56s/it, train loss=2.0076, val ΔE00=3.822, best=3.781]Training (late/smallcnn):  42%|████▏     | 42/100 [03:11<04:22,  4.53s/it, train loss=2.0076, val ΔE00=3.822, best=3.781]Training (late/smallcnn):  42%|████▏     | 42/100 [03:11<04:22,  4.53s/it, train loss=2.1296, val ΔE00=4.259, best=3.781]Training (late/smallcnn):  43%|████▎     | 43/100 [03:15<04:17,  4.51s/it, train loss=2.1296, val ΔE00=4.259, best=3.781]Training (late/smallcnn):  43%|████▎     | 43/100 [03:15<04:17,  4.51s/it, train loss=2.1263, val ΔE00=3.915, best=3.781]Training (late/smallcnn):  44%|████▍     | 44/100 [03:20<04:11,  4.49s/it, train loss=2.1263, val ΔE00=3.915, best=3.781]Training (late/smallcnn):  44%|████▍     | 44/100 [03:20<04:11,  4.49s/it, train loss=2.1768, val ΔE00=4.362, best=3.781]Training (late/smallcnn):  45%|████▌     | 45/100 [03:24<04:10,  4.55s/it, train loss=2.1768, val ΔE00=4.362, best=3.781]Training (late/smallcnn):  45%|████▌     | 45/100 [03:24<04:10,  4.55s/it, train loss=2.2526, val ΔE00=4.131, best=3.781]Training (late/smallcnn):  46%|████▌     | 46/100 [03:29<04:06,  4.57s/it, train loss=2.2526, val ΔE00=4.131, best=3.781]Training (late/smallcnn):  46%|████▌     | 46/100 [03:29<04:06,  4.57s/it, train loss=2.3403, val ΔE00=3.772, best=3.772]Training (late/smallcnn):  47%|████▋     | 47/100 [03:33<04:00,  4.54s/it, train loss=2.3403, val ΔE00=3.772, best=3.772]Training (late/smallcnn):  47%|████▋     | 47/100 [03:33<04:00,  4.54s/it, train loss=2.4766, val ΔE00=3.990, best=3.772]Training (late/smallcnn):  48%|████▊     | 48/100 [03:38<03:55,  4.52s/it, train loss=2.4766, val ΔE00=3.990, best=3.772]Training (late/smallcnn):  48%|████▊     | 48/100 [03:38<03:55,  4.52s/it, train loss=2.4447, val ΔE00=3.955, best=3.772]Training (late/smallcnn):  49%|████▉     | 49/100 [03:42<03:49,  4.51s/it, train loss=2.4447, val ΔE00=3.955, best=3.772]Training (late/smallcnn):  49%|████▉     | 49/100 [03:42<03:49,  4.51s/it, train loss=2.5079, val ΔE00=4.310, best=3.772]Training (late/smallcnn):  50%|█████     | 50/100 [03:47<03:48,  4.57s/it, train loss=2.5079, val ΔE00=4.310, best=3.772]Training (late/smallcnn):  50%|█████     | 50/100 [03:47<03:48,  4.57s/it, train loss=2.5644, val ΔE00=4.077, best=3.772]Training (late/smallcnn):  51%|█████     | 51/100 [03:52<03:44,  4.57s/it, train loss=2.5644, val ΔE00=4.077, best=3.772]Training (late/smallcnn):  51%|█████     | 51/100 [03:52<03:44,  4.57s/it, train loss=2.6673, val ΔE00=3.629, best=3.629]Training (late/smallcnn):  52%|█████▏    | 52/100 [03:56<03:38,  4.54s/it, train loss=2.6673, val ΔE00=3.629, best=3.629]Training (late/smallcnn):  52%|█████▏    | 52/100 [03:56<03:38,  4.54s/it, train loss=2.6912, val ΔE00=3.653, best=3.629]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:01<03:32,  4.52s/it, train loss=2.6912, val ΔE00=3.653, best=3.629]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:01<03:32,  4.52s/it, train loss=2.6639, val ΔE00=4.018, best=3.629]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:05<03:27,  4.51s/it, train loss=2.6639, val ΔE00=4.018, best=3.629]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:05<03:27,  4.51s/it, train loss=2.8008, val ΔE00=3.851, best=3.629]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:10<03:25,  4.56s/it, train loss=2.8008, val ΔE00=3.851, best=3.629]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:10<03:25,  4.56s/it, train loss=2.8749, val ΔE00=3.943, best=3.629]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:14<03:20,  4.56s/it, train loss=2.8749, val ΔE00=3.943, best=3.629]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:14<03:20,  4.56s/it, train loss=2.9241, val ΔE00=4.190, best=3.629]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:19<03:15,  4.54s/it, train loss=2.9241, val ΔE00=4.190, best=3.629]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:19<03:15,  4.54s/it, train loss=2.9401, val ΔE00=3.719, best=3.629]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:23<03:09,  4.52s/it, train loss=2.9401, val ΔE00=3.719, best=3.629]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:23<03:09,  4.52s/it, train loss=3.0045, val ΔE00=3.927, best=3.629]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:28<03:04,  4.50s/it, train loss=3.0045, val ΔE00=3.927, best=3.629]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:28<03:04,  4.50s/it, train loss=3.1384, val ΔE00=3.947, best=3.629]Training (late/smallcnn):  60%|██████    | 60/100 [04:33<03:02,  4.56s/it, train loss=3.1384, val ΔE00=3.947, best=3.629]Training (late/smallcnn):  60%|██████    | 60/100 [04:33<03:02,  4.56s/it, train loss=3.1881, val ΔE00=4.548, best=3.629]Training (late/smallcnn):  60%|██████    | 60/100 [04:37<03:02,  4.56s/it, train loss=3.2596, val ΔE00=4.031, early_stop=yes]Training (late/smallcnn):  60%|██████    | 60/100 [04:37<03:05,  4.63s/it, train loss=3.2596, val ΔE00=4.031, early_stop=yes]
[early] stop at epoch 61 (best de00=3.6294 @ 51)
[done] best ΔE00=3.629 over 61 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/late__smallcnn__image__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image/final_summary.json (kind=val)
[sweep] === Run 2/24 ===
[sweep] id=002_model=late__backbone=smallcnn__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone smallcnn --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image+mean, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:27,  5.13s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:27,  5.13s/it, train loss=0.0075, val ΔE00=6.218, best=6.218]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:53,  4.83s/it, train loss=0.0075, val ΔE00=6.218, best=6.218]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:53,  4.83s/it, train loss=0.0082, val ΔE00=5.694, best=5.694]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:38,  4.73s/it, train loss=0.0082, val ΔE00=5.694, best=5.694]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:38,  4.73s/it, train loss=0.0151, val ΔE00=4.928, best=4.928]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:29,  4.68s/it, train loss=0.0151, val ΔE00=4.928, best=4.928]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:29,  4.68s/it, train loss=0.0247, val ΔE00=5.000, best=4.928]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:29,  4.74s/it, train loss=0.0247, val ΔE00=5.000, best=4.928]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:29,  4.74s/it, train loss=0.0395, val ΔE00=5.119, best=4.928]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:24,  4.73s/it, train loss=0.0395, val ΔE00=5.119, best=4.928]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:24,  4.73s/it, train loss=0.0573, val ΔE00=5.107, best=4.928]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:16,  4.69s/it, train loss=0.0573, val ΔE00=5.107, best=4.928]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:16,  4.69s/it, train loss=0.0777, val ΔE00=5.068, best=4.928]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:09,  4.67s/it, train loss=0.0777, val ΔE00=5.068, best=4.928]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:09,  4.67s/it, train loss=0.0991, val ΔE00=5.068, best=4.928]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:03,  4.65s/it, train loss=0.0991, val ΔE00=5.068, best=4.928]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:03,  4.65s/it, train loss=0.1284, val ΔE00=5.410, best=4.928]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.71s/it, train loss=0.1284, val ΔE00=5.410, best=4.928]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.71s/it, train loss=0.1633, val ΔE00=4.815, best=4.815]Training (late/smallcnn):  11%|█         | 11/100 [00:51<06:59,  4.71s/it, train loss=0.1633, val ΔE00=4.815, best=4.815]Training (late/smallcnn):  11%|█         | 11/100 [00:51<06:59,  4.71s/it, train loss=0.1877, val ΔE00=4.735, best=4.735]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:52,  4.68s/it, train loss=0.1877, val ΔE00=4.735, best=4.735]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:52,  4.68s/it, train loss=0.2197, val ΔE00=4.587, best=4.587]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:46,  4.67s/it, train loss=0.2197, val ΔE00=4.587, best=4.587]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:46,  4.67s/it, train loss=0.2567, val ΔE00=4.244, best=4.244]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:40,  4.65s/it, train loss=0.2567, val ΔE00=4.244, best=4.244]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:40,  4.65s/it, train loss=0.2907, val ΔE00=4.093, best=4.093]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:40,  4.71s/it, train loss=0.2907, val ΔE00=4.093, best=4.093]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:40,  4.71s/it, train loss=0.3301, val ΔE00=4.152, best=4.093]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:35,  4.71s/it, train loss=0.3301, val ΔE00=4.152, best=4.093]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:35,  4.71s/it, train loss=0.3809, val ΔE00=3.943, best=3.943]Training (late/smallcnn):  17%|█▋        | 17/100 [01:19<06:28,  4.68s/it, train loss=0.3809, val ΔE00=3.943, best=3.943]Training (late/smallcnn):  17%|█▋        | 17/100 [01:19<06:28,  4.68s/it, train loss=0.4206, val ΔE00=4.431, best=3.943]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:21,  4.66s/it, train loss=0.4206, val ΔE00=4.431, best=3.943]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:21,  4.66s/it, train loss=0.4839, val ΔE00=3.873, best=3.873]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:15,  4.64s/it, train loss=0.4839, val ΔE00=3.873, best=3.873]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:15,  4.64s/it, train loss=0.5292, val ΔE00=4.026, best=3.873]Training (late/smallcnn):  20%|██        | 20/100 [01:33<06:15,  4.70s/it, train loss=0.5292, val ΔE00=4.026, best=3.873]Training (late/smallcnn):  20%|██        | 20/100 [01:33<06:15,  4.70s/it, train loss=0.5842, val ΔE00=4.014, best=3.873]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:11,  4.71s/it, train loss=0.5842, val ΔE00=4.014, best=3.873]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:11,  4.71s/it, train loss=0.6308, val ΔE00=3.969, best=3.873]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:04,  4.68s/it, train loss=0.6308, val ΔE00=3.969, best=3.873]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:04,  4.68s/it, train loss=0.6900, val ΔE00=4.281, best=3.873]Training (late/smallcnn):  23%|██▎       | 23/100 [01:47<05:58,  4.65s/it, train loss=0.6900, val ΔE00=4.281, best=3.873]Training (late/smallcnn):  23%|██▎       | 23/100 [01:47<05:58,  4.65s/it, train loss=0.7462, val ΔE00=3.962, best=3.873]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:52,  4.64s/it, train loss=0.7462, val ΔE00=3.962, best=3.873]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:52,  4.64s/it, train loss=0.8144, val ΔE00=4.281, best=3.873]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:52,  4.70s/it, train loss=0.8144, val ΔE00=4.281, best=3.873]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:52,  4.70s/it, train loss=0.8747, val ΔE00=4.951, best=3.873]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:48,  4.71s/it, train loss=0.8747, val ΔE00=4.951, best=3.873]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:48,  4.71s/it, train loss=0.9340, val ΔE00=4.183, best=3.873]Training (late/smallcnn):  27%|██▋       | 27/100 [02:06<05:41,  4.68s/it, train loss=0.9340, val ΔE00=4.183, best=3.873]Training (late/smallcnn):  27%|██▋       | 27/100 [02:06<05:41,  4.68s/it, train loss=1.0069, val ΔE00=4.277, best=3.873]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:35,  4.66s/it, train loss=1.0069, val ΔE00=4.277, best=3.873]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:35,  4.66s/it, train loss=1.0574, val ΔE00=3.857, best=3.857]Training (late/smallcnn):  29%|██▉       | 29/100 [02:15<05:29,  4.64s/it, train loss=1.0574, val ΔE00=3.857, best=3.857]Training (late/smallcnn):  29%|██▉       | 29/100 [02:15<05:29,  4.64s/it, train loss=1.1175, val ΔE00=4.034, best=3.857]Training (late/smallcnn):  30%|███       | 30/100 [02:20<05:28,  4.70s/it, train loss=1.1175, val ΔE00=4.034, best=3.857]Training (late/smallcnn):  30%|███       | 30/100 [02:20<05:28,  4.70s/it, train loss=1.2218, val ΔE00=4.238, best=3.857]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:25,  4.71s/it, train loss=1.2218, val ΔE00=4.238, best=3.857]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:25,  4.71s/it, train loss=1.2618, val ΔE00=4.241, best=3.857]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:18,  4.68s/it, train loss=1.2618, val ΔE00=4.241, best=3.857]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:18,  4.68s/it, train loss=1.3549, val ΔE00=4.114, best=3.857]Training (late/smallcnn):  33%|███▎      | 33/100 [02:34<05:12,  4.66s/it, train loss=1.3549, val ΔE00=4.114, best=3.857]Training (late/smallcnn):  33%|███▎      | 33/100 [02:34<05:12,  4.66s/it, train loss=1.4069, val ΔE00=4.270, best=3.857]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:06,  4.65s/it, train loss=1.4069, val ΔE00=4.270, best=3.857]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:06,  4.65s/it, train loss=1.4533, val ΔE00=3.848, best=3.848]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:05,  4.71s/it, train loss=1.4533, val ΔE00=3.848, best=3.848]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:05,  4.71s/it, train loss=1.4833, val ΔE00=4.110, best=3.848]Training (late/smallcnn):  36%|███▌      | 36/100 [02:48<05:01,  4.71s/it, train loss=1.4833, val ΔE00=4.110, best=3.848]Training (late/smallcnn):  36%|███▌      | 36/100 [02:48<05:01,  4.71s/it, train loss=1.5784, val ΔE00=4.084, best=3.848]Training (late/smallcnn):  37%|███▋      | 37/100 [02:53<04:55,  4.69s/it, train loss=1.5784, val ΔE00=4.084, best=3.848]Training (late/smallcnn):  37%|███▋      | 37/100 [02:53<04:55,  4.69s/it, train loss=1.7136, val ΔE00=3.872, best=3.848]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:49,  4.66s/it, train loss=1.7136, val ΔE00=3.872, best=3.848]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:49,  4.66s/it, train loss=1.7047, val ΔE00=4.113, best=3.848]Training (late/smallcnn):  39%|███▉      | 39/100 [03:02<04:43,  4.65s/it, train loss=1.7047, val ΔE00=4.113, best=3.848]Training (late/smallcnn):  39%|███▉      | 39/100 [03:02<04:43,  4.65s/it, train loss=1.7927, val ΔE00=5.257, best=3.848]Training (late/smallcnn):  40%|████      | 40/100 [03:07<04:42,  4.71s/it, train loss=1.7927, val ΔE00=5.257, best=3.848]Training (late/smallcnn):  40%|████      | 40/100 [03:07<04:42,  4.71s/it, train loss=1.9044, val ΔE00=4.108, best=3.848]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:38,  4.71s/it, train loss=1.9044, val ΔE00=4.108, best=3.848]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:38,  4.71s/it, train loss=1.8891, val ΔE00=4.159, best=3.848]Training (late/smallcnn):  42%|████▏     | 42/100 [03:16<04:31,  4.68s/it, train loss=1.8891, val ΔE00=4.159, best=3.848]Training (late/smallcnn):  42%|████▏     | 42/100 [03:16<04:31,  4.68s/it, train loss=1.9927, val ΔE00=4.181, best=3.848]Training (late/smallcnn):  43%|████▎     | 43/100 [03:21<04:25,  4.66s/it, train loss=1.9927, val ΔE00=4.181, best=3.848]Training (late/smallcnn):  43%|████▎     | 43/100 [03:21<04:25,  4.66s/it, train loss=2.0504, val ΔE00=3.940, best=3.848]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.65s/it, train loss=2.0504, val ΔE00=3.940, best=3.848]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.65s/it, train loss=2.0902, val ΔE00=3.685, best=3.685]Training (late/smallcnn):  45%|████▌     | 45/100 [03:30<04:18,  4.70s/it, train loss=2.0902, val ΔE00=3.685, best=3.685]Training (late/smallcnn):  45%|████▌     | 45/100 [03:30<04:18,  4.70s/it, train loss=2.1322, val ΔE00=3.961, best=3.685]Training (late/smallcnn):  46%|████▌     | 46/100 [03:35<04:14,  4.71s/it, train loss=2.1322, val ΔE00=3.961, best=3.685]Training (late/smallcnn):  46%|████▌     | 46/100 [03:35<04:14,  4.71s/it, train loss=2.2316, val ΔE00=4.507, best=3.685]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.68s/it, train loss=2.2316, val ΔE00=4.507, best=3.685]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.68s/it, train loss=2.2955, val ΔE00=3.837, best=3.685]Training (late/smallcnn):  48%|████▊     | 48/100 [03:44<04:02,  4.66s/it, train loss=2.2955, val ΔE00=3.837, best=3.685]Training (late/smallcnn):  48%|████▊     | 48/100 [03:44<04:02,  4.66s/it, train loss=2.4716, val ΔE00=4.556, best=3.685]Training (late/smallcnn):  49%|████▉     | 49/100 [03:49<03:57,  4.65s/it, train loss=2.4716, val ΔE00=4.556, best=3.685]Training (late/smallcnn):  49%|████▉     | 49/100 [03:49<03:57,  4.65s/it, train loss=2.4660, val ΔE00=4.262, best=3.685]Training (late/smallcnn):  50%|█████     | 50/100 [03:54<03:55,  4.71s/it, train loss=2.4660, val ΔE00=4.262, best=3.685]Training (late/smallcnn):  50%|█████     | 50/100 [03:54<03:55,  4.71s/it, train loss=2.4891, val ΔE00=4.320, best=3.685]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:51,  4.72s/it, train loss=2.4891, val ΔE00=4.320, best=3.685]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:51,  4.72s/it, train loss=2.5611, val ΔE00=4.088, best=3.685]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:03<03:44,  4.68s/it, train loss=2.5611, val ΔE00=4.088, best=3.685]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:03<03:44,  4.68s/it, train loss=2.5252, val ΔE00=3.827, best=3.685]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:08<03:39,  4.66s/it, train loss=2.5252, val ΔE00=3.827, best=3.685]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:08<03:39,  4.66s/it, train loss=2.7984, val ΔE00=4.782, best=3.685]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:12<03:33,  4.65s/it, train loss=2.7984, val ΔE00=4.782, best=3.685]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:12<03:33,  4.65s/it, train loss=2.7329, val ΔE00=4.103, best=3.685]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:17<03:31,  4.70s/it, train loss=2.7329, val ΔE00=4.103, best=3.685]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:17<03:31,  4.70s/it, train loss=2.7399, val ΔE00=3.780, best=3.685]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:22<03:27,  4.71s/it, train loss=2.7399, val ΔE00=3.780, best=3.685]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:22<03:27,  4.71s/it, train loss=2.8338, val ΔE00=4.451, best=3.685]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:21,  4.68s/it, train loss=2.8338, val ΔE00=4.451, best=3.685]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:21,  4.68s/it, train loss=2.9416, val ΔE00=3.793, best=3.685]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:31<03:15,  4.66s/it, train loss=2.9416, val ΔE00=3.793, best=3.685]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:31<03:15,  4.66s/it, train loss=2.8868, val ΔE00=4.050, best=3.685]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:36<03:15,  4.66s/it, train loss=2.8587, val ΔE00=3.990, early_stop=yes]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:36<03:20,  4.77s/it, train loss=2.8587, val ΔE00=3.990, early_stop=yes]
[early] stop at epoch 59 (best de00=3.6846 @ 44)
[done] best ΔE00=3.685 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/late__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 3/24 ===
[sweep] id=003_model=late__backbone=smallcnn__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone smallcnn --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image+meta, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:28,  5.14s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:28,  5.14s/it, train loss=0.0070, val ΔE00=6.720, best=6.720]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:53,  4.83s/it, train loss=0.0070, val ΔE00=6.720, best=6.720]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:53,  4.83s/it, train loss=0.0075, val ΔE00=5.758, best=5.758]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:38,  4.73s/it, train loss=0.0075, val ΔE00=5.758, best=5.758]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:38,  4.73s/it, train loss=0.0130, val ΔE00=4.910, best=4.910]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:29,  4.68s/it, train loss=0.0130, val ΔE00=4.910, best=4.910]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:29,  4.68s/it, train loss=0.0214, val ΔE00=5.645, best=4.910]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:31,  4.76s/it, train loss=0.0214, val ΔE00=5.645, best=4.910]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:31,  4.76s/it, train loss=0.0330, val ΔE00=3.794, best=3.794]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:25,  4.74s/it, train loss=0.0330, val ΔE00=3.794, best=3.794]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:25,  4.74s/it, train loss=0.0468, val ΔE00=3.499, best=3.499]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:16,  4.69s/it, train loss=0.0468, val ΔE00=3.499, best=3.499]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:16,  4.69s/it, train loss=0.0628, val ΔE00=4.137, best=3.499]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:09,  4.66s/it, train loss=0.0628, val ΔE00=4.137, best=3.499]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:09,  4.66s/it, train loss=0.0797, val ΔE00=3.611, best=3.499]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:03,  4.65s/it, train loss=0.0797, val ΔE00=3.611, best=3.499]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:03,  4.65s/it, train loss=0.0974, val ΔE00=3.185, best=3.185]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:03,  4.71s/it, train loss=0.0974, val ΔE00=3.185, best=3.185]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:03,  4.71s/it, train loss=0.1235, val ΔE00=3.393, best=3.185]Training (late/smallcnn):  11%|█         | 11/100 [00:51<06:58,  4.71s/it, train loss=0.1235, val ΔE00=3.393, best=3.185]Training (late/smallcnn):  11%|█         | 11/100 [00:51<06:58,  4.71s/it, train loss=0.1402, val ΔE00=3.207, best=3.185]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:51,  4.68s/it, train loss=0.1402, val ΔE00=3.207, best=3.185]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:51,  4.68s/it, train loss=0.1649, val ΔE00=3.490, best=3.185]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:44,  4.65s/it, train loss=0.1649, val ΔE00=3.490, best=3.185]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:44,  4.65s/it, train loss=0.1934, val ΔE00=4.601, best=3.185]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:39,  4.64s/it, train loss=0.1934, val ΔE00=4.601, best=3.185]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:39,  4.64s/it, train loss=0.2215, val ΔE00=2.733, best=2.733]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:38,  4.69s/it, train loss=0.2215, val ΔE00=2.733, best=2.733]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:38,  4.69s/it, train loss=0.2467, val ΔE00=3.011, best=2.733]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:35,  4.70s/it, train loss=0.2467, val ΔE00=3.011, best=2.733]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:35,  4.70s/it, train loss=0.2720, val ΔE00=3.132, best=2.733]Training (late/smallcnn):  17%|█▋        | 17/100 [01:19<06:27,  4.67s/it, train loss=0.2720, val ΔE00=3.132, best=2.733]Training (late/smallcnn):  17%|█▋        | 17/100 [01:19<06:27,  4.67s/it, train loss=0.3269, val ΔE00=2.870, best=2.733]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:21,  4.65s/it, train loss=0.3269, val ΔE00=2.870, best=2.733]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:21,  4.65s/it, train loss=0.3528, val ΔE00=3.376, best=2.733]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:15,  4.64s/it, train loss=0.3528, val ΔE00=3.376, best=2.733]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:15,  4.64s/it, train loss=0.3864, val ΔE00=2.789, best=2.733]Training (late/smallcnn):  20%|██        | 20/100 [01:33<06:15,  4.69s/it, train loss=0.3864, val ΔE00=2.789, best=2.733]Training (late/smallcnn):  20%|██        | 20/100 [01:33<06:15,  4.69s/it, train loss=0.4320, val ΔE00=2.692, best=2.692]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:11,  4.71s/it, train loss=0.4320, val ΔE00=2.692, best=2.692]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:11,  4.71s/it, train loss=0.4580, val ΔE00=2.648, best=2.648]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:04,  4.68s/it, train loss=0.4580, val ΔE00=2.648, best=2.648]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:04,  4.68s/it, train loss=0.4907, val ΔE00=2.520, best=2.520]Training (late/smallcnn):  23%|██▎       | 23/100 [01:47<05:58,  4.66s/it, train loss=0.4907, val ΔE00=2.520, best=2.520]Training (late/smallcnn):  23%|██▎       | 23/100 [01:47<05:58,  4.66s/it, train loss=0.5339, val ΔE00=2.770, best=2.520]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:52,  4.64s/it, train loss=0.5339, val ΔE00=2.770, best=2.520]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:52,  4.64s/it, train loss=0.5684, val ΔE00=2.594, best=2.520]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:52,  4.70s/it, train loss=0.5684, val ΔE00=2.594, best=2.520]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:52,  4.70s/it, train loss=0.6176, val ΔE00=2.550, best=2.520]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:48,  4.71s/it, train loss=0.6176, val ΔE00=2.550, best=2.520]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:48,  4.71s/it, train loss=0.6750, val ΔE00=2.437, best=2.437]Training (late/smallcnn):  27%|██▋       | 27/100 [02:06<05:41,  4.68s/it, train loss=0.6750, val ΔE00=2.437, best=2.437]Training (late/smallcnn):  27%|██▋       | 27/100 [02:06<05:41,  4.68s/it, train loss=0.7359, val ΔE00=2.398, best=2.398]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:35,  4.66s/it, train loss=0.7359, val ΔE00=2.398, best=2.398]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:35,  4.66s/it, train loss=0.7891, val ΔE00=3.292, best=2.398]Training (late/smallcnn):  29%|██▉       | 29/100 [02:15<05:29,  4.64s/it, train loss=0.7891, val ΔE00=3.292, best=2.398]Training (late/smallcnn):  29%|██▉       | 29/100 [02:15<05:29,  4.64s/it, train loss=0.8186, val ΔE00=2.555, best=2.398]Training (late/smallcnn):  30%|███       | 30/100 [02:20<05:29,  4.71s/it, train loss=0.8186, val ΔE00=2.555, best=2.398]Training (late/smallcnn):  30%|███       | 30/100 [02:20<05:29,  4.71s/it, train loss=0.8190, val ΔE00=2.969, best=2.398]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:25,  4.71s/it, train loss=0.8190, val ΔE00=2.969, best=2.398]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:25,  4.71s/it, train loss=0.8924, val ΔE00=2.674, best=2.398]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:18,  4.68s/it, train loss=0.8924, val ΔE00=2.674, best=2.398]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:18,  4.68s/it, train loss=0.9320, val ΔE00=2.895, best=2.398]Training (late/smallcnn):  33%|███▎      | 33/100 [02:34<05:12,  4.66s/it, train loss=0.9320, val ΔE00=2.895, best=2.398]Training (late/smallcnn):  33%|███▎      | 33/100 [02:34<05:12,  4.66s/it, train loss=1.0142, val ΔE00=2.498, best=2.398]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:07,  4.65s/it, train loss=1.0142, val ΔE00=2.498, best=2.398]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:07,  4.65s/it, train loss=1.0431, val ΔE00=2.711, best=2.398]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:06,  4.71s/it, train loss=1.0431, val ΔE00=2.711, best=2.398]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:06,  4.71s/it, train loss=1.0830, val ΔE00=2.500, best=2.398]Training (late/smallcnn):  36%|███▌      | 36/100 [02:48<05:01,  4.72s/it, train loss=1.0830, val ΔE00=2.500, best=2.398]Training (late/smallcnn):  36%|███▌      | 36/100 [02:48<05:01,  4.72s/it, train loss=1.1271, val ΔE00=2.643, best=2.398]Training (late/smallcnn):  37%|███▋      | 37/100 [02:53<04:55,  4.69s/it, train loss=1.1271, val ΔE00=2.643, best=2.398]Training (late/smallcnn):  37%|███▋      | 37/100 [02:53<04:55,  4.69s/it, train loss=1.1966, val ΔE00=2.674, best=2.398]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:49,  4.67s/it, train loss=1.1966, val ΔE00=2.674, best=2.398]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:49,  4.67s/it, train loss=1.2204, val ΔE00=2.496, best=2.398]Training (late/smallcnn):  39%|███▉      | 39/100 [03:02<04:43,  4.65s/it, train loss=1.2204, val ΔE00=2.496, best=2.398]Training (late/smallcnn):  39%|███▉      | 39/100 [03:02<04:43,  4.65s/it, train loss=1.2791, val ΔE00=2.627, best=2.398]Training (late/smallcnn):  40%|████      | 40/100 [03:07<04:42,  4.70s/it, train loss=1.2791, val ΔE00=2.627, best=2.398]Training (late/smallcnn):  40%|████      | 40/100 [03:07<04:42,  4.70s/it, train loss=1.4162, val ΔE00=2.642, best=2.398]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:37,  4.71s/it, train loss=1.4162, val ΔE00=2.642, best=2.398]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:37,  4.71s/it, train loss=1.3572, val ΔE00=2.671, best=2.398]Training (late/smallcnn):  42%|████▏     | 42/100 [03:16<04:31,  4.68s/it, train loss=1.3572, val ΔE00=2.671, best=2.398]Training (late/smallcnn):  42%|████▏     | 42/100 [03:16<04:31,  4.68s/it, train loss=1.4195, val ΔE00=2.479, best=2.398]Training (late/smallcnn):  43%|████▎     | 43/100 [03:21<04:25,  4.66s/it, train loss=1.4195, val ΔE00=2.479, best=2.398]Training (late/smallcnn):  43%|████▎     | 43/100 [03:21<04:25,  4.66s/it, train loss=1.4463, val ΔE00=2.551, best=2.398]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.64s/it, train loss=1.4463, val ΔE00=2.551, best=2.398]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.64s/it, train loss=1.4814, val ΔE00=2.564, best=2.398]Training (late/smallcnn):  45%|████▌     | 45/100 [03:30<04:18,  4.70s/it, train loss=1.4814, val ΔE00=2.564, best=2.398]Training (late/smallcnn):  45%|████▌     | 45/100 [03:30<04:18,  4.70s/it, train loss=1.5757, val ΔE00=2.642, best=2.398]Training (late/smallcnn):  46%|████▌     | 46/100 [03:35<04:14,  4.71s/it, train loss=1.5757, val ΔE00=2.642, best=2.398]Training (late/smallcnn):  46%|████▌     | 46/100 [03:35<04:14,  4.71s/it, train loss=1.6020, val ΔE00=2.368, best=2.368]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.68s/it, train loss=1.6020, val ΔE00=2.368, best=2.368]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.68s/it, train loss=1.6423, val ΔE00=2.833, best=2.368]Training (late/smallcnn):  48%|████▊     | 48/100 [03:44<04:02,  4.66s/it, train loss=1.6423, val ΔE00=2.833, best=2.368]Training (late/smallcnn):  48%|████▊     | 48/100 [03:44<04:02,  4.66s/it, train loss=1.8158, val ΔE00=2.218, best=2.218]Training (late/smallcnn):  49%|████▉     | 49/100 [03:49<03:56,  4.64s/it, train loss=1.8158, val ΔE00=2.218, best=2.218]Training (late/smallcnn):  49%|████▉     | 49/100 [03:49<03:56,  4.64s/it, train loss=1.6736, val ΔE00=2.532, best=2.218]Training (late/smallcnn):  50%|█████     | 50/100 [03:54<03:54,  4.70s/it, train loss=1.6736, val ΔE00=2.532, best=2.218]Training (late/smallcnn):  50%|█████     | 50/100 [03:54<03:54,  4.70s/it, train loss=1.7127, val ΔE00=2.245, best=2.218]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:50,  4.71s/it, train loss=1.7127, val ΔE00=2.245, best=2.218]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:50,  4.71s/it, train loss=1.7775, val ΔE00=2.488, best=2.218]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:03<03:44,  4.67s/it, train loss=1.7775, val ΔE00=2.488, best=2.218]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:03<03:44,  4.67s/it, train loss=1.7722, val ΔE00=2.712, best=2.218]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:08<03:38,  4.65s/it, train loss=1.7722, val ΔE00=2.712, best=2.218]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:08<03:38,  4.65s/it, train loss=1.7809, val ΔE00=2.456, best=2.218]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:12<03:33,  4.64s/it, train loss=1.7809, val ΔE00=2.456, best=2.218]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:12<03:33,  4.64s/it, train loss=1.9668, val ΔE00=2.478, best=2.218]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:17<03:31,  4.70s/it, train loss=1.9668, val ΔE00=2.478, best=2.218]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:17<03:31,  4.70s/it, train loss=1.9318, val ΔE00=2.424, best=2.218]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:22<03:27,  4.71s/it, train loss=1.9318, val ΔE00=2.424, best=2.218]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:22<03:27,  4.71s/it, train loss=1.9367, val ΔE00=2.517, best=2.218]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:21,  4.68s/it, train loss=1.9367, val ΔE00=2.517, best=2.218]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:21,  4.68s/it, train loss=1.9339, val ΔE00=2.578, best=2.218]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:31<03:15,  4.66s/it, train loss=1.9339, val ΔE00=2.578, best=2.218]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:31<03:15,  4.66s/it, train loss=1.9968, val ΔE00=2.286, best=2.218]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:36<03:15,  4.66s/it, train loss=2.0435, val ΔE00=2.340, early_stop=yes]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:36<03:20,  4.76s/it, train loss=2.0435, val ΔE00=2.340, early_stop=yes]
[early] stop at epoch 59 (best de00=2.2183 @ 48)
[done] best ΔE00=2.218 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/late__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 4/24 ===
[sweep] id=004_model=late__backbone=smallcnn__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone smallcnn --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=smallcnn, features=image+mean+meta, meta_encoder=none
[run] model=late backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:28,  5.13s/it]Training (late/smallcnn):   1%|          | 1/100 [00:05<08:28,  5.13s/it, train loss=0.0073, val ΔE00=6.845, best=6.845]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:52,  4.83s/it, train loss=0.0073, val ΔE00=6.845, best=6.845]Training (late/smallcnn):   2%|▏         | 2/100 [00:09<07:52,  4.83s/it, train loss=0.0075, val ΔE00=5.548, best=5.548]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:39,  4.73s/it, train loss=0.0075, val ΔE00=5.548, best=5.548]Training (late/smallcnn):   3%|▎         | 3/100 [00:14<07:39,  4.73s/it, train loss=0.0141, val ΔE00=5.098, best=5.098]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:30,  4.69s/it, train loss=0.0141, val ΔE00=5.098, best=5.098]Training (late/smallcnn):   4%|▍         | 4/100 [00:18<07:30,  4.69s/it, train loss=0.0228, val ΔE00=4.915, best=4.915]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:30,  4.75s/it, train loss=0.0228, val ΔE00=4.915, best=4.915]Training (late/smallcnn):   5%|▌         | 5/100 [00:23<07:30,  4.75s/it, train loss=0.0346, val ΔE00=4.864, best=4.864]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:26,  4.75s/it, train loss=0.0346, val ΔE00=4.864, best=4.864]Training (late/smallcnn):   6%|▌         | 6/100 [00:28<07:26,  4.75s/it, train loss=0.0500, val ΔE00=4.129, best=4.129]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:18,  4.71s/it, train loss=0.0500, val ΔE00=4.129, best=4.129]Training (late/smallcnn):   7%|▋         | 7/100 [00:33<07:18,  4.71s/it, train loss=0.0672, val ΔE00=4.053, best=4.053]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:11,  4.69s/it, train loss=0.0672, val ΔE00=4.053, best=4.053]Training (late/smallcnn):   8%|▊         | 8/100 [00:37<07:11,  4.69s/it, train loss=0.0839, val ΔE00=3.510, best=3.510]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:04,  4.67s/it, train loss=0.0839, val ΔE00=3.510, best=3.510]Training (late/smallcnn):   9%|▉         | 9/100 [00:42<07:04,  4.67s/it, train loss=0.1055, val ΔE00=3.637, best=3.510]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.72s/it, train loss=0.1055, val ΔE00=3.637, best=3.510]Training (late/smallcnn):  10%|█         | 10/100 [00:47<07:04,  4.72s/it, train loss=0.1310, val ΔE00=3.580, best=3.510]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:01,  4.73s/it, train loss=0.1310, val ΔE00=3.580, best=3.510]Training (late/smallcnn):  11%|█         | 11/100 [00:52<07:01,  4.73s/it, train loss=0.1484, val ΔE00=3.327, best=3.327]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:53,  4.70s/it, train loss=0.1484, val ΔE00=3.327, best=3.327]Training (late/smallcnn):  12%|█▏        | 12/100 [00:56<06:53,  4.70s/it, train loss=0.1706, val ΔE00=3.325, best=3.325]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:46,  4.67s/it, train loss=0.1706, val ΔE00=3.325, best=3.325]Training (late/smallcnn):  13%|█▎        | 13/100 [01:01<06:46,  4.67s/it, train loss=0.1917, val ΔE00=3.016, best=3.016]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:40,  4.65s/it, train loss=0.1917, val ΔE00=3.016, best=3.016]Training (late/smallcnn):  14%|█▍        | 14/100 [01:05<06:40,  4.65s/it, train loss=0.2270, val ΔE00=2.966, best=2.966]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:40,  4.71s/it, train loss=0.2270, val ΔE00=2.966, best=2.966]Training (late/smallcnn):  15%|█▌        | 15/100 [01:10<06:40,  4.71s/it, train loss=0.2634, val ΔE00=2.688, best=2.688]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:36,  4.72s/it, train loss=0.2634, val ΔE00=2.688, best=2.688]Training (late/smallcnn):  16%|█▌        | 16/100 [01:15<06:36,  4.72s/it, train loss=0.2864, val ΔE00=2.791, best=2.688]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:28,  4.69s/it, train loss=0.2864, val ΔE00=2.791, best=2.688]Training (late/smallcnn):  17%|█▋        | 17/100 [01:20<06:28,  4.69s/it, train loss=0.3238, val ΔE00=3.673, best=2.688]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:22,  4.67s/it, train loss=0.3238, val ΔE00=3.673, best=2.688]Training (late/smallcnn):  18%|█▊        | 18/100 [01:24<06:22,  4.67s/it, train loss=0.3760, val ΔE00=2.653, best=2.653]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:16,  4.65s/it, train loss=0.3760, val ΔE00=2.653, best=2.653]Training (late/smallcnn):  19%|█▉        | 19/100 [01:29<06:16,  4.65s/it, train loss=0.3776, val ΔE00=2.681, best=2.653]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:16,  4.70s/it, train loss=0.3776, val ΔE00=2.681, best=2.653]Training (late/smallcnn):  20%|██        | 20/100 [01:34<06:16,  4.70s/it, train loss=0.4187, val ΔE00=2.782, best=2.653]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:12,  4.72s/it, train loss=0.4187, val ΔE00=2.782, best=2.653]Training (late/smallcnn):  21%|██        | 21/100 [01:38<06:12,  4.72s/it, train loss=0.4489, val ΔE00=2.570, best=2.570]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:05,  4.69s/it, train loss=0.4489, val ΔE00=2.570, best=2.570]Training (late/smallcnn):  22%|██▏       | 22/100 [01:43<06:05,  4.69s/it, train loss=0.4902, val ΔE00=2.778, best=2.570]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<05:59,  4.67s/it, train loss=0.4902, val ΔE00=2.778, best=2.570]Training (late/smallcnn):  23%|██▎       | 23/100 [01:48<05:59,  4.67s/it, train loss=0.5093, val ΔE00=2.468, best=2.468]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:53,  4.66s/it, train loss=0.5093, val ΔE00=2.468, best=2.468]Training (late/smallcnn):  24%|██▍       | 24/100 [01:52<05:53,  4.66s/it, train loss=0.5954, val ΔE00=2.769, best=2.468]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:53,  4.71s/it, train loss=0.5954, val ΔE00=2.769, best=2.468]Training (late/smallcnn):  25%|██▌       | 25/100 [01:57<05:53,  4.71s/it, train loss=0.6168, val ΔE00=2.524, best=2.468]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:49,  4.72s/it, train loss=0.6168, val ΔE00=2.524, best=2.468]Training (late/smallcnn):  26%|██▌       | 26/100 [02:02<05:49,  4.72s/it, train loss=0.6520, val ΔE00=2.484, best=2.468]Training (late/smallcnn):  27%|██▋       | 27/100 [02:06<05:42,  4.69s/it, train loss=0.6520, val ΔE00=2.484, best=2.468]Training (late/smallcnn):  27%|██▋       | 27/100 [02:06<05:42,  4.69s/it, train loss=0.6854, val ΔE00=2.739, best=2.468]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:35,  4.66s/it, train loss=0.6854, val ΔE00=2.739, best=2.468]Training (late/smallcnn):  28%|██▊       | 28/100 [02:11<05:35,  4.66s/it, train loss=0.7313, val ΔE00=2.699, best=2.468]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:29,  4.65s/it, train loss=0.7313, val ΔE00=2.699, best=2.468]Training (late/smallcnn):  29%|██▉       | 29/100 [02:16<05:29,  4.65s/it, train loss=0.7968, val ΔE00=2.570, best=2.468]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:29,  4.70s/it, train loss=0.7968, val ΔE00=2.570, best=2.468]Training (late/smallcnn):  30%|███       | 30/100 [02:21<05:29,  4.70s/it, train loss=0.7861, val ΔE00=2.572, best=2.468]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:25,  4.71s/it, train loss=0.7861, val ΔE00=2.572, best=2.468]Training (late/smallcnn):  31%|███       | 31/100 [02:25<05:25,  4.71s/it, train loss=0.8476, val ΔE00=2.398, best=2.398]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:18,  4.68s/it, train loss=0.8476, val ΔE00=2.398, best=2.398]Training (late/smallcnn):  32%|███▏      | 32/100 [02:30<05:18,  4.68s/it, train loss=0.9126, val ΔE00=2.600, best=2.398]Training (late/smallcnn):  33%|███▎      | 33/100 [02:35<05:12,  4.67s/it, train loss=0.9126, val ΔE00=2.600, best=2.398]Training (late/smallcnn):  33%|███▎      | 33/100 [02:35<05:12,  4.67s/it, train loss=0.9498, val ΔE00=2.727, best=2.398]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:07,  4.65s/it, train loss=0.9498, val ΔE00=2.727, best=2.398]Training (late/smallcnn):  34%|███▍      | 34/100 [02:39<05:07,  4.65s/it, train loss=1.0156, val ΔE00=2.562, best=2.398]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:06,  4.71s/it, train loss=1.0156, val ΔE00=2.562, best=2.398]Training (late/smallcnn):  35%|███▌      | 35/100 [02:44<05:06,  4.71s/it, train loss=1.0525, val ΔE00=3.270, best=2.398]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:02,  4.72s/it, train loss=1.0525, val ΔE00=3.270, best=2.398]Training (late/smallcnn):  36%|███▌      | 36/100 [02:49<05:02,  4.72s/it, train loss=1.0813, val ΔE00=2.303, best=2.303]Training (late/smallcnn):  37%|███▋      | 37/100 [02:53<04:55,  4.69s/it, train loss=1.0813, val ΔE00=2.303, best=2.303]Training (late/smallcnn):  37%|███▋      | 37/100 [02:53<04:55,  4.69s/it, train loss=1.1807, val ΔE00=2.781, best=2.303]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:49,  4.67s/it, train loss=1.1807, val ΔE00=2.781, best=2.303]Training (late/smallcnn):  38%|███▊      | 38/100 [02:58<04:49,  4.67s/it, train loss=1.1965, val ΔE00=2.383, best=2.303]Training (late/smallcnn):  39%|███▉      | 39/100 [03:03<04:44,  4.66s/it, train loss=1.1965, val ΔE00=2.383, best=2.303]Training (late/smallcnn):  39%|███▉      | 39/100 [03:03<04:44,  4.66s/it, train loss=1.2169, val ΔE00=2.334, best=2.303]Training (late/smallcnn):  40%|████      | 40/100 [03:07<04:42,  4.71s/it, train loss=1.2169, val ΔE00=2.334, best=2.303]Training (late/smallcnn):  40%|████      | 40/100 [03:07<04:42,  4.71s/it, train loss=1.2535, val ΔE00=2.518, best=2.303]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:38,  4.72s/it, train loss=1.2535, val ΔE00=2.518, best=2.303]Training (late/smallcnn):  41%|████      | 41/100 [03:12<04:38,  4.72s/it, train loss=1.3365, val ΔE00=2.406, best=2.303]Training (late/smallcnn):  42%|████▏     | 42/100 [03:17<04:32,  4.69s/it, train loss=1.3365, val ΔE00=2.406, best=2.303]Training (late/smallcnn):  42%|████▏     | 42/100 [03:17<04:32,  4.69s/it, train loss=1.3302, val ΔE00=2.277, best=2.277]Training (late/smallcnn):  43%|████▎     | 43/100 [03:21<04:26,  4.67s/it, train loss=1.3302, val ΔE00=2.277, best=2.277]Training (late/smallcnn):  43%|████▎     | 43/100 [03:21<04:26,  4.67s/it, train loss=1.4177, val ΔE00=2.522, best=2.277]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.65s/it, train loss=1.4177, val ΔE00=2.522, best=2.277]Training (late/smallcnn):  44%|████▍     | 44/100 [03:26<04:20,  4.65s/it, train loss=1.4513, val ΔE00=2.288, best=2.277]Training (late/smallcnn):  45%|████▌     | 45/100 [03:31<04:18,  4.71s/it, train loss=1.4513, val ΔE00=2.288, best=2.277]Training (late/smallcnn):  45%|████▌     | 45/100 [03:31<04:18,  4.71s/it, train loss=1.4583, val ΔE00=2.992, best=2.277]Training (late/smallcnn):  46%|████▌     | 46/100 [03:36<04:14,  4.72s/it, train loss=1.4583, val ΔE00=2.992, best=2.277]Training (late/smallcnn):  46%|████▌     | 46/100 [03:36<04:14,  4.72s/it, train loss=1.4920, val ΔE00=2.382, best=2.277]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.68s/it, train loss=1.4920, val ΔE00=2.382, best=2.277]Training (late/smallcnn):  47%|████▋     | 47/100 [03:40<04:08,  4.68s/it, train loss=1.5724, val ΔE00=2.501, best=2.277]Training (late/smallcnn):  48%|████▊     | 48/100 [03:45<04:02,  4.66s/it, train loss=1.5724, val ΔE00=2.501, best=2.277]Training (late/smallcnn):  48%|████▊     | 48/100 [03:45<04:02,  4.66s/it, train loss=1.5990, val ΔE00=2.308, best=2.277]Training (late/smallcnn):  49%|████▉     | 49/100 [03:49<03:56,  4.65s/it, train loss=1.5990, val ΔE00=2.308, best=2.277]Training (late/smallcnn):  49%|████▉     | 49/100 [03:49<03:56,  4.65s/it, train loss=1.6018, val ΔE00=2.571, best=2.277]Training (late/smallcnn):  50%|█████     | 50/100 [03:54<03:54,  4.70s/it, train loss=1.6018, val ΔE00=2.571, best=2.277]Training (late/smallcnn):  50%|█████     | 50/100 [03:54<03:54,  4.70s/it, train loss=1.6331, val ΔE00=2.325, best=2.277]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:50,  4.71s/it, train loss=1.6331, val ΔE00=2.325, best=2.277]Training (late/smallcnn):  51%|█████     | 51/100 [03:59<03:50,  4.71s/it, train loss=1.6965, val ΔE00=2.283, best=2.277]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:04<03:44,  4.68s/it, train loss=1.6965, val ΔE00=2.283, best=2.277]Training (late/smallcnn):  52%|█████▏    | 52/100 [04:04<03:44,  4.68s/it, train loss=1.6993, val ΔE00=2.290, best=2.277]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:08<03:39,  4.66s/it, train loss=1.6993, val ΔE00=2.290, best=2.277]Training (late/smallcnn):  53%|█████▎    | 53/100 [04:08<03:39,  4.66s/it, train loss=1.7913, val ΔE00=2.243, best=2.243]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:13<03:33,  4.65s/it, train loss=1.7913, val ΔE00=2.243, best=2.243]Training (late/smallcnn):  54%|█████▍    | 54/100 [04:13<03:33,  4.65s/it, train loss=1.9490, val ΔE00=2.730, best=2.243]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:18<03:31,  4.70s/it, train loss=1.9490, val ΔE00=2.730, best=2.243]Training (late/smallcnn):  55%|█████▌    | 55/100 [04:18<03:31,  4.70s/it, train loss=1.8456, val ΔE00=2.617, best=2.243]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:22<03:27,  4.71s/it, train loss=1.8456, val ΔE00=2.617, best=2.243]Training (late/smallcnn):  56%|█████▌    | 56/100 [04:22<03:27,  4.71s/it, train loss=1.8620, val ΔE00=2.248, best=2.243]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:21,  4.68s/it, train loss=1.8620, val ΔE00=2.248, best=2.243]Training (late/smallcnn):  57%|█████▋    | 57/100 [04:27<03:21,  4.68s/it, train loss=1.9129, val ΔE00=2.353, best=2.243]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:32<03:15,  4.66s/it, train loss=1.9129, val ΔE00=2.353, best=2.243]Training (late/smallcnn):  58%|█████▊    | 58/100 [04:32<03:15,  4.66s/it, train loss=1.9584, val ΔE00=2.293, best=2.243]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:36<03:10,  4.65s/it, train loss=1.9584, val ΔE00=2.293, best=2.243]Training (late/smallcnn):  59%|█████▉    | 59/100 [04:36<03:10,  4.65s/it, train loss=2.0351, val ΔE00=2.181, best=2.181]Training (late/smallcnn):  60%|██████    | 60/100 [04:41<03:08,  4.70s/it, train loss=2.0351, val ΔE00=2.181, best=2.181]Training (late/smallcnn):  60%|██████    | 60/100 [04:41<03:08,  4.70s/it, train loss=2.0451, val ΔE00=2.068, best=2.068]Training (late/smallcnn):  61%|██████    | 61/100 [04:46<03:03,  4.71s/it, train loss=2.0451, val ΔE00=2.068, best=2.068]Training (late/smallcnn):  61%|██████    | 61/100 [04:46<03:03,  4.71s/it, train loss=1.9829, val ΔE00=2.368, best=2.068]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:50<02:57,  4.68s/it, train loss=1.9829, val ΔE00=2.368, best=2.068]Training (late/smallcnn):  62%|██████▏   | 62/100 [04:50<02:57,  4.68s/it, train loss=2.0631, val ΔE00=2.328, best=2.068]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:55<02:52,  4.66s/it, train loss=2.0631, val ΔE00=2.328, best=2.068]Training (late/smallcnn):  63%|██████▎   | 63/100 [04:55<02:52,  4.66s/it, train loss=2.1260, val ΔE00=2.313, best=2.068]Training (late/smallcnn):  64%|██████▍   | 64/100 [05:00<02:47,  4.65s/it, train loss=2.1260, val ΔE00=2.313, best=2.068]Training (late/smallcnn):  64%|██████▍   | 64/100 [05:00<02:47,  4.65s/it, train loss=2.0241, val ΔE00=3.017, best=2.068]Training (late/smallcnn):  65%|██████▌   | 65/100 [05:05<02:44,  4.70s/it, train loss=2.0241, val ΔE00=3.017, best=2.068]Training (late/smallcnn):  65%|██████▌   | 65/100 [05:05<02:44,  4.70s/it, train loss=2.1244, val ΔE00=3.055, best=2.068]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:09<02:40,  4.72s/it, train loss=2.1244, val ΔE00=3.055, best=2.068]Training (late/smallcnn):  66%|██████▌   | 66/100 [05:09<02:40,  4.72s/it, train loss=2.0980, val ΔE00=2.227, best=2.068]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:14<02:34,  4.69s/it, train loss=2.0980, val ΔE00=2.227, best=2.068]Training (late/smallcnn):  67%|██████▋   | 67/100 [05:14<02:34,  4.69s/it, train loss=2.1060, val ΔE00=2.411, best=2.068]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:19<02:29,  4.67s/it, train loss=2.1060, val ΔE00=2.411, best=2.068]Training (late/smallcnn):  68%|██████▊   | 68/100 [05:19<02:29,  4.67s/it, train loss=2.1030, val ΔE00=2.739, best=2.068]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:23<02:24,  4.65s/it, train loss=2.1030, val ΔE00=2.739, best=2.068]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:23<02:24,  4.65s/it, train loss=2.1664, val ΔE00=2.412, best=2.068]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:28<02:24,  4.65s/it, train loss=2.1126, val ΔE00=2.082, early_stop=yes]Training (late/smallcnn):  69%|██████▉   | 69/100 [05:28<02:27,  4.76s/it, train loss=2.1126, val ΔE00=2.082, early_stop=yes]
[early] stop at epoch 70 (best de00=2.0682 @ 60)
[done] best ΔE00=2.068 over 70 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/late__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=smallcnn__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 5/24 ===
[sweep] id=005_model=late__backbone=resnet18__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone resnet18 --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:36,  7.04s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:36,  7.04s/it, train loss=0.0105, val ΔE00=7.341, best=7.341]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:01,  6.75s/it, train loss=0.0105, val ΔE00=7.341, best=7.341]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:01,  6.75s/it, train loss=0.0083, val ΔE00=5.740, best=5.740]Training (late/resnet18):   3%|▎         | 3/100 [00:20<10:43,  6.63s/it, train loss=0.0083, val ΔE00=5.740, best=5.740]Training (late/resnet18):   3%|▎         | 3/100 [00:20<10:43,  6.63s/it, train loss=0.0131, val ΔE00=6.411, best=5.740]Training (late/resnet18):   4%|▍         | 4/100 [00:26<10:33,  6.60s/it, train loss=0.0131, val ΔE00=6.411, best=5.740]Training (late/resnet18):   4%|▍         | 4/100 [00:26<10:33,  6.60s/it, train loss=0.0224, val ΔE00=5.468, best=5.468]Training (late/resnet18):   5%|▌         | 5/100 [00:33<10:34,  6.68s/it, train loss=0.0224, val ΔE00=5.468, best=5.468]Training (late/resnet18):   5%|▌         | 5/100 [00:33<10:34,  6.68s/it, train loss=0.0329, val ΔE00=4.867, best=4.867]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:24,  6.64s/it, train loss=0.0329, val ΔE00=4.867, best=4.867]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:24,  6.64s/it, train loss=0.0486, val ΔE00=5.467, best=4.867]Training (late/resnet18):   7%|▋         | 7/100 [00:46<10:15,  6.62s/it, train loss=0.0486, val ΔE00=5.467, best=4.867]Training (late/resnet18):   7%|▋         | 7/100 [00:46<10:15,  6.62s/it, train loss=0.0620, val ΔE00=4.043, best=4.043]Training (late/resnet18):   8%|▊         | 8/100 [00:53<10:04,  6.57s/it, train loss=0.0620, val ΔE00=4.043, best=4.043]Training (late/resnet18):   8%|▊         | 8/100 [00:53<10:04,  6.57s/it, train loss=0.0802, val ΔE00=4.046, best=4.043]Training (late/resnet18):   9%|▉         | 9/100 [00:59<09:56,  6.55s/it, train loss=0.0802, val ΔE00=4.046, best=4.043]Training (late/resnet18):   9%|▉         | 9/100 [00:59<09:56,  6.55s/it, train loss=0.1036, val ΔE00=4.390, best=4.043]Training (late/resnet18):  10%|█         | 10/100 [01:06<09:54,  6.60s/it, train loss=0.1036, val ΔE00=4.390, best=4.043]Training (late/resnet18):  10%|█         | 10/100 [01:06<09:54,  6.60s/it, train loss=0.1203, val ΔE00=5.313, best=4.043]Training (late/resnet18):  11%|█         | 11/100 [01:12<09:50,  6.63s/it, train loss=0.1203, val ΔE00=5.313, best=4.043]Training (late/resnet18):  11%|█         | 11/100 [01:12<09:50,  6.63s/it, train loss=0.1367, val ΔE00=3.953, best=3.953]Training (late/resnet18):  12%|█▏        | 12/100 [01:19<09:42,  6.61s/it, train loss=0.1367, val ΔE00=3.953, best=3.953]Training (late/resnet18):  12%|█▏        | 12/100 [01:19<09:42,  6.61s/it, train loss=0.1555, val ΔE00=3.738, best=3.738]Training (late/resnet18):  13%|█▎        | 13/100 [01:26<09:32,  6.58s/it, train loss=0.1555, val ΔE00=3.738, best=3.738]Training (late/resnet18):  13%|█▎        | 13/100 [01:26<09:32,  6.58s/it, train loss=0.1814, val ΔE00=4.101, best=3.738]Training (late/resnet18):  14%|█▍        | 14/100 [01:32<09:23,  6.55s/it, train loss=0.1814, val ΔE00=4.101, best=3.738]Training (late/resnet18):  14%|█▍        | 14/100 [01:32<09:23,  6.55s/it, train loss=0.1892, val ΔE00=3.784, best=3.738]Training (late/resnet18):  15%|█▌        | 15/100 [01:39<09:23,  6.62s/it, train loss=0.1892, val ΔE00=3.784, best=3.738]Training (late/resnet18):  15%|█▌        | 15/100 [01:39<09:23,  6.62s/it, train loss=0.2286, val ΔE00=3.604, best=3.604]Training (late/resnet18):  16%|█▌        | 16/100 [01:45<09:17,  6.63s/it, train loss=0.2286, val ΔE00=3.604, best=3.604]Training (late/resnet18):  16%|█▌        | 16/100 [01:45<09:17,  6.63s/it, train loss=0.2349, val ΔE00=4.124, best=3.604]Training (late/resnet18):  17%|█▋        | 17/100 [01:52<09:07,  6.60s/it, train loss=0.2349, val ΔE00=4.124, best=3.604]Training (late/resnet18):  17%|█▋        | 17/100 [01:52<09:07,  6.60s/it, train loss=0.2694, val ΔE00=3.655, best=3.604]Training (late/resnet18):  18%|█▊        | 18/100 [01:59<09:00,  6.60s/it, train loss=0.2694, val ΔE00=3.655, best=3.604]Training (late/resnet18):  18%|█▊        | 18/100 [01:59<09:00,  6.60s/it, train loss=0.2992, val ΔE00=3.534, best=3.534]Training (late/resnet18):  19%|█▉        | 19/100 [02:05<08:52,  6.57s/it, train loss=0.2992, val ΔE00=3.534, best=3.534]Training (late/resnet18):  19%|█▉        | 19/100 [02:05<08:52,  6.57s/it, train loss=0.3133, val ΔE00=3.937, best=3.534]Training (late/resnet18):  20%|██        | 20/100 [02:12<08:51,  6.64s/it, train loss=0.3133, val ΔE00=3.937, best=3.534]Training (late/resnet18):  20%|██        | 20/100 [02:12<08:51,  6.64s/it, train loss=0.3310, val ΔE00=3.412, best=3.412]Training (late/resnet18):  21%|██        | 21/100 [02:19<08:43,  6.63s/it, train loss=0.3310, val ΔE00=3.412, best=3.412]Training (late/resnet18):  21%|██        | 21/100 [02:19<08:43,  6.63s/it, train loss=0.3534, val ΔE00=3.550, best=3.412]Training (late/resnet18):  22%|██▏       | 22/100 [02:25<08:33,  6.59s/it, train loss=0.3534, val ΔE00=3.550, best=3.412]Training (late/resnet18):  22%|██▏       | 22/100 [02:25<08:33,  6.59s/it, train loss=0.3820, val ΔE00=3.571, best=3.412]Training (late/resnet18):  23%|██▎       | 23/100 [02:32<08:25,  6.56s/it, train loss=0.3820, val ΔE00=3.571, best=3.412]Training (late/resnet18):  23%|██▎       | 23/100 [02:32<08:25,  6.56s/it, train loss=0.4030, val ΔE00=3.878, best=3.412]Training (late/resnet18):  24%|██▍       | 24/100 [02:38<08:19,  6.57s/it, train loss=0.4030, val ΔE00=3.878, best=3.412]Training (late/resnet18):  24%|██▍       | 24/100 [02:38<08:19,  6.57s/it, train loss=0.4284, val ΔE00=3.352, best=3.352]Training (late/resnet18):  25%|██▌       | 25/100 [02:45<08:16,  6.62s/it, train loss=0.4284, val ΔE00=3.352, best=3.352]Training (late/resnet18):  25%|██▌       | 25/100 [02:45<08:16,  6.62s/it, train loss=0.4552, val ΔE00=3.577, best=3.352]Training (late/resnet18):  26%|██▌       | 26/100 [02:51<08:09,  6.62s/it, train loss=0.4552, val ΔE00=3.577, best=3.352]Training (late/resnet18):  26%|██▌       | 26/100 [02:51<08:09,  6.62s/it, train loss=0.4924, val ΔE00=3.749, best=3.352]Training (late/resnet18):  27%|██▋       | 27/100 [02:58<08:00,  6.59s/it, train loss=0.4924, val ΔE00=3.749, best=3.352]Training (late/resnet18):  27%|██▋       | 27/100 [02:58<08:00,  6.59s/it, train loss=0.4803, val ΔE00=3.407, best=3.352]Training (late/resnet18):  28%|██▊       | 28/100 [03:04<07:52,  6.57s/it, train loss=0.4803, val ΔE00=3.407, best=3.352]Training (late/resnet18):  28%|██▊       | 28/100 [03:04<07:52,  6.57s/it, train loss=0.5222, val ΔE00=3.774, best=3.352]Training (late/resnet18):  29%|██▉       | 29/100 [03:11<07:44,  6.55s/it, train loss=0.5222, val ΔE00=3.774, best=3.352]Training (late/resnet18):  29%|██▉       | 29/100 [03:11<07:44,  6.55s/it, train loss=0.5609, val ΔE00=3.426, best=3.352]Training (late/resnet18):  30%|███       | 30/100 [03:18<07:42,  6.60s/it, train loss=0.5609, val ΔE00=3.426, best=3.352]Training (late/resnet18):  30%|███       | 30/100 [03:18<07:42,  6.60s/it, train loss=0.5827, val ΔE00=3.476, best=3.352]Training (late/resnet18):  31%|███       | 31/100 [03:24<07:36,  6.62s/it, train loss=0.5827, val ΔE00=3.476, best=3.352]Training (late/resnet18):  31%|███       | 31/100 [03:24<07:36,  6.62s/it, train loss=0.6098, val ΔE00=4.243, best=3.352]Training (late/resnet18):  32%|███▏      | 32/100 [03:31<07:27,  6.59s/it, train loss=0.6098, val ΔE00=4.243, best=3.352]Training (late/resnet18):  32%|███▏      | 32/100 [03:31<07:27,  6.59s/it, train loss=0.6165, val ΔE00=3.433, best=3.352]Training (late/resnet18):  33%|███▎      | 33/100 [03:37<07:20,  6.58s/it, train loss=0.6165, val ΔE00=3.433, best=3.352]Training (late/resnet18):  33%|███▎      | 33/100 [03:37<07:20,  6.58s/it, train loss=0.6554, val ΔE00=3.312, best=3.312]Training (late/resnet18):  34%|███▍      | 34/100 [03:44<07:12,  6.55s/it, train loss=0.6554, val ΔE00=3.312, best=3.312]Training (late/resnet18):  34%|███▍      | 34/100 [03:44<07:12,  6.55s/it, train loss=0.6463, val ΔE00=3.523, best=3.312]Training (late/resnet18):  35%|███▌      | 35/100 [03:51<07:09,  6.61s/it, train loss=0.6463, val ΔE00=3.523, best=3.312]Training (late/resnet18):  35%|███▌      | 35/100 [03:51<07:09,  6.61s/it, train loss=0.6813, val ΔE00=3.571, best=3.312]Training (late/resnet18):  36%|███▌      | 36/100 [03:57<07:03,  6.61s/it, train loss=0.6813, val ΔE00=3.571, best=3.312]Training (late/resnet18):  36%|███▌      | 36/100 [03:57<07:03,  6.61s/it, train loss=0.7522, val ΔE00=3.388, best=3.312]Training (late/resnet18):  37%|███▋      | 37/100 [04:04<06:54,  6.58s/it, train loss=0.7522, val ΔE00=3.388, best=3.312]Training (late/resnet18):  37%|███▋      | 37/100 [04:04<06:54,  6.58s/it, train loss=0.7370, val ΔE00=3.535, best=3.312]Training (late/resnet18):  38%|███▊      | 38/100 [04:10<06:46,  6.56s/it, train loss=0.7370, val ΔE00=3.535, best=3.312]Training (late/resnet18):  38%|███▊      | 38/100 [04:10<06:46,  6.56s/it, train loss=0.7342, val ΔE00=3.450, best=3.312]Training (late/resnet18):  39%|███▉      | 39/100 [04:17<06:39,  6.54s/it, train loss=0.7342, val ΔE00=3.450, best=3.312]Training (late/resnet18):  39%|███▉      | 39/100 [04:17<06:39,  6.54s/it, train loss=0.7607, val ΔE00=3.314, best=3.312]Training (late/resnet18):  40%|████      | 40/100 [04:24<06:36,  6.60s/it, train loss=0.7607, val ΔE00=3.314, best=3.312]Training (late/resnet18):  40%|████      | 40/100 [04:24<06:36,  6.60s/it, train loss=0.7802, val ΔE00=3.434, best=3.312]Training (late/resnet18):  41%|████      | 41/100 [04:30<06:29,  6.60s/it, train loss=0.7802, val ΔE00=3.434, best=3.312]Training (late/resnet18):  41%|████      | 41/100 [04:30<06:29,  6.60s/it, train loss=0.8297, val ΔE00=3.398, best=3.312]Training (late/resnet18):  42%|████▏     | 42/100 [04:37<06:21,  6.57s/it, train loss=0.8297, val ΔE00=3.398, best=3.312]Training (late/resnet18):  42%|████▏     | 42/100 [04:37<06:21,  6.57s/it, train loss=0.8186, val ΔE00=3.388, best=3.312]Training (late/resnet18):  43%|████▎     | 43/100 [04:43<06:13,  6.55s/it, train loss=0.8186, val ΔE00=3.388, best=3.312]Training (late/resnet18):  43%|████▎     | 43/100 [04:43<06:13,  6.55s/it, train loss=0.9074, val ΔE00=3.488, best=3.312]Training (late/resnet18):  44%|████▍     | 44/100 [04:50<06:06,  6.54s/it, train loss=0.9074, val ΔE00=3.488, best=3.312]Training (late/resnet18):  44%|████▍     | 44/100 [04:50<06:06,  6.54s/it, train loss=0.8766, val ΔE00=3.625, best=3.312]Training (late/resnet18):  45%|████▌     | 45/100 [04:56<06:03,  6.60s/it, train loss=0.8766, val ΔE00=3.625, best=3.312]Training (late/resnet18):  45%|████▌     | 45/100 [04:56<06:03,  6.60s/it, train loss=0.9135, val ΔE00=3.443, best=3.312]Training (late/resnet18):  46%|████▌     | 46/100 [05:03<05:56,  6.61s/it, train loss=0.9135, val ΔE00=3.443, best=3.312]Training (late/resnet18):  46%|████▌     | 46/100 [05:03<05:56,  6.61s/it, train loss=0.8701, val ΔE00=3.593, best=3.312]Training (late/resnet18):  47%|████▋     | 47/100 [05:10<05:48,  6.58s/it, train loss=0.8701, val ΔE00=3.593, best=3.312]Training (late/resnet18):  47%|████▋     | 47/100 [05:10<05:48,  6.58s/it, train loss=0.9090, val ΔE00=3.426, best=3.312]Training (late/resnet18):  48%|████▊     | 48/100 [05:16<05:41,  6.56s/it, train loss=0.9090, val ΔE00=3.426, best=3.312]Training (late/resnet18):  48%|████▊     | 48/100 [05:16<05:41,  6.56s/it, train loss=0.9778, val ΔE00=3.358, best=3.312]Training (late/resnet18):  49%|████▉     | 49/100 [05:23<05:34,  6.56s/it, train loss=0.9778, val ΔE00=3.358, best=3.312]Training (late/resnet18):  49%|████▉     | 49/100 [05:23<05:34,  6.56s/it, train loss=0.9278, val ΔE00=3.269, best=3.269]Training (late/resnet18):  50%|█████     | 50/100 [05:29<05:30,  6.61s/it, train loss=0.9278, val ΔE00=3.269, best=3.269]Training (late/resnet18):  50%|█████     | 50/100 [05:29<05:30,  6.61s/it, train loss=0.9975, val ΔE00=3.906, best=3.269]Training (late/resnet18):  51%|█████     | 51/100 [05:36<05:24,  6.62s/it, train loss=0.9975, val ΔE00=3.906, best=3.269]Training (late/resnet18):  51%|█████     | 51/100 [05:36<05:24,  6.62s/it, train loss=1.0150, val ΔE00=3.435, best=3.269]Training (late/resnet18):  52%|█████▏    | 52/100 [05:42<05:16,  6.59s/it, train loss=1.0150, val ΔE00=3.435, best=3.269]Training (late/resnet18):  52%|█████▏    | 52/100 [05:42<05:16,  6.59s/it, train loss=1.0087, val ΔE00=3.583, best=3.269]Training (late/resnet18):  53%|█████▎    | 53/100 [05:49<05:08,  6.56s/it, train loss=1.0087, val ΔE00=3.583, best=3.269]Training (late/resnet18):  53%|█████▎    | 53/100 [05:49<05:08,  6.56s/it, train loss=1.0250, val ΔE00=3.565, best=3.269]Training (late/resnet18):  54%|█████▍    | 54/100 [05:56<05:02,  6.57s/it, train loss=1.0250, val ΔE00=3.565, best=3.269]Training (late/resnet18):  54%|█████▍    | 54/100 [05:56<05:02,  6.57s/it, train loss=1.0118, val ΔE00=3.189, best=3.189]Training (late/resnet18):  55%|█████▌    | 55/100 [06:02<04:57,  6.61s/it, train loss=1.0118, val ΔE00=3.189, best=3.189]Training (late/resnet18):  55%|█████▌    | 55/100 [06:02<04:57,  6.61s/it, train loss=0.9894, val ΔE00=3.420, best=3.189]Training (late/resnet18):  56%|█████▌    | 56/100 [06:09<04:51,  6.62s/it, train loss=0.9894, val ΔE00=3.420, best=3.189]Training (late/resnet18):  56%|█████▌    | 56/100 [06:09<04:51,  6.62s/it, train loss=1.0591, val ΔE00=3.423, best=3.189]Training (late/resnet18):  57%|█████▋    | 57/100 [06:15<04:43,  6.59s/it, train loss=1.0591, val ΔE00=3.423, best=3.189]Training (late/resnet18):  57%|█████▋    | 57/100 [06:15<04:43,  6.59s/it, train loss=1.0828, val ΔE00=3.466, best=3.189]Training (late/resnet18):  58%|█████▊    | 58/100 [06:22<04:35,  6.56s/it, train loss=1.0828, val ΔE00=3.466, best=3.189]Training (late/resnet18):  58%|█████▊    | 58/100 [06:22<04:35,  6.56s/it, train loss=1.0679, val ΔE00=3.449, best=3.189]Training (late/resnet18):  59%|█████▉    | 59/100 [06:28<04:28,  6.55s/it, train loss=1.0679, val ΔE00=3.449, best=3.189]Training (late/resnet18):  59%|█████▉    | 59/100 [06:28<04:28,  6.55s/it, train loss=1.0380, val ΔE00=3.640, best=3.189]Training (late/resnet18):  60%|██████    | 60/100 [06:35<04:24,  6.61s/it, train loss=1.0380, val ΔE00=3.640, best=3.189]Training (late/resnet18):  60%|██████    | 60/100 [06:35<04:24,  6.61s/it, train loss=1.0861, val ΔE00=3.321, best=3.189]Training (late/resnet18):  61%|██████    | 61/100 [06:42<04:17,  6.61s/it, train loss=1.0861, val ΔE00=3.321, best=3.189]Training (late/resnet18):  61%|██████    | 61/100 [06:42<04:17,  6.61s/it, train loss=1.1182, val ΔE00=3.739, best=3.189]Training (late/resnet18):  62%|██████▏   | 62/100 [06:48<04:09,  6.58s/it, train loss=1.1182, val ΔE00=3.739, best=3.189]Training (late/resnet18):  62%|██████▏   | 62/100 [06:48<04:09,  6.58s/it, train loss=1.0951, val ΔE00=3.487, best=3.189]Training (late/resnet18):  63%|██████▎   | 63/100 [06:55<04:02,  6.56s/it, train loss=1.0951, val ΔE00=3.487, best=3.189]Training (late/resnet18):  63%|██████▎   | 63/100 [06:55<04:02,  6.56s/it, train loss=1.0390, val ΔE00=3.645, best=3.189]Training (late/resnet18):  63%|██████▎   | 63/100 [07:01<04:02,  6.56s/it, train loss=1.0600, val ΔE00=3.401, early_stop=yes]Training (late/resnet18):  63%|██████▎   | 63/100 [07:01<04:07,  6.70s/it, train loss=1.0600, val ΔE00=3.401, early_stop=yes]
[early] stop at epoch 64 (best de00=3.1894 @ 54)
[done] best ΔE00=3.189 over 64 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/late__resnet18__image__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image/final_summary.json (kind=val)
[sweep] === Run 6/24 ===
[sweep] id=006_model=late__backbone=resnet18__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone resnet18 --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image+mean, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:54,  7.22s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:54,  7.22s/it, train loss=0.0103, val ΔE00=6.979, best=6.979]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:18,  6.92s/it, train loss=0.0103, val ΔE00=6.979, best=6.979]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:18,  6.92s/it, train loss=0.0075, val ΔE00=6.167, best=6.167]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:01,  6.82s/it, train loss=0.0075, val ΔE00=6.167, best=6.167]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:01,  6.82s/it, train loss=0.0132, val ΔE00=4.723, best=4.723]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:47,  6.75s/it, train loss=0.0132, val ΔE00=4.723, best=4.723]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:47,  6.75s/it, train loss=0.0217, val ΔE00=4.931, best=4.723]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:47,  6.82s/it, train loss=0.0217, val ΔE00=4.931, best=4.723]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:47,  6.82s/it, train loss=0.0321, val ΔE00=4.246, best=4.246]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:39,  6.80s/it, train loss=0.0321, val ΔE00=4.246, best=4.246]Training (late/resnet18):   6%|▌         | 6/100 [00:40<10:39,  6.80s/it, train loss=0.0472, val ΔE00=4.599, best=4.246]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0472, val ΔE00=4.599, best=4.246]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.77s/it, train loss=0.0620, val ΔE00=4.046, best=4.046]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:20,  6.75s/it, train loss=0.0620, val ΔE00=4.046, best=4.046]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:20,  6.75s/it, train loss=0.0769, val ΔE00=3.900, best=3.900]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:10,  6.71s/it, train loss=0.0769, val ΔE00=3.900, best=3.900]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:10,  6.71s/it, train loss=0.0954, val ΔE00=4.032, best=3.900]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:10,  6.78s/it, train loss=0.0954, val ΔE00=4.032, best=3.900]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:10,  6.78s/it, train loss=0.1124, val ΔE00=3.851, best=3.851]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:05,  6.80s/it, train loss=0.1124, val ΔE00=3.851, best=3.851]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:05,  6.80s/it, train loss=0.1318, val ΔE00=3.531, best=3.531]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:54,  6.75s/it, train loss=0.1318, val ΔE00=3.531, best=3.531]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:54,  6.75s/it, train loss=0.1477, val ΔE00=3.698, best=3.531]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:46,  6.74s/it, train loss=0.1477, val ΔE00=3.698, best=3.531]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:46,  6.74s/it, train loss=0.1667, val ΔE00=3.466, best=3.466]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:37,  6.71s/it, train loss=0.1667, val ΔE00=3.466, best=3.466]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:37,  6.71s/it, train loss=0.1970, val ΔE00=3.660, best=3.466]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:34,  6.76s/it, train loss=0.1970, val ΔE00=3.660, best=3.466]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:34,  6.76s/it, train loss=0.2094, val ΔE00=3.729, best=3.466]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:29,  6.78s/it, train loss=0.2094, val ΔE00=3.729, best=3.466]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:29,  6.78s/it, train loss=0.2331, val ΔE00=3.337, best=3.337]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:19,  6.74s/it, train loss=0.2331, val ΔE00=3.337, best=3.337]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:19,  6.74s/it, train loss=0.2591, val ΔE00=3.768, best=3.337]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:10,  6.72s/it, train loss=0.2591, val ΔE00=3.768, best=3.337]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:10,  6.72s/it, train loss=0.3010, val ΔE00=4.204, best=3.337]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:02,  6.69s/it, train loss=0.3010, val ΔE00=4.204, best=3.337]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:02,  6.69s/it, train loss=0.3112, val ΔE00=3.487, best=3.337]Training (late/resnet18):  20%|██        | 20/100 [02:15<08:59,  6.74s/it, train loss=0.3112, val ΔE00=3.487, best=3.337]Training (late/resnet18):  20%|██        | 20/100 [02:15<08:59,  6.74s/it, train loss=0.3379, val ΔE00=3.477, best=3.337]Training (late/resnet18):  21%|██        | 21/100 [02:22<08:53,  6.75s/it, train loss=0.3379, val ΔE00=3.477, best=3.337]Training (late/resnet18):  21%|██        | 21/100 [02:22<08:53,  6.75s/it, train loss=0.3604, val ΔE00=3.590, best=3.337]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:43,  6.72s/it, train loss=0.3604, val ΔE00=3.590, best=3.337]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:43,  6.72s/it, train loss=0.3761, val ΔE00=3.573, best=3.337]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:35,  6.69s/it, train loss=0.3761, val ΔE00=3.573, best=3.337]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:35,  6.69s/it, train loss=0.3981, val ΔE00=3.605, best=3.337]Training (late/resnet18):  24%|██▍       | 24/100 [02:42<08:27,  6.68s/it, train loss=0.3981, val ΔE00=3.605, best=3.337]Training (late/resnet18):  24%|██▍       | 24/100 [02:42<08:27,  6.68s/it, train loss=0.4145, val ΔE00=3.612, best=3.337]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:25,  6.74s/it, train loss=0.4145, val ΔE00=3.612, best=3.337]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:25,  6.74s/it, train loss=0.4692, val ΔE00=3.384, best=3.337]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:18,  6.74s/it, train loss=0.4692, val ΔE00=3.384, best=3.337]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:18,  6.74s/it, train loss=0.4698, val ΔE00=3.351, best=3.337]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:09,  6.71s/it, train loss=0.4698, val ΔE00=3.351, best=3.337]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:09,  6.71s/it, train loss=0.5192, val ΔE00=3.357, best=3.337]Training (late/resnet18):  28%|██▊       | 28/100 [03:08<08:01,  6.69s/it, train loss=0.5192, val ΔE00=3.357, best=3.337]Training (late/resnet18):  28%|██▊       | 28/100 [03:08<08:01,  6.69s/it, train loss=0.5345, val ΔE00=3.446, best=3.337]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:53,  6.67s/it, train loss=0.5345, val ΔE00=3.446, best=3.337]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:53,  6.67s/it, train loss=0.5512, val ΔE00=3.609, best=3.337]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:51,  6.73s/it, train loss=0.5512, val ΔE00=3.609, best=3.337]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:51,  6.73s/it, train loss=0.6001, val ΔE00=3.616, best=3.337]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:44,  6.74s/it, train loss=0.6001, val ΔE00=3.616, best=3.337]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:44,  6.74s/it, train loss=0.6321, val ΔE00=3.538, best=3.337]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:37,  6.73s/it, train loss=0.6321, val ΔE00=3.538, best=3.337]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:37,  6.73s/it, train loss=0.6032, val ΔE00=3.248, best=3.248]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:30,  6.72s/it, train loss=0.6032, val ΔE00=3.248, best=3.248]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:30,  6.72s/it, train loss=0.6776, val ΔE00=3.188, best=3.188]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:23,  6.71s/it, train loss=0.6776, val ΔE00=3.188, best=3.188]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:23,  6.71s/it, train loss=0.6952, val ΔE00=3.142, best=3.142]Training (late/resnet18):  35%|███▌      | 35/100 [03:56<07:20,  6.77s/it, train loss=0.6952, val ΔE00=3.142, best=3.142]Training (late/resnet18):  35%|███▌      | 35/100 [03:56<07:20,  6.77s/it, train loss=0.6947, val ΔE00=3.297, best=3.142]Training (late/resnet18):  36%|███▌      | 36/100 [04:02<07:12,  6.76s/it, train loss=0.6947, val ΔE00=3.297, best=3.142]Training (late/resnet18):  36%|███▌      | 36/100 [04:02<07:12,  6.76s/it, train loss=0.7127, val ΔE00=3.809, best=3.142]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:03,  6.72s/it, train loss=0.7127, val ΔE00=3.809, best=3.142]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:03,  6.72s/it, train loss=0.7598, val ΔE00=3.427, best=3.142]Training (late/resnet18):  38%|███▊      | 38/100 [04:16<06:54,  6.69s/it, train loss=0.7598, val ΔE00=3.427, best=3.142]Training (late/resnet18):  38%|███▊      | 38/100 [04:16<06:54,  6.69s/it, train loss=0.7526, val ΔE00=3.576, best=3.142]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:46,  6.67s/it, train loss=0.7526, val ΔE00=3.576, best=3.142]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:46,  6.67s/it, train loss=0.8024, val ΔE00=3.314, best=3.142]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:43,  6.73s/it, train loss=0.8024, val ΔE00=3.314, best=3.142]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:43,  6.73s/it, train loss=0.8018, val ΔE00=3.397, best=3.142]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:37,  6.74s/it, train loss=0.8018, val ΔE00=3.397, best=3.142]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:37,  6.74s/it, train loss=0.8285, val ΔE00=3.261, best=3.142]Training (late/resnet18):  42%|████▏     | 42/100 [04:43<06:29,  6.71s/it, train loss=0.8285, val ΔE00=3.261, best=3.142]Training (late/resnet18):  42%|████▏     | 42/100 [04:43<06:29,  6.71s/it, train loss=0.8404, val ΔE00=3.361, best=3.142]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.69s/it, train loss=0.8404, val ΔE00=3.361, best=3.142]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:21,  6.69s/it, train loss=0.9007, val ΔE00=3.401, best=3.142]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:13,  6.67s/it, train loss=0.9007, val ΔE00=3.401, best=3.142]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:13,  6.67s/it, train loss=0.8639, val ΔE00=3.511, best=3.142]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:10,  6.74s/it, train loss=0.8639, val ΔE00=3.511, best=3.142]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:10,  6.74s/it, train loss=0.9041, val ΔE00=3.485, best=3.142]Training (late/resnet18):  46%|████▌     | 46/100 [05:10<06:04,  6.76s/it, train loss=0.9041, val ΔE00=3.485, best=3.142]Training (late/resnet18):  46%|████▌     | 46/100 [05:10<06:04,  6.76s/it, train loss=0.9521, val ΔE00=3.487, best=3.142]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:56,  6.73s/it, train loss=0.9521, val ΔE00=3.487, best=3.142]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:56,  6.73s/it, train loss=0.9284, val ΔE00=3.403, best=3.142]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:48,  6.71s/it, train loss=0.9284, val ΔE00=3.403, best=3.142]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:48,  6.71s/it, train loss=0.9354, val ΔE00=3.374, best=3.142]Training (late/resnet18):  49%|████▉     | 49/100 [05:29<05:41,  6.69s/it, train loss=0.9354, val ΔE00=3.374, best=3.142]Training (late/resnet18):  49%|████▉     | 49/100 [05:29<05:41,  6.69s/it, train loss=0.9465, val ΔE00=3.212, best=3.142]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:37,  6.75s/it, train loss=0.9465, val ΔE00=3.212, best=3.142]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:37,  6.75s/it, train loss=0.9651, val ΔE00=4.040, best=3.142]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:30,  6.75s/it, train loss=0.9651, val ΔE00=4.040, best=3.142]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:30,  6.75s/it, train loss=0.9360, val ΔE00=3.354, best=3.142]Training (late/resnet18):  52%|█████▏    | 52/100 [05:50<05:22,  6.72s/it, train loss=0.9360, val ΔE00=3.354, best=3.142]Training (late/resnet18):  52%|█████▏    | 52/100 [05:50<05:22,  6.72s/it, train loss=0.9902, val ΔE00=3.264, best=3.142]Training (late/resnet18):  53%|█████▎    | 53/100 [05:56<05:14,  6.69s/it, train loss=0.9902, val ΔE00=3.264, best=3.142]Training (late/resnet18):  53%|█████▎    | 53/100 [05:56<05:14,  6.69s/it, train loss=0.9800, val ΔE00=3.498, best=3.142]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:07,  6.68s/it, train loss=0.9800, val ΔE00=3.498, best=3.142]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:07,  6.68s/it, train loss=1.0120, val ΔE00=3.299, best=3.142]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:04,  6.76s/it, train loss=1.0120, val ΔE00=3.299, best=3.142]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:04,  6.76s/it, train loss=1.0170, val ΔE00=3.188, best=3.142]Training (late/resnet18):  56%|█████▌    | 56/100 [06:17<04:56,  6.75s/it, train loss=1.0170, val ΔE00=3.188, best=3.142]Training (late/resnet18):  56%|█████▌    | 56/100 [06:17<04:56,  6.75s/it, train loss=1.0306, val ΔE00=3.289, best=3.142]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:48,  6.72s/it, train loss=1.0306, val ΔE00=3.289, best=3.142]Training (late/resnet18):  57%|█████▋    | 57/100 [06:23<04:48,  6.72s/it, train loss=1.0533, val ΔE00=3.333, best=3.142]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:41,  6.69s/it, train loss=1.0533, val ΔE00=3.333, best=3.142]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:41,  6.69s/it, train loss=1.0307, val ΔE00=3.367, best=3.142]Training (late/resnet18):  58%|█████▊    | 58/100 [06:37<04:41,  6.69s/it, train loss=1.0622, val ΔE00=3.176, early_stop=yes]Training (late/resnet18):  58%|█████▊    | 58/100 [06:37<04:47,  6.85s/it, train loss=1.0622, val ΔE00=3.176, early_stop=yes]
[early] stop at epoch 59 (best de00=3.1416 @ 34)
[done] best ΔE00=3.142 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/late__resnet18__image+mean__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 7/24 ===
[sweep] id=007_model=late__backbone=resnet18__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone resnet18 --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image+meta, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<11:56,  7.24s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<11:56,  7.24s/it, train loss=0.0109, val ΔE00=7.566, best=7.566]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:18,  6.93s/it, train loss=0.0109, val ΔE00=7.566, best=7.566]Training (late/resnet18):   2%|▏         | 2/100 [00:13<11:18,  6.93s/it, train loss=0.0072, val ΔE00=5.645, best=5.645]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:01,  6.82s/it, train loss=0.0072, val ΔE00=5.645, best=5.645]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:01,  6.82s/it, train loss=0.0126, val ΔE00=5.440, best=5.440]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:49,  6.77s/it, train loss=0.0126, val ΔE00=5.440, best=5.440]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:49,  6.77s/it, train loss=0.0201, val ΔE00=4.507, best=4.507]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:49,  6.83s/it, train loss=0.0201, val ΔE00=4.507, best=4.507]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:49,  6.83s/it, train loss=0.0317, val ΔE00=4.089, best=4.089]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:39,  6.80s/it, train loss=0.0317, val ΔE00=4.089, best=4.089]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:39,  6.80s/it, train loss=0.0412, val ΔE00=4.120, best=4.089]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.76s/it, train loss=0.0412, val ΔE00=4.120, best=4.089]Training (late/resnet18):   7%|▋         | 7/100 [00:47<10:29,  6.76s/it, train loss=0.0574, val ΔE00=3.606, best=3.606]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:19,  6.74s/it, train loss=0.0574, val ΔE00=3.606, best=3.606]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:19,  6.74s/it, train loss=0.0738, val ΔE00=3.604, best=3.604]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:11,  6.72s/it, train loss=0.0738, val ΔE00=3.604, best=3.604]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:11,  6.72s/it, train loss=0.0896, val ΔE00=3.187, best=3.187]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:08,  6.76s/it, train loss=0.0896, val ΔE00=3.187, best=3.187]Training (late/resnet18):  10%|█         | 10/100 [01:07<10:08,  6.76s/it, train loss=0.1086, val ΔE00=3.548, best=3.187]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:03,  6.78s/it, train loss=0.1086, val ΔE00=3.548, best=3.187]Training (late/resnet18):  11%|█         | 11/100 [01:14<10:03,  6.78s/it, train loss=0.1244, val ΔE00=3.053, best=3.053]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:53,  6.74s/it, train loss=0.1244, val ΔE00=3.053, best=3.053]Training (late/resnet18):  12%|█▏        | 12/100 [01:21<09:53,  6.74s/it, train loss=0.1415, val ΔE00=3.206, best=3.053]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:45,  6.73s/it, train loss=0.1415, val ΔE00=3.206, best=3.053]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:45,  6.73s/it, train loss=0.1622, val ΔE00=2.786, best=2.786]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:36,  6.71s/it, train loss=0.1622, val ΔE00=2.786, best=2.786]Training (late/resnet18):  14%|█▍        | 14/100 [01:34<09:36,  6.71s/it, train loss=0.1798, val ΔE00=2.840, best=2.786]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:34,  6.76s/it, train loss=0.1798, val ΔE00=2.840, best=2.786]Training (late/resnet18):  15%|█▌        | 15/100 [01:41<09:34,  6.76s/it, train loss=0.1996, val ΔE00=3.064, best=2.786]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:27,  6.76s/it, train loss=0.1996, val ΔE00=3.064, best=2.786]Training (late/resnet18):  16%|█▌        | 16/100 [01:48<09:27,  6.76s/it, train loss=0.2243, val ΔE00=3.894, best=2.786]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:18,  6.72s/it, train loss=0.2243, val ΔE00=3.894, best=2.786]Training (late/resnet18):  17%|█▋        | 17/100 [01:55<09:18,  6.72s/it, train loss=0.2563, val ΔE00=3.103, best=2.786]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:09,  6.70s/it, train loss=0.2563, val ΔE00=3.103, best=2.786]Training (late/resnet18):  18%|█▊        | 18/100 [02:01<09:09,  6.70s/it, train loss=0.2768, val ΔE00=2.826, best=2.786]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:01,  6.68s/it, train loss=0.2768, val ΔE00=2.826, best=2.786]Training (late/resnet18):  19%|█▉        | 19/100 [02:08<09:01,  6.68s/it, train loss=0.2914, val ΔE00=2.844, best=2.786]Training (late/resnet18):  20%|██        | 20/100 [02:15<08:59,  6.75s/it, train loss=0.2914, val ΔE00=2.844, best=2.786]Training (late/resnet18):  20%|██        | 20/100 [02:15<08:59,  6.75s/it, train loss=0.3029, val ΔE00=2.791, best=2.786]Training (late/resnet18):  21%|██        | 21/100 [02:21<08:53,  6.75s/it, train loss=0.3029, val ΔE00=2.791, best=2.786]Training (late/resnet18):  21%|██        | 21/100 [02:21<08:53,  6.75s/it, train loss=0.3390, val ΔE00=2.794, best=2.786]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:44,  6.72s/it, train loss=0.3390, val ΔE00=2.794, best=2.786]Training (late/resnet18):  22%|██▏       | 22/100 [02:28<08:44,  6.72s/it, train loss=0.3773, val ΔE00=2.938, best=2.786]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:37,  6.72s/it, train loss=0.3773, val ΔE00=2.938, best=2.786]Training (late/resnet18):  23%|██▎       | 23/100 [02:35<08:37,  6.72s/it, train loss=0.4049, val ΔE00=2.766, best=2.766]Training (late/resnet18):  24%|██▍       | 24/100 [02:41<08:29,  6.70s/it, train loss=0.4049, val ΔE00=2.766, best=2.766]Training (late/resnet18):  24%|██▍       | 24/100 [02:41<08:29,  6.70s/it, train loss=0.4108, val ΔE00=2.881, best=2.766]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:27,  6.76s/it, train loss=0.4108, val ΔE00=2.881, best=2.766]Training (late/resnet18):  25%|██▌       | 25/100 [02:48<08:27,  6.76s/it, train loss=0.4242, val ΔE00=2.962, best=2.766]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:20,  6.76s/it, train loss=0.4242, val ΔE00=2.962, best=2.766]Training (late/resnet18):  26%|██▌       | 26/100 [02:55<08:20,  6.76s/it, train loss=0.4510, val ΔE00=2.872, best=2.766]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:12,  6.75s/it, train loss=0.4510, val ΔE00=2.872, best=2.766]Training (late/resnet18):  27%|██▋       | 27/100 [03:02<08:12,  6.75s/it, train loss=0.4870, val ΔE00=2.552, best=2.552]Training (late/resnet18):  28%|██▊       | 28/100 [03:09<08:03,  6.72s/it, train loss=0.4870, val ΔE00=2.552, best=2.552]Training (late/resnet18):  28%|██▊       | 28/100 [03:09<08:03,  6.72s/it, train loss=0.5118, val ΔE00=3.057, best=2.552]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:55,  6.69s/it, train loss=0.5118, val ΔE00=3.057, best=2.552]Training (late/resnet18):  29%|██▉       | 29/100 [03:15<07:55,  6.69s/it, train loss=0.5236, val ΔE00=3.051, best=2.552]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:53,  6.76s/it, train loss=0.5236, val ΔE00=3.051, best=2.552]Training (late/resnet18):  30%|███       | 30/100 [03:22<07:53,  6.76s/it, train loss=0.5436, val ΔE00=2.971, best=2.552]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:45,  6.75s/it, train loss=0.5436, val ΔE00=2.971, best=2.552]Training (late/resnet18):  31%|███       | 31/100 [03:29<07:45,  6.75s/it, train loss=0.5413, val ΔE00=2.764, best=2.552]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:36,  6.72s/it, train loss=0.5413, val ΔE00=2.764, best=2.552]Training (late/resnet18):  32%|███▏      | 32/100 [03:35<07:36,  6.72s/it, train loss=0.5861, val ΔE00=2.613, best=2.552]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:29,  6.70s/it, train loss=0.5861, val ΔE00=2.613, best=2.552]Training (late/resnet18):  33%|███▎      | 33/100 [03:42<07:29,  6.70s/it, train loss=0.6070, val ΔE00=2.907, best=2.552]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:21,  6.69s/it, train loss=0.6070, val ΔE00=2.907, best=2.552]Training (late/resnet18):  34%|███▍      | 34/100 [03:49<07:21,  6.69s/it, train loss=0.6598, val ΔE00=2.714, best=2.552]Training (late/resnet18):  35%|███▌      | 35/100 [03:56<07:18,  6.74s/it, train loss=0.6598, val ΔE00=2.714, best=2.552]Training (late/resnet18):  35%|███▌      | 35/100 [03:56<07:18,  6.74s/it, train loss=0.6402, val ΔE00=2.768, best=2.552]Training (late/resnet18):  36%|███▌      | 36/100 [04:02<07:12,  6.76s/it, train loss=0.6402, val ΔE00=2.768, best=2.552]Training (late/resnet18):  36%|███▌      | 36/100 [04:02<07:12,  6.76s/it, train loss=0.6682, val ΔE00=2.763, best=2.552]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:03,  6.72s/it, train loss=0.6682, val ΔE00=2.763, best=2.552]Training (late/resnet18):  37%|███▋      | 37/100 [04:09<07:03,  6.72s/it, train loss=0.6884, val ΔE00=2.819, best=2.552]Training (late/resnet18):  38%|███▊      | 38/100 [04:16<06:55,  6.70s/it, train loss=0.6884, val ΔE00=2.819, best=2.552]Training (late/resnet18):  38%|███▊      | 38/100 [04:16<06:55,  6.70s/it, train loss=0.6982, val ΔE00=2.704, best=2.552]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:47,  6.68s/it, train loss=0.6982, val ΔE00=2.704, best=2.552]Training (late/resnet18):  39%|███▉      | 39/100 [04:22<06:47,  6.68s/it, train loss=0.7419, val ΔE00=2.608, best=2.552]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:44,  6.74s/it, train loss=0.7419, val ΔE00=2.608, best=2.552]Training (late/resnet18):  40%|████      | 40/100 [04:29<06:44,  6.74s/it, train loss=0.7878, val ΔE00=3.190, best=2.552]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:39,  6.77s/it, train loss=0.7878, val ΔE00=3.190, best=2.552]Training (late/resnet18):  41%|████      | 41/100 [04:36<06:39,  6.77s/it, train loss=0.8454, val ΔE00=2.537, best=2.537]Training (late/resnet18):  42%|████▏     | 42/100 [04:43<06:30,  6.73s/it, train loss=0.8454, val ΔE00=2.537, best=2.537]Training (late/resnet18):  42%|████▏     | 42/100 [04:43<06:30,  6.73s/it, train loss=0.8174, val ΔE00=2.682, best=2.537]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:22,  6.71s/it, train loss=0.8174, val ΔE00=2.682, best=2.537]Training (late/resnet18):  43%|████▎     | 43/100 [04:49<06:22,  6.71s/it, train loss=0.8328, val ΔE00=2.591, best=2.537]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:14,  6.69s/it, train loss=0.8328, val ΔE00=2.591, best=2.537]Training (late/resnet18):  44%|████▍     | 44/100 [04:56<06:14,  6.69s/it, train loss=0.8475, val ΔE00=3.305, best=2.537]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:11,  6.75s/it, train loss=0.8475, val ΔE00=3.305, best=2.537]Training (late/resnet18):  45%|████▌     | 45/100 [05:03<06:11,  6.75s/it, train loss=0.8813, val ΔE00=2.562, best=2.537]Training (late/resnet18):  46%|████▌     | 46/100 [05:10<06:04,  6.75s/it, train loss=0.8813, val ΔE00=2.562, best=2.537]Training (late/resnet18):  46%|████▌     | 46/100 [05:10<06:04,  6.75s/it, train loss=0.9073, val ΔE00=2.645, best=2.537]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:56,  6.72s/it, train loss=0.9073, val ΔE00=2.645, best=2.537]Training (late/resnet18):  47%|████▋     | 47/100 [05:16<05:56,  6.72s/it, train loss=0.8838, val ΔE00=2.684, best=2.537]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:48,  6.70s/it, train loss=0.8838, val ΔE00=2.684, best=2.537]Training (late/resnet18):  48%|████▊     | 48/100 [05:23<05:48,  6.70s/it, train loss=0.9205, val ΔE00=2.570, best=2.537]Training (late/resnet18):  49%|████▉     | 49/100 [05:30<05:40,  6.68s/it, train loss=0.9205, val ΔE00=2.570, best=2.537]Training (late/resnet18):  49%|████▉     | 49/100 [05:30<05:40,  6.68s/it, train loss=0.9223, val ΔE00=2.728, best=2.537]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:36,  6.74s/it, train loss=0.9223, val ΔE00=2.728, best=2.537]Training (late/resnet18):  50%|█████     | 50/100 [05:36<05:36,  6.74s/it, train loss=0.9357, val ΔE00=2.924, best=2.537]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:31,  6.76s/it, train loss=0.9357, val ΔE00=2.924, best=2.537]Training (late/resnet18):  51%|█████     | 51/100 [05:43<05:31,  6.76s/it, train loss=0.9041, val ΔE00=2.851, best=2.537]Training (late/resnet18):  52%|█████▏    | 52/100 [05:50<05:23,  6.75s/it, train loss=0.9041, val ΔE00=2.851, best=2.537]Training (late/resnet18):  52%|█████▏    | 52/100 [05:50<05:23,  6.75s/it, train loss=0.9535, val ΔE00=2.525, best=2.525]Training (late/resnet18):  53%|█████▎    | 53/100 [05:57<05:15,  6.72s/it, train loss=0.9535, val ΔE00=2.525, best=2.525]Training (late/resnet18):  53%|█████▎    | 53/100 [05:57<05:15,  6.72s/it, train loss=0.9708, val ΔE00=2.807, best=2.525]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:08,  6.70s/it, train loss=0.9708, val ΔE00=2.807, best=2.525]Training (late/resnet18):  54%|█████▍    | 54/100 [06:03<05:08,  6.70s/it, train loss=0.9661, val ΔE00=2.662, best=2.525]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:05,  6.80s/it, train loss=0.9661, val ΔE00=2.662, best=2.525]Training (late/resnet18):  55%|█████▌    | 55/100 [06:10<05:05,  6.80s/it, train loss=1.0023, val ΔE00=2.511, best=2.511]Training (late/resnet18):  56%|█████▌    | 56/100 [06:17<04:58,  6.78s/it, train loss=1.0023, val ΔE00=2.511, best=2.511]Training (late/resnet18):  56%|█████▌    | 56/100 [06:17<04:58,  6.78s/it, train loss=0.9847, val ΔE00=2.599, best=2.511]Training (late/resnet18):  57%|█████▋    | 57/100 [06:24<04:49,  6.74s/it, train loss=0.9847, val ΔE00=2.599, best=2.511]Training (late/resnet18):  57%|█████▋    | 57/100 [06:24<04:49,  6.74s/it, train loss=1.0425, val ΔE00=2.868, best=2.511]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:41,  6.71s/it, train loss=1.0425, val ΔE00=2.868, best=2.511]Training (late/resnet18):  58%|█████▊    | 58/100 [06:30<04:41,  6.71s/it, train loss=1.0151, val ΔE00=2.751, best=2.511]Training (late/resnet18):  59%|█████▉    | 59/100 [06:37<04:34,  6.70s/it, train loss=1.0151, val ΔE00=2.751, best=2.511]Training (late/resnet18):  59%|█████▉    | 59/100 [06:37<04:34,  6.70s/it, train loss=1.0400, val ΔE00=2.754, best=2.511]Training (late/resnet18):  60%|██████    | 60/100 [06:44<04:30,  6.76s/it, train loss=1.0400, val ΔE00=2.754, best=2.511]Training (late/resnet18):  60%|██████    | 60/100 [06:44<04:30,  6.76s/it, train loss=1.0628, val ΔE00=2.769, best=2.511]Training (late/resnet18):  61%|██████    | 61/100 [06:51<04:23,  6.75s/it, train loss=1.0628, val ΔE00=2.769, best=2.511]Training (late/resnet18):  61%|██████    | 61/100 [06:51<04:23,  6.75s/it, train loss=1.0804, val ΔE00=2.707, best=2.511]Training (late/resnet18):  62%|██████▏   | 62/100 [06:57<04:15,  6.72s/it, train loss=1.0804, val ΔE00=2.707, best=2.511]Training (late/resnet18):  62%|██████▏   | 62/100 [06:57<04:15,  6.72s/it, train loss=1.0104, val ΔE00=2.596, best=2.511]Training (late/resnet18):  63%|██████▎   | 63/100 [07:04<04:07,  6.70s/it, train loss=1.0104, val ΔE00=2.596, best=2.511]Training (late/resnet18):  63%|██████▎   | 63/100 [07:04<04:07,  6.70s/it, train loss=1.0805, val ΔE00=2.594, best=2.511]Training (late/resnet18):  64%|██████▍   | 64/100 [07:11<04:00,  6.68s/it, train loss=1.0805, val ΔE00=2.594, best=2.511]Training (late/resnet18):  64%|██████▍   | 64/100 [07:11<04:00,  6.68s/it, train loss=1.0806, val ΔE00=2.580, best=2.511]Training (late/resnet18):  64%|██████▍   | 64/100 [07:17<04:00,  6.68s/it, train loss=1.0247, val ΔE00=2.723, early_stop=yes]Training (late/resnet18):  64%|██████▍   | 64/100 [07:17<04:06,  6.84s/it, train loss=1.0247, val ΔE00=2.723, early_stop=yes]
[early] stop at epoch 65 (best de00=2.5114 @ 55)
[done] best ΔE00=2.511 over 65 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/late__resnet18__image+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 8/24 ===
[sweep] id=008_model=late__backbone=resnet18__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model late --backbone resnet18 --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=late, backbone=resnet18, features=image+mean+meta, meta_encoder=none
[run] model=late backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (late/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (late/resnet18):   1%|          | 1/100 [00:07<12:01,  7.29s/it]Training (late/resnet18):   1%|          | 1/100 [00:07<12:01,  7.29s/it, train loss=0.0098, val ΔE00=6.737, best=6.737]Training (late/resnet18):   2%|▏         | 2/100 [00:14<11:24,  6.98s/it, train loss=0.0098, val ΔE00=6.737, best=6.737]Training (late/resnet18):   2%|▏         | 2/100 [00:14<11:24,  6.98s/it, train loss=0.0073, val ΔE00=5.622, best=5.622]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:07,  6.88s/it, train loss=0.0073, val ΔE00=5.622, best=5.622]Training (late/resnet18):   3%|▎         | 3/100 [00:20<11:07,  6.88s/it, train loss=0.0120, val ΔE00=4.447, best=4.447]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:55,  6.83s/it, train loss=0.0120, val ΔE00=4.447, best=4.447]Training (late/resnet18):   4%|▍         | 4/100 [00:27<10:55,  6.83s/it, train loss=0.0203, val ΔE00=3.923, best=3.923]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:52,  6.87s/it, train loss=0.0203, val ΔE00=3.923, best=3.923]Training (late/resnet18):   5%|▌         | 5/100 [00:34<10:52,  6.87s/it, train loss=0.0297, val ΔE00=3.958, best=3.923]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:45,  6.87s/it, train loss=0.0297, val ΔE00=3.958, best=3.923]Training (late/resnet18):   6%|▌         | 6/100 [00:41<10:45,  6.87s/it, train loss=0.0409, val ΔE00=3.760, best=3.760]Training (late/resnet18):   7%|▋         | 7/100 [00:48<10:35,  6.83s/it, train loss=0.0409, val ΔE00=3.760, best=3.760]Training (late/resnet18):   7%|▋         | 7/100 [00:48<10:35,  6.83s/it, train loss=0.0526, val ΔE00=3.485, best=3.485]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:26,  6.80s/it, train loss=0.0526, val ΔE00=3.485, best=3.485]Training (late/resnet18):   8%|▊         | 8/100 [00:54<10:26,  6.80s/it, train loss=0.0676, val ΔE00=3.366, best=3.366]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:17,  6.79s/it, train loss=0.0676, val ΔE00=3.366, best=3.366]Training (late/resnet18):   9%|▉         | 9/100 [01:01<10:17,  6.79s/it, train loss=0.0857, val ΔE00=3.343, best=3.343]Training (late/resnet18):  10%|█         | 10/100 [01:08<10:16,  6.85s/it, train loss=0.0857, val ΔE00=3.343, best=3.343]Training (late/resnet18):  10%|█         | 10/100 [01:08<10:16,  6.85s/it, train loss=0.0994, val ΔE00=3.170, best=3.170]Training (late/resnet18):  11%|█         | 11/100 [01:15<10:10,  6.86s/it, train loss=0.0994, val ΔE00=3.170, best=3.170]Training (late/resnet18):  11%|█         | 11/100 [01:15<10:10,  6.86s/it, train loss=0.1210, val ΔE00=3.142, best=3.142]Training (late/resnet18):  12%|█▏        | 12/100 [01:22<10:00,  6.82s/it, train loss=0.1210, val ΔE00=3.142, best=3.142]Training (late/resnet18):  12%|█▏        | 12/100 [01:22<10:00,  6.82s/it, train loss=0.1386, val ΔE00=2.971, best=2.971]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:49,  6.78s/it, train loss=0.1386, val ΔE00=2.971, best=2.971]Training (late/resnet18):  13%|█▎        | 13/100 [01:28<09:49,  6.78s/it, train loss=0.1545, val ΔE00=3.101, best=2.971]Training (late/resnet18):  14%|█▍        | 14/100 [01:35<09:40,  6.75s/it, train loss=0.1545, val ΔE00=3.101, best=2.971]Training (late/resnet18):  14%|█▍        | 14/100 [01:35<09:40,  6.75s/it, train loss=0.1766, val ΔE00=3.165, best=2.971]Training (late/resnet18):  15%|█▌        | 15/100 [01:42<09:40,  6.82s/it, train loss=0.1766, val ΔE00=3.165, best=2.971]Training (late/resnet18):  15%|█▌        | 15/100 [01:42<09:40,  6.82s/it, train loss=0.1967, val ΔE00=2.839, best=2.839]Training (late/resnet18):  16%|█▌        | 16/100 [01:49<09:34,  6.84s/it, train loss=0.1967, val ΔE00=2.839, best=2.839]Training (late/resnet18):  16%|█▌        | 16/100 [01:49<09:34,  6.84s/it, train loss=0.2165, val ΔE00=2.800, best=2.800]Training (late/resnet18):  17%|█▋        | 17/100 [01:56<09:25,  6.82s/it, train loss=0.2165, val ΔE00=2.800, best=2.800]Training (late/resnet18):  17%|█▋        | 17/100 [01:56<09:25,  6.82s/it, train loss=0.2409, val ΔE00=2.768, best=2.768]Training (late/resnet18):  18%|█▊        | 18/100 [02:02<09:15,  6.78s/it, train loss=0.2409, val ΔE00=2.768, best=2.768]Training (late/resnet18):  18%|█▊        | 18/100 [02:02<09:15,  6.78s/it, train loss=0.2647, val ΔE00=3.029, best=2.768]Training (late/resnet18):  19%|█▉        | 19/100 [02:09<09:07,  6.75s/it, train loss=0.2647, val ΔE00=3.029, best=2.768]Training (late/resnet18):  19%|█▉        | 19/100 [02:09<09:07,  6.75s/it, train loss=0.2846, val ΔE00=2.920, best=2.768]Training (late/resnet18):  20%|██        | 20/100 [02:16<09:05,  6.81s/it, train loss=0.2846, val ΔE00=2.920, best=2.768]Training (late/resnet18):  20%|██        | 20/100 [02:16<09:05,  6.81s/it, train loss=0.3045, val ΔE00=2.993, best=2.768]Training (late/resnet18):  21%|██        | 21/100 [02:23<08:58,  6.81s/it, train loss=0.3045, val ΔE00=2.993, best=2.768]Training (late/resnet18):  21%|██        | 21/100 [02:23<08:58,  6.81s/it, train loss=0.3221, val ΔE00=2.834, best=2.768]Training (late/resnet18):  22%|██▏       | 22/100 [02:30<08:48,  6.77s/it, train loss=0.3221, val ΔE00=2.834, best=2.768]Training (late/resnet18):  22%|██▏       | 22/100 [02:30<08:48,  6.77s/it, train loss=0.3446, val ΔE00=2.893, best=2.768]Training (late/resnet18):  23%|██▎       | 23/100 [02:36<08:41,  6.77s/it, train loss=0.3446, val ΔE00=2.893, best=2.768]Training (late/resnet18):  23%|██▎       | 23/100 [02:36<08:41,  6.77s/it, train loss=0.3621, val ΔE00=2.734, best=2.734]Training (late/resnet18):  24%|██▍       | 24/100 [02:43<08:33,  6.75s/it, train loss=0.3621, val ΔE00=2.734, best=2.734]Training (late/resnet18):  24%|██▍       | 24/100 [02:43<08:33,  6.75s/it, train loss=0.3863, val ΔE00=2.952, best=2.734]Training (late/resnet18):  25%|██▌       | 25/100 [02:50<08:31,  6.82s/it, train loss=0.3863, val ΔE00=2.952, best=2.734]Training (late/resnet18):  25%|██▌       | 25/100 [02:50<08:31,  6.82s/it, train loss=0.4263, val ΔE00=2.706, best=2.706]Training (late/resnet18):  26%|██▌       | 26/100 [02:57<08:25,  6.83s/it, train loss=0.4263, val ΔE00=2.706, best=2.706]Training (late/resnet18):  26%|██▌       | 26/100 [02:57<08:25,  6.83s/it, train loss=0.4421, val ΔE00=2.765, best=2.706]Training (late/resnet18):  27%|██▋       | 27/100 [03:04<08:15,  6.79s/it, train loss=0.4421, val ΔE00=2.765, best=2.706]Training (late/resnet18):  27%|██▋       | 27/100 [03:04<08:15,  6.79s/it, train loss=0.4770, val ΔE00=2.973, best=2.706]Training (late/resnet18):  28%|██▊       | 28/100 [03:10<08:06,  6.76s/it, train loss=0.4770, val ΔE00=2.973, best=2.706]Training (late/resnet18):  28%|██▊       | 28/100 [03:10<08:06,  6.76s/it, train loss=0.4745, val ΔE00=2.883, best=2.706]Training (late/resnet18):  29%|██▉       | 29/100 [03:17<07:58,  6.74s/it, train loss=0.4745, val ΔE00=2.883, best=2.706]Training (late/resnet18):  29%|██▉       | 29/100 [03:17<07:58,  6.74s/it, train loss=0.5423, val ΔE00=2.933, best=2.706]Training (late/resnet18):  30%|███       | 30/100 [03:24<07:55,  6.80s/it, train loss=0.5423, val ΔE00=2.933, best=2.706]Training (late/resnet18):  30%|███       | 30/100 [03:24<07:55,  6.80s/it, train loss=0.5448, val ΔE00=2.929, best=2.706]Training (late/resnet18):  31%|███       | 31/100 [03:31<07:49,  6.81s/it, train loss=0.5448, val ΔE00=2.929, best=2.706]Training (late/resnet18):  31%|███       | 31/100 [03:31<07:49,  6.81s/it, train loss=0.5762, val ΔE00=2.861, best=2.706]Training (late/resnet18):  32%|███▏      | 32/100 [03:37<07:41,  6.79s/it, train loss=0.5762, val ΔE00=2.861, best=2.706]Training (late/resnet18):  32%|███▏      | 32/100 [03:37<07:41,  6.79s/it, train loss=0.5772, val ΔE00=2.640, best=2.640]Training (late/resnet18):  33%|███▎      | 33/100 [03:44<07:33,  6.76s/it, train loss=0.5772, val ΔE00=2.640, best=2.640]Training (late/resnet18):  33%|███▎      | 33/100 [03:44<07:33,  6.76s/it, train loss=0.5920, val ΔE00=2.705, best=2.640]Training (late/resnet18):  34%|███▍      | 34/100 [03:51<07:25,  6.74s/it, train loss=0.5920, val ΔE00=2.705, best=2.640]Training (late/resnet18):  34%|███▍      | 34/100 [03:51<07:25,  6.74s/it, train loss=0.6345, val ΔE00=3.124, best=2.640]Training (late/resnet18):  35%|███▌      | 35/100 [03:58<07:23,  6.83s/it, train loss=0.6345, val ΔE00=3.124, best=2.640]Training (late/resnet18):  35%|███▌      | 35/100 [03:58<07:23,  6.83s/it, train loss=0.6308, val ΔE00=2.612, best=2.612]Training (late/resnet18):  36%|███▌      | 36/100 [04:05<07:16,  6.83s/it, train loss=0.6308, val ΔE00=2.612, best=2.612]Training (late/resnet18):  36%|███▌      | 36/100 [04:05<07:16,  6.83s/it, train loss=0.6597, val ΔE00=2.969, best=2.612]Training (late/resnet18):  37%|███▋      | 37/100 [04:11<07:07,  6.79s/it, train loss=0.6597, val ΔE00=2.969, best=2.612]Training (late/resnet18):  37%|███▋      | 37/100 [04:11<07:07,  6.79s/it, train loss=0.6926, val ΔE00=2.975, best=2.612]Training (late/resnet18):  38%|███▊      | 38/100 [04:18<06:59,  6.77s/it, train loss=0.6926, val ΔE00=2.975, best=2.612]Training (late/resnet18):  38%|███▊      | 38/100 [04:18<06:59,  6.77s/it, train loss=0.7230, val ΔE00=3.028, best=2.612]Training (late/resnet18):  39%|███▉      | 39/100 [04:25<06:51,  6.75s/it, train loss=0.7230, val ΔE00=3.028, best=2.612]Training (late/resnet18):  39%|███▉      | 39/100 [04:25<06:51,  6.75s/it, train loss=0.7409, val ΔE00=2.840, best=2.612]Training (late/resnet18):  40%|████      | 40/100 [04:32<06:48,  6.80s/it, train loss=0.7409, val ΔE00=2.840, best=2.612]Training (late/resnet18):  40%|████      | 40/100 [04:32<06:48,  6.80s/it, train loss=0.7615, val ΔE00=2.777, best=2.612]Training (late/resnet18):  41%|████      | 41/100 [04:39<06:41,  6.81s/it, train loss=0.7615, val ΔE00=2.777, best=2.612]Training (late/resnet18):  41%|████      | 41/100 [04:39<06:41,  6.81s/it, train loss=0.7991, val ΔE00=2.963, best=2.612]Training (late/resnet18):  42%|████▏     | 42/100 [04:45<06:32,  6.77s/it, train loss=0.7991, val ΔE00=2.963, best=2.612]Training (late/resnet18):  42%|████▏     | 42/100 [04:45<06:32,  6.77s/it, train loss=0.8071, val ΔE00=2.875, best=2.612]Training (late/resnet18):  43%|████▎     | 43/100 [04:52<06:24,  6.75s/it, train loss=0.8071, val ΔE00=2.875, best=2.612]Training (late/resnet18):  43%|████▎     | 43/100 [04:52<06:24,  6.75s/it, train loss=0.8068, val ΔE00=2.770, best=2.612]Training (late/resnet18):  44%|████▍     | 44/100 [04:59<06:17,  6.73s/it, train loss=0.8068, val ΔE00=2.770, best=2.612]Training (late/resnet18):  44%|████▍     | 44/100 [04:59<06:17,  6.73s/it, train loss=0.8337, val ΔE00=2.684, best=2.612]Training (late/resnet18):  45%|████▌     | 45/100 [05:06<06:14,  6.80s/it, train loss=0.8337, val ΔE00=2.684, best=2.612]Training (late/resnet18):  45%|████▌     | 45/100 [05:06<06:14,  6.80s/it, train loss=0.8352, val ΔE00=3.067, best=2.612]Training (late/resnet18):  46%|████▌     | 46/100 [05:12<06:07,  6.80s/it, train loss=0.8352, val ΔE00=3.067, best=2.612]Training (late/resnet18):  46%|████▌     | 46/100 [05:12<06:07,  6.80s/it, train loss=0.8525, val ΔE00=2.810, best=2.612]Training (late/resnet18):  47%|████▋     | 47/100 [05:19<05:59,  6.77s/it, train loss=0.8525, val ΔE00=2.810, best=2.612]Training (late/resnet18):  47%|████▋     | 47/100 [05:19<05:59,  6.77s/it, train loss=0.8632, val ΔE00=2.912, best=2.612]Training (late/resnet18):  48%|████▊     | 48/100 [05:26<05:51,  6.75s/it, train loss=0.8632, val ΔE00=2.912, best=2.612]Training (late/resnet18):  48%|████▊     | 48/100 [05:26<05:51,  6.75s/it, train loss=0.8724, val ΔE00=2.997, best=2.612]Training (late/resnet18):  49%|████▉     | 49/100 [05:33<05:43,  6.74s/it, train loss=0.8724, val ΔE00=2.997, best=2.612]Training (late/resnet18):  49%|████▉     | 49/100 [05:33<05:43,  6.74s/it, train loss=0.8753, val ΔE00=3.024, best=2.612]Training (late/resnet18):  50%|█████     | 50/100 [05:40<05:40,  6.81s/it, train loss=0.8753, val ΔE00=3.024, best=2.612]Training (late/resnet18):  50%|█████     | 50/100 [05:40<05:40,  6.81s/it, train loss=0.9425, val ΔE00=2.818, best=2.612]Training (late/resnet18):  51%|█████     | 51/100 [05:46<05:33,  6.80s/it, train loss=0.9425, val ΔE00=2.818, best=2.612]Training (late/resnet18):  51%|█████     | 51/100 [05:46<05:33,  6.80s/it, train loss=0.9496, val ΔE00=2.740, best=2.612]Training (late/resnet18):  52%|█████▏    | 52/100 [05:53<05:24,  6.77s/it, train loss=0.9496, val ΔE00=2.740, best=2.612]Training (late/resnet18):  52%|█████▏    | 52/100 [05:53<05:24,  6.77s/it, train loss=0.9386, val ΔE00=2.802, best=2.612]Training (late/resnet18):  53%|█████▎    | 53/100 [06:00<05:17,  6.75s/it, train loss=0.9386, val ΔE00=2.802, best=2.612]Training (late/resnet18):  53%|█████▎    | 53/100 [06:00<05:17,  6.75s/it, train loss=0.9649, val ΔE00=2.780, best=2.612]Training (late/resnet18):  54%|█████▍    | 54/100 [06:06<05:09,  6.73s/it, train loss=0.9649, val ΔE00=2.780, best=2.612]Training (late/resnet18):  54%|█████▍    | 54/100 [06:06<05:09,  6.73s/it, train loss=0.9492, val ΔE00=2.708, best=2.612]Training (late/resnet18):  55%|█████▌    | 55/100 [06:13<05:06,  6.80s/it, train loss=0.9492, val ΔE00=2.708, best=2.612]Training (late/resnet18):  55%|█████▌    | 55/100 [06:13<05:06,  6.80s/it, train loss=0.9639, val ΔE00=2.888, best=2.612]Training (late/resnet18):  56%|█████▌    | 56/100 [06:20<04:59,  6.80s/it, train loss=0.9639, val ΔE00=2.888, best=2.612]Training (late/resnet18):  56%|█████▌    | 56/100 [06:20<04:59,  6.80s/it, train loss=1.0838, val ΔE00=2.763, best=2.612]Training (late/resnet18):  57%|█████▋    | 57/100 [06:27<04:51,  6.77s/it, train loss=1.0838, val ΔE00=2.763, best=2.612]Training (late/resnet18):  57%|█████▋    | 57/100 [06:27<04:51,  6.77s/it, train loss=1.0934, val ΔE00=3.197, best=2.612]Training (late/resnet18):  58%|█████▊    | 58/100 [06:34<04:43,  6.75s/it, train loss=1.0934, val ΔE00=3.197, best=2.612]Training (late/resnet18):  58%|█████▊    | 58/100 [06:34<04:43,  6.75s/it, train loss=0.9532, val ΔE00=2.838, best=2.612]Training (late/resnet18):  58%|█████▊    | 58/100 [06:40<04:43,  6.75s/it, train loss=1.0530, val ΔE00=2.661, early_stop=yes]Training (late/resnet18):  58%|█████▊    | 58/100 [06:40<04:50,  6.91s/it, train loss=1.0530, val ΔE00=2.661, early_stop=yes]
[early] stop at epoch 59 (best de00=2.6118 @ 35)
[done] best ΔE00=2.612 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/late__resnet18__image+mean+meta__-focus-__layersnone__ts-2__s101__model=late__backbone=resnet18__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 9/24 ===
[sweep] id=009_model=film__backbone=smallcnn__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone smallcnn --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:04<08:10,  4.95s/it]Training (film/smallcnn):   1%|          | 1/100 [00:04<08:10,  4.95s/it, train loss=0.0070, val ΔE00=8.845, best=8.845]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:38,  4.67s/it, train loss=0.0070, val ΔE00=8.845, best=8.845]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:38,  4.67s/it, train loss=0.0077, val ΔE00=5.109, best=5.109]Training (film/smallcnn):   3%|▎         | 3/100 [00:13<07:24,  4.58s/it, train loss=0.0077, val ΔE00=5.109, best=5.109]Training (film/smallcnn):   3%|▎         | 3/100 [00:13<07:24,  4.58s/it, train loss=0.0137, val ΔE00=5.531, best=5.109]Training (film/smallcnn):   4%|▍         | 4/100 [00:18<07:16,  4.54s/it, train loss=0.0137, val ΔE00=5.531, best=5.109]Training (film/smallcnn):   4%|▍         | 4/100 [00:18<07:16,  4.54s/it, train loss=0.0243, val ΔE00=5.041, best=5.041]Training (film/smallcnn):   5%|▌         | 5/100 [00:23<07:18,  4.62s/it, train loss=0.0243, val ΔE00=5.041, best=5.041]Training (film/smallcnn):   5%|▌         | 5/100 [00:23<07:18,  4.62s/it, train loss=0.0375, val ΔE00=6.209, best=5.041]Training (film/smallcnn):   6%|▌         | 6/100 [00:27<07:11,  4.59s/it, train loss=0.0375, val ΔE00=6.209, best=5.041]Training (film/smallcnn):   6%|▌         | 6/100 [00:27<07:11,  4.59s/it, train loss=0.0565, val ΔE00=5.953, best=5.041]Training (film/smallcnn):   7%|▋         | 7/100 [00:32<07:03,  4.55s/it, train loss=0.0565, val ΔE00=5.953, best=5.041]Training (film/smallcnn):   7%|▋         | 7/100 [00:32<07:03,  4.55s/it, train loss=0.0768, val ΔE00=5.001, best=5.001]Training (film/smallcnn):   8%|▊         | 8/100 [00:36<06:56,  4.53s/it, train loss=0.0768, val ΔE00=5.001, best=5.001]Training (film/smallcnn):   8%|▊         | 8/100 [00:36<06:56,  4.53s/it, train loss=0.0978, val ΔE00=5.172, best=5.001]Training (film/smallcnn):   9%|▉         | 9/100 [00:41<06:50,  4.52s/it, train loss=0.0978, val ΔE00=5.172, best=5.001]Training (film/smallcnn):   9%|▉         | 9/100 [00:41<06:50,  4.52s/it, train loss=0.1196, val ΔE00=7.652, best=5.001]Training (film/smallcnn):  10%|█         | 10/100 [00:45<06:50,  4.57s/it, train loss=0.1196, val ΔE00=7.652, best=5.001]Training (film/smallcnn):  10%|█         | 10/100 [00:45<06:50,  4.57s/it, train loss=0.1545, val ΔE00=4.573, best=4.573]Training (film/smallcnn):  11%|█         | 11/100 [00:50<06:47,  4.58s/it, train loss=0.1545, val ΔE00=4.573, best=4.573]Training (film/smallcnn):  11%|█         | 11/100 [00:50<06:47,  4.58s/it, train loss=0.1748, val ΔE00=4.774, best=4.573]Training (film/smallcnn):  12%|█▏        | 12/100 [00:54<06:39,  4.54s/it, train loss=0.1748, val ΔE00=4.774, best=4.573]Training (film/smallcnn):  12%|█▏        | 12/100 [00:54<06:39,  4.54s/it, train loss=0.2150, val ΔE00=4.775, best=4.573]Training (film/smallcnn):  13%|█▎        | 13/100 [00:59<06:33,  4.52s/it, train loss=0.2150, val ΔE00=4.775, best=4.573]Training (film/smallcnn):  13%|█▎        | 13/100 [00:59<06:33,  4.52s/it, train loss=0.2489, val ΔE00=4.276, best=4.276]Training (film/smallcnn):  14%|█▍        | 14/100 [01:03<06:27,  4.51s/it, train loss=0.2489, val ΔE00=4.276, best=4.276]Training (film/smallcnn):  14%|█▍        | 14/100 [01:03<06:27,  4.51s/it, train loss=0.2807, val ΔE00=5.282, best=4.276]Training (film/smallcnn):  15%|█▌        | 15/100 [01:08<06:28,  4.57s/it, train loss=0.2807, val ΔE00=5.282, best=4.276]Training (film/smallcnn):  15%|█▌        | 15/100 [01:08<06:28,  4.57s/it, train loss=0.3250, val ΔE00=4.119, best=4.119]Training (film/smallcnn):  16%|█▌        | 16/100 [01:13<06:23,  4.57s/it, train loss=0.3250, val ΔE00=4.119, best=4.119]Training (film/smallcnn):  16%|█▌        | 16/100 [01:13<06:23,  4.57s/it, train loss=0.3669, val ΔE00=4.684, best=4.119]Training (film/smallcnn):  17%|█▋        | 17/100 [01:17<06:16,  4.54s/it, train loss=0.3669, val ΔE00=4.684, best=4.119]Training (film/smallcnn):  17%|█▋        | 17/100 [01:17<06:16,  4.54s/it, train loss=0.4296, val ΔE00=4.833, best=4.119]Training (film/smallcnn):  18%|█▊        | 18/100 [01:22<06:11,  4.53s/it, train loss=0.4296, val ΔE00=4.833, best=4.119]Training (film/smallcnn):  18%|█▊        | 18/100 [01:22<06:11,  4.53s/it, train loss=0.4731, val ΔE00=4.773, best=4.119]Training (film/smallcnn):  19%|█▉        | 19/100 [01:26<06:05,  4.52s/it, train loss=0.4731, val ΔE00=4.773, best=4.119]Training (film/smallcnn):  19%|█▉        | 19/100 [01:26<06:05,  4.52s/it, train loss=0.5249, val ΔE00=4.178, best=4.119]Training (film/smallcnn):  20%|██        | 20/100 [01:31<06:05,  4.57s/it, train loss=0.5249, val ΔE00=4.178, best=4.119]Training (film/smallcnn):  20%|██        | 20/100 [01:31<06:05,  4.57s/it, train loss=0.5753, val ΔE00=4.497, best=4.119]Training (film/smallcnn):  21%|██        | 21/100 [01:35<06:01,  4.58s/it, train loss=0.5753, val ΔE00=4.497, best=4.119]Training (film/smallcnn):  21%|██        | 21/100 [01:35<06:01,  4.58s/it, train loss=0.6105, val ΔE00=4.216, best=4.119]Training (film/smallcnn):  22%|██▏       | 22/100 [01:40<05:54,  4.55s/it, train loss=0.6105, val ΔE00=4.216, best=4.119]Training (film/smallcnn):  22%|██▏       | 22/100 [01:40<05:54,  4.55s/it, train loss=0.6747, val ΔE00=4.376, best=4.119]Training (film/smallcnn):  23%|██▎       | 23/100 [01:44<05:48,  4.53s/it, train loss=0.6747, val ΔE00=4.376, best=4.119]Training (film/smallcnn):  23%|██▎       | 23/100 [01:44<05:48,  4.53s/it, train loss=0.7302, val ΔE00=3.924, best=3.924]Training (film/smallcnn):  24%|██▍       | 24/100 [01:49<05:42,  4.51s/it, train loss=0.7302, val ΔE00=3.924, best=3.924]Training (film/smallcnn):  24%|██▍       | 24/100 [01:49<05:42,  4.51s/it, train loss=0.7830, val ΔE00=4.007, best=3.924]Training (film/smallcnn):  25%|██▌       | 25/100 [01:53<05:42,  4.57s/it, train loss=0.7830, val ΔE00=4.007, best=3.924]Training (film/smallcnn):  25%|██▌       | 25/100 [01:53<05:42,  4.57s/it, train loss=0.8902, val ΔE00=4.615, best=3.924]Training (film/smallcnn):  26%|██▌       | 26/100 [01:58<05:38,  4.58s/it, train loss=0.8902, val ΔE00=4.615, best=3.924]Training (film/smallcnn):  26%|██▌       | 26/100 [01:58<05:38,  4.58s/it, train loss=0.9107, val ΔE00=4.482, best=3.924]Training (film/smallcnn):  27%|██▋       | 27/100 [02:03<05:31,  4.55s/it, train loss=0.9107, val ΔE00=4.482, best=3.924]Training (film/smallcnn):  27%|██▋       | 27/100 [02:03<05:31,  4.55s/it, train loss=0.9833, val ΔE00=4.191, best=3.924]Training (film/smallcnn):  28%|██▊       | 28/100 [02:07<05:25,  4.52s/it, train loss=0.9833, val ΔE00=4.191, best=3.924]Training (film/smallcnn):  28%|██▊       | 28/100 [02:07<05:25,  4.52s/it, train loss=1.0507, val ΔE00=4.304, best=3.924]Training (film/smallcnn):  29%|██▉       | 29/100 [02:11<05:19,  4.50s/it, train loss=1.0507, val ΔE00=4.304, best=3.924]Training (film/smallcnn):  29%|██▉       | 29/100 [02:11<05:19,  4.50s/it, train loss=1.0915, val ΔE00=4.407, best=3.924]Training (film/smallcnn):  30%|███       | 30/100 [02:16<05:18,  4.56s/it, train loss=1.0915, val ΔE00=4.407, best=3.924]Training (film/smallcnn):  30%|███       | 30/100 [02:16<05:18,  4.56s/it, train loss=1.0881, val ΔE00=3.573, best=3.573]Training (film/smallcnn):  31%|███       | 31/100 [02:21<05:15,  4.57s/it, train loss=1.0881, val ΔE00=3.573, best=3.573]Training (film/smallcnn):  31%|███       | 31/100 [02:21<05:15,  4.57s/it, train loss=1.1963, val ΔE00=4.047, best=3.573]Training (film/smallcnn):  32%|███▏      | 32/100 [02:25<05:08,  4.54s/it, train loss=1.1963, val ΔE00=4.047, best=3.573]Training (film/smallcnn):  32%|███▏      | 32/100 [02:25<05:08,  4.54s/it, train loss=1.3007, val ΔE00=3.882, best=3.573]Training (film/smallcnn):  33%|███▎      | 33/100 [02:30<05:02,  4.52s/it, train loss=1.3007, val ΔE00=3.882, best=3.573]Training (film/smallcnn):  33%|███▎      | 33/100 [02:30<05:02,  4.52s/it, train loss=1.3605, val ΔE00=3.839, best=3.573]Training (film/smallcnn):  34%|███▍      | 34/100 [02:34<04:57,  4.51s/it, train loss=1.3605, val ΔE00=3.839, best=3.573]Training (film/smallcnn):  34%|███▍      | 34/100 [02:34<04:57,  4.51s/it, train loss=1.4146, val ΔE00=4.572, best=3.573]Training (film/smallcnn):  35%|███▌      | 35/100 [02:39<04:56,  4.56s/it, train loss=1.4146, val ΔE00=4.572, best=3.573]Training (film/smallcnn):  35%|███▌      | 35/100 [02:39<04:56,  4.56s/it, train loss=1.5001, val ΔE00=4.162, best=3.573]Training (film/smallcnn):  36%|███▌      | 36/100 [02:43<04:52,  4.58s/it, train loss=1.5001, val ΔE00=4.162, best=3.573]Training (film/smallcnn):  36%|███▌      | 36/100 [02:43<04:52,  4.58s/it, train loss=1.5851, val ΔE00=5.211, best=3.573]Training (film/smallcnn):  37%|███▋      | 37/100 [02:48<04:46,  4.55s/it, train loss=1.5851, val ΔE00=5.211, best=3.573]Training (film/smallcnn):  37%|███▋      | 37/100 [02:48<04:46,  4.55s/it, train loss=1.6032, val ΔE00=3.883, best=3.573]Training (film/smallcnn):  38%|███▊      | 38/100 [02:52<04:40,  4.53s/it, train loss=1.6032, val ΔE00=3.883, best=3.573]Training (film/smallcnn):  38%|███▊      | 38/100 [02:52<04:40,  4.53s/it, train loss=1.6776, val ΔE00=3.997, best=3.573]Training (film/smallcnn):  39%|███▉      | 39/100 [02:57<04:35,  4.51s/it, train loss=1.6776, val ΔE00=3.997, best=3.573]Training (film/smallcnn):  39%|███▉      | 39/100 [02:57<04:35,  4.51s/it, train loss=1.7202, val ΔE00=4.267, best=3.573]Training (film/smallcnn):  40%|████      | 40/100 [03:02<04:34,  4.57s/it, train loss=1.7202, val ΔE00=4.267, best=3.573]Training (film/smallcnn):  40%|████      | 40/100 [03:02<04:34,  4.57s/it, train loss=1.8416, val ΔE00=4.107, best=3.573]Training (film/smallcnn):  41%|████      | 41/100 [03:06<04:30,  4.58s/it, train loss=1.8416, val ΔE00=4.107, best=3.573]Training (film/smallcnn):  41%|████      | 41/100 [03:06<04:30,  4.58s/it, train loss=1.8918, val ΔE00=3.736, best=3.573]Training (film/smallcnn):  42%|████▏     | 42/100 [03:11<04:23,  4.55s/it, train loss=1.8918, val ΔE00=3.736, best=3.573]Training (film/smallcnn):  42%|████▏     | 42/100 [03:11<04:23,  4.55s/it, train loss=1.9495, val ΔE00=3.988, best=3.573]Training (film/smallcnn):  43%|████▎     | 43/100 [03:15<04:18,  4.53s/it, train loss=1.9495, val ΔE00=3.988, best=3.573]Training (film/smallcnn):  43%|████▎     | 43/100 [03:15<04:18,  4.53s/it, train loss=1.9893, val ΔE00=4.919, best=3.573]Training (film/smallcnn):  44%|████▍     | 44/100 [03:20<04:12,  4.52s/it, train loss=1.9893, val ΔE00=4.919, best=3.573]Training (film/smallcnn):  44%|████▍     | 44/100 [03:20<04:12,  4.52s/it, train loss=2.1878, val ΔE00=4.269, best=3.573]Training (film/smallcnn):  45%|████▌     | 45/100 [03:24<04:11,  4.57s/it, train loss=2.1878, val ΔE00=4.269, best=3.573]Training (film/smallcnn):  45%|████▌     | 45/100 [03:24<04:11,  4.57s/it, train loss=2.2231, val ΔE00=4.336, best=3.573]Training (film/smallcnn):  46%|████▌     | 46/100 [03:29<04:07,  4.58s/it, train loss=2.2231, val ΔE00=4.336, best=3.573]Training (film/smallcnn):  46%|████▌     | 46/100 [03:29<04:07,  4.58s/it, train loss=2.1716, val ΔE00=4.586, best=3.573]Training (film/smallcnn):  47%|████▋     | 47/100 [03:33<04:00,  4.55s/it, train loss=2.1716, val ΔE00=4.586, best=3.573]Training (film/smallcnn):  47%|████▋     | 47/100 [03:33<04:00,  4.55s/it, train loss=2.3974, val ΔE00=4.524, best=3.573]Training (film/smallcnn):  48%|████▊     | 48/100 [03:38<03:55,  4.53s/it, train loss=2.3974, val ΔE00=4.524, best=3.573]Training (film/smallcnn):  48%|████▊     | 48/100 [03:38<03:55,  4.53s/it, train loss=2.3867, val ΔE00=3.663, best=3.573]Training (film/smallcnn):  49%|████▉     | 49/100 [03:42<03:50,  4.52s/it, train loss=2.3867, val ΔE00=3.663, best=3.573]Training (film/smallcnn):  49%|████▉     | 49/100 [03:42<03:50,  4.52s/it, train loss=2.4329, val ΔE00=4.189, best=3.573]Training (film/smallcnn):  50%|█████     | 50/100 [03:47<03:48,  4.57s/it, train loss=2.4329, val ΔE00=4.189, best=3.573]Training (film/smallcnn):  50%|█████     | 50/100 [03:47<03:48,  4.57s/it, train loss=2.5713, val ΔE00=4.410, best=3.573]Training (film/smallcnn):  51%|█████     | 51/100 [03:52<03:44,  4.57s/it, train loss=2.5713, val ΔE00=4.410, best=3.573]Training (film/smallcnn):  51%|█████     | 51/100 [03:52<03:44,  4.57s/it, train loss=2.4823, val ΔE00=4.857, best=3.573]Training (film/smallcnn):  52%|█████▏    | 52/100 [03:56<03:38,  4.54s/it, train loss=2.4823, val ΔE00=4.857, best=3.573]Training (film/smallcnn):  52%|█████▏    | 52/100 [03:56<03:38,  4.54s/it, train loss=2.5481, val ΔE00=3.651, best=3.573]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:01<03:32,  4.52s/it, train loss=2.5481, val ΔE00=3.651, best=3.573]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:01<03:32,  4.52s/it, train loss=2.6854, val ΔE00=4.156, best=3.573]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:05<03:27,  4.51s/it, train loss=2.6854, val ΔE00=4.156, best=3.573]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:05<03:27,  4.51s/it, train loss=2.6686, val ΔE00=3.912, best=3.573]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:10<03:25,  4.57s/it, train loss=2.6686, val ΔE00=3.912, best=3.573]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:10<03:25,  4.57s/it, train loss=2.6643, val ΔE00=4.200, best=3.573]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:14<03:21,  4.58s/it, train loss=2.6643, val ΔE00=4.200, best=3.573]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:14<03:21,  4.58s/it, train loss=2.8372, val ΔE00=3.969, best=3.573]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:19<03:15,  4.55s/it, train loss=2.8372, val ΔE00=3.969, best=3.573]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:19<03:15,  4.55s/it, train loss=2.7838, val ΔE00=4.286, best=3.573]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:23<03:09,  4.52s/it, train loss=2.7838, val ΔE00=4.286, best=3.573]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:23<03:09,  4.52s/it, train loss=2.8065, val ΔE00=4.324, best=3.573]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:28<03:09,  4.52s/it, train loss=2.7980, val ΔE00=3.930, early_stop=yes]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:28<03:14,  4.63s/it, train loss=2.7980, val ΔE00=3.930, early_stop=yes]
[early] stop at epoch 59 (best de00=3.5733 @ 30)
[done] best ΔE00=3.573 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/film__smallcnn__image__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image/final_summary.json (kind=val)
[sweep] === Run 10/24 ===
[sweep] id=010_model=film__backbone=smallcnn__features=image+mean
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone smallcnn --features image+mean --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image+mean, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:32,  5.18s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:32,  5.18s/it, train loss=0.0063, val ΔE00=7.277, best=7.277]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:59,  4.89s/it, train loss=0.0063, val ΔE00=7.277, best=7.277]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:59,  4.89s/it, train loss=0.0072, val ΔE00=5.492, best=5.492]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:44,  4.79s/it, train loss=0.0072, val ΔE00=5.492, best=5.492]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:44,  4.79s/it, train loss=0.0124, val ΔE00=4.864, best=4.864]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:35,  4.74s/it, train loss=0.0124, val ΔE00=4.864, best=4.864]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:35,  4.74s/it, train loss=0.0222, val ΔE00=5.573, best=4.864]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:35,  4.79s/it, train loss=0.0222, val ΔE00=5.573, best=4.864]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:35,  4.79s/it, train loss=0.0353, val ΔE00=5.003, best=4.864]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:30,  4.80s/it, train loss=0.0353, val ΔE00=5.003, best=4.864]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:30,  4.80s/it, train loss=0.0503, val ΔE00=4.630, best=4.630]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:22,  4.76s/it, train loss=0.0503, val ΔE00=4.630, best=4.630]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:22,  4.76s/it, train loss=0.0700, val ΔE00=4.711, best=4.630]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:15,  4.73s/it, train loss=0.0700, val ΔE00=4.711, best=4.630]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:15,  4.73s/it, train loss=0.0875, val ΔE00=5.290, best=4.630]Training (film/smallcnn):   9%|▉         | 9/100 [00:42<07:08,  4.71s/it, train loss=0.0875, val ΔE00=5.290, best=4.630]Training (film/smallcnn):   9%|▉         | 9/100 [00:42<07:08,  4.71s/it, train loss=0.1102, val ΔE00=4.580, best=4.580]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:09,  4.77s/it, train loss=0.1102, val ΔE00=4.580, best=4.580]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:09,  4.77s/it, train loss=0.1332, val ΔE00=4.827, best=4.580]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:05,  4.78s/it, train loss=0.1332, val ΔE00=4.827, best=4.580]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:05,  4.78s/it, train loss=0.1645, val ΔE00=4.284, best=4.284]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:57,  4.74s/it, train loss=0.1645, val ΔE00=4.284, best=4.284]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:57,  4.74s/it, train loss=0.1945, val ΔE00=4.502, best=4.284]Training (film/smallcnn):  13%|█▎        | 13/100 [01:01<06:50,  4.72s/it, train loss=0.1945, val ΔE00=4.502, best=4.284]Training (film/smallcnn):  13%|█▎        | 13/100 [01:01<06:50,  4.72s/it, train loss=0.2296, val ΔE00=3.857, best=3.857]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:44,  4.71s/it, train loss=0.2296, val ΔE00=3.857, best=3.857]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:44,  4.71s/it, train loss=0.2601, val ΔE00=3.568, best=3.568]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:44,  4.76s/it, train loss=0.2601, val ΔE00=3.568, best=3.568]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:44,  4.76s/it, train loss=0.2947, val ΔE00=4.055, best=3.568]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:40,  4.76s/it, train loss=0.2947, val ΔE00=4.055, best=3.568]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:40,  4.76s/it, train loss=0.3304, val ΔE00=3.864, best=3.568]Training (film/smallcnn):  17%|█▋        | 17/100 [01:20<06:32,  4.73s/it, train loss=0.3304, val ΔE00=3.864, best=3.568]Training (film/smallcnn):  17%|█▋        | 17/100 [01:20<06:32,  4.73s/it, train loss=0.3570, val ΔE00=4.181, best=3.568]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:26,  4.72s/it, train loss=0.3570, val ΔE00=4.181, best=3.568]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:26,  4.72s/it, train loss=0.4170, val ΔE00=3.679, best=3.568]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:20,  4.70s/it, train loss=0.4170, val ΔE00=3.679, best=3.568]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:20,  4.70s/it, train loss=0.4635, val ΔE00=4.530, best=3.568]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:21,  4.76s/it, train loss=0.4635, val ΔE00=4.530, best=3.568]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:21,  4.76s/it, train loss=0.5096, val ΔE00=4.106, best=3.568]Training (film/smallcnn):  21%|██        | 21/100 [01:39<06:16,  4.77s/it, train loss=0.5096, val ΔE00=4.106, best=3.568]Training (film/smallcnn):  21%|██        | 21/100 [01:39<06:16,  4.77s/it, train loss=0.5237, val ΔE00=3.667, best=3.568]Training (film/smallcnn):  22%|██▏       | 22/100 [01:44<06:09,  4.74s/it, train loss=0.5237, val ΔE00=3.667, best=3.568]Training (film/smallcnn):  22%|██▏       | 22/100 [01:44<06:09,  4.74s/it, train loss=0.6036, val ΔE00=4.118, best=3.568]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:03,  4.72s/it, train loss=0.6036, val ΔE00=4.118, best=3.568]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:03,  4.72s/it, train loss=0.6417, val ΔE00=3.684, best=3.568]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:58,  4.71s/it, train loss=0.6417, val ΔE00=3.684, best=3.568]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:58,  4.71s/it, train loss=0.7186, val ΔE00=3.887, best=3.568]Training (film/smallcnn):  25%|██▌       | 25/100 [01:58<05:57,  4.77s/it, train loss=0.7186, val ΔE00=3.887, best=3.568]Training (film/smallcnn):  25%|██▌       | 25/100 [01:58<05:57,  4.77s/it, train loss=0.7366, val ΔE00=3.847, best=3.568]Training (film/smallcnn):  26%|██▌       | 26/100 [02:03<05:53,  4.78s/it, train loss=0.7366, val ΔE00=3.847, best=3.568]Training (film/smallcnn):  26%|██▌       | 26/100 [02:03<05:53,  4.78s/it, train loss=0.7920, val ΔE00=3.733, best=3.568]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:46,  4.75s/it, train loss=0.7920, val ΔE00=3.733, best=3.568]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:46,  4.75s/it, train loss=0.8674, val ΔE00=3.791, best=3.568]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:40,  4.72s/it, train loss=0.8674, val ΔE00=3.791, best=3.568]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:40,  4.72s/it, train loss=0.9412, val ΔE00=4.291, best=3.568]Training (film/smallcnn):  29%|██▉       | 29/100 [02:17<05:34,  4.71s/it, train loss=0.9412, val ΔE00=4.291, best=3.568]Training (film/smallcnn):  29%|██▉       | 29/100 [02:17<05:34,  4.71s/it, train loss=0.9557, val ΔE00=4.054, best=3.568]Training (film/smallcnn):  30%|███       | 30/100 [02:22<05:33,  4.77s/it, train loss=0.9557, val ΔE00=4.054, best=3.568]Training (film/smallcnn):  30%|███       | 30/100 [02:22<05:33,  4.77s/it, train loss=1.0355, val ΔE00=3.753, best=3.568]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:29,  4.77s/it, train loss=1.0355, val ΔE00=3.753, best=3.568]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:29,  4.77s/it, train loss=1.1379, val ΔE00=4.314, best=3.568]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:22,  4.74s/it, train loss=1.1379, val ΔE00=4.314, best=3.568]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:22,  4.74s/it, train loss=1.2077, val ΔE00=4.251, best=3.568]Training (film/smallcnn):  33%|███▎      | 33/100 [02:36<05:16,  4.72s/it, train loss=1.2077, val ΔE00=4.251, best=3.568]Training (film/smallcnn):  33%|███▎      | 33/100 [02:36<05:16,  4.72s/it, train loss=1.2289, val ΔE00=4.337, best=3.568]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:10,  4.71s/it, train loss=1.2289, val ΔE00=4.337, best=3.568]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:10,  4.71s/it, train loss=1.2790, val ΔE00=4.192, best=3.568]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:09,  4.77s/it, train loss=1.2790, val ΔE00=4.192, best=3.568]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:09,  4.77s/it, train loss=1.3492, val ΔE00=3.852, best=3.568]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:05,  4.78s/it, train loss=1.3492, val ΔE00=3.852, best=3.568]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:05,  4.78s/it, train loss=1.4116, val ΔE00=4.410, best=3.568]Training (film/smallcnn):  37%|███▋      | 37/100 [02:55<04:59,  4.75s/it, train loss=1.4116, val ΔE00=4.410, best=3.568]Training (film/smallcnn):  37%|███▋      | 37/100 [02:55<04:59,  4.75s/it, train loss=1.4543, val ΔE00=4.097, best=3.568]Training (film/smallcnn):  38%|███▊      | 38/100 [03:00<04:52,  4.72s/it, train loss=1.4543, val ΔE00=4.097, best=3.568]Training (film/smallcnn):  38%|███▊      | 38/100 [03:00<04:52,  4.72s/it, train loss=1.5505, val ΔE00=4.060, best=3.568]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:47,  4.71s/it, train loss=1.5505, val ΔE00=4.060, best=3.568]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:47,  4.71s/it, train loss=1.5644, val ΔE00=3.954, best=3.568]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:46,  4.77s/it, train loss=1.5644, val ΔE00=3.954, best=3.568]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:46,  4.77s/it, train loss=1.6400, val ΔE00=3.841, best=3.568]Training (film/smallcnn):  41%|████      | 41/100 [03:14<04:42,  4.78s/it, train loss=1.6400, val ΔE00=3.841, best=3.568]Training (film/smallcnn):  41%|████      | 41/100 [03:14<04:42,  4.78s/it, train loss=1.6695, val ΔE00=3.678, best=3.568]Training (film/smallcnn):  42%|████▏     | 42/100 [03:19<04:35,  4.75s/it, train loss=1.6695, val ΔE00=3.678, best=3.568]Training (film/smallcnn):  42%|████▏     | 42/100 [03:19<04:35,  4.75s/it, train loss=1.7972, val ΔE00=3.996, best=3.568]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:29,  4.73s/it, train loss=1.7972, val ΔE00=3.996, best=3.568]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:29,  4.73s/it, train loss=1.7022, val ΔE00=3.879, best=3.568]Training (film/smallcnn):  44%|████▍     | 44/100 [03:28<04:23,  4.71s/it, train loss=1.7022, val ΔE00=3.879, best=3.568]Training (film/smallcnn):  44%|████▍     | 44/100 [03:28<04:23,  4.71s/it, train loss=2.0050, val ΔE00=3.689, best=3.568]Training (film/smallcnn):  45%|████▌     | 45/100 [03:33<04:22,  4.77s/it, train loss=2.0050, val ΔE00=3.689, best=3.568]Training (film/smallcnn):  45%|████▌     | 45/100 [03:33<04:22,  4.77s/it, train loss=1.8644, val ΔE00=3.537, best=3.537]Training (film/smallcnn):  46%|████▌     | 46/100 [03:38<04:17,  4.78s/it, train loss=1.8644, val ΔE00=3.537, best=3.537]Training (film/smallcnn):  46%|████▌     | 46/100 [03:38<04:17,  4.78s/it, train loss=2.0166, val ΔE00=4.721, best=3.537]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:11,  4.74s/it, train loss=2.0166, val ΔE00=4.721, best=3.537]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:11,  4.74s/it, train loss=2.0098, val ΔE00=3.739, best=3.537]Training (film/smallcnn):  48%|████▊     | 48/100 [03:47<04:05,  4.72s/it, train loss=2.0098, val ΔE00=3.739, best=3.537]Training (film/smallcnn):  48%|████▊     | 48/100 [03:47<04:05,  4.72s/it, train loss=2.0854, val ΔE00=3.580, best=3.537]Training (film/smallcnn):  49%|████▉     | 49/100 [03:52<04:00,  4.71s/it, train loss=2.0854, val ΔE00=3.580, best=3.537]Training (film/smallcnn):  49%|████▉     | 49/100 [03:52<04:00,  4.71s/it, train loss=2.2080, val ΔE00=3.837, best=3.537]Training (film/smallcnn):  50%|█████     | 50/100 [03:57<03:58,  4.76s/it, train loss=2.2080, val ΔE00=3.837, best=3.537]Training (film/smallcnn):  50%|█████     | 50/100 [03:57<03:58,  4.76s/it, train loss=2.1069, val ΔE00=4.257, best=3.537]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:54,  4.78s/it, train loss=2.1069, val ΔE00=4.257, best=3.537]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:54,  4.78s/it, train loss=2.1947, val ΔE00=3.547, best=3.537]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:07<03:47,  4.75s/it, train loss=2.1947, val ΔE00=3.547, best=3.537]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:07<03:47,  4.75s/it, train loss=2.2943, val ΔE00=4.028, best=3.537]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:11<03:42,  4.73s/it, train loss=2.2943, val ΔE00=4.028, best=3.537]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:11<03:42,  4.73s/it, train loss=2.3370, val ΔE00=3.743, best=3.537]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:16<03:36,  4.72s/it, train loss=2.3370, val ΔE00=3.743, best=3.537]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:16<03:36,  4.72s/it, train loss=2.3261, val ΔE00=3.834, best=3.537]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:34,  4.77s/it, train loss=2.3261, val ΔE00=3.834, best=3.537]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:34,  4.77s/it, train loss=2.3239, val ΔE00=3.645, best=3.537]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:26<03:30,  4.78s/it, train loss=2.3239, val ΔE00=3.645, best=3.537]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:26<03:30,  4.78s/it, train loss=2.4471, val ΔE00=3.492, best=3.492]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:30<03:24,  4.75s/it, train loss=2.4471, val ΔE00=3.492, best=3.492]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:30<03:24,  4.75s/it, train loss=2.4249, val ΔE00=4.139, best=3.492]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:35<03:18,  4.73s/it, train loss=2.4249, val ΔE00=4.139, best=3.492]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:35<03:18,  4.73s/it, train loss=2.5126, val ΔE00=3.688, best=3.492]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:40<03:13,  4.71s/it, train loss=2.5126, val ΔE00=3.688, best=3.492]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:40<03:13,  4.71s/it, train loss=2.5070, val ΔE00=3.963, best=3.492]Training (film/smallcnn):  60%|██████    | 60/100 [04:45<03:10,  4.77s/it, train loss=2.5070, val ΔE00=3.963, best=3.492]Training (film/smallcnn):  60%|██████    | 60/100 [04:45<03:10,  4.77s/it, train loss=2.5633, val ΔE00=3.772, best=3.492]Training (film/smallcnn):  61%|██████    | 61/100 [04:49<03:06,  4.78s/it, train loss=2.5633, val ΔE00=3.772, best=3.492]Training (film/smallcnn):  61%|██████    | 61/100 [04:49<03:06,  4.78s/it, train loss=2.6332, val ΔE00=4.271, best=3.492]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:54<03:00,  4.74s/it, train loss=2.6332, val ΔE00=4.271, best=3.492]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:54<03:00,  4.74s/it, train loss=2.5940, val ΔE00=3.531, best=3.492]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:59<02:54,  4.72s/it, train loss=2.5940, val ΔE00=3.531, best=3.492]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:59<02:54,  4.72s/it, train loss=2.7964, val ΔE00=3.647, best=3.492]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:03<02:49,  4.71s/it, train loss=2.7964, val ΔE00=3.647, best=3.492]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:03<02:49,  4.71s/it, train loss=2.6164, val ΔE00=3.902, best=3.492]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:08<02:47,  4.78s/it, train loss=2.6164, val ΔE00=3.902, best=3.492]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:08<02:47,  4.78s/it, train loss=2.7571, val ΔE00=3.909, best=3.492]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:13<02:47,  4.78s/it, train loss=2.7798, val ΔE00=3.625, early_stop=yes]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:13<02:48,  4.82s/it, train loss=2.7798, val ΔE00=3.625, early_stop=yes]
[early] stop at epoch 66 (best de00=3.4920 @ 56)
[done] best ΔE00=3.492 over 66 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/film__smallcnn__image+mean__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean/final_summary.json (kind=val)
[sweep] === Run 11/24 ===
[sweep] id=011_model=film__backbone=smallcnn__features=image+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone smallcnn --features image+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image+meta, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:34,  5.20s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:34,  5.20s/it, train loss=0.0070, val ΔE00=6.450, best=6.450]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<08:00,  4.90s/it, train loss=0.0070, val ΔE00=6.450, best=6.450]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<08:00,  4.90s/it, train loss=0.0060, val ΔE00=4.820, best=4.820]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:45,  4.80s/it, train loss=0.0060, val ΔE00=4.820, best=4.820]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:45,  4.80s/it, train loss=0.0113, val ΔE00=4.512, best=4.512]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:37,  4.76s/it, train loss=0.0113, val ΔE00=4.512, best=4.512]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:37,  4.76s/it, train loss=0.0200, val ΔE00=5.752, best=4.512]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:37,  4.82s/it, train loss=0.0200, val ΔE00=5.752, best=4.512]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:37,  4.82s/it, train loss=0.0302, val ΔE00=4.341, best=4.341]Training (film/smallcnn):   6%|▌         | 6/100 [00:29<07:32,  4.82s/it, train loss=0.0302, val ΔE00=4.341, best=4.341]Training (film/smallcnn):   6%|▌         | 6/100 [00:29<07:32,  4.82s/it, train loss=0.0459, val ΔE00=4.133, best=4.133]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:24,  4.78s/it, train loss=0.0459, val ΔE00=4.133, best=4.133]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:24,  4.78s/it, train loss=0.0597, val ΔE00=3.312, best=3.312]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:16,  4.75s/it, train loss=0.0597, val ΔE00=3.312, best=3.312]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:16,  4.75s/it, train loss=0.0709, val ΔE00=3.373, best=3.312]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:10,  4.73s/it, train loss=0.0709, val ΔE00=3.373, best=3.312]Training (film/smallcnn):   9%|▉         | 9/100 [00:43<07:10,  4.73s/it, train loss=0.0945, val ΔE00=3.141, best=3.141]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:10,  4.78s/it, train loss=0.0945, val ΔE00=3.141, best=3.141]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:10,  4.78s/it, train loss=0.1109, val ΔE00=3.140, best=3.140]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:07,  4.80s/it, train loss=0.1109, val ΔE00=3.140, best=3.140]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:07,  4.80s/it, train loss=0.1386, val ΔE00=2.944, best=2.944]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:59,  4.77s/it, train loss=0.1386, val ΔE00=2.944, best=2.944]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:59,  4.77s/it, train loss=0.1589, val ΔE00=2.812, best=2.812]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:52,  4.74s/it, train loss=0.1589, val ΔE00=2.812, best=2.812]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:52,  4.74s/it, train loss=0.1816, val ΔE00=3.787, best=2.812]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:46,  4.72s/it, train loss=0.1816, val ΔE00=3.787, best=2.812]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:46,  4.72s/it, train loss=0.2075, val ΔE00=2.994, best=2.812]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:45,  4.77s/it, train loss=0.2075, val ΔE00=2.994, best=2.812]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:45,  4.77s/it, train loss=0.2546, val ΔE00=3.608, best=2.812]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:41,  4.78s/it, train loss=0.2546, val ΔE00=3.608, best=2.812]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:41,  4.78s/it, train loss=0.2846, val ΔE00=4.211, best=2.812]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:34,  4.75s/it, train loss=0.2846, val ΔE00=4.211, best=2.812]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:34,  4.75s/it, train loss=0.3065, val ΔE00=2.844, best=2.812]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:27,  4.72s/it, train loss=0.3065, val ΔE00=2.844, best=2.812]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:27,  4.72s/it, train loss=0.3319, val ΔE00=2.935, best=2.812]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:21,  4.71s/it, train loss=0.3319, val ΔE00=2.935, best=2.812]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:21,  4.71s/it, train loss=0.3709, val ΔE00=2.982, best=2.812]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:21,  4.76s/it, train loss=0.3709, val ΔE00=2.982, best=2.812]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:21,  4.76s/it, train loss=0.3882, val ΔE00=3.024, best=2.812]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:16,  4.77s/it, train loss=0.3882, val ΔE00=3.024, best=2.812]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:16,  4.77s/it, train loss=0.4407, val ΔE00=3.356, best=2.812]Training (film/smallcnn):  22%|██▏       | 22/100 [01:44<06:10,  4.75s/it, train loss=0.4407, val ΔE00=3.356, best=2.812]Training (film/smallcnn):  22%|██▏       | 22/100 [01:44<06:10,  4.75s/it, train loss=0.4741, val ΔE00=3.374, best=2.812]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:03,  4.72s/it, train loss=0.4741, val ΔE00=3.374, best=2.812]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:03,  4.72s/it, train loss=0.4982, val ΔE00=3.088, best=2.812]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:57,  4.71s/it, train loss=0.4982, val ΔE00=3.088, best=2.812]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:57,  4.71s/it, train loss=0.5455, val ΔE00=3.627, best=2.812]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:57,  4.76s/it, train loss=0.5455, val ΔE00=3.627, best=2.812]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:57,  4.76s/it, train loss=0.6242, val ΔE00=3.231, best=2.812]Training (film/smallcnn):  26%|██▌       | 26/100 [02:03<05:53,  4.77s/it, train loss=0.6242, val ΔE00=3.231, best=2.812]Training (film/smallcnn):  26%|██▌       | 26/100 [02:03<05:53,  4.77s/it, train loss=0.6511, val ΔE00=3.025, best=2.812]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:46,  4.75s/it, train loss=0.6511, val ΔE00=3.025, best=2.812]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:46,  4.75s/it, train loss=0.6758, val ΔE00=2.707, best=2.707]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:40,  4.73s/it, train loss=0.6758, val ΔE00=2.707, best=2.707]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:40,  4.73s/it, train loss=0.7241, val ΔE00=2.552, best=2.552]Training (film/smallcnn):  29%|██▉       | 29/100 [02:18<05:34,  4.71s/it, train loss=0.7241, val ΔE00=2.552, best=2.552]Training (film/smallcnn):  29%|██▉       | 29/100 [02:18<05:34,  4.71s/it, train loss=0.7581, val ΔE00=2.726, best=2.552]Training (film/smallcnn):  30%|███       | 30/100 [02:22<05:33,  4.77s/it, train loss=0.7581, val ΔE00=2.726, best=2.552]Training (film/smallcnn):  30%|███       | 30/100 [02:22<05:33,  4.77s/it, train loss=0.8644, val ΔE00=3.020, best=2.552]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:29,  4.77s/it, train loss=0.8644, val ΔE00=3.020, best=2.552]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:29,  4.77s/it, train loss=0.8673, val ΔE00=3.006, best=2.552]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:22,  4.74s/it, train loss=0.8673, val ΔE00=3.006, best=2.552]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:22,  4.74s/it, train loss=0.8673, val ΔE00=3.818, best=2.552]Training (film/smallcnn):  33%|███▎      | 33/100 [02:37<05:16,  4.72s/it, train loss=0.8673, val ΔE00=3.818, best=2.552]Training (film/smallcnn):  33%|███▎      | 33/100 [02:37<05:16,  4.72s/it, train loss=0.8816, val ΔE00=2.865, best=2.552]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:10,  4.71s/it, train loss=0.8816, val ΔE00=2.865, best=2.552]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:10,  4.71s/it, train loss=0.9451, val ΔE00=2.754, best=2.552]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:09,  4.76s/it, train loss=0.9451, val ΔE00=2.754, best=2.552]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:09,  4.76s/it, train loss=0.9892, val ΔE00=2.693, best=2.552]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:05,  4.77s/it, train loss=0.9892, val ΔE00=2.693, best=2.552]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:05,  4.77s/it, train loss=1.0674, val ΔE00=2.812, best=2.552]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<04:58,  4.74s/it, train loss=1.0674, val ΔE00=2.812, best=2.552]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<04:58,  4.74s/it, train loss=1.1008, val ΔE00=3.079, best=2.552]Training (film/smallcnn):  38%|███▊      | 38/100 [03:00<04:52,  4.72s/it, train loss=1.1008, val ΔE00=3.079, best=2.552]Training (film/smallcnn):  38%|███▊      | 38/100 [03:00<04:52,  4.72s/it, train loss=1.1392, val ΔE00=2.889, best=2.552]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:46,  4.70s/it, train loss=1.1392, val ΔE00=2.889, best=2.552]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:46,  4.70s/it, train loss=1.1434, val ΔE00=2.857, best=2.552]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:45,  4.76s/it, train loss=1.1434, val ΔE00=2.857, best=2.552]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:45,  4.76s/it, train loss=1.1744, val ΔE00=2.620, best=2.552]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:41,  4.77s/it, train loss=1.1744, val ΔE00=2.620, best=2.552]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:41,  4.77s/it, train loss=1.2618, val ΔE00=2.551, best=2.551]Training (film/smallcnn):  42%|████▏     | 42/100 [03:19<04:35,  4.74s/it, train loss=1.2618, val ΔE00=2.551, best=2.551]Training (film/smallcnn):  42%|████▏     | 42/100 [03:19<04:35,  4.74s/it, train loss=1.2553, val ΔE00=2.344, best=2.344]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:29,  4.72s/it, train loss=1.2553, val ΔE00=2.344, best=2.344]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:29,  4.72s/it, train loss=1.3310, val ΔE00=3.235, best=2.344]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:24,  4.72s/it, train loss=1.3310, val ΔE00=3.235, best=2.344]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:24,  4.72s/it, train loss=1.3178, val ΔE00=2.835, best=2.344]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:22,  4.78s/it, train loss=1.3178, val ΔE00=2.835, best=2.344]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:22,  4.78s/it, train loss=1.3891, val ΔE00=2.688, best=2.344]Training (film/smallcnn):  46%|████▌     | 46/100 [03:38<04:18,  4.79s/it, train loss=1.3891, val ΔE00=2.688, best=2.344]Training (film/smallcnn):  46%|████▌     | 46/100 [03:38<04:18,  4.79s/it, train loss=1.4340, val ΔE00=2.877, best=2.344]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:12,  4.76s/it, train loss=1.4340, val ΔE00=2.877, best=2.344]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:12,  4.76s/it, train loss=1.4626, val ΔE00=2.720, best=2.344]Training (film/smallcnn):  48%|████▊     | 48/100 [03:48<04:06,  4.73s/it, train loss=1.4626, val ΔE00=2.720, best=2.344]Training (film/smallcnn):  48%|████▊     | 48/100 [03:48<04:06,  4.73s/it, train loss=1.5817, val ΔE00=2.457, best=2.344]Training (film/smallcnn):  49%|████▉     | 49/100 [03:52<04:00,  4.72s/it, train loss=1.5817, val ΔE00=2.457, best=2.344]Training (film/smallcnn):  49%|████▉     | 49/100 [03:52<04:00,  4.72s/it, train loss=1.5494, val ΔE00=2.529, best=2.344]Training (film/smallcnn):  50%|█████     | 50/100 [03:57<03:58,  4.78s/it, train loss=1.5494, val ΔE00=2.529, best=2.344]Training (film/smallcnn):  50%|█████     | 50/100 [03:57<03:58,  4.78s/it, train loss=1.6575, val ΔE00=2.963, best=2.344]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:54,  4.79s/it, train loss=1.6575, val ΔE00=2.963, best=2.344]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:54,  4.79s/it, train loss=1.7519, val ΔE00=2.292, best=2.292]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:07<03:48,  4.75s/it, train loss=1.7519, val ΔE00=2.292, best=2.292]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:07<03:48,  4.75s/it, train loss=1.6280, val ΔE00=2.451, best=2.292]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:12<03:42,  4.73s/it, train loss=1.6280, val ΔE00=2.451, best=2.292]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:12<03:42,  4.73s/it, train loss=1.7381, val ΔE00=2.560, best=2.292]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:16<03:37,  4.72s/it, train loss=1.7381, val ΔE00=2.560, best=2.292]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:16<03:37,  4.72s/it, train loss=1.8818, val ΔE00=2.803, best=2.292]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:35,  4.78s/it, train loss=1.8818, val ΔE00=2.803, best=2.292]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:35,  4.78s/it, train loss=1.7672, val ΔE00=2.581, best=2.292]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:26<03:30,  4.79s/it, train loss=1.7672, val ΔE00=2.581, best=2.292]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:26<03:30,  4.79s/it, train loss=1.7977, val ΔE00=2.595, best=2.292]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:31<03:24,  4.76s/it, train loss=1.7977, val ΔE00=2.595, best=2.292]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:31<03:24,  4.76s/it, train loss=1.8389, val ΔE00=2.422, best=2.292]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:35<03:18,  4.73s/it, train loss=1.8389, val ΔE00=2.422, best=2.292]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:35<03:18,  4.73s/it, train loss=1.7937, val ΔE00=2.441, best=2.292]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:40<03:13,  4.72s/it, train loss=1.7937, val ΔE00=2.441, best=2.292]Training (film/smallcnn):  59%|█████▉    | 59/100 [04:40<03:13,  4.72s/it, train loss=1.7934, val ΔE00=2.191, best=2.191]Training (film/smallcnn):  60%|██████    | 60/100 [04:45<03:11,  4.79s/it, train loss=1.7934, val ΔE00=2.191, best=2.191]Training (film/smallcnn):  60%|██████    | 60/100 [04:45<03:11,  4.79s/it, train loss=1.8719, val ΔE00=2.656, best=2.191]Training (film/smallcnn):  61%|██████    | 61/100 [04:50<03:06,  4.77s/it, train loss=1.8719, val ΔE00=2.656, best=2.191]Training (film/smallcnn):  61%|██████    | 61/100 [04:50<03:06,  4.77s/it, train loss=1.9086, val ΔE00=2.357, best=2.191]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:54<03:00,  4.75s/it, train loss=1.9086, val ΔE00=2.357, best=2.191]Training (film/smallcnn):  62%|██████▏   | 62/100 [04:54<03:00,  4.75s/it, train loss=1.8633, val ΔE00=2.304, best=2.191]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:59<02:54,  4.73s/it, train loss=1.8633, val ΔE00=2.304, best=2.191]Training (film/smallcnn):  63%|██████▎   | 63/100 [04:59<02:54,  4.73s/it, train loss=1.9485, val ΔE00=2.717, best=2.191]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:04<02:49,  4.72s/it, train loss=1.9485, val ΔE00=2.717, best=2.191]Training (film/smallcnn):  64%|██████▍   | 64/100 [05:04<02:49,  4.72s/it, train loss=1.9318, val ΔE00=2.552, best=2.191]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:09<02:47,  4.77s/it, train loss=1.9318, val ΔE00=2.552, best=2.191]Training (film/smallcnn):  65%|██████▌   | 65/100 [05:09<02:47,  4.77s/it, train loss=2.1431, val ΔE00=2.209, best=2.191]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:13<02:42,  4.78s/it, train loss=2.1431, val ΔE00=2.209, best=2.191]Training (film/smallcnn):  66%|██████▌   | 66/100 [05:13<02:42,  4.78s/it, train loss=2.0435, val ΔE00=2.491, best=2.191]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:18<02:36,  4.75s/it, train loss=2.0435, val ΔE00=2.491, best=2.191]Training (film/smallcnn):  67%|██████▋   | 67/100 [05:18<02:36,  4.75s/it, train loss=2.0486, val ΔE00=2.984, best=2.191]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:23<02:31,  4.73s/it, train loss=2.0486, val ΔE00=2.984, best=2.191]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:23<02:31,  4.73s/it, train loss=1.8650, val ΔE00=2.613, best=2.191]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:27<02:31,  4.73s/it, train loss=2.0257, val ΔE00=2.950, early_stop=yes]Training (film/smallcnn):  68%|██████▊   | 68/100 [05:27<02:34,  4.82s/it, train loss=2.0257, val ΔE00=2.950, early_stop=yes]
[early] stop at epoch 69 (best de00=2.1911 @ 59)
[done] best ΔE00=2.191 over 69 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/film__smallcnn__image+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+meta/final_summary.json (kind=val)
[sweep] === Run 12/24 ===
[sweep] id=012_model=film__backbone=smallcnn__features=image+mean+meta
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone smallcnn --features image+mean+meta --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=smallcnn, features=image+mean+meta, meta_encoder=none
[run] model=film backbone=smallcnn train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/smallcnn):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:34,  5.19s/it]Training (film/smallcnn):   1%|          | 1/100 [00:05<08:34,  5.19s/it, train loss=0.0060, val ΔE00=6.939, best=6.939]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:59,  4.89s/it, train loss=0.0060, val ΔE00=6.939, best=6.939]Training (film/smallcnn):   2%|▏         | 2/100 [00:09<07:59,  4.89s/it, train loss=0.0067, val ΔE00=5.133, best=5.133]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:45,  4.79s/it, train loss=0.0067, val ΔE00=5.133, best=5.133]Training (film/smallcnn):   3%|▎         | 3/100 [00:14<07:45,  4.79s/it, train loss=0.0116, val ΔE00=4.839, best=4.839]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:35,  4.75s/it, train loss=0.0116, val ΔE00=4.839, best=4.839]Training (film/smallcnn):   4%|▍         | 4/100 [00:19<07:35,  4.75s/it, train loss=0.0196, val ΔE00=4.899, best=4.839]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:36,  4.80s/it, train loss=0.0196, val ΔE00=4.899, best=4.839]Training (film/smallcnn):   5%|▌         | 5/100 [00:24<07:36,  4.80s/it, train loss=0.0292, val ΔE00=4.497, best=4.497]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:31,  4.81s/it, train loss=0.0292, val ΔE00=4.497, best=4.497]Training (film/smallcnn):   6%|▌         | 6/100 [00:28<07:31,  4.81s/it, train loss=0.0416, val ΔE00=3.689, best=3.689]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:23,  4.77s/it, train loss=0.0416, val ΔE00=3.689, best=3.689]Training (film/smallcnn):   7%|▋         | 7/100 [00:33<07:23,  4.77s/it, train loss=0.0535, val ΔE00=3.867, best=3.689]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:15,  4.74s/it, train loss=0.0535, val ΔE00=3.867, best=3.689]Training (film/smallcnn):   8%|▊         | 8/100 [00:38<07:15,  4.74s/it, train loss=0.0682, val ΔE00=4.129, best=3.689]Training (film/smallcnn):   9%|▉         | 9/100 [00:42<07:09,  4.72s/it, train loss=0.0682, val ΔE00=4.129, best=3.689]Training (film/smallcnn):   9%|▉         | 9/100 [00:42<07:09,  4.72s/it, train loss=0.0842, val ΔE00=3.694, best=3.689]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:10,  4.78s/it, train loss=0.0842, val ΔE00=3.694, best=3.689]Training (film/smallcnn):  10%|█         | 10/100 [00:47<07:10,  4.78s/it, train loss=0.0993, val ΔE00=3.101, best=3.101]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:06,  4.79s/it, train loss=0.0993, val ΔE00=3.101, best=3.101]Training (film/smallcnn):  11%|█         | 11/100 [00:52<07:06,  4.79s/it, train loss=0.1185, val ΔE00=3.176, best=3.101]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:58,  4.76s/it, train loss=0.1185, val ΔE00=3.176, best=3.101]Training (film/smallcnn):  12%|█▏        | 12/100 [00:57<06:58,  4.76s/it, train loss=0.1365, val ΔE00=2.912, best=2.912]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:51,  4.73s/it, train loss=0.1365, val ΔE00=2.912, best=2.912]Training (film/smallcnn):  13%|█▎        | 13/100 [01:02<06:51,  4.73s/it, train loss=0.1577, val ΔE00=3.002, best=2.912]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:45,  4.71s/it, train loss=0.1577, val ΔE00=3.002, best=2.912]Training (film/smallcnn):  14%|█▍        | 14/100 [01:06<06:45,  4.71s/it, train loss=0.1841, val ΔE00=3.151, best=2.912]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:44,  4.76s/it, train loss=0.1841, val ΔE00=3.151, best=2.912]Training (film/smallcnn):  15%|█▌        | 15/100 [01:11<06:44,  4.76s/it, train loss=0.2046, val ΔE00=3.059, best=2.912]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:41,  4.78s/it, train loss=0.2046, val ΔE00=3.059, best=2.912]Training (film/smallcnn):  16%|█▌        | 16/100 [01:16<06:41,  4.78s/it, train loss=0.2376, val ΔE00=2.914, best=2.912]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:34,  4.75s/it, train loss=0.2376, val ΔE00=2.914, best=2.912]Training (film/smallcnn):  17%|█▋        | 17/100 [01:21<06:34,  4.75s/it, train loss=0.2642, val ΔE00=2.695, best=2.695]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:27,  4.72s/it, train loss=0.2642, val ΔE00=2.695, best=2.695]Training (film/smallcnn):  18%|█▊        | 18/100 [01:25<06:27,  4.72s/it, train loss=0.2810, val ΔE00=2.842, best=2.695]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:21,  4.71s/it, train loss=0.2810, val ΔE00=2.842, best=2.695]Training (film/smallcnn):  19%|█▉        | 19/100 [01:30<06:21,  4.71s/it, train loss=0.3089, val ΔE00=3.008, best=2.695]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:21,  4.77s/it, train loss=0.3089, val ΔE00=3.008, best=2.695]Training (film/smallcnn):  20%|██        | 20/100 [01:35<06:21,  4.77s/it, train loss=0.3353, val ΔE00=3.074, best=2.695]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:17,  4.77s/it, train loss=0.3353, val ΔE00=3.074, best=2.695]Training (film/smallcnn):  21%|██        | 21/100 [01:40<06:17,  4.77s/it, train loss=0.3712, val ΔE00=2.684, best=2.684]Training (film/smallcnn):  22%|██▏       | 22/100 [01:44<06:10,  4.75s/it, train loss=0.3712, val ΔE00=2.684, best=2.684]Training (film/smallcnn):  22%|██▏       | 22/100 [01:44<06:10,  4.75s/it, train loss=0.3938, val ΔE00=3.990, best=2.684]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:03,  4.73s/it, train loss=0.3938, val ΔE00=3.990, best=2.684]Training (film/smallcnn):  23%|██▎       | 23/100 [01:49<06:03,  4.73s/it, train loss=0.4449, val ΔE00=2.458, best=2.458]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:57,  4.71s/it, train loss=0.4449, val ΔE00=2.458, best=2.458]Training (film/smallcnn):  24%|██▍       | 24/100 [01:54<05:57,  4.71s/it, train loss=0.4631, val ΔE00=3.419, best=2.458]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:58,  4.78s/it, train loss=0.4631, val ΔE00=3.419, best=2.458]Training (film/smallcnn):  25%|██▌       | 25/100 [01:59<05:58,  4.78s/it, train loss=0.4952, val ΔE00=2.447, best=2.447]Training (film/smallcnn):  26%|██▌       | 26/100 [02:03<05:53,  4.77s/it, train loss=0.4952, val ΔE00=2.447, best=2.447]Training (film/smallcnn):  26%|██▌       | 26/100 [02:03<05:53,  4.77s/it, train loss=0.5134, val ΔE00=2.685, best=2.447]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:46,  4.74s/it, train loss=0.5134, val ΔE00=2.685, best=2.447]Training (film/smallcnn):  27%|██▋       | 27/100 [02:08<05:46,  4.74s/it, train loss=0.5516, val ΔE00=2.491, best=2.447]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:40,  4.72s/it, train loss=0.5516, val ΔE00=2.491, best=2.447]Training (film/smallcnn):  28%|██▊       | 28/100 [02:13<05:40,  4.72s/it, train loss=0.5952, val ΔE00=2.540, best=2.447]Training (film/smallcnn):  29%|██▉       | 29/100 [02:17<05:34,  4.71s/it, train loss=0.5952, val ΔE00=2.540, best=2.447]Training (film/smallcnn):  29%|██▉       | 29/100 [02:17<05:34,  4.71s/it, train loss=0.6179, val ΔE00=2.490, best=2.447]Training (film/smallcnn):  30%|███       | 30/100 [02:22<05:33,  4.77s/it, train loss=0.6179, val ΔE00=2.490, best=2.447]Training (film/smallcnn):  30%|███       | 30/100 [02:22<05:33,  4.77s/it, train loss=0.6708, val ΔE00=2.576, best=2.447]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:29,  4.78s/it, train loss=0.6708, val ΔE00=2.576, best=2.447]Training (film/smallcnn):  31%|███       | 31/100 [02:27<05:29,  4.78s/it, train loss=0.6798, val ΔE00=2.517, best=2.447]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:22,  4.75s/it, train loss=0.6798, val ΔE00=2.517, best=2.447]Training (film/smallcnn):  32%|███▏      | 32/100 [02:32<05:22,  4.75s/it, train loss=0.7472, val ΔE00=2.580, best=2.447]Training (film/smallcnn):  33%|███▎      | 33/100 [02:36<05:16,  4.73s/it, train loss=0.7472, val ΔE00=2.580, best=2.447]Training (film/smallcnn):  33%|███▎      | 33/100 [02:36<05:16,  4.73s/it, train loss=0.7688, val ΔE00=2.533, best=2.447]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:10,  4.71s/it, train loss=0.7688, val ΔE00=2.533, best=2.447]Training (film/smallcnn):  34%|███▍      | 34/100 [02:41<05:10,  4.71s/it, train loss=0.7813, val ΔE00=2.591, best=2.447]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:10,  4.77s/it, train loss=0.7813, val ΔE00=2.591, best=2.447]Training (film/smallcnn):  35%|███▌      | 35/100 [02:46<05:10,  4.77s/it, train loss=0.8324, val ΔE00=2.613, best=2.447]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:06,  4.78s/it, train loss=0.8324, val ΔE00=2.613, best=2.447]Training (film/smallcnn):  36%|███▌      | 36/100 [02:51<05:06,  4.78s/it, train loss=0.8526, val ΔE00=2.658, best=2.447]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<04:59,  4.75s/it, train loss=0.8526, val ΔE00=2.658, best=2.447]Training (film/smallcnn):  37%|███▋      | 37/100 [02:56<04:59,  4.75s/it, train loss=0.8940, val ΔE00=2.733, best=2.447]Training (film/smallcnn):  38%|███▊      | 38/100 [03:00<04:53,  4.73s/it, train loss=0.8940, val ΔE00=2.733, best=2.447]Training (film/smallcnn):  38%|███▊      | 38/100 [03:00<04:53,  4.73s/it, train loss=0.9557, val ΔE00=2.853, best=2.447]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:48,  4.72s/it, train loss=0.9557, val ΔE00=2.853, best=2.447]Training (film/smallcnn):  39%|███▉      | 39/100 [03:05<04:48,  4.72s/it, train loss=0.9498, val ΔE00=2.445, best=2.445]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:47,  4.80s/it, train loss=0.9498, val ΔE00=2.445, best=2.445]Training (film/smallcnn):  40%|████      | 40/100 [03:10<04:47,  4.80s/it, train loss=1.0049, val ΔE00=2.707, best=2.445]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:42,  4.79s/it, train loss=1.0049, val ΔE00=2.707, best=2.445]Training (film/smallcnn):  41%|████      | 41/100 [03:15<04:42,  4.79s/it, train loss=0.9985, val ΔE00=2.505, best=2.445]Training (film/smallcnn):  42%|████▏     | 42/100 [03:19<04:36,  4.76s/it, train loss=0.9985, val ΔE00=2.505, best=2.445]Training (film/smallcnn):  42%|████▏     | 42/100 [03:19<04:36,  4.76s/it, train loss=1.0636, val ΔE00=2.523, best=2.445]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:30,  4.74s/it, train loss=1.0636, val ΔE00=2.523, best=2.445]Training (film/smallcnn):  43%|████▎     | 43/100 [03:24<04:30,  4.74s/it, train loss=1.0590, val ΔE00=2.731, best=2.445]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:24,  4.73s/it, train loss=1.0590, val ΔE00=2.731, best=2.445]Training (film/smallcnn):  44%|████▍     | 44/100 [03:29<04:24,  4.73s/it, train loss=1.1195, val ΔE00=2.595, best=2.445]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:24,  4.80s/it, train loss=1.1195, val ΔE00=2.595, best=2.445]Training (film/smallcnn):  45%|████▌     | 45/100 [03:34<04:24,  4.80s/it, train loss=1.1494, val ΔE00=2.697, best=2.445]Training (film/smallcnn):  46%|████▌     | 46/100 [03:39<04:18,  4.79s/it, train loss=1.1494, val ΔE00=2.697, best=2.445]Training (film/smallcnn):  46%|████▌     | 46/100 [03:39<04:18,  4.79s/it, train loss=1.1715, val ΔE00=2.141, best=2.141]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:12,  4.76s/it, train loss=1.1715, val ΔE00=2.141, best=2.141]Training (film/smallcnn):  47%|████▋     | 47/100 [03:43<04:12,  4.76s/it, train loss=1.2314, val ΔE00=2.857, best=2.141]Training (film/smallcnn):  48%|████▊     | 48/100 [03:48<04:06,  4.74s/it, train loss=1.2314, val ΔE00=2.857, best=2.141]Training (film/smallcnn):  48%|████▊     | 48/100 [03:48<04:06,  4.74s/it, train loss=1.2107, val ΔE00=2.380, best=2.141]Training (film/smallcnn):  49%|████▉     | 49/100 [03:53<04:01,  4.73s/it, train loss=1.2107, val ΔE00=2.380, best=2.141]Training (film/smallcnn):  49%|████▉     | 49/100 [03:53<04:01,  4.73s/it, train loss=1.2340, val ΔE00=2.207, best=2.141]Training (film/smallcnn):  50%|█████     | 50/100 [03:57<03:58,  4.78s/it, train loss=1.2340, val ΔE00=2.207, best=2.141]Training (film/smallcnn):  50%|█████     | 50/100 [03:57<03:58,  4.78s/it, train loss=1.3007, val ΔE00=2.320, best=2.141]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:54,  4.79s/it, train loss=1.3007, val ΔE00=2.320, best=2.141]Training (film/smallcnn):  51%|█████     | 51/100 [04:02<03:54,  4.79s/it, train loss=1.3304, val ΔE00=3.520, best=2.141]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:07<03:48,  4.76s/it, train loss=1.3304, val ΔE00=3.520, best=2.141]Training (film/smallcnn):  52%|█████▏    | 52/100 [04:07<03:48,  4.76s/it, train loss=1.3644, val ΔE00=3.014, best=2.141]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:12<03:42,  4.74s/it, train loss=1.3644, val ΔE00=3.014, best=2.141]Training (film/smallcnn):  53%|█████▎    | 53/100 [04:12<03:42,  4.74s/it, train loss=1.3765, val ΔE00=2.650, best=2.141]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:16<03:37,  4.73s/it, train loss=1.3765, val ΔE00=2.650, best=2.141]Training (film/smallcnn):  54%|█████▍    | 54/100 [04:16<03:37,  4.73s/it, train loss=1.3726, val ΔE00=2.562, best=2.141]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:35,  4.79s/it, train loss=1.3726, val ΔE00=2.562, best=2.141]Training (film/smallcnn):  55%|█████▌    | 55/100 [04:21<03:35,  4.79s/it, train loss=1.4913, val ΔE00=2.678, best=2.141]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:26<03:30,  4.79s/it, train loss=1.4913, val ΔE00=2.678, best=2.141]Training (film/smallcnn):  56%|█████▌    | 56/100 [04:26<03:30,  4.79s/it, train loss=1.4412, val ΔE00=2.233, best=2.141]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:31<03:24,  4.76s/it, train loss=1.4412, val ΔE00=2.233, best=2.141]Training (film/smallcnn):  57%|█████▋    | 57/100 [04:31<03:24,  4.76s/it, train loss=1.4916, val ΔE00=2.432, best=2.141]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:35<03:19,  4.74s/it, train loss=1.4916, val ΔE00=2.432, best=2.141]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:35<03:19,  4.74s/it, train loss=1.4887, val ΔE00=2.826, best=2.141]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:40<03:19,  4.74s/it, train loss=1.4543, val ΔE00=2.528, early_stop=yes]Training (film/smallcnn):  58%|█████▊    | 58/100 [04:40<03:23,  4.84s/it, train loss=1.4543, val ΔE00=2.528, early_stop=yes]
[early] stop at epoch 59 (best de00=2.1413 @ 46)
[done] best ΔE00=2.141 over 59 epochs
[eval] Wrote final summary → ./checkpoints/results/no-bg2/full/film__smallcnn__image+mean+meta__-focus-__layersnone__ts-2__s101__model=film__backbone=smallcnn__features=image+mean+meta/final_summary.json (kind=val)
[sweep] === Run 13/24 ===
[sweep] id=013_model=film__backbone=resnet18__features=image
[run]  python -m src.engine.experiment --images_dir /home/data/Pantone/cropped-256-ada --json_dir /home/data/Pantone/original --labels_csv /home/data/Pantone/gt/pantone_labels.csv --outdir ./checkpoints/results/no-bg2/full --logdir ./runs/results/no-bg2/full --included_folders focus --group_split class --epochs 100 --batch_size 32 --val_split 0.15 --seed 101 --color_space rgb --pred_activation sigmoid_eps --mse_space rgb --mse_weight_start 1.0 --mse_weight_epochs 75 --robust huber --optim adamw --weight_decay 0.0001 --lr_schedule cosine --meta_encoder none --token_stage=-2 --min_keep_epochs 0 --save_top_k 1 --ckpt_monitor de00 --ckpt_mode min --early_stop_patience 10 --early_stop_min_delta 0.008 --early_stop_monitor de00 --early_stop_mode min --early_stop_min_epoch 50 --restore_best_on_stop --model film --backbone resnet18 --features image --tag_keys model backbone features
[split] Included 2070/2070 samples by folders ['focus'] (subdirs included)
[split] train=1755 val=315
[diag] diag_start: model=film, backbone=resnet18, features=image, meta_encoder=none
[run] model=film backbone=resnet18 train=1755 val=315 epochs=100 optim=adamw lr=0.00100 wd=0.0001 momentum=— schedule=cosine
Training (film/resnet18):   0%|          | 0/100 [00:00<?, ?it/s]Training (film/resnet18):   1%|          | 1/100 [00:05<09:48,  5.95s/it]Training (film/resnet18):   1%|          | 1/100 [00:05<09:48,  5.95s/it, train loss=0.0095, val ΔE00=6.703, best=6.703]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:13,  5.64s/it, train loss=0.0095, val ΔE00=6.703, best=6.703]Training (film/resnet18):   2%|▏         | 2/100 [00:11<09:13,  5.64s/it, train loss=0.0068, val ΔE00=5.388, best=5.388]Training (film/resnet18):   3%|▎         | 3/100 [00:16<08:58,  5.55s/it, train loss=0.0068, val ΔE00=5.388, best=5.388]Training (film/resnet18):   3%|▎         | 3/100 [00:16<08:58,  5.55s/it, train loss=0.0131, val ΔE00=5.016, best=5.016]Training (film/resnet18):   4%|▍         | 4/100 [00:22<08:48,  5.50s/it, train loss=0.0131, val ΔE00=5.016, best=5.016]Training (film/resnet18):   4%|▍         | 4/100 [00:22<08:48,  5.50s/it, train loss=0.0210, val ΔE00=4.789, best=4.789]Training (film/resnet18):   5%|▌         | 5/100 [00:27<08:48,  5.56s/it, train loss=0.0210, val ΔE00=4.789, best=4.789]Training (film/resnet18):   5%|▌         | 5/100 [00:27<08:48,  5.56s/it, train loss=0.0326, val ΔE00=4.415, best=4.415]Training (film/resnet18):   6%|▌         | 6/100 [00:33<08:42,  5.56s/it, train loss=0.0326, val ΔE00=4.415, best=4.415]Training (film/resnet18):   6%|▌         | 6/100 [00:33<08:42,  5.56s/it, train loss=0.0452, val ΔE00=4.177, best=4.177]Training (film/resnet18):   7%|▋         | 7/100 [00:38<08:31,  5.50s/it, train loss=0.0452, val ΔE00=4.177, best=4.177]Training (film/resnet18):   7%|▋         | 7/100 [00:38<08:31,  5.50s/it, train loss=0.0604, val ΔE00=4.350, best=4.177]Training (film/resnet18):   8%|▊         | 8/100 [00:44<08:22,  5.46s/it, train loss=0.0604, val ΔE00=4.350, best=4.177]Training (film/resnet18):   8%|▊         | 8/100 [00:44<08:22,  5.46s/it, train loss=0.0786, val ΔE00=5.404, best=4.177]Training (film/resnet18):   9%|▉         | 9/100 [00:49<08:15,  5.45s/it, train loss=0.0786, val ΔE00=5.404, best=4.177]Training (film/resnet18):   9%|▉         | 9/100 [00:49<08:15,  5.45s/it, train loss=0.0970, val ΔE00=3.801, best=3.801]